/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var x={389:(x,S,w)=>{"use strict";w.r(S),w.d(S,{glTFLoader:()=>ae});var U=w(685);var G=w(160);var H;H=function vec4_create(){var x=new U.WT(4);return U.WT!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0,x[3]=0),x}();function quat_create(){var x=new U.WT(4);return U.WT!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0),x[3]=1,x}function slerp(x,S,w,G){var H,z,j,X,K,q=S[0],Y=S[1],Z=S[2],J=S[3],Q=w[0],ee=w[1],te=w[2],ne=w[3];return(z=q*Q+Y*ee+Z*te+J*ne)<0&&(z=-z,Q=-Q,ee=-ee,te=-te,ne=-ne),1-z>U.Ib?(H=Math.acos(z),j=Math.sin(H),X=Math.sin((1-G)*H)/j,K=Math.sin(G*H)/j):(X=1-G,K=G),x[0]=X*q+K*Q,x[1]=X*Y+K*ee,x[2]=X*Z+K*te,x[3]=X*J+K*ne,x}var z,j,X,K,q,Y,Z,J=function vec4_set(x,S,w,U,G){return x[0]=S,x[1]=w,x[2]=U,x[3]=G,x},Q=function normalize(x,S){var w=S[0],U=S[1],G=S[2],H=S[3],z=w*w+U*U+G*G+H*H;return z>0&&(z=1/Math.sqrt(z)),x[0]=w*z,x[1]=U*z,x[2]=G*z,x[3]=H*z,x},ee=(z=G.Ue(),j=G.al(1,0,0),X=G.al(0,1,0),K=quat_create(),q=quat_create(),Y=function create(){var x=new U.WT(9);return U.WT!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x}(),w(975)),te=te||{},ne=te.Scene=function(){this.meshes=[]},ie=te.Mesh=function(){this.meshID="",this.primitives=[]},re=te.Primitive=function(){this.mode=4,this.matrix=ee.Ue(),this.indices=null,this.indicesComponentType=5123,this.vertexBuffer=null,this.attributes={},this.material=null,this.technique=null},oe=te.glTFModel=function(){this.defaultScene="",this.scenes={},this.nodeMatrix={},this.json=null,this.shaders={},this.programs={},this.images={}},ae=te.glTFLoader=function(x){Z=x,this._init(),this.glTF=null};ae.prototype._init=function(){this._parseDone=!1,this._loadDone=!1,this._bufferRequested=0,this._bufferLoaded=0,this._buffers={},this._bufferTasks={},this._bufferViews={},this._shaderRequested=0,this._shaderLoaded=0,this._imageRequested=0,this._imageLoaded=0,this._pendingTasks=0,this._finishedPendingTasks=0,this.onload=null},ae.prototype._getBufferViewData=function(x,S,w){var U=this._bufferViews[S];if(U)w(U);else{var G=x.bufferViews[S],H=this._buffers[G.buffer];if(H)this._bufferViews[S]=H.slice(G.byteOffset,G.byteOffset+G.byteLength),w(U);else{this._pendingTasks++;var z=this._bufferTasks[G.buffer];z||(this._bufferTasks[G.buffer]=[],z=this._bufferTasks[G.buffer]);var j=this;z.push((function(x){var U=j._bufferViews[S];U||(console.log("create new BufferView Data for "+S),U=j._bufferViews[S]=x.slice(G.byteOffset,G.byteOffset+G.byteLength)),j._finishedPendingTasks++,w(U)}))}}},ae.prototype._checkComplete=function(){this._bufferRequested==this._bufferLoaded&&this._shaderRequested==this._shaderLoaded&&this._imageRequested==this._imageLoaded&&(this._loadDone=!0),this._loadDone&&this._parseDone&&this._pendingTasks==this._finishedPendingTasks&&this.onload(this.glTF)},ae.prototype._parseGLTF=function(x){if(this.glTF.json=x,this.glTF.defaultScene=x.scene,x.scenes)for(var S in x.scenes){var w=new ne;this.glTF.scenes[S]=w;for(var U=x.scenes[S].nodes,G=U.length,H=0;H<G;++H){var z=U[H];this._parseNode(x,z,w)}}this._parseDone=!0,this._checkComplete()};var se=G.Ue(),le=quat_create(),ce=G.Ue(),ue=ee.Ue();ae.prototype._parseNode=function(x,S,w,U){var H=x.nodes[S];void 0===U&&(U=ee.Ue());var z=ee.Ue();if(H.hasOwnProperty("matrix")){for(var j=0;j<16;++j)z[j]=H.matrix[j];ee.Jp(z,U,z)}else G.t8(se,H.translation[0],H.translation[1],H.translation[2]),J(le,H.rotation[0],H.rotation[1],H.rotation[2],H.rotation[3]),ee.yl(ue,le,se),ee.Jp(z,z,ue),G.t8(ce,H.scale[0],H.scale[1],H.scale[2]),ee.bA(z,z,ce);this.glTF.nodeMatrix[S]=z;var X=H.meshes;if(X)for(var K=X.length,q=0;q<K;++q){var Y=new ie;w.meshes.push(Y);var Z=X[q],Q=x.meshes[Z];Y.meshID=Z;for(var te=Q.primitives,ne=te.length,oe=0;oe<ne;++oe){var ae=new re;Y.primitives.push(ae);var he=te[oe];he.indices&&this._parseIndices(x,he,ae),this._parseAttributes(x,he,ae,z),ae.material=x.materials[he.material],ae.material.technique&&(ae.technique=x.techniques[ae.material.technique])}}for(var de=H.children,pe=de.length,me=0;me<pe;++me){var fe=de[me];this._parseNode(x,fe,w,z)}},ae.prototype._parseIndices=function(x,S,w){var U=S.indices,G=x.accessors[U];w.mode=S.mode||4,w.indicesComponentType=G.componentType;var H=this;this._getBufferViewData(x,G.bufferView,(function(x){w.indices=function _getAccessorData(x,S){return _arrayBuffer2TypedArray(x,S.byteOffset,S.count*de[S.type],S.componentType)}(x,G),H._checkComplete()}))},ae.prototype._parseAttributes=function(x,S,w,U){var G=Object.keys(S.attributes)[0],H=x.accessors[S.attributes[G]],z=H.bufferView,j=x.bufferViews[z],X=this;this._getBufferViewData(x,z,(function(G){w.vertexBuffer=_arrayBuffer2TypedArray(G,0,j.byteLength/he[H.componentType],H.componentType);for(var z in S.attributes){var K=S.attributes[z],q=x.accessors[K],Y=he[q.componentType];q.byteStride,q.byteOffset,q.count;ee.JG(w.matrix,U),w.attributes[z]={size:de[q.type],type:q.componentType,stride:q.byteStride,offset:q.byteOffset}}X._checkComplete()}))},ae.prototype.loadGLTF=function(x,S){this._init(),this.onload=S||function(x){console.log("glTF model loaded."),console.log(x)},this.glTF=new oe,this.baseUri=function _getBaseUri(x){var S="",w=x.lastIndexOf("/");-1!==w&&(S=x.substring(0,w+1));return S}(x);var w=this;!function _loadJSON(x,S){var w=new XMLHttpRequest;w.overrideMimeType("application/json"),w.open("GET",x,!0),w.onreadystatechange=function(){4==w.readyState&&"200"==w.status&&S(w.responseText,this)},w.send(null)}(x,(function(x){var S,U=JSON.parse(x),G=function loadArrayBufferCallback(x){var U,G;if(w._buffers[S]=x,w._bufferLoaded++,w._bufferTasks[S])for(U=0,G=w._bufferTasks[S].length;U<G;++U)w._bufferTasks[S][U](x);w._checkComplete()};if(U.buffers)for(S in U.buffers)w._bufferRequested++,_loadArrayBuffer(w.baseUri+U.buffers[S].uri,G);var H,z,j,X=function loadImageCallback(x,S){w._imageLoaded++,w.glTF.images[S]=x,w._checkComplete()};if(U.images)for(H in U.images)w._imageRequested++,_loadImage(w.baseUri+U.images[H].uri,H,X);var K=function loadVertexShaderFileCallback(x){w._shaderLoaded++,j.vertexShader=x,j.fragmentShader&&(j.program=_createProgram(Z,j.vertexShader,j.fragmentShader),w._checkComplete())},q=function loadFragmentShaderFileCallback(x){w._shaderLoaded++,j.fragmentShader=x,j.vertexShader&&(j.program=_createProgram(Z,j.vertexShader,j.fragmentShader),w._checkComplete())};if(U.programs)for(z in U.programs){j=w.glTF.programs[z]={vertexShader:null,fragmentShader:null,program:null};var Y=U.programs[z];w._shaderRequested+=2,_loadShaderFile(w.baseUri+U.shaders[Y.vertexShader].uri,K),_loadShaderFile(w.baseUri+U.shaders[Y.fragmentShader].uri,q)}w._parseGLTF(U)}))};var he={5120:1,5121:1,5122:2,5123:2,5126:4},de={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function _arrayBuffer2TypedArray(x,S,w,U){switch(U){case 5122:return new Int16Array(x,S,w);case 5123:return new Uint16Array(x,S,w);case 5124:return new Int32Array(x,S,w);case 5125:return new Uint32Array(x,S,w);case 5126:return new Float32Array(x,S,w);default:return null}}function _loadArrayBuffer(x,S){var w=new XMLHttpRequest;w.responseType="arraybuffer",w.open("GET",x,!0),w.onreadystatechange=function(){if(4==w.readyState&&"200"==w.status){var x=w.response;x&&S&&S(x)}},w.send(null)}function _loadShaderFile(x,S){var w=new XMLHttpRequest;w.responseType="text",w.open("GET",x,!0),w.onreadystatechange=function(){if(4==w.readyState&&"200"==w.status){var x=w.response;x&&S&&S(x)}},w.send(null)}function _loadImage(x,S,w){var U=new Image;U.src=x,U.onload=function(){w(U,S)}}function _createShader(x,S,w){var U=x.createShader(w);return x.shaderSource(U,S),x.compileShader(U),U}function _createProgram(x,S,w){var U=x.createProgram(),G=_createShader(x,S,x.VERTEX_SHADER),H=_createShader(x,w,x.FRAGMENT_SHADER);x.attachShader(U,G),x.deleteShader(G),x.attachShader(U,H),x.deleteShader(H),x.linkProgram(U);var z=x.getProgramInfoLog(U);return z&&console.log(z),(z=x.getShaderInfoLog(G))&&console.log(z),(z=x.getShaderInfoLog(H))&&console.log(z),U}te.Attributes=["POSITION","NORMAL","TEXCOORD","COLOR","JOINT","WEIGHT"]},943:(x,S,w)=>{"use strict";function colorToString(x,S){var w=x.__state.conversionName.toString(),U=Math.round(x.r),G=Math.round(x.g),H=Math.round(x.b),z=x.a,j=Math.round(x.h),X=x.s.toFixed(1),K=x.v.toFixed(1);if(S||"THREE_CHAR_HEX"===w||"SIX_CHAR_HEX"===w){for(var q=x.hex.toString(16);q.length<6;)q="0"+q;return"#"+q}return"CSS_RGB"===w?"rgb("+U+","+G+","+H+")":"CSS_RGBA"===w?"rgba("+U+","+G+","+H+","+z+")":"HEX"===w?"0x"+x.hex.toString(16):"RGB_ARRAY"===w?"["+U+","+G+","+H+"]":"RGBA_ARRAY"===w?"["+U+","+G+","+H+","+z+"]":"RGB_OBJ"===w?"{r:"+U+",g:"+G+",b:"+H+"}":"RGBA_OBJ"===w?"{r:"+U+",g:"+G+",b:"+H+",a:"+z+"}":"HSV_OBJ"===w?"{h:"+j+",s:"+X+",v:"+K+"}":"HSVA_OBJ"===w?"{h:"+j+",s:"+X+",v:"+K+",a:"+z+"}":"unknown format"}w.d(S,{BJ:()=>Ve,JG:()=>abort,nS:()=>$e,Dd:()=>ze,JQ:()=>Ne,gl:()=>De,NR:()=>He,Re:()=>makeRenderLoop});var U=Array.prototype.forEach,G=Array.prototype.slice,H={BREAK:{},extend:function extend(x){return this.each(G.call(arguments,1),(function(S){(this.isObject(S)?Object.keys(S):[]).forEach(function(w){this.isUndefined(S[w])||(x[w]=S[w])}.bind(this))}),this),x},defaults:function defaults(x){return this.each(G.call(arguments,1),(function(S){(this.isObject(S)?Object.keys(S):[]).forEach(function(w){this.isUndefined(x[w])&&(x[w]=S[w])}.bind(this))}),this),x},compose:function compose(){var x=G.call(arguments);return function(){for(var S=G.call(arguments),w=x.length-1;w>=0;w--)S=[x[w].apply(this,S)];return S[0]}},each:function each(x,S,w){if(x)if(U&&x.forEach&&x.forEach===U)x.forEach(S,w);else if(x.length===x.length+0){var G,H=void 0;for(H=0,G=x.length;H<G;H++)if(H in x&&S.call(w,x[H],H)===this.BREAK)return}else for(var z in x)if(S.call(w,x[z],z)===this.BREAK)return},defer:function defer(x){setTimeout(x,0)},debounce:function debounce(x,S,w){var U=void 0;return function(){var G=this,H=arguments;function delayed(){U=null,w||x.apply(G,H)}var z=w||!U;clearTimeout(U),U=setTimeout(delayed,S),z&&x.apply(G,H)}},toArray:function toArray(x){return x.toArray?x.toArray():G.call(x)},isUndefined:function isUndefined(x){return void 0===x},isNull:function isNull(x){return null===x},isNaN:function(x){function isNaN(S){return x.apply(this,arguments)}return isNaN.toString=function(){return x.toString()},isNaN}((function(x){return isNaN(x)})),isArray:Array.isArray||function(x){return x.constructor===Array},isObject:function isObject(x){return x===Object(x)},isNumber:function isNumber(x){return x===x+0},isString:function isString(x){return x===x+""},isBoolean:function isBoolean(x){return!1===x||!0===x},isFunction:function isFunction(x){return x instanceof Function}},z=[{litmus:H.isString,conversions:{THREE_CHAR_HEX:{read:function read(x){var S=x.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==S&&{space:"HEX",hex:parseInt("0x"+S[1].toString()+S[1].toString()+S[2].toString()+S[2].toString()+S[3].toString()+S[3].toString(),0)}},write:colorToString},SIX_CHAR_HEX:{read:function read(x){var S=x.match(/^#([A-F0-9]{6})$/i);return null!==S&&{space:"HEX",hex:parseInt("0x"+S[1].toString(),0)}},write:colorToString},CSS_RGB:{read:function read(x){var S=x.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==S&&{space:"RGB",r:parseFloat(S[1]),g:parseFloat(S[2]),b:parseFloat(S[3])}},write:colorToString},CSS_RGBA:{read:function read(x){var S=x.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==S&&{space:"RGB",r:parseFloat(S[1]),g:parseFloat(S[2]),b:parseFloat(S[3]),a:parseFloat(S[4])}},write:colorToString}}},{litmus:H.isNumber,conversions:{HEX:{read:function read(x){return{space:"HEX",hex:x,conversionName:"HEX"}},write:function write(x){return x.hex}}}},{litmus:H.isArray,conversions:{RGB_ARRAY:{read:function read(x){return 3===x.length&&{space:"RGB",r:x[0],g:x[1],b:x[2]}},write:function write(x){return[x.r,x.g,x.b]}},RGBA_ARRAY:{read:function read(x){return 4===x.length&&{space:"RGB",r:x[0],g:x[1],b:x[2],a:x[3]}},write:function write(x){return[x.r,x.g,x.b,x.a]}}}},{litmus:H.isObject,conversions:{RGBA_OBJ:{read:function read(x){return!!(H.isNumber(x.r)&&H.isNumber(x.g)&&H.isNumber(x.b)&&H.isNumber(x.a))&&{space:"RGB",r:x.r,g:x.g,b:x.b,a:x.a}},write:function write(x){return{r:x.r,g:x.g,b:x.b,a:x.a}}},RGB_OBJ:{read:function read(x){return!!(H.isNumber(x.r)&&H.isNumber(x.g)&&H.isNumber(x.b))&&{space:"RGB",r:x.r,g:x.g,b:x.b}},write:function write(x){return{r:x.r,g:x.g,b:x.b}}},HSVA_OBJ:{read:function read(x){return!!(H.isNumber(x.h)&&H.isNumber(x.s)&&H.isNumber(x.v)&&H.isNumber(x.a))&&{space:"HSV",h:x.h,s:x.s,v:x.v,a:x.a}},write:function write(x){return{h:x.h,s:x.s,v:x.v,a:x.a}}},HSV_OBJ:{read:function read(x){return!!(H.isNumber(x.h)&&H.isNumber(x.s)&&H.isNumber(x.v))&&{space:"HSV",h:x.h,s:x.s,v:x.v}},write:function write(x){return{h:x.h,s:x.s,v:x.v}}}}}],j=void 0,X=void 0,K=function interpret(){X=!1;var x=arguments.length>1?H.toArray(arguments):arguments[0];return H.each(z,(function(S){if(S.litmus(x))return H.each(S.conversions,(function(S,w){if(j=S.read(x),!1===X&&!1!==j)return X=j,j.conversionName=w,j.conversion=S,H.BREAK})),H.BREAK})),X},q=void 0,Y={hsv_to_rgb:function hsv_to_rgb(x,S,w){var U=Math.floor(x/60)%6,G=x/60-Math.floor(x/60),H=w*(1-S),z=w*(1-G*S),j=w*(1-(1-G)*S),X=[[w,j,H],[z,w,H],[H,w,j],[H,z,w],[j,H,w],[w,H,z]][U];return{r:255*X[0],g:255*X[1],b:255*X[2]}},rgb_to_hsv:function rgb_to_hsv(x,S,w){var U=Math.min(x,S,w),G=Math.max(x,S,w),H=G-U,z=void 0;return 0===G?{h:NaN,s:0,v:0}:(z=x===G?(S-w)/H:S===G?2+(w-x)/H:4+(x-S)/H,(z/=6)<0&&(z+=1),{h:360*z,s:H/G,v:G/255})},rgb_to_hex:function rgb_to_hex(x,S,w){var U=this.hex_with_component(0,2,x);return U=this.hex_with_component(U,1,S),U=this.hex_with_component(U,0,w)},component_from_hex:function component_from_hex(x,S){return x>>8*S&255},hex_with_component:function hex_with_component(x,S,w){return w<<(q=8*S)|x&~(255<<q)}},Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(x){return typeof x}:function(x){return x&&"function"==typeof Symbol&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},classCallCheck=function(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")},J=function(){function defineProperties(x,S){for(var w=0;w<S.length;w++){var U=S[w];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(x,U.key,U)}}return function(x,S,w){return S&&defineProperties(x.prototype,S),w&&defineProperties(x,w),x}}(),Q=function get(x,S,w){null===x&&(x=Function.prototype);var U=Object.getOwnPropertyDescriptor(x,S);if(void 0===U){var G=Object.getPrototypeOf(x);return null===G?void 0:get(G,S,w)}if("value"in U)return U.value;var H=U.get;return void 0!==H?H.call(w):void 0},inherits=function(x,S){if("function"!=typeof S&&null!==S)throw new TypeError("Super expression must either be null or a function, not "+typeof S);x.prototype=Object.create(S&&S.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(x,S):x.__proto__=S)},possibleConstructorReturn=function(x,S){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!S||"object"!=typeof S&&"function"!=typeof S?x:S},ee=function(){function Color(){if(classCallCheck(this,Color),this.__state=K.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return J(Color,[{key:"toString",value:function toString(){return colorToString(this)}},{key:"toHexString",value:function toHexString(){return colorToString(this,!0)}},{key:"toOriginal",value:function toOriginal(){return this.__state.conversion.write(this)}}]),Color}();function defineRGBComponent(x,S,w){Object.defineProperty(x,S,{get:function get$$1(){return"RGB"===this.__state.space||ee.recalculateRGB(this,S,w),this.__state[S]},set:function set$$1(x){"RGB"!==this.__state.space&&(ee.recalculateRGB(this,S,w),this.__state.space="RGB"),this.__state[S]=x}})}function defineHSVComponent(x,S){Object.defineProperty(x,S,{get:function get$$1(){return"HSV"===this.__state.space||ee.recalculateHSV(this),this.__state[S]},set:function set$$1(x){"HSV"!==this.__state.space&&(ee.recalculateHSV(this),this.__state.space="HSV"),this.__state[S]=x}})}ee.recalculateRGB=function(x,S,w){if("HEX"===x.__state.space)x.__state[S]=Y.component_from_hex(x.__state.hex,w);else{if("HSV"!==x.__state.space)throw new Error("Corrupted color state");H.extend(x.__state,Y.hsv_to_rgb(x.__state.h,x.__state.s,x.__state.v))}},ee.recalculateHSV=function(x){var S=Y.rgb_to_hsv(x.r,x.g,x.b);H.extend(x.__state,{s:S.s,v:S.v}),H.isNaN(S.h)?H.isUndefined(x.__state.h)&&(x.__state.h=0):x.__state.h=S.h},ee.COMPONENTS=["r","g","b","h","s","v","hex","a"],defineRGBComponent(ee.prototype,"r",2),defineRGBComponent(ee.prototype,"g",1),defineRGBComponent(ee.prototype,"b",0),defineHSVComponent(ee.prototype,"h"),defineHSVComponent(ee.prototype,"s"),defineHSVComponent(ee.prototype,"v"),Object.defineProperty(ee.prototype,"a",{get:function get$$1(){return this.__state.a},set:function set$$1(x){this.__state.a=x}}),Object.defineProperty(ee.prototype,"hex",{get:function get$$1(){return"HEX"!==this.__state.space&&(this.__state.hex=Y.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function set$$1(x){this.__state.space="HEX",this.__state.hex=x}});var te=function(){function Controller(x,S){classCallCheck(this,Controller),this.initialValue=x[S],this.domElement=document.createElement("div"),this.object=x,this.property=S,this.__onChange=void 0,this.__onFinishChange=void 0}return J(Controller,[{key:"onChange",value:function onChange(x){return this.__onChange=x,this}},{key:"onFinishChange",value:function onFinishChange(x){return this.__onFinishChange=x,this}},{key:"setValue",value:function setValue(x){return this.object[this.property]=x,this.__onChange&&this.__onChange.call(this,x),this.updateDisplay(),this}},{key:"getValue",value:function getValue(){return this.object[this.property]}},{key:"updateDisplay",value:function updateDisplay(){return this}},{key:"isModified",value:function isModified(){return this.initialValue!==this.getValue()}}]),Controller}(),ne={};H.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(x,S){H.each(x,(function(x){ne[x]=S}))}));var ie=/(\d+(\.\d+)?)px/;function cssValueToPixels(x){if("0"===x||H.isUndefined(x))return 0;var S=x.match(ie);return H.isNull(S)?0:parseFloat(S[1])}var re={makeSelectable:function makeSelectable(x,S){void 0!==x&&void 0!==x.style&&(x.onselectstart=S?function(){return!1}:function(){},x.style.MozUserSelect=S?"auto":"none",x.style.KhtmlUserSelect=S?"auto":"none",x.unselectable=S?"on":"off")},makeFullscreen:function makeFullscreen(x,S,w){var U=w,G=S;H.isUndefined(G)&&(G=!0),H.isUndefined(U)&&(U=!0),x.style.position="absolute",G&&(x.style.left=0,x.style.right=0),U&&(x.style.top=0,x.style.bottom=0)},fakeEvent:function fakeEvent(x,S,w,U){var G=w||{},z=ne[S];if(!z)throw new Error("Event type "+S+" not supported.");var j=document.createEvent(z);switch(z){case"MouseEvents":var X=G.x||G.clientX||0,K=G.y||G.clientY||0;j.initMouseEvent(S,G.bubbles||!1,G.cancelable||!0,window,G.clickCount||1,0,0,X,K,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var q=j.initKeyboardEvent||j.initKeyEvent;H.defaults(G,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),q(S,G.bubbles||!1,G.cancelable,window,G.ctrlKey,G.altKey,G.shiftKey,G.metaKey,G.keyCode,G.charCode);break;default:j.initEvent(S,G.bubbles||!1,G.cancelable||!0)}H.defaults(j,U),x.dispatchEvent(j)},bind:function bind(x,S,w,U){var G=U||!1;return x.addEventListener?x.addEventListener(S,w,G):x.attachEvent&&x.attachEvent("on"+S,w),re},unbind:function unbind(x,S,w,U){var G=U||!1;return x.removeEventListener?x.removeEventListener(S,w,G):x.detachEvent&&x.detachEvent("on"+S,w),re},addClass:function addClass(x,S){if(void 0===x.className)x.className=S;else if(x.className!==S){var w=x.className.split(/ +/);-1===w.indexOf(S)&&(w.push(S),x.className=w.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return re},removeClass:function removeClass(x,S){if(S)if(x.className===S)x.removeAttribute("class");else{var w=x.className.split(/ +/),U=w.indexOf(S);-1!==U&&(w.splice(U,1),x.className=w.join(" "))}else x.className=void 0;return re},hasClass:function hasClass(x,S){return new RegExp("(?:^|\\s+)"+S+"(?:\\s+|$)").test(x.className)||!1},getWidth:function getWidth(x){var S=getComputedStyle(x);return cssValueToPixels(S["border-left-width"])+cssValueToPixels(S["border-right-width"])+cssValueToPixels(S["padding-left"])+cssValueToPixels(S["padding-right"])+cssValueToPixels(S.width)},getHeight:function getHeight(x){var S=getComputedStyle(x);return cssValueToPixels(S["border-top-width"])+cssValueToPixels(S["border-bottom-width"])+cssValueToPixels(S["padding-top"])+cssValueToPixels(S["padding-bottom"])+cssValueToPixels(S.height)},getOffset:function getOffset(x){var S=x,w={left:0,top:0};if(S.offsetParent)do{w.left+=S.offsetLeft,w.top+=S.offsetTop,S=S.offsetParent}while(S);return w},isActive:function isActive(x){return x===document.activeElement&&(x.type||x.href)}},oe=function(x){function BooleanController(x,S){classCallCheck(this,BooleanController);var w=possibleConstructorReturn(this,(BooleanController.__proto__||Object.getPrototypeOf(BooleanController)).call(this,x,S)),U=w;return w.__prev=w.getValue(),w.__checkbox=document.createElement("input"),w.__checkbox.setAttribute("type","checkbox"),re.bind(w.__checkbox,"change",(function onChange(){U.setValue(!U.__prev)}),!1),w.domElement.appendChild(w.__checkbox),w.updateDisplay(),w}return inherits(BooleanController,x),J(BooleanController,[{key:"setValue",value:function setValue(x){var S=Q(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"setValue",this).call(this,x);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),S}},{key:"updateDisplay",value:function updateDisplay(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Q(BooleanController.prototype.__proto__||Object.getPrototypeOf(BooleanController.prototype),"updateDisplay",this).call(this)}}]),BooleanController}(te),ae=function(x){function OptionController(x,S,w){classCallCheck(this,OptionController);var U=possibleConstructorReturn(this,(OptionController.__proto__||Object.getPrototypeOf(OptionController)).call(this,x,S)),G=w,z=U;if(U.__select=document.createElement("select"),H.isArray(G)){var j={};H.each(G,(function(x){j[x]=x})),G=j}return H.each(G,(function(x,S){var w=document.createElement("option");w.innerHTML=S,w.setAttribute("value",x),z.__select.appendChild(w)})),U.updateDisplay(),re.bind(U.__select,"change",(function(){var x=this.options[this.selectedIndex].value;z.setValue(x)})),U.domElement.appendChild(U.__select),U}return inherits(OptionController,x),J(OptionController,[{key:"setValue",value:function setValue(x){var S=Q(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"setValue",this).call(this,x);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),S}},{key:"updateDisplay",value:function updateDisplay(){return re.isActive(this.__select)?this:(this.__select.value=this.getValue(),Q(OptionController.prototype.__proto__||Object.getPrototypeOf(OptionController.prototype),"updateDisplay",this).call(this))}}]),OptionController}(te),se=function(x){function StringController(x,S){classCallCheck(this,StringController);var w=possibleConstructorReturn(this,(StringController.__proto__||Object.getPrototypeOf(StringController)).call(this,x,S)),U=w;function onChange(){U.setValue(U.__input.value)}return w.__input=document.createElement("input"),w.__input.setAttribute("type","text"),re.bind(w.__input,"keyup",onChange),re.bind(w.__input,"change",onChange),re.bind(w.__input,"blur",(function onBlur(){U.__onFinishChange&&U.__onFinishChange.call(U,U.getValue())})),re.bind(w.__input,"keydown",(function(x){13===x.keyCode&&this.blur()})),w.updateDisplay(),w.domElement.appendChild(w.__input),w}return inherits(StringController,x),J(StringController,[{key:"updateDisplay",value:function updateDisplay(){return re.isActive(this.__input)||(this.__input.value=this.getValue()),Q(StringController.prototype.__proto__||Object.getPrototypeOf(StringController.prototype),"updateDisplay",this).call(this)}}]),StringController}(te);function numDecimals(x){var S=x.toString();return S.indexOf(".")>-1?S.length-S.indexOf(".")-1:0}var le=function(x){function NumberController(x,S,w){classCallCheck(this,NumberController);var U=possibleConstructorReturn(this,(NumberController.__proto__||Object.getPrototypeOf(NumberController)).call(this,x,S)),G=w||{};return U.__min=G.min,U.__max=G.max,U.__step=G.step,H.isUndefined(U.__step)?0===U.initialValue?U.__impliedStep=1:U.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(U.initialValue))/Math.LN10))/10:U.__impliedStep=U.__step,U.__precision=numDecimals(U.__impliedStep),U}return inherits(NumberController,x),J(NumberController,[{key:"setValue",value:function setValue(x){var S=x;return void 0!==this.__min&&S<this.__min?S=this.__min:void 0!==this.__max&&S>this.__max&&(S=this.__max),void 0!==this.__step&&S%this.__step!=0&&(S=Math.round(S/this.__step)*this.__step),Q(NumberController.prototype.__proto__||Object.getPrototypeOf(NumberController.prototype),"setValue",this).call(this,S)}},{key:"min",value:function min(x){return this.__min=x,this}},{key:"max",value:function max(x){return this.__max=x,this}},{key:"step",value:function step(x){return this.__step=x,this.__impliedStep=x,this.__precision=numDecimals(x),this}}]),NumberController}(te);var ce=function(x){function NumberControllerBox(x,S,w){classCallCheck(this,NumberControllerBox);var U=possibleConstructorReturn(this,(NumberControllerBox.__proto__||Object.getPrototypeOf(NumberControllerBox)).call(this,x,S,w));U.__truncationSuspended=!1;var G=U,z=void 0;function onFinish(){G.__onFinishChange&&G.__onFinishChange.call(G,G.getValue())}function onMouseDrag(x){var S=z-x.clientY;G.setValue(G.getValue()+S*G.__impliedStep),z=x.clientY}function onMouseUp(){re.unbind(window,"mousemove",onMouseDrag),re.unbind(window,"mouseup",onMouseUp),onFinish()}return U.__input=document.createElement("input"),U.__input.setAttribute("type","text"),re.bind(U.__input,"change",(function onChange(){var x=parseFloat(G.__input.value);H.isNaN(x)||G.setValue(x)})),re.bind(U.__input,"blur",(function onBlur(){onFinish()})),re.bind(U.__input,"mousedown",(function onMouseDown(x){re.bind(window,"mousemove",onMouseDrag),re.bind(window,"mouseup",onMouseUp),z=x.clientY})),re.bind(U.__input,"keydown",(function(x){13===x.keyCode&&(G.__truncationSuspended=!0,this.blur(),G.__truncationSuspended=!1,onFinish())})),U.updateDisplay(),U.domElement.appendChild(U.__input),U}return inherits(NumberControllerBox,x),J(NumberControllerBox,[{key:"updateDisplay",value:function updateDisplay(){return this.__input.value=this.__truncationSuspended?this.getValue():function roundToDecimal(x,S){var w=Math.pow(10,S);return Math.round(x*w)/w}(this.getValue(),this.__precision),Q(NumberControllerBox.prototype.__proto__||Object.getPrototypeOf(NumberControllerBox.prototype),"updateDisplay",this).call(this)}}]),NumberControllerBox}(le);function map(x,S,w,U,G){return U+(x-S)/(w-S)*(G-U)}var ue=function(x){function NumberControllerSlider(x,S,w,U,G){classCallCheck(this,NumberControllerSlider);var H=possibleConstructorReturn(this,(NumberControllerSlider.__proto__||Object.getPrototypeOf(NumberControllerSlider)).call(this,x,S,{min:w,max:U,step:G})),z=H;function onMouseDrag(x){x.preventDefault();var S=z.__background.getBoundingClientRect();return z.setValue(map(x.clientX,S.left,S.right,z.__min,z.__max)),!1}function onMouseUp(){re.unbind(window,"mousemove",onMouseDrag),re.unbind(window,"mouseup",onMouseUp),z.__onFinishChange&&z.__onFinishChange.call(z,z.getValue())}function onTouchMove(x){var S=x.touches[0].clientX,w=z.__background.getBoundingClientRect();z.setValue(map(S,w.left,w.right,z.__min,z.__max))}function onTouchEnd(){re.unbind(window,"touchmove",onTouchMove),re.unbind(window,"touchend",onTouchEnd),z.__onFinishChange&&z.__onFinishChange.call(z,z.getValue())}return H.__background=document.createElement("div"),H.__foreground=document.createElement("div"),re.bind(H.__background,"mousedown",(function onMouseDown(x){document.activeElement.blur(),re.bind(window,"mousemove",onMouseDrag),re.bind(window,"mouseup",onMouseUp),onMouseDrag(x)})),re.bind(H.__background,"touchstart",(function onTouchStart(x){if(1!==x.touches.length)return;re.bind(window,"touchmove",onTouchMove),re.bind(window,"touchend",onTouchEnd),onTouchMove(x)})),re.addClass(H.__background,"slider"),re.addClass(H.__foreground,"slider-fg"),H.updateDisplay(),H.__background.appendChild(H.__foreground),H.domElement.appendChild(H.__background),H}return inherits(NumberControllerSlider,x),J(NumberControllerSlider,[{key:"updateDisplay",value:function updateDisplay(){var x=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*x+"%",Q(NumberControllerSlider.prototype.__proto__||Object.getPrototypeOf(NumberControllerSlider.prototype),"updateDisplay",this).call(this)}}]),NumberControllerSlider}(le),he=function(x){function FunctionController(x,S,w){classCallCheck(this,FunctionController);var U=possibleConstructorReturn(this,(FunctionController.__proto__||Object.getPrototypeOf(FunctionController)).call(this,x,S)),G=U;return U.__button=document.createElement("div"),U.__button.innerHTML=void 0===w?"Fire":w,re.bind(U.__button,"click",(function(x){return x.preventDefault(),G.fire(),!1})),re.addClass(U.__button,"button"),U.domElement.appendChild(U.__button),U}return inherits(FunctionController,x),J(FunctionController,[{key:"fire",value:function fire(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),FunctionController}(te),de=function(x){function ColorController(x,S){classCallCheck(this,ColorController);var w=possibleConstructorReturn(this,(ColorController.__proto__||Object.getPrototypeOf(ColorController)).call(this,x,S));w.__color=new ee(w.getValue()),w.__temp=new ee(0);var U=w;w.domElement=document.createElement("div"),re.makeSelectable(w.domElement,!1),w.__selector=document.createElement("div"),w.__selector.className="selector",w.__saturation_field=document.createElement("div"),w.__saturation_field.className="saturation-field",w.__field_knob=document.createElement("div"),w.__field_knob.className="field-knob",w.__field_knob_border="2px solid ",w.__hue_knob=document.createElement("div"),w.__hue_knob.className="hue-knob",w.__hue_field=document.createElement("div"),w.__hue_field.className="hue-field",w.__input=document.createElement("input"),w.__input.type="text",w.__input_textShadow="0 1px 1px ",re.bind(w.__input,"keydown",(function(x){13===x.keyCode&&onBlur.call(this)})),re.bind(w.__input,"blur",onBlur),re.bind(w.__selector,"mousedown",(function(){re.addClass(this,"drag").bind(window,"mouseup",(function(){re.removeClass(U.__selector,"drag")}))})),re.bind(w.__selector,"touchstart",(function(){re.addClass(this,"drag").bind(window,"touchend",(function(){re.removeClass(U.__selector,"drag")}))}));var G=document.createElement("div");function fieldDown(x){setSV(x),re.bind(window,"mousemove",setSV),re.bind(window,"touchmove",setSV),re.bind(window,"mouseup",fieldUpSV),re.bind(window,"touchend",fieldUpSV)}function fieldDownH(x){setH(x),re.bind(window,"mousemove",setH),re.bind(window,"touchmove",setH),re.bind(window,"mouseup",fieldUpH),re.bind(window,"touchend",fieldUpH)}function fieldUpSV(){re.unbind(window,"mousemove",setSV),re.unbind(window,"touchmove",setSV),re.unbind(window,"mouseup",fieldUpSV),re.unbind(window,"touchend",fieldUpSV),onFinish()}function fieldUpH(){re.unbind(window,"mousemove",setH),re.unbind(window,"touchmove",setH),re.unbind(window,"mouseup",fieldUpH),re.unbind(window,"touchend",fieldUpH),onFinish()}function onBlur(){var x=K(this.value);!1!==x?(U.__color.__state=x,U.setValue(U.__color.toOriginal())):this.value=U.__color.toString()}function onFinish(){U.__onFinishChange&&U.__onFinishChange.call(U,U.__color.toOriginal())}function setSV(x){-1===x.type.indexOf("touch")&&x.preventDefault();var S=U.__saturation_field.getBoundingClientRect(),w=x.touches&&x.touches[0]||x,G=w.clientX,H=w.clientY,z=(G-S.left)/(S.right-S.left),j=1-(H-S.top)/(S.bottom-S.top);return j>1?j=1:j<0&&(j=0),z>1?z=1:z<0&&(z=0),U.__color.v=j,U.__color.s=z,U.setValue(U.__color.toOriginal()),!1}function setH(x){-1===x.type.indexOf("touch")&&x.preventDefault();var S=U.__hue_field.getBoundingClientRect(),w=1-((x.touches&&x.touches[0]||x).clientY-S.top)/(S.bottom-S.top);return w>1?w=1:w<0&&(w=0),U.__color.h=360*w,U.setValue(U.__color.toOriginal()),!1}return H.extend(w.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),H.extend(w.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:w.__field_knob_border+(w.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),H.extend(w.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),H.extend(w.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),H.extend(G.style,{width:"100%",height:"100%",background:"none"}),linearGradient(G,"top","rgba(0,0,0,0)","#000"),H.extend(w.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function hueGradient(x){x.style.background="",x.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",x.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",x.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",x.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",x.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(w.__hue_field),H.extend(w.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:w.__input_textShadow+"rgba(0,0,0,0.7)"}),re.bind(w.__saturation_field,"mousedown",fieldDown),re.bind(w.__saturation_field,"touchstart",fieldDown),re.bind(w.__field_knob,"mousedown",fieldDown),re.bind(w.__field_knob,"touchstart",fieldDown),re.bind(w.__hue_field,"mousedown",fieldDownH),re.bind(w.__hue_field,"touchstart",fieldDownH),w.__saturation_field.appendChild(G),w.__selector.appendChild(w.__field_knob),w.__selector.appendChild(w.__saturation_field),w.__selector.appendChild(w.__hue_field),w.__hue_field.appendChild(w.__hue_knob),w.domElement.appendChild(w.__input),w.domElement.appendChild(w.__selector),w.updateDisplay(),w}return inherits(ColorController,x),J(ColorController,[{key:"updateDisplay",value:function updateDisplay(){var x=K(this.getValue());if(!1!==x){var S=!1;H.each(ee.COMPONENTS,(function(w){if(!H.isUndefined(x[w])&&!H.isUndefined(this.__color.__state[w])&&x[w]!==this.__color.__state[w])return S=!0,{}}),this),S&&H.extend(this.__color.__state,x)}H.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var w=this.__color.v<.5||this.__color.s>.5?255:0,U=255-w;H.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+w+","+w+","+w+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),H.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+w+","+w+","+w+")",textShadow:this.__input_textShadow+"rgba("+U+","+U+","+U+",.7)"})}}]),ColorController}(te),pe=["-moz-","-o-","-webkit-","-ms-",""];function linearGradient(x,S,w,U){x.style.background="",H.each(pe,(function(G){x.style.cssText+="background: "+G+"linear-gradient("+S+", "+w+" 0%, "+U+" 100%); "}))}var me=function inject(x,S){var w=S||document,U=document.createElement("style");U.type="text/css",U.innerHTML=x;var G=w.getElementsByTagName("head")[0];try{G.appendChild(U)}catch(x){}},fe='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',ge=function ControllerFactory(x,S){var w=x[S];return H.isArray(arguments[2])||H.isObject(arguments[2])?new ae(x,S,arguments[2]):H.isNumber(w)?H.isNumber(arguments[2])&&H.isNumber(arguments[3])?H.isNumber(arguments[4])?new ue(x,S,arguments[2],arguments[3],arguments[4]):new ue(x,S,arguments[2],arguments[3]):H.isNumber(arguments[4])?new ce(x,S,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ce(x,S,{min:arguments[2],max:arguments[3]}):H.isString(w)?new se(x,S):H.isFunction(w)?new he(x,S,""):H.isBoolean(w)?new oe(x,S):null};var ve=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function dat_gui_module_requestAnimationFrame(x){setTimeout(x,1e3/60)},_e=function(){function CenteredDiv(){classCallCheck(this,CenteredDiv),this.backgroundElement=document.createElement("div"),H.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),re.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),H.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var x=this;re.bind(this.backgroundElement,"click",(function(){x.hide()}))}return J(CenteredDiv,[{key:"show",value:function show(){var x=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),H.defer((function(){x.backgroundElement.style.opacity=1,x.domElement.style.opacity=1,x.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function hide(){var x=this,hide=function hide(){x.domElement.style.display="none",x.backgroundElement.style.display="none",re.unbind(x.domElement,"webkitTransitionEnd",hide),re.unbind(x.domElement,"transitionend",hide),re.unbind(x.domElement,"oTransitionEnd",hide)};re.bind(this.domElement,"webkitTransitionEnd",hide),re.bind(this.domElement,"transitionend",hide),re.bind(this.domElement,"oTransitionEnd",hide),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function layout(){this.domElement.style.left=window.innerWidth/2-re.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-re.getHeight(this.domElement)/2+"px"}}]),CenteredDiv}(),ye=function ___$insertStyle(x){if(x&&"undefined"!=typeof window){var S=document.createElement("style");return S.setAttribute("type","text/css"),S.innerHTML=x,document.head.appendChild(S),x}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");me(ye);var be="Default",xe=function(){try{return!!window.localStorage}catch(x){return!1}}(),Ee=void 0,Se=!0,we=void 0,Te=!1,Ce=[],Ae=function GUI(x){var S=this,w=x||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),re.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],w=H.defaults(w,{closeOnTop:!1,autoPlace:!0,width:GUI.DEFAULT_WIDTH}),w=H.defaults(w,{resizable:w.autoPlace,hideable:w.autoPlace}),H.isUndefined(w.load)?w.load={preset:be}:w.preset&&(w.load.preset=w.preset),H.isUndefined(w.parent)&&w.hideable&&Ce.push(this),w.resizable=H.isUndefined(w.parent)&&w.resizable,w.autoPlace&&H.isUndefined(w.scrollable)&&(w.scrollable=!0);var U=xe&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal")),G=void 0,z=void 0;if(Object.defineProperties(this,{parent:{get:function get$$1(){return w.parent}},scrollable:{get:function get$$1(){return w.scrollable}},autoPlace:{get:function get$$1(){return w.autoPlace}},closeOnTop:{get:function get$$1(){return w.closeOnTop}},preset:{get:function get$$1(){return S.parent?S.getRoot().preset:w.load.preset},set:function set$$1(x){S.parent?S.getRoot().preset=x:w.load.preset=x,function setPresetSelectIndex(x){for(var S=0;S<x.__preset_select.length;S++)x.__preset_select[S].value===x.preset&&(x.__preset_select.selectedIndex=S)}(this),S.revert()}},width:{get:function get$$1(){return w.width},set:function set$$1(x){w.width=x,setWidth(S,x)}},name:{get:function get$$1(){return w.name},set:function set$$1(x){w.name=x,z&&(z.innerHTML=w.name)}},closed:{get:function get$$1(){return w.closed},set:function set$$1(x){w.closed=x,w.closed?re.addClass(S.__ul,GUI.CLASS_CLOSED):re.removeClass(S.__ul,GUI.CLASS_CLOSED),this.onResize(),S.__closeButton&&(S.__closeButton.innerHTML=x?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function get$$1(){return w.load}},useLocalStorage:{get:function get$$1(){return U},set:function set$$1(x){xe&&(U=x,x?re.bind(window,"unload",G):re.unbind(window,"unload",G),localStorage.setItem(getLocalStorageHash(S,"isLocal"),x))}}}),H.isUndefined(w.parent)){if(this.closed=w.closed||!1,re.addClass(this.domElement,GUI.CLASS_MAIN),re.makeSelectable(this.domElement,!1),xe&&U){S.useLocalStorage=!0;var j=localStorage.getItem(getLocalStorageHash(this,"gui"));j&&(w.load=JSON.parse(j))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,re.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),w.closeOnTop?(re.addClass(this.__closeButton,GUI.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(re.addClass(this.__closeButton,GUI.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),re.bind(this.__closeButton,"click",(function(){S.closed=!S.closed}))}else{void 0===w.closed&&(w.closed=!0);var X=document.createTextNode(w.name);re.addClass(X,"controller-name"),z=addRow(S,X);re.addClass(this.__ul,GUI.CLASS_CLOSED),re.addClass(z,"title"),re.bind(z,"click",(function onClickTitle(x){return x.preventDefault(),S.closed=!S.closed,!1})),w.closed||(this.closed=!1)}w.autoPlace&&(H.isUndefined(w.parent)&&(Se&&(we=document.createElement("div"),re.addClass(we,"dg"),re.addClass(we,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(we),Se=!1),we.appendChild(this.domElement),re.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(S,w.width)),this.__resizeHandler=function(){S.onResizeDebounced()},re.bind(window,"resize",this.__resizeHandler),re.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),re.bind(this.__ul,"transitionend",this.__resizeHandler),re.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),w.resizable&&addResizeHandle(this),G=function saveToLocalStorage(){xe&&"true"===localStorage.getItem(getLocalStorageHash(S,"isLocal"))&&localStorage.setItem(getLocalStorageHash(S,"gui"),JSON.stringify(S.getSaveObject()))},this.saveToLocalStorageIfPossible=G,w.parent||function resetWidth(){var x=S.getRoot();x.width+=1,H.defer((function(){x.width-=1}))}()};function addRow(x,S,w){var U=document.createElement("li");return S&&U.appendChild(S),w?x.__ul.insertBefore(U,w):x.__ul.appendChild(U),x.onResize(),U}function removeListeners(x){re.unbind(window,"resize",x.__resizeHandler),x.saveToLocalStorageIfPossible&&re.unbind(window,"unload",x.saveToLocalStorageIfPossible)}function markPresetModified(x,S){var w=x.__preset_select[x.__preset_select.selectedIndex];w.innerHTML=S?w.value+"*":w.value}function recallSavedValue(x,S){var w=x.getRoot(),U=w.__rememberedObjects.indexOf(S.object);if(-1!==U){var G=w.__rememberedObjectIndecesToControllers[U];if(void 0===G&&(G={},w.__rememberedObjectIndecesToControllers[U]=G),G[S.property]=S,w.load&&w.load.remembered){var H=w.load.remembered,z=void 0;if(H[x.preset])z=H[x.preset];else{if(!H.Default)return;z=H.Default}if(z[U]&&void 0!==z[U][S.property]){var j=z[U][S.property];S.initialValue=j,S.setValue(j)}}}}function _add(x,S,w,U){if(void 0===S[w])throw new Error('Object "'+S+'" has no property "'+w+'"');var G=void 0;if(U.color)G=new de(S,w);else{var z=[S,w].concat(U.factoryArgs);G=ge.apply(x,z)}U.before instanceof te&&(U.before=U.before.__li),recallSavedValue(x,G),re.addClass(G.domElement,"c");var j=document.createElement("span");re.addClass(j,"property-name"),j.innerHTML=G.property;var X=document.createElement("div");X.appendChild(j),X.appendChild(G.domElement);var K=addRow(x,X,U.before);return re.addClass(K,Ae.CLASS_CONTROLLER_ROW),G instanceof de?re.addClass(K,"color"):re.addClass(K,Z(G.getValue())),function augmentController(x,S,w){if(w.__li=S,w.__gui=x,H.extend(w,{options:function options(S){if(arguments.length>1){var U=w.__li.nextElementSibling;return w.remove(),_add(x,w.object,w.property,{before:U,factoryArgs:[H.toArray(arguments)]})}if(H.isArray(S)||H.isObject(S)){var G=w.__li.nextElementSibling;return w.remove(),_add(x,w.object,w.property,{before:G,factoryArgs:[S]})}},name:function name(x){return w.__li.firstElementChild.firstElementChild.innerHTML=x,w},listen:function listen(){return w.__gui.listen(w),w},remove:function remove(){return w.__gui.remove(w),w}}),w instanceof ue){var U=new ce(w.object,w.property,{min:w.__min,max:w.__max,step:w.__step});H.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(x){var S=w[x],G=U[x];w[x]=U[x]=function(){var x=Array.prototype.slice.call(arguments);return G.apply(U,x),S.apply(w,x)}})),re.addClass(S,"has-slider"),w.domElement.insertBefore(U.domElement,w.domElement.firstElementChild)}else if(w instanceof ce){var G=function r(S){if(H.isNumber(w.__min)&&H.isNumber(w.__max)){var U=w.__li.firstElementChild.firstElementChild.innerHTML,G=w.__gui.__listening.indexOf(w)>-1;w.remove();var z=_add(x,w.object,w.property,{before:w.__li.nextElementSibling,factoryArgs:[w.__min,w.__max,w.__step]});return z.name(U),G&&z.listen(),z}return S};w.min=H.compose(G,w.min),w.max=H.compose(G,w.max)}else w instanceof oe?(re.bind(S,"click",(function(){re.fakeEvent(w.__checkbox,"click")})),re.bind(w.__checkbox,"click",(function(x){x.stopPropagation()}))):w instanceof he?(re.bind(S,"click",(function(){re.fakeEvent(w.__button,"click")})),re.bind(S,"mouseover",(function(){re.addClass(w.__button,"hover")})),re.bind(S,"mouseout",(function(){re.removeClass(w.__button,"hover")}))):w instanceof de&&(re.addClass(S,"color"),w.updateDisplay=H.compose((function(x){return S.style.borderLeftColor=w.__color.toString(),x}),w.updateDisplay),w.updateDisplay());w.setValue=H.compose((function(S){return x.getRoot().__preset_select&&w.isModified()&&markPresetModified(x.getRoot(),!0),S}),w.setValue)}(x,K,G),x.__controllers.push(G),G}function getLocalStorageHash(x,S){return document.location.href+"."+S}function addPresetOption(x,S,w){var U=document.createElement("option");U.innerHTML=S,U.value=S,x.__preset_select.appendChild(U),w&&(x.__preset_select.selectedIndex=x.__preset_select.length-1)}function showHideExplain(x,S){S.style.display=x.useLocalStorage?"block":"none"}function addSaveMenu(x){var S=x.__save_row=document.createElement("li");re.addClass(x.domElement,"has-save"),x.__ul.insertBefore(S,x.__ul.firstChild),re.addClass(S,"save-row");var w=document.createElement("span");w.innerHTML="&nbsp;",re.addClass(w,"button gears");var U=document.createElement("span");U.innerHTML="Save",re.addClass(U,"button"),re.addClass(U,"save");var G=document.createElement("span");G.innerHTML="New",re.addClass(G,"button"),re.addClass(G,"save-as");var z=document.createElement("span");z.innerHTML="Revert",re.addClass(z,"button"),re.addClass(z,"revert");var j=x.__preset_select=document.createElement("select");if(x.load&&x.load.remembered?H.each(x.load.remembered,(function(S,w){addPresetOption(x,w,w===x.preset)})):addPresetOption(x,be,!1),re.bind(j,"change",(function(){for(var S=0;S<x.__preset_select.length;S++)x.__preset_select[S].innerHTML=x.__preset_select[S].value;x.preset=this.value})),S.appendChild(j),S.appendChild(w),S.appendChild(U),S.appendChild(G),S.appendChild(z),xe){var X=document.getElementById("dg-local-explain"),K=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(getLocalStorageHash(0,"isLocal"))&&K.setAttribute("checked","checked"),showHideExplain(x,X),re.bind(K,"change",(function(){x.useLocalStorage=!x.useLocalStorage,showHideExplain(x,X)}))}var q=document.getElementById("dg-new-constructor");re.bind(q,"keydown",(function(x){!x.metaKey||67!==x.which&&67!==x.keyCode||Ee.hide()})),re.bind(w,"click",(function(){q.innerHTML=JSON.stringify(x.getSaveObject(),void 0,2),Ee.show(),q.focus(),q.select()})),re.bind(U,"click",(function(){x.save()})),re.bind(G,"click",(function(){var S=prompt("Enter a new preset name.");S&&x.saveAs(S)})),re.bind(z,"click",(function(){x.revert()}))}function addResizeHandle(x){var S=void 0;function drag(w){return w.preventDefault(),x.width+=S-w.clientX,x.onResize(),S=w.clientX,!1}function dragStop(){re.removeClass(x.__closeButton,Ae.CLASS_DRAG),re.unbind(window,"mousemove",drag),re.unbind(window,"mouseup",dragStop)}function dragStart(w){return w.preventDefault(),S=w.clientX,re.addClass(x.__closeButton,Ae.CLASS_DRAG),re.bind(window,"mousemove",drag),re.bind(window,"mouseup",dragStop),!1}x.__resize_handle=document.createElement("div"),H.extend(x.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),re.bind(x.__resize_handle,"mousedown",dragStart),re.bind(x.__closeButton,"mousedown",dragStart),x.domElement.insertBefore(x.__resize_handle,x.domElement.firstElementChild)}function setWidth(x,S){x.domElement.style.width=S+"px",x.__save_row&&x.autoPlace&&(x.__save_row.style.width=S+"px"),x.__closeButton&&(x.__closeButton.style.width=S+"px")}function getCurrentPreset(x,S){var w={};return H.each(x.__rememberedObjects,(function(U,G){var z={},j=x.__rememberedObjectIndecesToControllers[G];H.each(j,(function(x,w){z[w]=S?x.initialValue:x.getValue()})),w[G]=z})),w}function updateDisplays(x){0!==x.length&&ve.call(window,(function(){updateDisplays(x)})),H.each(x,(function(x){x.updateDisplay()}))}Ae.toggleHide=function(){Te=!Te,H.each(Ce,(function(x){x.domElement.style.display=Te?"none":""}))},Ae.CLASS_AUTO_PLACE="a",Ae.CLASS_AUTO_PLACE_CONTAINER="ac",Ae.CLASS_MAIN="main",Ae.CLASS_CONTROLLER_ROW="cr",Ae.CLASS_TOO_TALL="taller-than-window",Ae.CLASS_CLOSED="closed",Ae.CLASS_CLOSE_BUTTON="close-button",Ae.CLASS_CLOSE_TOP="close-top",Ae.CLASS_CLOSE_BOTTOM="close-bottom",Ae.CLASS_DRAG="drag",Ae.DEFAULT_WIDTH=245,Ae.TEXT_CLOSED="Close Controls",Ae.TEXT_OPEN="Open Controls",Ae._keydownHandler=function(x){"text"===document.activeElement.type||72!==x.which&&72!==x.keyCode||Ae.toggleHide()},re.bind(window,"keydown",Ae._keydownHandler,!1),H.extend(Ae.prototype,{add:function add(x,S){return _add(this,x,S,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function addColor(x,S){return _add(this,x,S,{color:!0})},remove:function remove(x){this.__ul.removeChild(x.__li),this.__controllers.splice(this.__controllers.indexOf(x),1);var S=this;H.defer((function(){S.onResize()}))},destroy:function destroy(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&we.removeChild(this.domElement);var x=this;H.each(this.__folders,(function(S){x.removeFolder(S)})),re.unbind(window,"keydown",Ae._keydownHandler,!1),removeListeners(this)},addFolder:function addFolder(x){if(void 0!==this.__folders[x])throw new Error('You already have a folder in this GUI by the name "'+x+'"');var S={name:x,parent:this};S.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[x]&&(S.closed=this.load.folders[x].closed,S.load=this.load.folders[x]);var w=new Ae(S);this.__folders[x]=w;var U=addRow(this,w.domElement);return re.addClass(U,"folder"),w},removeFolder:function removeFolder(x){this.__ul.removeChild(x.domElement.parentElement),delete this.__folders[x.name],this.load&&this.load.folders&&this.load.folders[x.name]&&delete this.load.folders[x.name],removeListeners(x);var S=this;H.each(x.__folders,(function(S){x.removeFolder(S)})),H.defer((function(){S.onResize()}))},open:function open(){this.closed=!1},close:function close(){this.closed=!0},hide:function hide(){this.domElement.style.display="none"},show:function show(){this.domElement.style.display=""},onResize:function onResize(){var x=this.getRoot();if(x.scrollable){var S=re.getOffset(x.__ul).top,w=0;H.each(x.__ul.childNodes,(function(S){x.autoPlace&&S===x.__save_row||(w+=re.getHeight(S))})),window.innerHeight-S-20<w?(re.addClass(x.domElement,Ae.CLASS_TOO_TALL),x.__ul.style.height=window.innerHeight-S-20+"px"):(re.removeClass(x.domElement,Ae.CLASS_TOO_TALL),x.__ul.style.height="auto")}x.__resize_handle&&H.defer((function(){x.__resize_handle.style.height=x.__ul.offsetHeight+"px"})),x.__closeButton&&(x.__closeButton.style.width=x.width+"px")},onResizeDebounced:H.debounce((function(){this.onResize()}),50),remember:function remember(){if(H.isUndefined(Ee)&&((Ee=new _e).domElement.innerHTML=fe),this.parent)throw new Error("You can only call remember on a top level GUI.");var x=this;H.each(Array.prototype.slice.call(arguments),(function(S){0===x.__rememberedObjects.length&&addSaveMenu(x),-1===x.__rememberedObjects.indexOf(S)&&x.__rememberedObjects.push(S)})),this.autoPlace&&setWidth(this,this.width)},getRoot:function getRoot(){for(var x=this;x.parent;)x=x.parent;return x},getSaveObject:function getSaveObject(){var x=this.load;return x.closed=this.closed,this.__rememberedObjects.length>0&&(x.preset=this.preset,x.remembered||(x.remembered={}),x.remembered[this.preset]=getCurrentPreset(this)),x.folders={},H.each(this.__folders,(function(S,w){x.folders[w]=S.getSaveObject()})),x},save:function save(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function saveAs(x){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=getCurrentPreset(this,!0)),this.load.remembered[x]=getCurrentPreset(this),this.preset=x,addPresetOption(this,x,!0),this.saveToLocalStorageIfPossible()},revert:function revert(x){H.each(this.__controllers,(function(S){this.getRoot().load.remembered?recallSavedValue(x||this.getRoot(),S):S.setValue(S.initialValue),S.__onFinishChange&&S.__onFinishChange.call(S,S.getValue())}),this),H.each(this.__folders,(function(x){x.revert(x)})),x||markPresetModified(this.getRoot(),!1)},listen:function listen(x){var S=0===this.__listening.length;this.__listening.push(x),S&&updateDisplays(this.__listening)},updateDisplay:function updateDisplay(){H.each(this.__controllers,(function(x){x.updateDisplay()})),H.each(this.__folders,(function(x){x.updateDisplay()}))}});const Me={color:{Color:ee,math:Y,interpret:K},controllers:{Controller:te,BooleanController:oe,OptionController:ae,StringController:se,NumberController:le,NumberControllerBox:ce,NumberControllerSlider:ue,FunctionController:he,ColorController:de},dom:{dom:re},gui:{GUI:Ae},GUI:Ae};w(557);var Re=w(792),Le=w.n(Re),Ie=w(212),Pe=w(581),Fe=w.n(Pe),Oe=(w(739),!1);function abort(x){throw Oe=!0,x}for(var Ne=document.getElementById("canvas"),Be=Ne.getContext("webgl"),De=Be,ke=De.getSupportedExtensions(),Ue=["OES_texture_float","OES_texture_float_linear","OES_element_index_uint","WEBGL_depth_texture","WEBGL_draw_buffers"],Ge=0;Ge<Ue.length;++Ge)if(ke.indexOf(Ue[Ge])<0)throw"Unable to load extension "+Ue[Ge];De.getExtension("OES_texture_float"),De.getExtension("OES_texture_float_linear"),De.getExtension("OES_element_index_uint"),De.getExtension("WEBGL_depth_texture");var Ve=De.getExtension("WEBGL_draw_buffers"),He=(De.getParameter(Ve.MAX_DRAW_BUFFERS_WEBGL),new Me.GUI),We=new(Le());We.setMode(1),We.domElement.style.position="absolute",We.domElement.style.left="0px",We.domElement.style.top="0px",document.body.appendChild(We.domElement);var $e=new Ie.PerspectiveCamera(75,Ne.clientWidth/Ne.clientHeight,.1,1e3),ze=new(Fe())($e,Ne);function setSize(x,S){Ne.width=x,Ne.height=S,$e.aspect=x/S,$e.updateProjectionMatrix()}function makeRenderLoop(x){return function tick(){ze.update(),We.begin(),x(),We.end(),Oe||requestAnimationFrame(tick)}}ze.enableDamping=!0,ze.enableZoom=!0,ze.rotateSpeed=.3,ze.zoomSpeed=1,ze.panSpeed=2,setSize(Ne.clientWidth,Ne.clientHeight),window.addEventListener("resize",(function(){return setSize(Ne.clientWidth,Ne.clientHeight)})),w(260)},260:(x,S,w)=>{"use strict";w.r(S);var U=w(943),G=w(975),H=w(999),z=w.n(H);function compileShader(x,S){var w=U.gl.createShader(S);return U.gl.shaderSource(w,x),U.gl.compileShader(w),U.gl.getShaderParameter(w,U.gl.COMPILE_STATUS)||(console.error(x),(0,U.JG)("shader compiler error:\n"+U.gl.getShaderInfoLog(w))),w}function linkShader(x,S){var w=U.gl.createProgram();return U.gl.attachShader(w,x),U.gl.attachShader(w,S),U.gl.linkProgram(w),U.gl.getProgramParameter(w,U.gl.LINK_STATUS)||(0,U.JG)("shader linker error:\n"+U.gl.getProgramInfoLog(w)),w}function loadShaderProgram(x,S,w){return function addShaderLocations(x,S){if(S&&S.uniforms&&S.uniforms.length)for(var w=0;w<S.uniforms.length;++w){var G;x=Object.assign(x,((G={})[S.uniforms[w]]=U.gl.getUniformLocation(x.glShaderProgram,S.uniforms[w]),G))}if(S&&S.attribs&&S.attribs.length)for(var H=0;H<S.attribs.length;++H){var z;x=Object.assign(x,((z={})[S.attribs[H]]=U.gl.getAttribLocation(x.glShaderProgram,S.attribs[H]),z))}return x}({glShaderProgram:linkShader(compileShader(x,U.gl.VERTEX_SHADER),compileShader(S,U.gl.FRAGMENT_SHADER))},w)}var j=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]),X=U.gl.createBuffer();U.gl.bindBuffer(U.gl.ARRAY_BUFFER,X),U.gl.bufferData(U.gl.ARRAY_BUFFER,j,U.gl.STATIC_DRAW);var K=w(389),q=[-14,0,-6],Y=[14,20,6],Z=100;const J=function(){function Scene(){this.lights=[],this.models=[];for(var x=0;x<Z;++x)this.lights.push({position:new Float32Array([Math.random()*(Y[0]-q[0])+q[0],Math.random()*(Y[1]-q[1])+q[1],Math.random()*(Y[2]-q[2])+q[2]]),color:new Float32Array([.5+.5*Math.random(),.5+.5*Math.random(),.5+Math.random()]),radius:5})}var x=Scene.prototype;return x.loadGLTF=function loadGLTF(x){var S=this;new K.glTFLoader(U.gl).loadGLTF(x,(function(x){var w,G,H,z,j,X,K,q,Y,Z,J,Q,ee,te,ne,ie,re,oe,ae=x.scenes[x.defaultScene],se={},le=0;for(var ce in x.json.textures){if(Y=(K=x.json.textures[ce]).target||U.gl.TEXTURE_2D,Z=K.format||U.gl.RGBA,J=K.format||U.gl.RGBA,Q=K.type||U.gl.UNSIGNED_BYTE,re=x.images[K.source],oe=U.gl.createTexture(),U.gl.activeTexture(U.gl.TEXTURE0+le),U.gl.bindTexture(Y,oe),3553===Y)U.gl.texImage2D(Y,0,J,Z,Q,re);te=(q=x.json.samplers[K.sampler]).minFilter||U.gl.NEAREST_MIPMAP_LINEAR,ee=q.magFilter||U.gl.LINEAR,ne=q.wrapS||U.gl.REPEAT,ie=q.wrapT||U.gl.REPEAT,U.gl.texParameteri(Y,U.gl.TEXTURE_MIN_FILTER,te),U.gl.texParameteri(Y,U.gl.TEXTURE_MAG_FILTER,ee),U.gl.texParameteri(Y,U.gl.TEXTURE_WRAP_S,ne),U.gl.texParameteri(Y,U.gl.TEXTURE_WRAP_T,ie),te!=U.gl.NEAREST_MIPMAP_NEAREST&&te!=U.gl.NEAREST_MIPMAP_LINEAR&&te!=U.gl.LINEAR_MIPMAP_NEAREST&&te!=U.gl.LINEAR_MIPMAP_LINEAR||U.gl.generateMipmap(Y),U.gl.bindTexture(Y,null),se[ce]={texture:oe,target:Y,id:le},le++}for(var ue in ae.meshes)for(w=0,G=(H=ae.meshes[ue]).primitives.length;w<G;++w){z=H.primitives[w],j=U.gl.createBuffer(),X=U.gl.createBuffer();var he=z.vertexBuffer;U.gl.bindBuffer(U.gl.ARRAY_BUFFER,j),U.gl.bufferData(U.gl.ARRAY_BUFFER,he,U.gl.STATIC_DRAW),U.gl.bindBuffer(U.gl.ARRAY_BUFFER,null);var de=z.indices;U.gl.bindBuffer(U.gl.ELEMENT_ARRAY_BUFFER,X),U.gl.bufferData(U.gl.ELEMENT_ARRAY_BUFFER,de,U.gl.STATIC_DRAW),U.gl.bindBuffer(U.gl.ELEMENT_ARRAY_BUFFER,null);var pe=z.attributes[z.technique.parameters.position.semantic],me=z.attributes[z.technique.parameters.normal.semantic],fe=z.attributes[z.technique.parameters.texcoord_0.semantic];S.models.push({gltf:z,idx:X,attributes:j,posInfo:{size:pe.size,type:pe.type,stride:pe.stride,offset:pe.offset},norInfo:{size:me.size,type:me.type,stride:me.stride,offset:me.offset},uvInfo:{size:fe.size,type:fe.type,stride:fe.stride,offset:fe.offset},colmap:se.texture_color.texture,normap:se.texture_normal.texture})}}))},x.update=function update(){for(var x=0;x<Z;x++)this.lights[x].position[1]+=-.03,this.lights[x].position[1]=(this.lights[x].position[1]+Y[1]-q[1])%Y[1]+q[1]},x.draw=function draw(x){for(var S=0;S<this.models.length;++S){var w=this.models[S];w.colmap&&(U.gl.activeTexture(U.gl.TEXTURE0),U.gl.bindTexture(U.gl.TEXTURE_2D,w.colmap),U.gl.uniform1i(x.u_colmap,0)),w.normap&&(U.gl.activeTexture(U.gl.TEXTURE1),U.gl.bindTexture(U.gl.TEXTURE_2D,w.normap),U.gl.uniform1i(x.u_normap,1)),U.gl.bindBuffer(U.gl.ARRAY_BUFFER,w.attributes),U.gl.enableVertexAttribArray(x.a_position),U.gl.vertexAttribPointer(x.a_position,w.posInfo.size,w.posInfo.type,!1,w.posInfo.stride,w.posInfo.offset),U.gl.enableVertexAttribArray(x.a_normal),U.gl.vertexAttribPointer(x.a_normal,w.norInfo.size,w.norInfo.type,!1,w.norInfo.stride,w.norInfo.offset),U.gl.enableVertexAttribArray(x.a_uv),U.gl.vertexAttribPointer(x.a_uv,w.uvInfo.size,w.uvInfo.type,!1,w.uvInfo.stride,w.uvInfo.offset),U.gl.bindBuffer(U.gl.ELEMENT_ARRAY_BUFFER,w.idx),U.gl.drawElements(w.gltf.mode,w.gltf.indices.length,w.gltf.indicesComponentType,0)}},Scene}();var Q=w(594),ee=w.n(Q);function _defineProperties(x,S){for(var w=0;w<S.length;w++){var U=S[w];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(x,U.key,U)}}var te=function(){function TextureBuffer(x,S){this._glTexture=U.gl.createTexture(),U.gl.bindTexture(U.gl.TEXTURE_2D,this._glTexture),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MIN_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MAG_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_S,U.gl.CLAMP_TO_EDGE),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_T,U.gl.CLAMP_TO_EDGE),this._pixelsPerElement=Math.ceil(S/4),this._elementCount=x,U.gl.texImage2D(U.gl.TEXTURE_2D,0,U.gl.RGBA,x,this._pixelsPerElement,0,U.gl.RGBA,U.gl.FLOAT,null),U.gl.bindTexture(U.gl.TEXTURE_2D,null),this._buffer=new Float32Array(4*x*this._pixelsPerElement)}var x=TextureBuffer.prototype;return x.bufferIndex=function bufferIndex(x,S){return 4*x+4*S*this._elementCount},x.update=function update(){U.gl.bindTexture(U.gl.TEXTURE_2D,this._glTexture),U.gl.texSubImage2D(U.gl.TEXTURE_2D,0,0,0,this._elementCount,this._pixelsPerElement,U.gl.RGBA,U.gl.FLOAT,this._buffer),U.gl.bindTexture(U.gl.TEXTURE_2D,null)},function _createClass(x,S,w){return S&&_defineProperties(x.prototype,S),w&&_defineProperties(x,w),x}(TextureBuffer,[{key:"glTexture",get:function get(){return this._glTexture}},{key:"buffer",get:function get(){return this._buffer}}]),TextureBuffer}(),ne=function(){function ForwardRenderer(){this._lightTexture=new te(Z,8),this._shaderProgram=loadShaderProgram(ee(),function forward_frag_glsl(x){return"\n  #version 100\n  precision highp float;\n\n  uniform sampler2D u_colmap;\n  uniform sampler2D u_normap;\n  uniform sampler2D u_lightbuffer;\n\n  varying vec3 v_position;\n  varying vec3 v_normal;\n  varying vec2 v_uv;\n  \n  uniform mat4 u_view;\n  uniform vec3 u_camPos;\n\n  vec3 applyNormalMap(vec3 geomnor, vec3 normap) {\n    normap = normap * 2.0 - 1.0;\n    vec3 up = normalize(vec3(0.001, 1, 0.001));\n    vec3 surftan = normalize(cross(geomnor, up));\n    vec3 surfbinor = cross(geomnor, surftan);\n    return normap.y * surftan + normap.x * surfbinor + normap.z * geomnor;\n  }\n\n  struct Light {\n    vec3 position;\n    float radius;\n    vec3 color;\n  };\n\n  float ExtractFloat(sampler2D texture, int textureWidth, int textureHeight, int index, int component) {\n    float u = float(index + 1) / float(textureWidth + 1);\n    int pixel = component / 4;\n    float v = float(pixel + 1) / float(textureHeight + 1);\n    vec4 texel = texture2D(texture, vec2(u, v));\n    int pixelComponent = component - pixel * 4;\n    if (pixelComponent == 0) {\n      return texel[0];\n    } else if (pixelComponent == 1) {\n      return texel[1];\n    } else if (pixelComponent == 2) {\n      return texel[2];\n    } else if (pixelComponent == 3) {\n      return texel[3];\n    }\n  }\n\n  Light UnpackLight(int index) {\n    Light light;\n    float u = float(index + 1) / float("+(x.numLights+1)+");\n    vec4 v1 = texture2D(u_lightbuffer, vec2(u, 0.0));\n    vec4 v2 = texture2D(u_lightbuffer, vec2(u, 0.5));\n    light.position = v1.xyz;\n\n    // LOOK: This extracts the 4th float (radius) of the (index)th light in the buffer\n    // Note that this is just an example implementation to extract one float.\n    // There are more efficient ways if you need adjacent values\n    light.radius = ExtractFloat(u_lightbuffer, "+x.numLights+", 2, index, 3);\n\n    light.color = v2.rgb;\n    return light;\n  }\n\n  // Cubic approximation of gaussian curve so we falloff to exactly 0 at the light radius\n  float cubicGaussian(float h) {\n    if (h < 1.0) {\n      return 0.25 * pow(2.0 - h, 3.0) - pow(1.0 - h, 3.0);\n    } else if (h < 2.0) {\n      return 0.25 * pow(2.0 - h, 3.0);\n    } else {\n      return 0.0;\n    }\n  }\n\n  void main() {\n    vec3 albedo = texture2D(u_colmap, v_uv).rgb;\n    vec3 normap = texture2D(u_normap, v_uv).xyz;\n    vec3 normal = applyNormalMap(v_normal, normap);\n\n    vec3 fragColor = vec3(0.0);\n\n    for (int i = 0; i < "+x.numLights+"; ++i) {\n      Light light = UnpackLight(i);\n      float lightDistance = distance(light.position, v_position);\n      \n      vec3 viewDirection = \n               normalize(u_camPos - vec3(v_position));\n      vec3 lightDirection = (light.position - v_position);\n      vec3 L = lightDirection / lightDistance;\n\n      float lightIntensity = cubicGaussian(2.0 * lightDistance / light.radius);\n      float lambertTerm = max(dot(L, normal), 0.0);\n      \n      float _DiffuseThreshold = 0.1;\n      float _UnlitOutlineThickness = 0.4;\n      float _LitOutlineThickness = 0.1;\n      vec4 _OutlineColor = vec4(0, 0, 0, 1);\n      float _Shininess = 10.0;\n\n      fragColor += albedo * lambertTerm * light.color * vec3(lightIntensity);\n      \n      // if (lightIntensity \n      //    * max(0.0, dot(normal, lightDirection)) \n      //    >= _DiffuseThreshold)\n      // {\n      //    fragColor += vec3(light.color) * albedo * lambertTerm; \n      // }else\n      //\n      // if (dot(viewDirection, normal) \n      //    < mix(_UnlitOutlineThickness, _LitOutlineThickness, \n      //    max(0.0, dot(normal, lightDirection))))\n      // {\n      //    fragColor += \n      //       vec3(light.color) * vec3(_OutlineColor); \n      // }else\n      //\n      // if (dot(normal, lightDirection) > 0.0 \n      //   \n      //    && lightIntensity *  pow(max(0.0, dot(\n      //    reflect(-lightDirection, normal), \n      //    viewDirection)), _Shininess) > 0.5) \n      // {\n      //    fragColor += vec3(light.color) * albedo * lambertTerm;\n      //      \n      // }\n    }\n\n    const vec3 ambientLight = vec3(0.025);\n    fragColor += albedo * ambientLight;\n\n    gl_FragColor = vec4(fragColor, 1.0);\n  }\n  "}({numLights:Z}),{uniforms:["u_viewProjectionMatrix","u_colmap","u_normap","u_lightbuffer","u_camPos","u_view"],attribs:["a_position","a_normal","a_uv"]}),this._projectionMatrix=G.Ue(),this._viewMatrix=G.Ue(),this._viewProjectionMatrix=G.Ue()}return ForwardRenderer.prototype.render=function render(x,S){x.updateMatrixWorld(),G.U_(this._viewMatrix,x.matrixWorld.elements),G.JG(this._projectionMatrix,x.projectionMatrix.elements),G.Jp(this._viewProjectionMatrix,this._projectionMatrix,this._viewMatrix);for(var w=0;w<Z;++w)this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+0]=S.lights[w].position[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+1]=S.lights[w].position[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+2]=S.lights[w].position[2],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+3]=S.lights[w].radius,this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+0]=S.lights[w].color[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+1]=S.lights[w].color[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+2]=S.lights[w].color[2];this._lightTexture.update(),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,null),U.gl.viewport(0,0,canvas.width,canvas.height),U.gl.clear(U.gl.COLOR_BUFFER_BIT|U.gl.DEPTH_BUFFER_BIT),U.gl.useProgram(this._shaderProgram.glShaderProgram),U.gl.uniformMatrix4fv(this._shaderProgram.u_viewProjectionMatrix,!1,this._viewProjectionMatrix),U.gl.activeTexture(U.gl.TEXTURE2),U.gl.bindTexture(U.gl.TEXTURE_2D,this._lightTexture.glTexture),U.gl.uniform1i(this._shaderProgram.u_lightbuffer,2),U.gl.uniformMatrix4fv(this._shaderProgram.u_view,!1,this._viewMatrix),U.gl.uniform3f(this._shaderProgram.u_camPos,x.position.x,x.position.y,x.position.z),S.draw(this._shaderProgram)},ForwardRenderer}(),ie=w(863),re=w.n(ie);var oe=w(212),ae=w(7),se=w.n(ae),le=w(355),ce=w.n(le),ue=function(){function Wireframe(){this._shaderProgram=loadShaderProgram(se(),ce(),{uniforms:["u_viewProjectionMatrix"],attribs:["a_position","a_color"]}),this._projectionMatrix=G.Ue(),this._viewMatrix=G.Ue(),this._viewProjectionMatrix=G.Ue(),this._attributesNeedUpdate=!1,this._positions=[],this._colors=[],this._vertexAttributes}var x=Wireframe.prototype;return x.addLineSegment=function addLineSegment(x,S,w){this._positions.push(x.slice()),this._positions.push(S.slice()),this._colors.push(w.slice()),this._colors.push(w.slice()),this._attributesNeedUpdate=!0},x._updateVertexData=function _updateVertexData(){for(var x=[],S=0;S<this._positions.length;S++)x.push(this._positions[S][0]),x.push(this._positions[S][1]),x.push(this._positions[S][2]),x.push(this._colors[S][0]),x.push(this._colors[S][1]),x.push(this._colors[S][2]);var w=U.gl.createBuffer();U.gl.bindBuffer(U.gl.ARRAY_BUFFER,w),U.gl.bufferData(U.gl.ARRAY_BUFFER,new Float32Array(x),U.gl.STATIC_DRAW),this._vertexAttributes=w,this._attributesNeedUpdate=!1},x.render=function render(x){0!==this._positions.length&&(this._attributesNeedUpdate&&this._updateVertexData(),x.updateMatrixWorld(),G.U_(this._viewMatrix,x.matrixWorld.elements),G.JG(this._projectionMatrix,x.projectionMatrix.elements),G.Jp(this._viewProjectionMatrix,this._projectionMatrix,this._viewMatrix),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,null),U.gl.viewport(0,0,canvas.width,canvas.height),U.gl.useProgram(this._shaderProgram.glShaderProgram),U.gl.uniformMatrix4fv(this._shaderProgram.u_viewProjectionMatrix,!1,this._viewProjectionMatrix),U.gl.bindBuffer(U.gl.ARRAY_BUFFER,this._vertexAttributes),U.gl.enableVertexAttribArray(this._shaderProgram.a_position),U.gl.enableVertexAttribArray(this._shaderProgram.a_color),U.gl.vertexAttribPointer(this._shaderProgram.a_position,3,U.gl.FLOAT,!1,24,0),U.gl.vertexAttribPointer(this._shaderProgram.a_color,3,U.gl.FLOAT,!1,24,12),U.gl.drawArrays(U.gl.LINES,0,this._positions.length))},Wireframe}(),he=w(160),de=100,pe=function(){function BaseRenderer(x,S,w){this._clusterTexture=new te(x*S*w,101),this._xSlices=x,this._ySlices=S,this._zSlices=w,this._clusterMins=[],this._clusterMaxs=[],this._clusterAABB=[],this.assembleClusters(U.nS,U.JQ)}var x=BaseRenderer.prototype;return x.getNormalForTriangle=function getNormalForTriangle(x){var S=Math.sqrt(1+x*x);return[1/S,x/S]},x.getDotForFrustumCheck=function getDotForFrustumCheck(x,S,w){var U,G=this.getNormalForTriangle(x);return U="x"===w?he.al(G[0],0,-G[1]):he.al(0,G[0],-G[1]),he.AK(S,U)},x.screen2View=function screen2View(x,S){var w=new oe.Vector2(x.x/U.JQ.width,x.y/U.JQ.height),G=new oe.Vector4(2*w.x-1,2*(1-w.y)-1,x.z,x.w).applyMatrix4(S);return G=G.divideScalar(G.w)},x.lineIntersectionToZPlane=function lineIntersectionToZPlane(x,S){var w=new oe.Vector3(0,0,1),U=new oe.Vector3(0,0,0);w.dot(x);var G=S/w.dot(x);return U.clone().add(x.multiplyScalar(G))},x.assembleClusters=function assembleClusters(x,S){var w=S.width/this._xSlices,U=S.height/this._ySlices,G=x.near,H=x.far;this._clusterAABB=[];for(var z=0;z<this._zSlices;++z)for(var j=0;j<this._ySlices;++j)for(var X=0;X<this._xSlices;++X){new oe.Vector3(0,0,0);var K=new oe.Vector4((X+1)*w,(j+1)*U,-1,1),q=new oe.Vector4((X+0)*w,(j+0)*U,-1,1),Y=this.screen2View(K,x.projectionMatrixInverse),Z=new oe.Vector3(Y.x,Y.y,Y.z),J=this.screen2View(q,x.projectionMatrixInverse),Q=new oe.Vector3(J.x,J.y,J.z),ee=-G*Math.pow(H/G,z/this._zSlices),te=-G*Math.pow(H/G,(z+1)/this._zSlices),ne=this.lineIntersectionToZPlane(Q,ee),ie=this.lineIntersectionToZPlane(Q,te),re=this.lineIntersectionToZPlane(Z,ee),ae=this.lineIntersectionToZPlane(Z,te),se=new oe.Vector3(Math.min(ne.x,ie.x,re.x,ae.x),Math.min(ne.y,ie.y,re.y,ae.y),Math.min(ne.z,ie.z,re.z,ae.z)),le=new oe.Vector3(Math.max(re.x,ae.x,re.x,ae.x),Math.max(re.y,ae.y,re.y,ae.y),Math.max(re.z,ae.z,re.z,ae.z));this._clusterAABB.push(new oe.Box3(se,le))}},x.rad=function rad(x){return x*(Math.PI/180)},x.updateClusters=function updateClusters(x,S,w){for(var U=2*Math.tan(this.rad(x.fov/2)),G=(x.aspect,this._xSlices,this._ySlices,x.far,x.near,this._zSlices,x.position,x.rotation,0);G<this._zSlices;++G)for(var H=0;H<this._ySlices;++H)for(var z=0;z<this._xSlices;++z){var j=z+H*this._xSlices+G*this._xSlices*this._ySlices;this._clusterTexture.buffer[this._clusterTexture.bufferIndex(j,0)]=0}for(var X=0;X<this._zSlices;++X)for(var K=0;K<this._ySlices;++K)for(var q=0;q<this._xSlices;++q)for(var Y=q+K*this._xSlices+X*this._xSlices*this._ySlices,J=0;J<Z;++J){var Q=w.lights[J],ee=new oe.Vector4(Q.position[0],Q.position[1],Q.position[2],1);if(ee.applyMatrix4(x.matrixWorldInverse),new oe.Sphere(new oe.Vector3(ee.x,ee.y,ee.z),Q.radius).intersectsBox(this._clusterAABB[Y])){var te=this._clusterTexture.buffer[this._clusterTexture.bufferIndex(Y,0)];if(te<de){this._clusterTexture.buffer[this._clusterTexture.bufferIndex(Y,0)]=te+1;var ne=Math.floor((te+1)/4),ie=te+1-4*ne;this._clusterTexture.buffer[this._clusterTexture.bufferIndex(Y,ne)+ie]=J}}}this._clusterTexture.update()},BaseRenderer}();function _setPrototypeOf(x,S){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(x,S){return x.__proto__=S,x},_setPrototypeOf(x,S)}var me=function(x){function ForwardPlusRenderer(S,w,U){var H;return(H=x.call(this,S,w,U)||this)._lightTexture=new te(Z,8),H._shaderProgram=loadShaderProgram(re(),function forwardPlus_frag_glsl(x){return"\n  // TODO: This is pretty much just a clone of forward.frag.glsl.js\n\n  #version 100\n  precision highp float;\n\n  uniform sampler2D u_colmap;\n  uniform sampler2D u_normap;\n  uniform sampler2D u_lightbuffer;\n\n  // TODO: Read this buffer to determine the lights influencing a cluster\n  uniform sampler2D u_clusterbuffer;\n  \n  uniform float u_near;\n  uniform float u_far;\n  uniform float u_width;\n  uniform float u_height;\n\n  uniform mat4 u_view;\n  uniform vec3 u_camPos;\n\n  varying vec3 v_position;\n  varying vec3 v_normal;\n  varying vec2 v_uv;\n\n  vec3 applyNormalMap(vec3 geomnor, vec3 normap) {\n    normap = normap * 2.0 - 1.0;\n    vec3 up = normalize(vec3(0.001, 1, 0.001));\n    vec3 surftan = normalize(cross(geomnor, up));\n    vec3 surfbinor = cross(geomnor, surftan);\n    return normap.y * surftan + normap.x * surfbinor + normap.z * geomnor;\n  }\n\n  struct Light {\n    vec3 position;\n    float radius;\n    vec3 color;\n  };\n\n  float ExtractFloat(sampler2D texture, int textureWidth, int textureHeight, int index, int component) {\n    float u = float(index + 1) / float(textureWidth + 1);\n    int pixel = component / 4;\n    float v = float(pixel + 1) / float(textureHeight + 1);\n    vec4 texel = texture2D(texture, vec2(u, v));\n    int pixelComponent = component - pixel * 4;\n    if (pixelComponent == 0) {\n      return texel[0];\n    } else if (pixelComponent == 1) {\n      return texel[1];\n    } else if (pixelComponent == 2) {\n      return texel[2];\n    } else if (pixelComponent == 3) {\n      return texel[3];\n    }\n  }\n\n  Light UnpackLight(int index) {\n    Light light;\n    float u = float(index + 1) / float("+(x.numLights+1)+");\n    vec4 v1 = texture2D(u_lightbuffer, vec2(u, 0.3));\n    vec4 v2 = texture2D(u_lightbuffer, vec2(u, 0.6));\n    light.position = v1.xyz;\n\n    // LOOK: This extracts the 4th float (radius) of the (index)th light in the buffer\n    // Note that this is just an example implementation to extract one float.\n    // There are more efficient ways if you need adjacent values\n    light.radius = ExtractFloat(u_lightbuffer, "+x.numLights+", 2, index, 3);\n\n    light.color = v2.rgb;\n    return light;\n  }\n\n  // Cubic approximation of gaussian curve so we falloff to exactly 0 at the light radius\n  float cubicGaussian(float h) {\n    if (h < 1.0) {\n      return 0.25 * pow(2.0 - h, 3.0) - pow(1.0 - h, 3.0);\n    } else if (h < 2.0) {\n      return 0.25 * pow(2.0 - h, 3.0);\n    } else {\n      return 0.0;\n    }\n  }\n\n  void main() {\n    vec3 albedo = texture2D(u_colmap, v_uv).rgb;\n    vec3 normap = texture2D(u_normap, v_uv).xyz;\n    vec3 normal = applyNormalMap(v_normal, normap);\n\n    vec3 fragColor = vec3(0.0);\n    \n    // determine which cluster index we are in\n    // it seems like we need to basically do almost the same calculations as before?\n    // luckily I guess we don't need to re calculate the x/y as they are already part of the shader \n    int cx = int(gl_FragCoord.x / u_width * float("+x.xSlices+"));\n    int cy = int(gl_FragCoord.y / u_height * float("+x.ySlices+"));\n    \n    // for z, we need to repeat another version of the technique used for the cpu calculation\n    // use the view matrix to get our coordinate system into camera-based coordinates \n    vec4 transCamPos = u_view * vec4(v_position, 1.0);   \n    float Z = distance(vec3(u_camPos), vec3(v_position)) - u_near;\n    \n    float fraq1 =  float("+x.zSlices+") / log(u_far / u_near);\n    float fraq2 =  ( float("+x.zSlices+") * log(u_near) ) / log( u_far / u_near);\n    \n    int cz = int( float("+x.zSlices+") - ((log(-transCamPos.z) *  fraq1)  - fraq2 )); \n    //int cz = 1;\n    \n    //int cz = int((-transCamPos.z - u_near) / (u_far - u_near) * float("+x.zSlices+"));\n    \n    \n    // using the indexes, get the buffer indexes by using the 3d offsets\n    int cluster_idx = cx + cy * "+x.xSlices+" + cz * "+x.xSlices+" * "+x.ySlices+";\n    int bufWidth = "+x.xSlices+" * "+x.ySlices+" * "+x.zSlices+";\n    // divide by four because each stores x,y,z,rad    \n    int bufHeight = int(float("+x.maxLights+" + 1) / 4.0) + 1;\n    \n    // finally, extract info from buffer using the provided function\n    int num_lights = int(ExtractFloat(u_clusterbuffer, bufWidth, bufHeight,  cluster_idx, 0)); \n\n\n    for (int i = 0; i < "+x.numLights+"; i++) {\n    \n      // can not seem to use this as a loop sentinel for some reason\n      if (i >= num_lights) {\n         break;\n      }\n      \n      // use the light index\n      int light_idx = int(ExtractFloat(u_clusterbuffer, bufWidth, bufHeight,  cluster_idx, i + 1));\n      \n    \n      Light light = UnpackLight(light_idx);\n      float lightDistance = distance(light.position, v_position);\n      vec3 L = (light.position - v_position) / lightDistance;\n\n      float lightIntensity = cubicGaussian(2.0 * lightDistance / light.radius);\n      float lambertTerm = max(dot(L, normal), 0.0);\n\n      fragColor += albedo * lambertTerm * light.color * vec3(lightIntensity);\n    }\n\n    const vec3 ambientLight = vec3(0.025);\n    fragColor += albedo * ambientLight;\n\n    gl_FragColor = vec4(fragColor, 1.0);\n  }\n  "}({numLights:Z,maxLights:de,xSlices:S,ySlices:w,zSlices:U}),{uniforms:["u_viewProjectionMatrix","u_colmap","u_normap","u_lightbuffer","u_clusterbuffer","u_width","u_height","u_camPos","u_view","u_near","u_far"],attribs:["a_position","a_normal","a_uv"]}),H._projectionMatrix=G.Ue(),H._viewMatrix=G.Ue(),H._viewProjectionMatrix=G.Ue(),H}return function _inheritsLoose(x,S){x.prototype=Object.create(S.prototype),x.prototype.constructor=x,_setPrototypeOf(x,S)}(ForwardPlusRenderer,x),ForwardPlusRenderer.prototype.render=function render(x,S){x.updateMatrixWorld(),G.U_(this._viewMatrix,x.matrixWorld.elements),G.JG(this._projectionMatrix,x.projectionMatrix.elements),G.Jp(this._viewProjectionMatrix,this._projectionMatrix,this._viewMatrix),this.updateClusters(x,this._viewMatrix,S);for(var w=0;w<Z;++w)this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+0]=S.lights[w].position[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+1]=S.lights[w].position[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+2]=S.lights[w].position[2],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+3]=S.lights[w].radius,this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+0]=S.lights[w].color[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+1]=S.lights[w].color[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+2]=S.lights[w].color[2];this._lightTexture.update(),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,null),U.gl.viewport(0,0,canvas.width,canvas.height),U.gl.clear(U.gl.COLOR_BUFFER_BIT|U.gl.DEPTH_BUFFER_BIT),U.gl.useProgram(this._shaderProgram.glShaderProgram),U.gl.uniformMatrix4fv(this._shaderProgram.u_viewProjectionMatrix,!1,this._viewProjectionMatrix),U.gl.activeTexture(U.gl.TEXTURE2),U.gl.bindTexture(U.gl.TEXTURE_2D,this._lightTexture.glTexture),U.gl.uniform1i(this._shaderProgram.u_lightbuffer,2),U.gl.activeTexture(U.gl.TEXTURE3),U.gl.bindTexture(U.gl.TEXTURE_2D,this._clusterTexture.glTexture),U.gl.uniform1i(this._shaderProgram.u_clusterbuffer,3),U.gl.uniformMatrix4fv(this._shaderProgram.u_view,!1,this._viewMatrix),U.gl.uniform3f(this._shaderProgram.u_camPos,x.position.x,x.position.y,x.position.z),U.gl.uniform1f(this._shaderProgram.u_near,x.near),U.gl.uniform1f(this._shaderProgram.u_far,x.far),U.gl.uniform1f(this._shaderProgram.u_width,canvas.width),U.gl.uniform1f(this._shaderProgram.u_height,canvas.height),S.draw(this._shaderProgram)},ForwardPlusRenderer}(pe),fe=w(864),ge=w.n(fe),ve=w(745),_e=w.n(ve);function clusteredDeferred_setPrototypeOf(x,S){return clusteredDeferred_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(x,S){return x.__proto__=S,x},clusteredDeferred_setPrototypeOf(x,S)}var ye=function(x){function ClusteredDeferredRenderer(S,w,H){var j;return(j=x.call(this,S,w,H)||this).setupDrawBuffers(U.JQ.width,U.JQ.height),j._lightTexture=new te(Z,8),j._progCopy=loadShaderProgram(ge(),_e(),{uniforms:["u_viewProjectionMatrix","u_colmap","u_normap"],attribs:["a_position","a_normal","a_uv"]}),j._progShade=loadShaderProgram(z(),function deferred_frag_glsl(x){return"\n  #version 100\n  precision highp float;\n  \n  uniform sampler2D u_gbuffers["+x.numGBuffers+"];\n  uniform sampler2D u_lightbuffer;\n  uniform sampler2D u_clusterbuffer;\n  \n  uniform float u_near;\n  uniform float u_far;\n  uniform float u_width;\n  uniform float u_height;\n\n  uniform mat4 u_view;\n  uniform vec3 u_camPos;\n  \n  uniform mat4 u_invView;\n  \n  varying vec2 v_uv;\n  \n  struct Light {\n    vec3 position;\n    float radius;\n    vec3 color;\n  };\n\n  float ExtractFloat(sampler2D texture, int textureWidth, int textureHeight, int index, int component) {\n    float u = float(index + 1) / float(textureWidth + 1);\n    int pixel = component / 4;\n    float v = float(pixel + 1) / float(textureHeight + 1);\n    vec4 texel = texture2D(texture, vec2(u, v));\n    int pixelComponent = component - pixel * 4;\n    if (pixelComponent == 0) {\n      return texel[0];\n    } else if (pixelComponent == 1) {\n      return texel[1];\n    } else if (pixelComponent == 2) {\n      return texel[2];\n    } else if (pixelComponent == 3) {\n      return texel[3];\n    }\n  }\n\n  Light UnpackLight(int index) {\n    Light light;\n    float u = float(index + 1) / float("+(x.numLights+1)+");\n    vec4 v1 = texture2D(u_lightbuffer, vec2(u, 0.0));\n    vec4 v2 = texture2D(u_lightbuffer, vec2(u, 0.5));\n    light.position = v1.xyz;\n\n    // LOOK: This extracts the 4th float (radius) of the (index)th light in the buffer\n    // Note that this is just an example implementation to extract one float.\n    // There are more efficient ways if you need adjacent values\n    light.radius = ExtractFloat(u_lightbuffer, "+x.numLights+", 2, index, 3);\n\n    light.color = v2.rgb;\n    return light;\n  }\n\n  // Cubic approximation of gaussian curve so we falloff to exactly 0 at the light radius\n  float cubicGaussian(float h) {\n    if (h < 1.0) {\n      return 0.25 * pow(2.0 - h, 3.0) - pow(1.0 - h, 3.0);\n    } else if (h < 2.0) {\n      return 0.25 * pow(2.0 - h, 3.0);\n    } else {\n      return 0.0;\n    }\n  }\n  \n  void main() {\n    // TODO: extract data from g buffers and do lighting\n    // vec4 gb0 = texture2D(u_gbuffers[0], v_uv);\n    // vec4 gb1 = texture2D(u_gbuffers[1], v_uv);\n    // vec4 gb2 = texture2D(u_gbuffers[2], v_uv);\n    // vec4 gb3 = texture2D(u_gbuffers[3], v_uv);\n    \n    \n    // un optimized\n    vec4 gb0 = texture2D(u_gbuffers[0], v_uv);\n    vec4 gb1 = texture2D(u_gbuffers[1], v_uv);\n    vec4 gb2 = texture2D(u_gbuffers[2], v_uv);\n\n    vec3 albedo = gb0.xyz;\n    vec3 normal = gb1.xyz;    \n    vec3 v_position = gb2.xyz;\n    \n    // optimized \n    // vec4 gb0 = texture2D(u_gbuffers[0], v_uv);\n    // vec4 gb1 = texture2D(u_gbuffers[1], v_uv);\n    //\n    // vec3 albedo = gb0.xyz;\n    // vec3 v_position = gb1.xyz;\n    //\n    // float inv = sqrt(1.0 - gb0.w * gb0.w - gb1.w * gb1.w);\n    // vec4 norm_sq = u_invView * vec4(gb0.w, gb1.w, inv, 0.0);\n    // vec3 normal = normalize(norm_sq.xyz);\n    \n    \n    \n    vec3 fragColor = vec3(0.0);\n    \n    // determine which cluster index we are in\n    // it seems like we need to basically do almost the same calculations as before?\n    // luckily I guess we don't need to re calculate the x/y as they are already part of the shader \n    int cx = int(gl_FragCoord.x / u_width * float("+x.xSlices+"));\n    int cy = int(gl_FragCoord.y / u_height * float("+x.ySlices+"));\n    \n    // for z, we need to repeat another version of the technique used for the cpu calculation\n    // use the view matrix to get our coordinate system into camera-based coordinates \n    vec4 transCamPos = u_view * vec4(v_position, 1.0);   \n    \n    float fraq1 =  float("+x.zSlices+") / log(u_far / u_near);\n    float fraq2 =  ( float("+x.zSlices+") * log(u_near) ) / log( u_far / u_near);\n    \n    int cz = int( float("+x.zSlices+") - ((log(-transCamPos.z) *  fraq1)  - fraq2 )); \n    //int cz = 1;\n    \n    //int cz = int((-transCamPos.z - u_near) / (u_far - u_near) * float("+x.zSlices+"));\n    \n    \n    // using the indexes, get the buffer indexes by using the 3d offsets\n    int cluster_idx = cx + cy * "+x.xSlices+" + cz * "+x.xSlices+" * "+x.ySlices+";\n    int bufWidth = "+x.xSlices+" * "+x.ySlices+" * "+x.zSlices+";\n    // divide by four because each stores x,y,z,rad    \n    int bufHeight = int(float("+x.maxLights+" + 1) / 4.0) + 1;\n    \n    // finally, extract info from buffer using the provided function\n    int num_lights = int(ExtractFloat(u_clusterbuffer, bufWidth, bufHeight,  cluster_idx, 0)); \n\n\n    for (int i = 0; i < "+x.numLights+"; i++) {\n    \n      // can not seem to use this as a loop sentinel for some reason\n      if (i >= num_lights) {\n         break;\n      }\n      \n      // use the light index\n      int light_idx = int(ExtractFloat(u_clusterbuffer, bufWidth, bufHeight,  cluster_idx, i + 1));\n      \n    \n      Light light = UnpackLight(light_idx);\n      float lightDistance = distance(light.position, v_position);\n      vec3 L = (light.position - v_position) / lightDistance;\n\n      float lightIntensity = cubicGaussian(2.0 * lightDistance / light.radius);\n      float lambertTerm = max(dot(L, normal), 0.0);\n\n      fragColor += albedo * lambertTerm * light.color * vec3(lightIntensity);\n    }\n\n    const vec3 ambientLight = vec3(0.025);\n    fragColor += albedo * ambientLight;\n\n    gl_FragColor = vec4(fragColor, 1.0);\n  }\n  "}({numLights:Z,numGBuffers:3,maxLights:de,xSlices:S,ySlices:w,zSlices:H}),{uniforms:["u_gbuffers[0]","u_gbuffers[1]","u_gbuffers[2]","u_invView","u_viewProjectionMatrix","u_colmap","u_normap","u_lightbuffer","u_clusterbuffer","u_width","u_height","u_camPos","u_view","u_near","u_far"],attribs:["a_uv"]}),j._projectionMatrix=G.Ue(),j._viewMatrix=G.Ue(),j._viewProjectionMatrix=G.Ue(),j}!function clusteredDeferred_inheritsLoose(x,S){x.prototype=Object.create(S.prototype),x.prototype.constructor=x,clusteredDeferred_setPrototypeOf(x,S)}(ClusteredDeferredRenderer,x);var S=ClusteredDeferredRenderer.prototype;return S.setupDrawBuffers=function setupDrawBuffers(x,S){this._width=x,this._height=S,this.invView=G.Ue(),this._fbo=U.gl.createFramebuffer(),this._depthTex=U.gl.createTexture(),U.gl.bindTexture(U.gl.TEXTURE_2D,this._depthTex),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MAG_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MIN_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_S,U.gl.CLAMP_TO_EDGE),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_T,U.gl.CLAMP_TO_EDGE),U.gl.texImage2D(U.gl.TEXTURE_2D,0,U.gl.DEPTH_COMPONENT,x,S,0,U.gl.DEPTH_COMPONENT,U.gl.UNSIGNED_SHORT,null),U.gl.bindTexture(U.gl.TEXTURE_2D,null),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,this._fbo),U.gl.framebufferTexture2D(U.gl.FRAMEBUFFER,U.gl.DEPTH_ATTACHMENT,U.gl.TEXTURE_2D,this._depthTex,0),this._gbuffers=new Array(3);for(var w=new Array(3),H=0;H<3;H++)w[H]=U.BJ["COLOR_ATTACHMENT"+H+"_WEBGL"],this._gbuffers[H]=U.gl.createTexture(),U.gl.bindTexture(U.gl.TEXTURE_2D,this._gbuffers[H]),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MAG_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_MIN_FILTER,U.gl.NEAREST),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_S,U.gl.CLAMP_TO_EDGE),U.gl.texParameteri(U.gl.TEXTURE_2D,U.gl.TEXTURE_WRAP_T,U.gl.CLAMP_TO_EDGE),U.gl.texImage2D(U.gl.TEXTURE_2D,0,U.gl.RGBA,x,S,0,U.gl.RGBA,U.gl.FLOAT,null),U.gl.bindTexture(U.gl.TEXTURE_2D,null),U.gl.framebufferTexture2D(U.gl.FRAMEBUFFER,w[H],U.gl.TEXTURE_2D,this._gbuffers[H],0);if(U.gl.checkFramebufferStatus(U.gl.FRAMEBUFFER)!=U.gl.FRAMEBUFFER_COMPLETE)throw"Framebuffer incomplete";U.BJ.drawBuffersWEBGL(w),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,null)},S.resize=function resize(x,S){this._width=x,this._height=S,U.gl.bindTexture(U.gl.TEXTURE_2D,this._depthTex),U.gl.texImage2D(U.gl.TEXTURE_2D,0,U.gl.DEPTH_COMPONENT,x,S,0,U.gl.DEPTH_COMPONENT,U.gl.UNSIGNED_SHORT,null);for(var w=0;w<3;w++)U.gl.bindTexture(U.gl.TEXTURE_2D,this._gbuffers[w]),U.gl.texImage2D(U.gl.TEXTURE_2D,0,U.gl.RGBA,x,S,0,U.gl.RGBA,U.gl.FLOAT,null);U.gl.bindTexture(U.gl.TEXTURE_2D,null)},S.render=function render(x,S){U.JQ.width==this._width&&U.JQ.height==this._height||this.resize(U.JQ.width,U.JQ.height),x.updateMatrixWorld(),G.U_(this._viewMatrix,x.matrixWorld.elements),G.U_(this.invView,this._viewMatrix),G.JG(this._projectionMatrix,x.projectionMatrix.elements),G.Jp(this._viewProjectionMatrix,this._projectionMatrix,this._viewMatrix),U.gl.viewport(0,0,U.JQ.width,U.JQ.height),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,this._fbo),U.gl.clear(U.gl.COLOR_BUFFER_BIT|U.gl.DEPTH_BUFFER_BIT),U.gl.useProgram(this._progCopy.glShaderProgram),U.gl.uniformMatrix4fv(this._progCopy.u_viewProjectionMatrix,!1,this._viewProjectionMatrix),S.draw(this._progCopy);for(var w=0;w<Z;++w)this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+0]=S.lights[w].position[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+1]=S.lights[w].position[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+2]=S.lights[w].position[2],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,0)+3]=S.lights[w].radius,this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+0]=S.lights[w].color[0],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+1]=S.lights[w].color[1],this._lightTexture.buffer[this._lightTexture.bufferIndex(w,1)+2]=S.lights[w].color[2];this._lightTexture.update(),this.updateClusters(x,this._viewMatrix,S),U.gl.bindFramebuffer(U.gl.FRAMEBUFFER,null),U.gl.clear(U.gl.COLOR_BUFFER_BIT|U.gl.DEPTH_BUFFER_BIT),U.gl.useProgram(this._progShade.glShaderProgram),U.gl.activeTexture(U.gl.TEXTURE3),U.gl.bindTexture(U.gl.TEXTURE_2D,this._clusterTexture.glTexture),U.gl.uniform1i(this._progShade.u_clusterbuffer,3),U.gl.activeTexture(U.gl.TEXTURE4),U.gl.bindTexture(U.gl.TEXTURE_2D,this._lightTexture.glTexture),U.gl.uniform1i(this._progShade.u_lightbuffer,4),U.gl.uniformMatrix4fv(this._progShade.u_view,!1,this._viewMatrix),U.gl.uniform3f(this._progShade.u_camPos,x.position.x,x.position.y,x.position.z),U.gl.uniform1f(this._progShade.u_near,x.near),U.gl.uniform1f(this._progShade.u_far,x.far),U.gl.uniform1f(this._progShade.u_width,U.JQ.width),U.gl.uniform1f(this._progShade.u_height,U.JQ.height),U.gl.uniformMatrix4fv(this._progShade.u_invView,!1,this.invView);for(var H=0;H<3;H++)U.gl.activeTexture(U.gl["TEXTURE"+(H+0)]),U.gl.bindTexture(U.gl.TEXTURE_2D,this._gbuffers[H]),U.gl.uniform1i(this._progShade["u_gbuffers["+H+"]"],H+0);!function renderFullscreenQuad(x){U.gl.useProgram(x.glShaderProgram),U.gl.bindBuffer(U.gl.ARRAY_BUFFER,X),U.gl.enableVertexAttribArray(x.a_position),U.gl.vertexAttribPointer(x.a_position,3,U.gl.FLOAT,U.gl.FALSE,0,0),U.gl.drawArrays(U.gl.TRIANGLE_STRIP,0,4),U.gl.disableVertexAttribArray(x.a_position),U.gl.bindBuffer(U.gl.ARRAY_BUFFER,null)}(this._progShade)},ClusteredDeferredRenderer}(pe),be="Forward",xe="Forward+",Ee="Clustered Deferred",Se={renderer:be,_renderer:null};function setRenderer(x){switch(x){case be:Se._renderer=new ne;break;case xe:Se._renderer=new me(10,10,10);break;case Ee:Se._renderer=new ye(10,10,10)}}setRenderer(Se.renderer),U.NR.add(Se,"renderer",[be,xe,Ee]).onChange(setRenderer);var we=new J;we.loadGLTF("models/sponza/sponza.gltf");var Te=new ue;U.nS.position.set(-10,8,0),U.Dd.target.set(0,2,0),U.gl.enable(U.gl.DEPTH_TEST);(0,U.Re)((function render(){we.update(),Se._renderer.render(U.nS,we),U.gl.disable(U.gl.DEPTH_TEST),Te.render(U.nS),U.gl.enable(U.gl.DEPTH_TEST)}))()},685:(x,S,w)=>{"use strict";w.d(S,{Ib:()=>U,WT:()=>G});var U=1e-6,G="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var x=0,S=arguments.length;S--;)x+=arguments[S]*arguments[S];return Math.sqrt(x)})},975:(x,S,w)=>{"use strict";w.d(S,{Ue:()=>create,JG:()=>copy,U_:()=>invert,Jp:()=>multiply,bA:()=>scale,yl:()=>fromRotationTranslation});var U=w(685);function create(){var x=new U.WT(16);return U.WT!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x}function copy(x,S){return x[0]=S[0],x[1]=S[1],x[2]=S[2],x[3]=S[3],x[4]=S[4],x[5]=S[5],x[6]=S[6],x[7]=S[7],x[8]=S[8],x[9]=S[9],x[10]=S[10],x[11]=S[11],x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15],x}function invert(x,S){var w=S[0],U=S[1],G=S[2],H=S[3],z=S[4],j=S[5],X=S[6],K=S[7],q=S[8],Y=S[9],Z=S[10],J=S[11],Q=S[12],ee=S[13],te=S[14],ne=S[15],ie=w*j-U*z,re=w*X-G*z,oe=w*K-H*z,ae=U*X-G*j,se=U*K-H*j,le=G*K-H*X,ce=q*ee-Y*Q,ue=q*te-Z*Q,he=q*ne-J*Q,de=Y*te-Z*ee,pe=Y*ne-J*ee,me=Z*ne-J*te,fe=ie*me-re*pe+oe*de+ae*he-se*ue+le*ce;return fe?(fe=1/fe,x[0]=(j*me-X*pe+K*de)*fe,x[1]=(G*pe-U*me-H*de)*fe,x[2]=(ee*le-te*se+ne*ae)*fe,x[3]=(Z*se-Y*le-J*ae)*fe,x[4]=(X*he-z*me-K*ue)*fe,x[5]=(w*me-G*he+H*ue)*fe,x[6]=(te*oe-Q*le-ne*re)*fe,x[7]=(q*le-Z*oe+J*re)*fe,x[8]=(z*pe-j*he+K*ce)*fe,x[9]=(U*he-w*pe-H*ce)*fe,x[10]=(Q*se-ee*oe+ne*ie)*fe,x[11]=(Y*oe-q*se-J*ie)*fe,x[12]=(j*ue-z*de-X*ce)*fe,x[13]=(w*de-U*ue+G*ce)*fe,x[14]=(ee*re-Q*ae-te*ie)*fe,x[15]=(q*ae-Y*re+Z*ie)*fe,x):null}function multiply(x,S,w){var U=S[0],G=S[1],H=S[2],z=S[3],j=S[4],X=S[5],K=S[6],q=S[7],Y=S[8],Z=S[9],J=S[10],Q=S[11],ee=S[12],te=S[13],ne=S[14],ie=S[15],re=w[0],oe=w[1],ae=w[2],se=w[3];return x[0]=re*U+oe*j+ae*Y+se*ee,x[1]=re*G+oe*X+ae*Z+se*te,x[2]=re*H+oe*K+ae*J+se*ne,x[3]=re*z+oe*q+ae*Q+se*ie,re=w[4],oe=w[5],ae=w[6],se=w[7],x[4]=re*U+oe*j+ae*Y+se*ee,x[5]=re*G+oe*X+ae*Z+se*te,x[6]=re*H+oe*K+ae*J+se*ne,x[7]=re*z+oe*q+ae*Q+se*ie,re=w[8],oe=w[9],ae=w[10],se=w[11],x[8]=re*U+oe*j+ae*Y+se*ee,x[9]=re*G+oe*X+ae*Z+se*te,x[10]=re*H+oe*K+ae*J+se*ne,x[11]=re*z+oe*q+ae*Q+se*ie,re=w[12],oe=w[13],ae=w[14],se=w[15],x[12]=re*U+oe*j+ae*Y+se*ee,x[13]=re*G+oe*X+ae*Z+se*te,x[14]=re*H+oe*K+ae*J+se*ne,x[15]=re*z+oe*q+ae*Q+se*ie,x}function scale(x,S,w){var U=w[0],G=w[1],H=w[2];return x[0]=S[0]*U,x[1]=S[1]*U,x[2]=S[2]*U,x[3]=S[3]*U,x[4]=S[4]*G,x[5]=S[5]*G,x[6]=S[6]*G,x[7]=S[7]*G,x[8]=S[8]*H,x[9]=S[9]*H,x[10]=S[10]*H,x[11]=S[11]*H,x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15],x}function fromRotationTranslation(x,S,w){var U=S[0],G=S[1],H=S[2],z=S[3],j=U+U,X=G+G,K=H+H,q=U*j,Y=U*X,Z=U*K,J=G*X,Q=G*K,ee=H*K,te=z*j,ne=z*X,ie=z*K;return x[0]=1-(J+ee),x[1]=Y+ie,x[2]=Z-ne,x[3]=0,x[4]=Y-ie,x[5]=1-(q+ee),x[6]=Q+te,x[7]=0,x[8]=Z+ne,x[9]=Q-te,x[10]=1-(q+J),x[11]=0,x[12]=w[0],x[13]=w[1],x[14]=w[2],x[15]=1,x}},160:(x,S,w)=>{"use strict";w.d(S,{Ue:()=>create,al:()=>fromValues,t8:()=>set,Fv:()=>normalize,AK:()=>dot,kC:()=>cross,Zh:()=>H});var U=w(685);function create(){var x=new U.WT(3);return U.WT!=Float32Array&&(x[0]=0,x[1]=0,x[2]=0),x}function fromValues(x,S,w){var G=new U.WT(3);return G[0]=x,G[1]=S,G[2]=w,G}function set(x,S,w,U){return x[0]=S,x[1]=w,x[2]=U,x}function normalize(x,S){var w=S[0],U=S[1],G=S[2],H=w*w+U*U+G*G;return H>0&&(H=1/Math.sqrt(H)),x[0]=S[0]*H,x[1]=S[1]*H,x[2]=S[2]*H,x}function dot(x,S){return x[0]*S[0]+x[1]*S[1]+x[2]*S[2]}function cross(x,S,w){var U=S[0],G=S[1],H=S[2],z=w[0],j=w[1],X=w[2];return x[0]=G*X-H*j,x[1]=H*z-U*X,x[2]=U*j-G*z,x}var G,H=function length(x){var S=x[0],w=x[1],U=x[2];return Math.hypot(S,w,U)};G=create()},739:x=>{window,x.exports=function(x){var S={};function n(w){if(S[w])return S[w].exports;var U=S[w]={i:w,l:!1,exports:{}};return x[w].call(U.exports,U,U.exports,n),U.l=!0,U.exports}return n.m=x,n.c=S,n.d=function(x,S,w){n.o(x,S)||Object.defineProperty(x,S,{enumerable:!0,get:w})},n.r=function(x){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},n.t=function(x,S){if(1&S&&(x=n(x)),8&S)return x;if(4&S&&"object"==typeof x&&x&&x.__esModule)return x;var w=Object.create(null);if(n.r(w),Object.defineProperty(w,"default",{enumerable:!0,value:x}),2&S&&"string"!=typeof x)for(var U in x)n.d(w,U,function(S){return x[S]}.bind(null,U));return w},n.n=function(x){var S=x&&x.__esModule?function(){return x.default}:function(){return x};return n.d(S,"a",S),S},n.o=function(x,S){return Object.prototype.hasOwnProperty.call(x,S)},n.p="/",n(n.s=4)}([function(x,S){x.exports=function(x){return x.webpackPolyfill||(x.deprecate=function(){},x.paths=[],x.children||(x.children=[]),Object.defineProperty(x,"loaded",{enumerable:!0,get:function(){return x.l}}),Object.defineProperty(x,"id",{enumerable:!0,get:function(){return x.i}}),x.webpackPolyfill=1),x}},function(x,S,w){"use strict";var U,r=function(){return void 0===U&&(U=Boolean(window&&document&&document.all&&!window.atob)),U},G=function(){var x={};return function(S){if(void 0===x[S]){var w=document.querySelector(S);if(window.HTMLIFrameElement&&w instanceof window.HTMLIFrameElement)try{w=w.contentDocument.head}catch(x){w=null}x[S]=w}return x[S]}}(),H=[];function a(x){for(var S=-1,w=0;w<H.length;w++)if(H[w].identifier===x){S=w;break}return S}function c(x,S){for(var w={},U=[],G=0;G<x.length;G++){var z=x[G],j=S.base?z[0]+S.base:z[0],X=w[j]||0,K="".concat(j," ").concat(X);w[j]=X+1;var q=a(K),Y={css:z[1],media:z[2],sourceMap:z[3]};-1!==q?(H[q].references++,H[q].updater(Y)):H.push({identifier:K,updater:g(Y,S),references:1}),U.push(K)}return U}function l(x){var S=document.createElement("style"),U=x.attributes||{};if(void 0===U.nonce){var H=w.nc;H&&(U.nonce=H)}if(Object.keys(U).forEach((function(x){S.setAttribute(x,U[x])})),"function"==typeof x.insert)x.insert(S);else{var z=G(x.insert||"head");if(!z)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");z.appendChild(S)}return S}var z,j=(z=[],function(x,S){return z[x]=S,z.filter(Boolean).join("\n")});function d(x,S,w,U){var G=w?"":U.media?"@media ".concat(U.media," {").concat(U.css,"}"):U.css;if(x.styleSheet)x.styleSheet.cssText=j(S,G);else{var H=document.createTextNode(G),z=x.childNodes;z[S]&&x.removeChild(z[S]),z.length?x.insertBefore(H,z[S]):x.appendChild(H)}}function p(x,S,w){var U=w.css,G=w.media,H=w.sourceMap;if(G?x.setAttribute("media",G):x.removeAttribute("media"),H&&btoa&&(U+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(H))))," */")),x.styleSheet)x.styleSheet.cssText=U;else{for(;x.firstChild;)x.removeChild(x.firstChild);x.appendChild(document.createTextNode(U))}}var X=null,K=0;function g(x,S){var w,U,G;if(S.singleton){var H=K++;w=X||(X=l(S)),U=d.bind(null,w,H,!1),G=d.bind(null,w,H,!0)}else w=l(S),U=p.bind(null,w,S),G=function(){!function(x){if(null===x.parentNode)return!1;x.parentNode.removeChild(x)}(w)};return U(x),function(S){if(S){if(S.css===x.css&&S.media===x.media&&S.sourceMap===x.sourceMap)return;U(x=S)}else G()}}x.exports=function(x,S){(S=S||{}).singleton||"boolean"==typeof S.singleton||(S.singleton=r());var w=c(x=x||[],S);return function(x){if(x=x||[],"[object Array]"===Object.prototype.toString.call(x)){for(var U=0;U<w.length;U++){var G=a(w[U]);H[G].references--}for(var z=c(x,S),j=0;j<w.length;j++){var X=a(w[j]);0===H[X].references&&(H[X].updater(),H.splice(X,1))}w=z}}}},function(x,S,w){"use strict";x.exports=function(x){var S=[];return S.toString=function(){return this.map((function(S){var w=function(x,S){var w,U,G,H=x[1]||"",z=x[3];if(!z)return H;if(S&&"function"==typeof btoa){var j=(w=z,U=btoa(unescape(encodeURIComponent(JSON.stringify(w)))),G="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(U),"/*# ".concat(G," */")),X=z.sources.map((function(x){return"/*# sourceURL=".concat(z.sourceRoot||"").concat(x," */")}));return[H].concat(X).concat([j]).join("\n")}return[H].join("\n")}(S,x);return S[2]?"@media ".concat(S[2]," {").concat(w,"}"):w})).join("")},S.i=function(x,w,U){"string"==typeof x&&(x=[[null,x,""]]);var G={};if(U)for(var H=0;H<this.length;H++){var z=this[H][0];null!=z&&(G[z]=!0)}for(var j=0;j<x.length;j++){var X=[].concat(x[j]);U&&G[X[0]]||(w&&(X[2]?X[2]="".concat(w," and ").concat(X[2]):X[2]=w),S.push(X))}},S}},function(x,S){x.exports=function(){throw new Error("define cannot be used indirect")}},function(x,S,w){w(5),w(6),w(7),w(8),w(10),x.exports=w(15)},function(x,S,w){(function(x){!function(){var x=function(){return this}();x||"undefined"==typeof window||(x=window);var t=function(x,S,w){"string"==typeof x?(2==arguments.length&&(w=S),t.modules[x]||(t.payloads[x]=w,t.modules[x]=null)):t.original?t.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};t.modules={},t.payloads={};var S,w,r=function(x,S,w){if("string"==typeof S){var U=a(x,S);if(null!=U)return w&&w(),U}else if("[object Array]"===Object.prototype.toString.call(S)){for(var G=[],H=0,z=S.length;H<z;++H){var j=a(x,S[H]);if(null==j&&o.original)return;G.push(j)}return w&&w.apply(null,G)||!0}},o=function(x,S){var w=r("",x,S);return null==w&&o.original?o.original.apply(this,arguments):w},s=function(x,S){if(-1!==S.indexOf("!")){var w=S.split("!");return s(x,w[0])+"!"+s(x,w[1])}if("."==S.charAt(0))for(S=x.split("/").slice(0,-1).join("/")+"/"+S;-1!==S.indexOf(".")&&U!=S;){var U=S;S=S.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return S},a=function(x,S){S=s(x,S);var w=t.modules[S];if(!w){if("function"==typeof(w=t.payloads[S])){var U={},G={id:S,uri:"",exports:U,packaged:!0};U=w((function(x,w){return r(S,x,w)}),U,G)||G.exports,t.modules[S]=U,delete t.payloads[S]}w=t.modules[S]=U||w}return w};w=x,(S="ace")&&(x[S]||(x[S]={}),w=x[S]),w.define&&w.define.packaged||(t.original=w.define,w.define=t,w.define.packaged=!0),w.require&&w.require.packaged||(o.original=w.require,w.require=o,w.require.packaged=!0)}(),ace.define("ace/lib/regexp",["require","exports","module"],(function(x,S,w){"use strict";var U,G={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},H=void 0===G.exec.call(/()??/,"")[1],z=(U=/^/g,G.test.call(U,""),!U.lastIndex);function a(x){return(x.global?"g":"")+(x.ignoreCase?"i":"")+(x.multiline?"m":"")+(x.extended?"x":"")+(x.sticky?"y":"")}function c(x,S,w){if(Array.prototype.indexOf)return x.indexOf(S,w);for(var U=w||0;U<x.length;U++)if(x[U]===S)return U;return-1}z&&H||(RegExp.prototype.exec=function(x){var S,w,U=G.exec.apply(this,arguments);if("string"==typeof x&&U){if(!H&&U.length>1&&c(U,"")>-1&&(w=RegExp(this.source,G.replace.call(a(this),"g","")),G.replace.call(x.slice(U.index),w,(function(){for(var x=1;x<arguments.length-2;x++)void 0===arguments[x]&&(U[x]=void 0)}))),this._xregexp&&this._xregexp.captureNames)for(var j=1;j<U.length;j++)(S=this._xregexp.captureNames[j-1])&&(U[S]=U[j]);!z&&this.global&&!U[0].length&&this.lastIndex>U.index&&this.lastIndex--}return U},z||(RegExp.prototype.test=function(x){var S=G.exec.call(this,x);return S&&this.global&&!S[0].length&&this.lastIndex>S.index&&this.lastIndex--,!!S}))})),ace.define("ace/lib/es5-shim",["require","exports","module"],(function(x,S,w){function i(){}Function.prototype.bind||(Function.prototype.bind=function(x){var S=this;if("function"!=typeof S)throw new TypeError("Function.prototype.bind called on incompatible "+S);var w=Y.call(arguments,1),r=function(){if(this instanceof r){var U=S.apply(this,w.concat(Y.call(arguments)));return Object(U)===U?U:this}return S.apply(x,w.concat(Y.call(arguments)))};return S.prototype&&(i.prototype=S.prototype,r.prototype=new i,i.prototype=null),r});var U,G,H,z,j,X=Function.prototype.call,K=Array.prototype,q=Object.prototype,Y=K.slice,Z=X.bind(q.toString),J=X.bind(q.hasOwnProperty);if((j=J(q,"__defineGetter__"))&&(U=X.bind(q.__defineGetter__),G=X.bind(q.__defineSetter__),H=X.bind(q.__lookupGetter__),z=X.bind(q.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(x){var S=new Array(x+2);return S[0]=S[1]=0,S}var x,S=[];if(S.splice.apply(S,e(20)),S.splice.apply(S,e(26)),x=S.length,S.splice(5,0,"XXX"),S.length,x+1==S.length)return!0}()){var Q=Array.prototype.splice;Array.prototype.splice=function(x,S){return arguments.length?Q.apply(this,[void 0===x?0:x,void 0===S?this.length-x:S].concat(Y.call(arguments,2))):[]}}else Array.prototype.splice=function(x,S){var w=this.length;x>0?x>w&&(x=w):null==x?x=0:x<0&&(x=Math.max(w+x,0)),x+S<w||(S=w-x);var U=this.slice(x,x+S),G=Y.call(arguments,2),H=G.length;if(x===w)H&&this.push.apply(this,G);else{var z=Math.min(S,w-x),j=x+z,X=j+H-z,K=w-j,q=w-z;if(X<j)for(var Z=0;Z<K;++Z)this[X+Z]=this[j+Z];else if(X>j)for(Z=K;Z--;)this[X+Z]=this[j+Z];if(H&&x===q)this.length=q,this.push.apply(this,G);else for(this.length=q+H,Z=0;Z<H;++Z)this[x+Z]=G[Z]}return U};Array.isArray||(Array.isArray=function(x){return"[object Array]"==Z(x)});var ee,te,ne=Object("a"),ie="a"!=ne[0]||!(0 in ne);function C(x){try{return Object.defineProperty(x,"sentinel",{}),"sentinel"in x}catch(x){}}if(Array.prototype.forEach||(Array.prototype.forEach=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=arguments[1],G=-1,H=w.length>>>0;if("[object Function]"!=Z(x))throw new TypeError;for(;++G<H;)G in w&&x.call(U,w[G],G,S)}),Array.prototype.map||(Array.prototype.map=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=w.length>>>0,G=Array(U),H=arguments[1];if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");for(var z=0;z<U;z++)z in w&&(G[z]=x.call(H,w[z],z,S));return G}),Array.prototype.filter||(Array.prototype.filter=function(x){var S,w=F(this),U=ie&&"[object String]"==Z(this)?this.split(""):w,G=U.length>>>0,H=[],z=arguments[1];if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");for(var j=0;j<G;j++)j in U&&(S=U[j],x.call(z,S,j,w)&&H.push(S));return H}),Array.prototype.every||(Array.prototype.every=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=w.length>>>0,G=arguments[1];if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");for(var H=0;H<U;H++)if(H in w&&!x.call(G,w[H],H,S))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=w.length>>>0,G=arguments[1];if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");for(var H=0;H<U;H++)if(H in w&&x.call(G,w[H],H,S))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=w.length>>>0;if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");if(!U&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var G,H=0;if(arguments.length>=2)G=arguments[1];else for(;;){if(H in w){G=w[H++];break}if(++H>=U)throw new TypeError("reduce of empty array with no initial value")}for(;H<U;H++)H in w&&(G=x.call(void 0,G,w[H],H,S));return G}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(x){var S=F(this),w=ie&&"[object String]"==Z(this)?this.split(""):S,U=w.length>>>0;if("[object Function]"!=Z(x))throw new TypeError(x+" is not a function");if(!U&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var G,H=U-1;if(arguments.length>=2)G=arguments[1];else for(;;){if(H in w){G=w[H--];break}if(--H<0)throw new TypeError("reduceRight of empty array with no initial value")}do{H in this&&(G=x.call(void 0,G,w[H],H,S))}while(H--);return G}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(x){var S=ie&&"[object String]"==Z(this)?this.split(""):F(this),w=S.length>>>0;if(!w)return-1;var U=0;for(arguments.length>1&&(U=O(arguments[1])),U=U>=0?U:Math.max(0,w+U);U<w;U++)if(U in S&&S[U]===x)return U;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(x){var S=ie&&"[object String]"==Z(this)?this.split(""):F(this),w=S.length>>>0;if(!w)return-1;var U=w-1;for(arguments.length>1&&(U=Math.min(U,O(arguments[1]))),U=U>=0?U:w-Math.abs(U);U>=0;U--)if(U in S&&x===S[U])return U;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(x){return x.__proto__||(x.constructor?x.constructor.prototype:q)}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(x,S){if("object"!=typeof x&&"function"!=typeof x||null===x)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+x);if(J(x,S)){var w;if(w={enumerable:!0,configurable:!0},j){var U=x.__proto__;x.__proto__=q;var G=H(x,S),X=z(x,S);if(x.__proto__=U,G||X)return G&&(w.get=G),X&&(w.set=X),w}return w.value=x[S],w}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(x){return Object.keys(x)}),Object.create||(ee=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var x={};for(var S in x)x[S]=null;return x.constructor=x.hasOwnProperty=x.propertyIsEnumerable=x.isPrototypeOf=x.toLocaleString=x.toString=x.valueOf=x.__proto__=null,x},Object.create=function(x,S){var w;if(null===x)w=ee();else{if("object"!=typeof x)throw new TypeError("typeof prototype["+typeof x+"] != 'object'");var i=function(){};i.prototype=x,(w=new i).__proto__=x}return void 0!==S&&Object.defineProperties(w,S),w}),Object.defineProperty){var re=C({}),oe="undefined"==typeof document||C(document.createElement("div"));if(!re||!oe)var ae=Object.defineProperty}Object.defineProperty&&!ae||(Object.defineProperty=function(x,S,w){if("object"!=typeof x&&"function"!=typeof x||null===x)throw new TypeError("Object.defineProperty called on non-object: "+x);if("object"!=typeof w&&"function"!=typeof w||null===w)throw new TypeError("Property description must be an object: "+w);if(ae)try{return ae.call(Object,x,S,w)}catch(x){}if(J(w,"value"))if(j&&(H(x,S)||z(x,S))){var X=x.__proto__;x.__proto__=q,delete x[S],x[S]=w.value,x.__proto__=X}else x[S]=w.value;else{if(!j)throw new TypeError("getters & setters can not be defined on this javascript engine");J(w,"get")&&U(x,S,w.get),J(w,"set")&&G(x,S,w.set)}return x}),Object.defineProperties||(Object.defineProperties=function(x,S){for(var w in S)J(S,w)&&Object.defineProperty(x,w,S[w]);return x}),Object.seal||(Object.seal=function(x){return x}),Object.freeze||(Object.freeze=function(x){return x});try{Object.freeze((function(){}))}catch(x){Object.freeze=(te=Object.freeze,function(x){return"function"==typeof x?x:te(x)})}if(Object.preventExtensions||(Object.preventExtensions=function(x){return x}),Object.isSealed||(Object.isSealed=function(x){return!1}),Object.isFrozen||(Object.isFrozen=function(x){return!1}),Object.isExtensible||(Object.isExtensible=function(x){if(Object(x)===x)throw new TypeError;for(var S="";J(x,S);)S+="?";x[S]=!0;var w=J(x,S);return delete x[S],w}),!Object.keys){var se=!0,le=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ce=le.length;for(var ue in{toString:null})se=!1;Object.keys=function(x){if("object"!=typeof x&&"function"!=typeof x||null===x)throw new TypeError("Object.keys called on a non-object");var S=[];for(var w in x)J(x,w)&&S.push(w);if(se)for(var U=0,G=ce;U<G;U++){var H=le[U];J(x,H)&&S.push(H)}return S}}Date.now||(Date.now=function(){return(new Date).getTime()});var he="\t\n\v\f\r                　\u2028\u2029\ufeff";if(!String.prototype.trim){he="["+he+"]";var de=new RegExp("^"+he+he+"*"),pe=new RegExp(he+he+"*$");String.prototype.trim=function(){return String(this).replace(de,"").replace(pe,"")}}function O(x){return(x=+x)!=x?x=0:0!==x&&x!==1/0&&x!==-1/0&&(x=(x>0||-1)*Math.floor(Math.abs(x))),x}var F=function(x){if(null==x)throw new TypeError("can't convert "+x+" to object");return Object(x)}})),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],(function(x,S,w){"use strict";x("./regexp"),x("./es5-shim"),"undefined"==typeof Element||Element.prototype.remove||Object.defineProperty(Element.prototype,"remove",{enumerable:!1,writable:!0,configurable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),ace.define("ace/lib/useragent",["require","exports","module"],(function(x,S,w){"use strict";S.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},S.getOS=function(){return S.isMac?S.OS.MAC:S.isLinux?S.OS.LINUX:S.OS.WINDOWS};var U="object"==typeof navigator?navigator:{},G=(/mac|win|linux/i.exec(U.platform)||["other"])[0].toLowerCase(),H=U.userAgent||"",z=U.appName||"";S.isWin="win"==G,S.isMac="mac"==G,S.isLinux="linux"==G,S.isIE="Microsoft Internet Explorer"==z||z.indexOf("MSAppHost")>=0?parseFloat((H.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((H.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),S.isOldIE=S.isIE&&S.isIE<9,S.isGecko=S.isMozilla=H.match(/ Gecko\/\d+/),S.isOpera="object"==typeof opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),S.isWebKit=parseFloat(H.split("WebKit/")[1])||void 0,S.isChrome=parseFloat(H.split(" Chrome/")[1])||void 0,S.isEdge=parseFloat(H.split(" Edge/")[1])||void 0,S.isAIR=H.indexOf("AdobeAIR")>=0,S.isAndroid=H.indexOf("Android")>=0,S.isChromeOS=H.indexOf(" CrOS ")>=0,S.isIOS=/iPad|iPhone|iPod/.test(H)&&!window.MSStream,S.isIOS&&(S.isMac=!0),S.isMobile=S.isIOS||S.isAndroid})),ace.define("ace/lib/dom",["require","exports","module","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("./useragent");if(S.buildDom=function e(x,S,w){if("string"==typeof x&&x){var U=document.createTextNode(x);return S&&S.appendChild(U),U}if(!Array.isArray(x))return x;if("string"!=typeof x[0]||!x[0]){for(var G=[],H=0;H<x.length;H++){var z=e(x[H],S,w);z&&G.push(z)}return G}var j=document.createElement(x[0]),X=x[1],K=1;for(X&&"object"==typeof X&&!Array.isArray(X)&&(K=2),H=K;H<x.length;H++)e(x[H],j,w);return 2==K&&Object.keys(X).forEach((function(x){var S=X[x];"class"===x?j.className=Array.isArray(S)?S.join(" "):S:"function"==typeof S||"value"==x?j[x]=S:"ref"===x?w&&(w[S]=j):null!=S&&j.setAttribute(x,S)})),S&&S.appendChild(j),j},S.getDocumentHead=function(x){return x||(x=document),x.head||x.getElementsByTagName("head")[0]||x.documentElement},S.createElement=function(x,S){return document.createElementNS?document.createElementNS(S||"http://www.w3.org/1999/xhtml",x):document.createElement(x)},S.removeChildren=function(x){x.innerHTML=""},S.createTextNode=function(x,S){return(S?S.ownerDocument:document).createTextNode(x)},S.createFragment=function(x){return(x?x.ownerDocument:document).createDocumentFragment()},S.hasCssClass=function(x,S){return-1!==(x.className+"").split(/\s+/g).indexOf(S)},S.addCssClass=function(x,w){S.hasCssClass(x,w)||(x.className+=" "+w)},S.removeCssClass=function(x,S){for(var w=x.className.split(/\s+/g);;){var U=w.indexOf(S);if(-1==U)break;w.splice(U,1)}x.className=w.join(" ")},S.toggleCssClass=function(x,S){for(var w=x.className.split(/\s+/g),U=!0;;){var G=w.indexOf(S);if(-1==G)break;U=!1,w.splice(G,1)}return U&&w.push(S),x.className=w.join(" "),U},S.setCssClass=function(x,w,U){U?S.addCssClass(x,w):S.removeCssClass(x,w)},S.hasCssString=function(x,S){var w,U=0;if(w=(S=S||document).querySelectorAll("style"))for(;U<w.length;)if(w[U++].id===x)return!0},S.importCssString=function(x,w,U){var G=U;U&&U.getRootNode&&(G=U.getRootNode())&&G!=U||(G=document);var H=G.ownerDocument||G;if(w&&S.hasCssString(w,G))return null;w&&(x+="\n/*# sourceURL=ace/css/"+w+" */");var z=S.createElement("style");z.appendChild(H.createTextNode(x)),w&&(z.id=w),G==H&&(G=S.getDocumentHead(H)),G.insertBefore(z,G.firstChild)},S.importCssStylsheet=function(x,w){S.buildDom(["link",{rel:"stylesheet",href:x}],S.getDocumentHead(w))},S.scrollbarWidth=function(x){var w=S.createElement("ace_inner");w.style.width="100%",w.style.minWidth="0px",w.style.height="200px",w.style.display="block";var U=S.createElement("ace_outer"),G=U.style;G.position="absolute",G.left="-10000px",G.overflow="hidden",G.width="200px",G.minWidth="0px",G.height="150px",G.display="block",U.appendChild(w);var H=x.documentElement;H.appendChild(U);var z=w.offsetWidth;G.overflow="scroll";var j=w.offsetWidth;return z==j&&(j=U.clientWidth),H.removeChild(U),z-j},"undefined"==typeof document&&(S.importCssString=function(){}),S.computedStyle=function(x,S){return window.getComputedStyle(x,"")||{}},S.setStyle=function(x,S,w){x[S]!==w&&(x[S]=w)},S.HAS_CSS_ANIMATION=!1,S.HAS_CSS_TRANSFORMS=!1,S.HI_DPI=!U.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,"undefined"!=typeof document){var G=document.createElement("div");S.HI_DPI&&void 0!==G.style.transform&&(S.HAS_CSS_TRANSFORMS=!0),U.isEdge||void 0===G.style.animationName||(S.HAS_CSS_ANIMATION=!0),G=null}S.HAS_CSS_TRANSFORMS?S.translate=function(x,S,w){x.style.transform="translate("+Math.round(S)+"px, "+Math.round(w)+"px)"}:S.translate=function(x,S,w){x.style.top=Math.round(w)+"px",x.style.left=Math.round(S)+"px"}})),ace.define("ace/lib/oop",["require","exports","module"],(function(x,S,w){"use strict";S.inherits=function(x,S){x.super_=S,x.prototype=Object.create(S.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}})},S.mixin=function(x,S){for(var w in S)x[w]=S[w];return x},S.implement=function(x,w){S.mixin(x,w)}})),ace.define("ace/lib/keys",["require","exports","module","ace/lib/oop"],(function(x,S,w){"use strict";var U=x("./oop"),G=function(){var x,S,w={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta",91:"MetaLeft",92:"MetaRight",93:"ContextMenu"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(S in w.FUNCTION_KEYS)x=w.FUNCTION_KEYS[S].toLowerCase(),w[x]=parseInt(S,10);for(S in w.PRINTABLE_KEYS)x=w.PRINTABLE_KEYS[S].toLowerCase(),w[x]=parseInt(S,10);return U.mixin(w,w.MODIFIER_KEYS),U.mixin(w,w.PRINTABLE_KEYS),U.mixin(w,w.FUNCTION_KEYS),w.enter=w.return,w.escape=w.esc,w.del=w.delete,w[173]="-",function(){for(var x=["cmd","ctrl","alt","shift"],S=Math.pow(2,x.length);S--;)w.KEY_MODS[S]=x.filter((function(x){return S&w.KEY_MODS[x]})).join("-")+"-"}(),w.KEY_MODS[0]="",w.KEY_MODS[-1]="input-",w}();U.mixin(S,G),S.keyCodeToString=function(x){var S=G[x];return"string"!=typeof S&&(S=String.fromCharCode(x)),S.toLowerCase()}})),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("./keys"),G=x("./useragent"),H=null,z=0;S.addListener=function(x,S,w){if(x.addEventListener)return x.addEventListener(S,w,!1);if(x.attachEvent){var i=function(){w.call(x,window.event)};w._wrapper=i,x.attachEvent("on"+S,i)}},S.removeListener=function(x,S,w){if(x.removeEventListener)return x.removeEventListener(S,w,!1);x.detachEvent&&x.detachEvent("on"+S,w._wrapper||w)},S.stopEvent=function(x){return S.stopPropagation(x),S.preventDefault(x),!1},S.stopPropagation=function(x){x.stopPropagation?x.stopPropagation():x.cancelBubble=!0},S.preventDefault=function(x){x.preventDefault?x.preventDefault():x.returnValue=!1},S.getButton=function(x){return"dblclick"==x.type?0:"contextmenu"==x.type||G.isMac&&x.ctrlKey&&!x.altKey&&!x.shiftKey?2:x.preventDefault?x.button:{1:0,2:2,4:1}[x.button]},S.capture=function(x,w,U){function r(x){w&&w(x),U&&U(x),S.removeListener(document,"mousemove",w,!0),S.removeListener(document,"mouseup",r,!0),S.removeListener(document,"dragstart",r,!0)}return S.addListener(document,"mousemove",w,!0),S.addListener(document,"mouseup",r,!0),S.addListener(document,"dragstart",r,!0),r},S.addMouseWheelListener=function(x,w){"onmousewheel"in x?S.addListener(x,"mousewheel",(function(x){void 0!==x.wheelDeltaX?(x.wheelX=-x.wheelDeltaX/8,x.wheelY=-x.wheelDeltaY/8):(x.wheelX=0,x.wheelY=-x.wheelDelta/8),w(x)})):"onwheel"in x?S.addListener(x,"wheel",(function(x){switch(x.deltaMode){case x.DOM_DELTA_PIXEL:x.wheelX=.35*x.deltaX||0,x.wheelY=.35*x.deltaY||0;break;case x.DOM_DELTA_LINE:case x.DOM_DELTA_PAGE:x.wheelX=5*(x.deltaX||0),x.wheelY=5*(x.deltaY||0)}w(x)})):S.addListener(x,"DOMMouseScroll",(function(x){x.axis&&x.axis==x.HORIZONTAL_AXIS?(x.wheelX=5*(x.detail||0),x.wheelY=0):(x.wheelX=0,x.wheelY=5*(x.detail||0)),w(x)}))},S.addMultiMouseDownListener=function(x,w,U,H){var z,j,X,K=0,q={2:"dblclick",3:"tripleclick",4:"quadclick"};function h(x){if(0!==S.getButton(x)?K=0:x.detail>1?++K>4&&(K=1):K=1,G.isIE){var Y=Math.abs(x.clientX-z)>5||Math.abs(x.clientY-j)>5;X&&!Y||(K=1),X&&clearTimeout(X),X=setTimeout((function(){X=null}),w[K-1]||600),1==K&&(z=x.clientX,j=x.clientY)}if(x._clicks=K,U[H]("mousedown",x),K>4)K=0;else if(K>1)return U[H](q[K],x)}function d(x){K=2,X&&clearTimeout(X),X=setTimeout((function(){X=null}),w[K-1]||600),U[H]("mousedown",x),U[H](q[K],x)}Array.isArray(x)||(x=[x]),x.forEach((function(x){S.addListener(x,"mousedown",h),G.isOldIE&&S.addListener(x,"dblclick",d)}))};var j=G.isMac&&G.isOpera&&!("KeyboardEvent"in window)?function(x){return 0|(x.metaKey?1:0)|(x.altKey?2:0)|(x.shiftKey?4:0)|(x.ctrlKey?8:0)}:function(x){return 0|(x.ctrlKey?1:0)|(x.altKey?2:0)|(x.shiftKey?4:0)|(x.metaKey?8:0)};function c(x,S,w){var X=j(S);if(!G.isMac&&H){if(S.getModifierState&&(S.getModifierState("OS")||S.getModifierState("Win"))&&(X|=8),H.altGr){if(3==(3&X))return;H.altGr=0}if(18===w||17===w){var K="location"in S?S.location:S.keyLocation;17===w&&1===K?1==H[w]&&(z=S.timeStamp):18===w&&3===X&&2===K&&S.timeStamp-z<50&&(H.altGr=!0)}}if(w in U.MODIFIER_KEYS&&(w=-1),X||13!==w||3!==(K="location"in S?S.location:S.keyLocation)||(x(S,X,-w),!S.defaultPrevented)){if(G.isChromeOS&&8&X){if(x(S,X,w),S.defaultPrevented)return;X&=-9}return!!(X||w in U.FUNCTION_KEYS||w in U.PRINTABLE_KEYS)&&x(S,X,w)}}function l(){H=Object.create(null)}if(S.getModifierString=function(x){return U.KEY_MODS[j(x)]},S.addCommandKeyListener=function(x,w){var U=S.addListener;if(G.isOldGecko||G.isOpera&&!("KeyboardEvent"in window)){var z=null;U(x,"keydown",(function(x){z=x.keyCode})),U(x,"keypress",(function(x){return c(w,x,z)}))}else{var j=null;U(x,"keydown",(function(x){H[x.keyCode]=(H[x.keyCode]||0)+1;var S=c(w,x,x.keyCode);return j=x.defaultPrevented,S})),U(x,"keypress",(function(x){j&&(x.ctrlKey||x.altKey||x.shiftKey||x.metaKey)&&(S.stopEvent(x),j=null)})),U(x,"keyup",(function(x){H[x.keyCode]=null})),H||(l(),U(window,"focus",l))}},"object"==typeof window&&window.postMessage&&!G.isOldIE){var X=1;S.nextTick=function(x,w){w=w||window;var U="zero-timeout-message-"+X++,r=function(G){G.data==U&&(S.stopPropagation(G),S.removeListener(w,"message",r),x())};S.addListener(w,"message",r),w.postMessage(U,"*")}}S.$idleBlocked=!1,S.onIdle=function(x,w){return setTimeout((function n(){S.$idleBlocked?setTimeout(n,100):x()}),w)},S.$idleBlockId=null,S.blockIdle=function(x){S.$idleBlockId&&clearTimeout(S.$idleBlockId),S.$idleBlocked=!0,S.$idleBlockId=setTimeout((function(){S.$idleBlocked=!1}),x||100)},S.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),S.nextFrame?S.nextFrame=S.nextFrame.bind(window):S.nextFrame=function(x){setTimeout(x,17)}})),ace.define("ace/range",["require","exports","module"],(function(x,S,w){"use strict";var i=function(x,S,w,U){this.start={row:x,column:S},this.end={row:w,column:U}};(function(){this.isEqual=function(x){return this.start.row===x.start.row&&this.end.row===x.end.row&&this.start.column===x.start.column&&this.end.column===x.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(x,S){return 0==this.compare(x,S)},this.compareRange=function(x){var S,w=x.end,U=x.start;return 1==(S=this.compare(w.row,w.column))?1==(S=this.compare(U.row,U.column))?2:0==S?1:0:-1==S?-2:-1==(S=this.compare(U.row,U.column))?-1:1==S?42:0},this.comparePoint=function(x){return this.compare(x.row,x.column)},this.containsRange=function(x){return 0==this.comparePoint(x.start)&&0==this.comparePoint(x.end)},this.intersects=function(x){var S=this.compareRange(x);return-1==S||0==S||1==S},this.isEnd=function(x,S){return this.end.row==x&&this.end.column==S},this.isStart=function(x,S){return this.start.row==x&&this.start.column==S},this.setStart=function(x,S){"object"==typeof x?(this.start.column=x.column,this.start.row=x.row):(this.start.row=x,this.start.column=S)},this.setEnd=function(x,S){"object"==typeof x?(this.end.column=x.column,this.end.row=x.row):(this.end.row=x,this.end.column=S)},this.inside=function(x,S){return 0==this.compare(x,S)&&!this.isEnd(x,S)&&!this.isStart(x,S)},this.insideStart=function(x,S){return 0==this.compare(x,S)&&!this.isEnd(x,S)},this.insideEnd=function(x,S){return 0==this.compare(x,S)&&!this.isStart(x,S)},this.compare=function(x,S){return this.isMultiLine()||x!==this.start.row?x<this.start.row?-1:x>this.end.row?1:this.start.row===x?S>=this.start.column?0:-1:this.end.row===x?S<=this.end.column?0:1:0:S<this.start.column?-1:S>this.end.column?1:0},this.compareStart=function(x,S){return this.start.row==x&&this.start.column==S?-1:this.compare(x,S)},this.compareEnd=function(x,S){return this.end.row==x&&this.end.column==S?1:this.compare(x,S)},this.compareInside=function(x,S){return this.end.row==x&&this.end.column==S?1:this.start.row==x&&this.start.column==S?-1:this.compare(x,S)},this.clipRows=function(x,S){if(this.end.row>S)var w={row:S+1,column:0};else this.end.row<x&&(w={row:x,column:0});if(this.start.row>S)var U={row:S+1,column:0};else this.start.row<x&&(U={row:x,column:0});return i.fromPoints(U||this.start,w||this.end)},this.extend=function(x,S){var w=this.compare(x,S);if(0==w)return this;if(-1==w)var U={row:x,column:S};else var G={row:x,column:S};return i.fromPoints(U||this.start,G||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return i.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},this.toScreenRange=function(x){var S=x.documentToScreenPosition(this.start),w=x.documentToScreenPosition(this.end);return new i(S.row,S.column,w.row,w.column)},this.moveBy=function(x,S){this.start.row+=x,this.start.column+=S,this.end.row+=x,this.end.column+=S}}).call(i.prototype),i.fromPoints=function(x,S){return new i(x.row,x.column,S.row,S.column)},i.comparePoints=function(x,S){return x.row-S.row||x.column-S.column},i.comparePoints=function(x,S){return x.row-S.row||x.column-S.column},S.Range=i})),ace.define("ace/lib/lang",["require","exports","module"],(function(x,S,w){"use strict";S.last=function(x){return x[x.length-1]},S.stringReverse=function(x){return x.split("").reverse().join("")},S.stringRepeat=function(x,S){for(var w="";S>0;)1&S&&(w+=x),(S>>=1)&&(x+=x);return w};var U=/^\s\s*/,G=/\s\s*$/;S.stringTrimLeft=function(x){return x.replace(U,"")},S.stringTrimRight=function(x){return x.replace(G,"")},S.copyObject=function(x){var S={};for(var w in x)S[w]=x[w];return S},S.copyArray=function(x){for(var S=[],w=0,U=x.length;w<U;w++)x[w]&&"object"==typeof x[w]?S[w]=this.copyObject(x[w]):S[w]=x[w];return S},S.deepCopy=function e(x){if("object"!=typeof x||!x)return x;var S;if(Array.isArray(x)){S=[];for(var w=0;w<x.length;w++)S[w]=e(x[w]);return S}if("[object Object]"!==Object.prototype.toString.call(x))return x;for(var w in S={},x)S[w]=e(x[w]);return S},S.arrayToMap=function(x){for(var S={},w=0;w<x.length;w++)S[x[w]]=1;return S},S.createMap=function(x){var S=Object.create(null);for(var w in x)S[w]=x[w];return S},S.arrayRemove=function(x,S){for(var w=0;w<=x.length;w++)S===x[w]&&x.splice(w,1)},S.escapeRegExp=function(x){return x.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},S.escapeHTML=function(x){return(""+x).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},S.getMatchOffsets=function(x,S){var w=[];return x.replace(S,(function(x){w.push({offset:arguments[arguments.length-2],length:x.length})})),w},S.deferredCall=function(x){var S=null,n=function(){S=null,x()},i=function(x){return i.cancel(),S=setTimeout(n,x||0),i};return i.schedule=i,i.call=function(){return this.cancel(),x(),i},i.cancel=function(){return clearTimeout(S),S=null,i},i.isPending=function(){return S},i},S.delayedCall=function(x,S){var w=null,i=function(){w=null,x()},r=function(x){null==w&&(w=setTimeout(i,x||S))};return r.delay=function(x){w&&clearTimeout(w),w=setTimeout(i,x||S)},r.schedule=r,r.call=function(){this.cancel(),x()},r.cancel=function(){w&&clearTimeout(w),w=null},r.isPending=function(){return w},r}})),ace.define("ace/clipboard",["require","exports","module"],(function(x,S,w){"use strict";var U;w.exports={lineMode:!1,pasteCancelled:function(){return!!(U&&U>Date.now()-50)||(U=!1)},cancel:function(){U=Date.now()}}})),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/clipboard","ace/lib/keys"],(function(x,S,w){"use strict";var U=x("../lib/event"),G=x("../lib/useragent"),H=x("../lib/dom"),z=x("../lib/lang"),j=x("../clipboard"),X=G.isChrome<18,K=G.isIE,q=G.isChrome>63,Y=x("../lib/keys"),Z=Y.KEY_MODS,J=G.isIOS,Q=J?/\s/:/\n/;S.TextInput=function(x,S){var w=H.createElement("textarea");w.className="ace_text-input",w.setAttribute("wrap","off"),w.setAttribute("autocorrect","off"),w.setAttribute("autocapitalize","off"),w.setAttribute("spellcheck",!1),w.style.opacity="0",x.insertBefore(w,x.firstChild);var ee=!1,te=!1,ne=!1,ie=!1,re="";G.isMobile||(w.style.fontSize="1px");var oe=!1,ae=!1,se="",le=0,ce=0,ue=0;try{var he=document.activeElement===w}catch(x){}U.addListener(w,"blur",(function(x){ae||(S.onBlur(x),he=!1)})),U.addListener(w,"focus",(function(x){if(!ae){if(he=!0,G.isEdge)try{if(!document.hasFocus())return}catch(x){}S.onFocus(x),G.isEdge?setTimeout(de):de()}})),this.$focusScroll=!1,this.focus=function(){if(re||q||"browser"==this.$focusScroll)return w.focus({preventScroll:!0});var x=w.style.top;w.style.position="fixed",w.style.top="0px";try{var S=0!=w.getBoundingClientRect().top}catch(x){return}var U=[];if(S)for(var G=w.parentElement;G&&1==G.nodeType;)U.push(G),G.setAttribute("ace_nocontext",!0),G=!G.parentElement&&G.getRootNode?G.getRootNode().host:G.parentElement;w.focus({preventScroll:!0}),S&&U.forEach((function(x){x.removeAttribute("ace_nocontext")})),setTimeout((function(){w.style.position="","0px"==w.style.top&&(w.style.top=x)}),0)},this.blur=function(){w.blur()},this.isFocused=function(){return he},S.on("beforeEndOperation",(function(){S.curOp&&"insertstring"==S.curOp.command.name||(ne&&(se=w.value="",k()),de())}));var de=J?function(x){if(he&&(!ee||x)&&!ie){x||(x="");var U="\n ab"+x+"cde fg\n";U!=w.value&&(w.value=se=U);var G=4+(x.length||(S.selection.isEmpty()?0:1));4==le&&ce==G||w.setSelectionRange(4,G),le=4,ce=G}}:function(){if(!ne&&!ie&&(he||me)){ne=!0;var x=S.selection,U=x.getRange(),G=x.cursor.row,H=U.start.column,z=U.end.column,j=S.session.getLine(G);if(U.start.row!=G){var X=S.session.getLine(G-1);H=U.start.row<G-1?0:H,z+=X.length+1,j=X+"\n"+j}else if(U.end.row!=G){var K=S.session.getLine(G+1);z=U.end.row>G+1?K.length:z,z+=j.length+1,j=j+"\n"+K}j.length>400&&(H<400&&z<400?j=j.slice(0,400):(j="\n",H=0,z=1));var q=j+"\n\n";if(q!=se&&(w.value=se=q,le=ce=q.length),me&&(le=w.selectionStart,ce=w.selectionEnd),ce!=z||le!=H||w.selectionEnd!=ce)try{w.setSelectionRange(H,z),le=H,ce=z}catch(x){}ne=!1}};he&&S.onFocus();var pe=null;this.setInputHandler=function(x){pe=x},this.getInputHandler=function(){return pe};var me=!1,I=function(x,U){if(me&&(me=!1),te)return de(),x&&S.onPaste(x),te=!1,"";for(var G=w.selectionStart,H=w.selectionEnd,z=le,j=se.length-ce,X=x,K=x.length-G,q=x.length-H,Y=0;z>0&&se[Y]==x[Y];)Y++,z--;for(X=X.slice(Y),Y=1;j>0&&se.length-Y>le-1&&se[se.length-Y]==x[x.length-Y];)Y++,j--;K-=Y-1,q-=Y-1;var Z=X.length-Y+1;return Z<0&&(z=-Z,Z=0),X=X.slice(0,Z),U||X||K||z||j||q?(ie=!0,X&&!z&&!j&&!K&&!q||oe?S.onTextInput(X):S.onTextInput(X,{extendLeft:z,extendRight:j,restoreStart:K,restoreEnd:q}),ie=!1,se=x,le=G,ce=H,ue=q,X):""},O=function(x){if(ne)return $();if(x&&x.inputType){if("historyUndo"==x.inputType)return S.execCommand("undo");if("historyRedo"==x.inputType)return S.execCommand("redo")}var U=w.value,G=I(U,!0);(U.length>500||Q.test(G))&&de()},F=function(x,S,w){var U=x.clipboardData||window.clipboardData;if(U&&!X){var G=K||w?"Text":"text/plain";try{return S?!1!==U.setData(G,S):U.getData(G)}catch(x){if(!w)return F(x,S,!0)}}},M=function(x,G){var H=S.getCopyText();if(!H)return U.preventDefault(x);F(x,H)?(J&&(de(H),ee=H,setTimeout((function(){ee=!1}),10)),G?S.onCut():S.onCopy(),U.preventDefault(x)):(ee=!0,w.value=H,w.select(),setTimeout((function(){ee=!1,de(),G?S.onCut():S.onCopy()})))},N=function(x){M(x,!0)},P=function(x){M(x,!1)},B=function(x){var H=F(x);j.pasteCancelled()||("string"==typeof H?(H&&S.onPaste(H,x),G.isIE&&setTimeout(de),U.preventDefault(x)):(w.value="",te=!0))};U.addCommandKeyListener(w,S.onCommandKey.bind(S)),U.addListener(w,"select",(function(x){ne||(ee?ee=!1:function(x){return 0===x.selectionStart&&x.selectionEnd>=se.length&&x.value===se&&se&&x.selectionEnd!==ce}(w)&&(S.selectAll(),de()))})),U.addListener(w,"input",O),U.addListener(w,"cut",N),U.addListener(w,"copy",P),U.addListener(w,"paste",B),"oncut"in w&&"oncopy"in w&&"onpaste"in w||U.addListener(x,"keydown",(function(x){if((!G.isMac||x.metaKey)&&x.ctrlKey)switch(x.keyCode){case 67:P(x);break;case 86:B(x);break;case 88:N(x)}}));var $=function(){if(ne&&S.onCompositionUpdate&&!S.$readOnly){if(oe)return D();if(ne.useTextareaForIME)S.onCompositionUpdate(w.value);else{var x=w.value;I(x),ne.markerRange&&(ne.context&&(ne.markerRange.start.column=ne.selectionStart=ne.context.compositionStartOffset),ne.markerRange.end.column=ne.markerRange.start.column+ce-ne.selectionStart+ue)}}},k=function(x){S.onCompositionEnd&&!S.$readOnly&&(ne=!1,S.onCompositionEnd(),S.off("mousedown",D),x&&O())};function D(){ae=!0,w.blur(),w.focus(),ae=!1}var fe,ge=z.delayedCall($,50).schedule.bind(null,null);function W(){clearTimeout(fe),fe=setTimeout((function(){re&&(w.style.cssText=re,re=""),S.renderer.$isMousePressed=!1,S.renderer.$keepTextAreaAtCursor&&S.renderer.$moveTextAreaToCursor()}),0)}U.addListener(w,"compositionstart",(function(x){if(!ne&&S.onCompositionStart&&!S.$readOnly&&(ne={},!oe)){setTimeout($,0),S.on("mousedown",D);var U=S.getSelectionRange();U.end.row=U.start.row,U.end.column=U.start.column,ne.markerRange=U,ne.selectionStart=le,S.onCompositionStart(ne),ne.useTextareaForIME?(w.value="",se="",le=0,ce=0):(w.msGetInputContext&&(ne.context=w.msGetInputContext()),w.getInputContext&&(ne.context=w.getInputContext()))}})),U.addListener(w,"compositionupdate",$),U.addListener(w,"keyup",(function(x){27==x.keyCode&&w.value.length<w.selectionStart&&(ne||(se=w.value),le=ce=-1,de()),ge()})),U.addListener(w,"keydown",ge),U.addListener(w,"compositionend",k),this.getElement=function(){return w},this.setCommandMode=function(x){oe=x,w.readOnly=!1},this.setReadOnly=function(x){oe||(w.readOnly=x)},this.setCopyWithEmptySelection=function(x){},this.onContextMenu=function(x){me=!0,de(),S._emit("nativecontextmenu",{target:S,domEvent:x}),this.moveToMouse(x,!0)},this.moveToMouse=function(x,z){re||(re=w.style.cssText),w.style.cssText=(z?"z-index:100000;":"")+(G.isIE?"opacity:0.1;":"")+"text-indent: -"+(le+ce)*S.renderer.characterWidth*.5+"px;";var j=S.container.getBoundingClientRect(),X=H.computedStyle(S.container),K=j.top+(parseInt(X.borderTopWidth)||0),q=j.left+(parseInt(j.borderLeftWidth)||0),Y=j.bottom-K-w.clientHeight-2,d=function(x){H.translate(w,x.clientX-q-2,Math.min(x.clientY-K-2,Y))};d(x),"mousedown"==x.type&&(S.renderer.$isMousePressed=!0,clearTimeout(fe),G.isWin&&U.capture(S.container,d,W))},this.onContextMenuClose=W;var V=function(x){S.textInput.onContextMenu(x),W()};U.addListener(w,"mouseup",V),U.addListener(w,"mousedown",(function(x){x.preventDefault(),W()})),U.addListener(S.renderer.scroller,"contextmenu",V),U.addListener(w,"contextmenu",V),J&&function(x,S,w){var U=null,G=!1;w.addEventListener("keydown",(function(x){U&&clearTimeout(U),G=!0}),!0),w.addEventListener("keyup",(function(x){U=setTimeout((function(){G=!1}),100)}),!0);var o=function(x){if(document.activeElement===w&&!(G||ne||S.$mouseHandler.isMousePressed||ee)){var U=w.selectionStart,H=w.selectionEnd,z=null,j=0;if(0==U?z=Y.up:1==U?z=Y.home:H>ce&&"\n"==se[H]?z=Y.end:U<le&&" "==se[U-1]?(z=Y.left,j=Z.option):U<le||U==le&&ce!=le&&U==H?z=Y.left:H>ce&&se.slice(0,H).split("\n").length>2?z=Y.down:H>ce&&" "==se[H-1]?(z=Y.right,j=Z.option):(H>ce||H==ce&&ce!=le&&U==H)&&(z=Y.right),U!==H&&(j|=Z.shift),z){if(!S.onCommandKey({},j,z)&&S.commands){z=Y.keyCodeToString(z);var X=S.commands.findKeyCommand(j,z);X&&S.execCommand(X)}le=U,ce=H,de("")}}};document.addEventListener("selectionchange",o),S.on("destroy",(function(){document.removeEventListener("selectionchange",o)}))}(0,S,w)}})),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("../lib/useragent");function r(x){x.$clickSelection=null;var S=x.editor;S.setDefaultHandler("mousedown",this.onMouseDown.bind(x)),S.setDefaultHandler("dblclick",this.onDoubleClick.bind(x)),S.setDefaultHandler("tripleclick",this.onTripleClick.bind(x)),S.setDefaultHandler("quadclick",this.onQuadClick.bind(x)),S.setDefaultHandler("mousewheel",this.onMouseWheel.bind(x)),["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(S){x[S]=this[S]}),this),x.selectByLines=this.extendSelectionBy.bind(x,"getLineRange"),x.selectByWords=this.extendSelectionBy.bind(x,"getWordRange")}function o(x,S){if(x.start.row==x.end.row)var w=2*S.column-x.start.column-x.end.column;else w=x.start.row!=x.end.row-1||x.start.column||x.end.column?2*S.row-x.start.row-x.end.row:S.column-4;return w<0?{cursor:x.start,anchor:x.end}:{cursor:x.end,anchor:x.start}}(function(){this.onMouseDown=function(x){var S=x.inSelection(),w=x.getDocumentPosition();this.mousedownEvent=x;var G=this.editor,H=x.getButton();return 0!==H?((G.getSelectionRange().isEmpty()||1==H)&&G.selection.moveToPosition(w),void(2==H&&(G.textInput.onContextMenu(x.domEvent),U.isMozilla||x.preventDefault()))):(this.mousedownEvent.time=Date.now(),!S||G.isFocused()||(G.focus(),!this.$focusTimeout||this.$clickSelection||G.inMultiSelectMode)?(this.captureMouse(x),this.startSelect(w,x.domEvent._clicks>1),x.preventDefault()):(this.setState("focusWait"),void this.captureMouse(x)))},this.startSelect=function(x,S){x=x||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var w=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?w.selection.selectToPosition(x):S||w.selection.moveToPosition(x),S||this.select(),w.renderer.scroller.setCapture&&w.renderer.scroller.setCapture(),w.setStyle("ace_selecting"),this.setState("select"))},this.select=function(){var x,S=this.editor,w=S.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var U=this.$clickSelection.comparePoint(w);if(-1==U)x=this.$clickSelection.end;else if(1==U)x=this.$clickSelection.start;else{var G=o(this.$clickSelection,w);w=G.cursor,x=G.anchor}S.selection.setSelectionAnchor(x.row,x.column)}S.selection.selectToPosition(w),S.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(x){var S,w=this.editor,U=w.renderer.screenToTextCoordinates(this.x,this.y),G=w.selection[x](U.row,U.column);if(this.$clickSelection){var H=this.$clickSelection.comparePoint(G.start),z=this.$clickSelection.comparePoint(G.end);if(-1==H&&z<=0)S=this.$clickSelection.end,G.end.row==U.row&&G.end.column==U.column||(U=G.start);else if(1==z&&H>=0)S=this.$clickSelection.start,G.start.row==U.row&&G.start.column==U.column||(U=G.end);else if(-1==H&&1==z)U=G.end,S=G.start;else{var j=o(this.$clickSelection,U);U=j.cursor,S=j.anchor}w.selection.setSelectionAnchor(S.row,S.column)}w.selection.selectToPosition(U),w.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var x,S,w,U,G=(x=this.mousedownEvent.x,S=this.mousedownEvent.y,w=this.x,U=this.y,Math.sqrt(Math.pow(w-x,2)+Math.pow(U-S,2))),H=Date.now();(G>0||H-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(x){var S=x.getDocumentPosition(),w=this.editor,U=w.session.getBracketRange(S);U?(U.isEmpty()&&(U.start.column--,U.end.column++),this.setState("select")):(U=w.selection.getWordRange(S.row,S.column),this.setState("selectByWords")),this.$clickSelection=U,this.select()},this.onTripleClick=function(x){var S=x.getDocumentPosition(),w=this.editor;this.setState("selectByLines");var U=w.getSelectionRange();U.isMultiLine()&&U.contains(S.row,S.column)?(this.$clickSelection=w.selection.getLineRange(U.start.row),this.$clickSelection.end=w.selection.getLineRange(U.end.row).end):this.$clickSelection=w.selection.getLineRange(S.row),this.select()},this.onQuadClick=function(x){var S=this.editor;S.selectAll(),this.$clickSelection=S.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(x){if(!x.getAccelKey()){x.getShiftKey()&&x.wheelY&&!x.wheelX&&(x.wheelX=x.wheelY,x.wheelY=0);var S=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var w=this.$lastScroll,U=x.domEvent.timeStamp,G=U-w.t,H=G?x.wheelX/G:w.vx,z=G?x.wheelY/G:w.vy;G<550&&(H=(H+w.vx)/2,z=(z+w.vy)/2);var j=Math.abs(H/z),X=!1;return j>=1&&S.renderer.isScrollableBy(x.wheelX*x.speed,0)&&(X=!0),j<=1&&S.renderer.isScrollableBy(0,x.wheelY*x.speed)&&(X=!0),X?w.allowed=U:U-w.allowed<550&&(Math.abs(H)<=1.5*Math.abs(w.vx)&&Math.abs(z)<=1.5*Math.abs(w.vy)?(X=!0,w.allowed=U):w.allowed=0),w.t=U,w.vx=H,w.vy=z,X?(S.renderer.scrollBy(x.wheelX*x.speed,x.wheelY*x.speed),x.stop()):void 0}}}).call(r.prototype),S.DefaultHandlers=r})),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],(function(x,S,w){"use strict";x("./lib/oop");var U=x("./lib/dom");function r(x){this.isOpen=!1,this.$element=null,this.$parentNode=x}(function(){this.$init=function(){return this.$element=U.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(x){this.getElement().textContent=x},this.setHtml=function(x){this.getElement().innerHTML=x},this.setPosition=function(x,S){this.getElement().style.left=x+"px",this.getElement().style.top=S+"px"},this.setClassName=function(x){U.addCssClass(this.getElement(),x)},this.show=function(x,S,w){null!=x&&this.setText(x),null!=S&&null!=w&&this.setPosition(S,w),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(r.prototype),S.Tooltip=r})),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],(function(x,S,w){"use strict";var U=x("../lib/dom"),G=x("../lib/oop"),H=x("../lib/event"),z=x("../tooltip").Tooltip;function a(x){z.call(this,x)}G.inherits(a,z),function(){this.setPosition=function(x,S){var w=window.innerWidth||document.documentElement.clientWidth,U=window.innerHeight||document.documentElement.clientHeight,G=this.getWidth(),H=this.getHeight();(x+=15)+G>w&&(x-=x+G-w),(S+=15)+H>U&&(S-=20+H),z.prototype.setPosition.call(this,x,S)}}.call(a.prototype),S.GutterHandler=function(x){var S,w,G,z=x.editor,j=z.renderer.$gutterLayer,X=new a(z.container);function u(){S&&(S=clearTimeout(S)),G&&(X.hide(),G=null,z._signal("hideGutterTooltip",X),z.removeEventListener("mousewheel",u))}function h(x){X.setPosition(x.x,x.y)}x.editor.setDefaultHandler("guttermousedown",(function(S){if(z.isFocused()&&0==S.getButton()&&"foldWidgets"!=j.getRegion(S)){var w=S.getDocumentPosition().row,U=z.session.selection;if(S.getShiftKey())U.selectTo(w,0);else{if(2==S.domEvent.detail)return z.selectAll(),S.preventDefault();x.$clickSelection=z.selection.getLineRange(w)}return x.setState("selectByLines"),x.captureMouse(S),S.preventDefault()}})),x.editor.setDefaultHandler("guttermousemove",(function(H){var K=H.domEvent.target||H.domEvent.srcElement;if(U.hasCssClass(K,"ace_fold-widget"))return u();G&&x.$tooltipFollowsMouse&&h(H),w=H,S||(S=setTimeout((function(){S=null,w&&!x.isMousePressed?function(){var S=w.getDocumentPosition().row,U=j.$annotations[S];if(!U)return u();if(S==z.session.getLength()){var H=z.renderer.pixelToScreenCoordinates(0,w.y).row,K=w.$pos;if(H>z.session.documentToScreenRow(K.row,K.column))return u()}if(G!=U)if(G=U.text.join("<br/>"),X.setHtml(G),X.show(),z._signal("showGutterTooltip",X),z.on("mousewheel",u),x.$tooltipFollowsMouse)h(w);else{var q=w.domEvent.target.getBoundingClientRect(),Y=X.getElement().style;Y.left=q.right+"px",Y.top=q.bottom+"px"}}():u()}),50))})),H.addListener(z.renderer.$gutter,"mouseout",(function(x){w=null,G&&!S&&(S=setTimeout((function(){S=null,u()}),50))})),z.on("changeSession",u)}})),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("../lib/event"),G=x("../lib/useragent"),H=S.MouseEvent=function(x,S){this.domEvent=x,this.editor=S,this.x=this.clientX=x.clientX,this.y=this.clientY=x.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){U.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){U.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var x=this.editor.getSelectionRange();if(x.isEmpty())this.$inSelection=!1;else{var S=this.getDocumentPosition();this.$inSelection=x.contains(S.row,S.column)}return this.$inSelection},this.getButton=function(){return U.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=G.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(H.prototype)})),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("../lib/dom"),G=x("../lib/event"),H=x("../lib/useragent");function s(x){var S=x.editor,w=U.createElement("img");w.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",H.isOpera&&(w.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;"),["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(S){x[S]=this[S]}),this),S.addEventListener("mousedown",this.onMouseDown.bind(x));var z,j,X,K,q,Y,Z,J,Q,ee,te,ne=S.container,ie=0;function C(){var x=Y;(function(x,w){var U=Date.now(),G=!w||x.row!=w.row,H=!w||x.column!=w.column;!ee||G||H?(S.moveCursorToPosition(x),ee=U,te={x:j,y:X}):a(te.x,te.y,j,X)>5?ee=null:U-ee>=200&&(S.renderer.scrollCursorIntoView(),ee=null)})(Y=S.renderer.screenToTextCoordinates(j,X),x),function(x,w){var U=Date.now(),G=S.renderer.layerConfig.lineHeight,H=S.renderer.layerConfig.characterWidth,z=S.renderer.scroller.getBoundingClientRect(),K={x:{left:j-z.left,right:z.right-j},y:{top:X-z.top,bottom:z.bottom-X}},q=Math.min(K.x.left,K.x.right),Y=Math.min(K.y.top,K.y.bottom),Z={row:x.row,column:x.column};q/H<=2&&(Z.column+=K.x.left<K.x.right?-3:2),Y/G<=1&&(Z.row+=K.y.top<K.y.bottom?-1:1);var J=x.row!=Z.row,ee=x.column!=Z.column,te=!w||x.row!=w.row;J||ee&&!te?Q?U-Q>=200&&S.renderer.scrollCursorIntoView(Z):Q=U:Q=null}(Y,x)}function A(){q=S.selection.toOrientedRange(),z=S.session.addMarker(q,"ace_selection",S.getSelectionStyle()),S.clearSelection(),S.isFocused()&&S.renderer.$cursorLayer.setBlinking(!1),clearInterval(K),C(),K=setInterval(C,20),ie=0,G.addListener(document,"mousemove",y)}function R(){clearInterval(K),S.session.removeMarker(z),z=null,S.selection.fromOrientedRange(q),S.isFocused()&&!J&&S.$resetCursorStyle(),q=null,Y=null,ie=0,Q=null,ee=null,G.removeListener(document,"mousemove",y)}this.onDragStart=function(x){if(this.cancelDrag||!ne.draggable){var U=this;return setTimeout((function(){U.startSelect(),U.captureMouse(x)}),0),x.preventDefault()}q=S.getSelectionRange();var G=x.dataTransfer;G.effectAllowed=S.getReadOnly()?"copy":"copyMove",H.isOpera&&(S.container.appendChild(w),w.scrollTop=0),G.setDragImage&&G.setDragImage(w,0,0),H.isOpera&&S.container.removeChild(w),G.clearData(),G.setData("Text",S.session.getTextRange()),J=!0,this.setState("drag")},this.onDragEnd=function(x){if(ne.draggable=!1,J=!1,this.setState(null),!S.getReadOnly()){var w=x.dataTransfer.dropEffect;Z||"move"!=w||S.session.remove(S.getSelectionRange()),S.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(x){if(!S.getReadOnly()&&T(x.dataTransfer))return j=x.clientX,X=x.clientY,z||A(),ie++,x.dataTransfer.dropEffect=Z=b(x),G.preventDefault(x)},this.onDragOver=function(x){if(!S.getReadOnly()&&T(x.dataTransfer))return j=x.clientX,X=x.clientY,z||(A(),ie++),null!==re&&(re=null),x.dataTransfer.dropEffect=Z=b(x),G.preventDefault(x)},this.onDragLeave=function(x){if(--ie<=0&&z)return R(),Z=null,G.preventDefault(x)},this.onDrop=function(x){if(Y){var w=x.dataTransfer;if(J)switch(Z){case"move":q=q.contains(Y.row,Y.column)?{start:Y,end:Y}:S.moveText(q,Y);break;case"copy":q=S.moveText(q,Y,!0)}else{var U=w.getData("Text");q={start:Y,end:S.session.insert(Y,U)},S.focus(),Z=null}return R(),G.preventDefault(x)}},G.addListener(ne,"dragstart",this.onDragStart.bind(x)),G.addListener(ne,"dragend",this.onDragEnd.bind(x)),G.addListener(ne,"dragenter",this.onDragEnter.bind(x)),G.addListener(ne,"dragover",this.onDragOver.bind(x)),G.addListener(ne,"dragleave",this.onDragLeave.bind(x)),G.addListener(ne,"drop",this.onDrop.bind(x));var re=null;function y(){null==re&&(re=setTimeout((function(){null!=re&&z&&R()}),20))}function T(x){var S=x.types;return!S||Array.prototype.some.call(S,(function(x){return"text/plain"==x||"Text"==x}))}function b(x){var S=["copy","copymove","all","uninitialized"],w=H.isMac?x.altKey:x.ctrlKey,U="uninitialized";try{U=x.dataTransfer.effectAllowed.toLowerCase()}catch(x){}var G="none";return w&&S.indexOf(U)>=0?G="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(U)>=0?G="move":S.indexOf(U)>=0&&(G="copy"),G}}function a(x,S,w,U){return Math.sqrt(Math.pow(w-x,2)+Math.pow(U-S,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(x){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var x=this.editor;x.container.draggable=!0,x.renderer.$cursorLayer.setBlinking(!1),x.setStyle("ace_dragging");var S=H.isWin?"default":"move";x.renderer.setCursorStyle(S),this.setState("dragReady")},this.onMouseDrag=function(x){var S=this.editor.container;H.isIE&&"dragReady"==this.state&&a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&S.dragDrop(),"dragWait"===this.state&&a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(S.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))},this.onMouseDown=function(x){if(this.$dragEnabled){this.mousedownEvent=x;var S=this.editor,w=x.inSelection(),U=x.getButton();if(1===(x.domEvent.detail||1)&&0===U&&w){if(x.editor.inMultiSelectMode&&(x.getAccelKey()||x.getShiftKey()))return;this.mousedownEvent.time=Date.now();var G=x.domEvent.target||x.domEvent.srcElement;"unselectable"in G&&(G.unselectable="on"),S.getDragDelay()?(H.isWebKit&&(this.cancelDrag=!0,S.container.draggable=!0),this.setState("dragWait")):this.startDrag(),this.captureMouse(x,this.onMouseDrag.bind(this)),x.defaultPrevented=!0}}}}).call(s.prototype),S.DragdropHandler=s})),ace.define("ace/mouse/touch_handler",["require","exports","module","ace/mouse/mouse_event","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("./mouse_event").MouseEvent,G=x("../lib/dom");S.addTouchListeners=function(x,S){var w,H,z,j,X,K,q,Y,Z,J="scroll",Q=0,ee=0,te=0,ne=0;function _(){var x=window.navigator&&window.navigator.clipboard,w=!1,i=function(U){var H,z,j=U.target.getAttribute("action");if("more"==j||!w)return w=!w,H=S.getCopyText(),z=S.session.getUndoManager().hasUndo(),void Z.replaceChild(G.buildDom(w?["span",!H&&["span",{class:"ace_mobile-button",action:"selectall"},"Select All"],H&&["span",{class:"ace_mobile-button",action:"copy"},"Copy"],H&&["span",{class:"ace_mobile-button",action:"cut"},"Cut"],x&&["span",{class:"ace_mobile-button",action:"paste"},"Paste"],z&&["span",{class:"ace_mobile-button",action:"undo"},"Undo"],["span",{class:"ace_mobile-button",action:"find"},"Find"],["span",{class:"ace_mobile-button",action:"openCommandPallete"},"Pallete"]]:["span"]),Z.firstChild);"paste"==j?x.readText().then((function(x){S.execCommand(j,x)})):j&&("cut"!=j&&"copy"!=j||(x?x.writeText(S.getCopyText()):document.execCommand("copy")),S.execCommand(j)),Z.firstChild.style.display="none",w=!1,"openCommandPallete"!=j&&S.focus()};Z=G.buildDom(["div",{class:"ace_mobile-menu",ontouchstart:function(x){J="menu",x.stopPropagation(),x.preventDefault(),S.textInput.focus()},ontouchend:function(x){x.stopPropagation(),x.preventDefault(),i(x)},onclick:i},["span"],["span",{class:"ace_mobile-button",action:"more"},"..."]],S.container)}function E(){Z||_();var x=S.selection.cursor,w=S.renderer.textToScreenCoordinates(x.row,x.column),U=S.container.getBoundingClientRect();Z.style.top=w.pageY-U.top-3+"px",Z.style.right="10px",Z.style.display="",Z.firstChild.style.display="none",S.on("input",C)}function C(x){Z&&(Z.style.display="none"),S.off("input",C)}function A(){X=null,clearTimeout(X);var x=S.selection.getRange(),w=x.contains(q.row,q.column);!x.isEmpty()&&w||(S.selection.moveToPosition(q),S.selection.selectWord()),J="wait",E()}x.addEventListener("contextmenu",(function(x){Y&&S.textInput.getElement().focus()})),x.addEventListener("touchstart",(function(x){var G=x.touches;if(X||G.length>1)return clearTimeout(X),X=null,z=-1,void(J="zoom");Y=S.$mouseHandler.isMousePressed=!0;var K=S.renderer.layerConfig.lineHeight,Z=S.renderer.layerConfig.lineHeight,ie=x.timeStamp;j=ie;var re=G[0],oe=re.clientX,ae=re.clientY;Math.abs(w-oe)+Math.abs(H-ae)>K&&(z=-1),w=x.clientX=oe,H=x.clientY=ae,te=ne=0;var se=new U(x,S);if(q=se.getDocumentPosition(),ie-z<500&&1==G.length&&!Q)ee++,x.preventDefault(),x.button=0,function(){X=null,clearTimeout(X),S.selection.moveToPosition(q);var x=ee>=2?S.selection.getLineRange(q.row):S.session.getBracketRange(q);x&&!x.isEmpty()?S.selection.setRange(x):S.selection.selectWord(),J="wait"}();else{ee=0;var le=S.selection.cursor,ce=S.selection.isEmpty()?le:S.selection.anchor,ue=S.renderer.$cursorLayer.getPixelPosition(le,!0),he=S.renderer.$cursorLayer.getPixelPosition(ce,!0),de=S.renderer.scroller.getBoundingClientRect(),L=function(x,S){return(x/=Z)*x+(S=S/K-.75)*S};if(x.clientX<de.left)return void(J="zoom");var pe=L(x.clientX-de.left-ue.left,x.clientY-de.top-ue.top),me=L(x.clientX-de.left-he.left,x.clientY-de.top-he.top);pe<3.5&&me<3.5&&(J=pe>me?"cursor":"anchor"),J=me<3.5?"anchor":pe<3.5?"cursor":"scroll",X=setTimeout(A,450)}z=ie})),x.addEventListener("touchend",(function(x){Y=S.$mouseHandler.isMousePressed=!1,K&&clearInterval(K),"zoom"==J?(J="",Q=0):X?(S.selection.moveToPosition(q),Q=0,E()):"scroll"==J?(Q+=60,K=setInterval((function(){Q--<=0&&(clearInterval(K),K=null),Math.abs(te)<.01&&(te=0),Math.abs(ne)<.01&&(ne=0),Q<20&&(te*=.9),Q<20&&(ne*=.9);var x=S.session.getScrollTop();S.renderer.scrollBy(10*te,10*ne),x==S.session.getScrollTop()&&(Q=0)}),10),x.preventDefault(),C()):E(),clearTimeout(X),X=null})),x.addEventListener("touchmove",(function(x){X&&(clearTimeout(X),X=null);var G=x.touches;if(!(G.length>1||"zoom"==J)){var z=G[0],K=w-z.clientX,q=H-z.clientY;if("wait"==J){if(!(K*K+q*q>4))return x.preventDefault();J="cursor"}w=z.clientX,H=z.clientY,x.clientX=z.clientX,x.clientY=z.clientY;var Y=x.timeStamp,Z=Y-j;if(j=Y,"scroll"==J){var Q=new U(x,S);Q.speed=1,Q.wheelX=K,Q.wheelY=q,10*Math.abs(K)<Math.abs(q)&&(K=0),10*Math.abs(q)<Math.abs(K)&&(q=0),0!=Z&&(te=K/Z,ne=q/Z),S._emit("mousewheel",Q),Q.propagationStopped||(te=ne=0)}else{var ee=new U(x,S).getDocumentPosition();"cursor"==J?S.selection.moveCursorToPosition(ee):"anchor"==J&&S.selection.setSelectionAnchor(ee.row,ee.column),S.renderer.scrollCursorIntoView(ee),x.preventDefault()}}}))}})),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("./dom");S.get=function(x,S){var w=new XMLHttpRequest;w.open("GET",x,!0),w.onreadystatechange=function(){4===w.readyState&&S(w.responseText)},w.send(null)},S.loadScript=function(x,S){var w=U.getDocumentHead(),G=document.createElement("script");G.src=x,w.appendChild(G),G.onload=G.onreadystatechange=function(x,w){!w&&G.readyState&&"loaded"!=G.readyState&&"complete"!=G.readyState||(G=G.onload=G.onreadystatechange=null,w||S())}},S.qualifyURL=function(x){var S=document.createElement("a");return S.href=x,S.href}})),ace.define("ace/lib/event_emitter",["require","exports","module"],(function(x,S,w){"use strict";var U={},r=function(){this.propagationStopped=!0},o=function(){this.defaultPrevented=!0};U._emit=U._dispatchEvent=function(x,S){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var w=this._eventRegistry[x]||[],U=this._defaultHandlers[x];if(w.length||U){"object"==typeof S&&S||(S={}),S.type||(S.type=x),S.stopPropagation||(S.stopPropagation=r),S.preventDefault||(S.preventDefault=o),w=w.slice();for(var G=0;G<w.length&&(w[G](S,this),!S.propagationStopped);G++);return U&&!S.defaultPrevented?U(S,this):void 0}},U._signal=function(x,S){var w=(this._eventRegistry||{})[x];if(w){w=w.slice();for(var U=0;U<w.length;U++)w[U](S,this)}},U.once=function(x,S){var w=this;if(this.addEventListener(x,(function i(){w.removeEventListener(x,i),S.apply(null,arguments)})),!S)return new Promise((function(x){S=x}))},U.setDefaultHandler=function(x,S){var w=this._defaultHandlers;if(w||(w=this._defaultHandlers={_disabled_:{}}),w[x]){var U=w[x],G=w._disabled_[x];G||(w._disabled_[x]=G=[]),G.push(U);var H=G.indexOf(S);-1!=H&&G.splice(H,1)}w[x]=S},U.removeDefaultHandler=function(x,S){var w=this._defaultHandlers;if(w){var U=w._disabled_[x];if(w[x]==S)U&&this.setDefaultHandler(x,U.pop());else if(U){var G=U.indexOf(S);-1!=G&&U.splice(G,1)}}},U.on=U.addEventListener=function(x,S,w){this._eventRegistry=this._eventRegistry||{};var U=this._eventRegistry[x];return U||(U=this._eventRegistry[x]=[]),-1==U.indexOf(S)&&U[w?"unshift":"push"](S),S},U.off=U.removeListener=U.removeEventListener=function(x,S){this._eventRegistry=this._eventRegistry||{};var w=this._eventRegistry[x];if(w){var U=w.indexOf(S);-1!==U&&w.splice(U,1)}},U.removeAllListeners=function(x){this._eventRegistry&&(this._eventRegistry[x]=[])},S.EventEmitter=U})),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(x,S,w){var U=x("./oop"),G=x("./event_emitter").EventEmitter,H={setOptions:function(x){Object.keys(x).forEach((function(S){this.setOption(S,x[S])}),this)},getOptions:function(x){var S={};if(x)Array.isArray(x)||(S=x,x=Object.keys(S));else{var w=this.$options;x=Object.keys(w).filter((function(x){return!w[x].hidden}))}return x.forEach((function(x){S[x]=this.getOption(x)}),this),S},setOption:function(x,S){if(this["$"+x]!==S){var w=this.$options[x];if(!w)return s('misspelled option "'+x+'"');if(w.forwardTo)return this[w.forwardTo]&&this[w.forwardTo].setOption(x,S);w.handlesSet||(this["$"+x]=S),w&&w.set&&w.set.call(this,S)}},getOption:function(x){var S=this.$options[x];return S?S.forwardTo?this[S.forwardTo]&&this[S.forwardTo].getOption(x):S&&S.get?S.get.call(this):this["$"+x]:s('misspelled option "'+x+'"')}};function s(x){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function a(x,S){var w=new Error(x);w.data=S,"object"==typeof console&&console.error&&console.error(w),setTimeout((function(){throw w}))}var c=function(){this.$defaultOptions={}};(function(){U.implement(this,G),this.defineOptions=function(x,S,w){return x.$options||(this.$defaultOptions[S]=x.$options={}),Object.keys(w).forEach((function(S){var U=w[S];"string"==typeof U&&(U={forwardTo:U}),U.name||(U.name=S),x.$options[U.name]=U,"initialValue"in U&&(x["$"+U.name]=U.initialValue)})),U.implement(x,H),this},this.resetOptions=function(x){Object.keys(x.$options).forEach((function(S){var w=x.$options[S];"value"in w&&x.setOption(S,w.value)}))},this.setDefaultValue=function(x,S,w){if(!x){for(x in this.$defaultOptions)if(this.$defaultOptions[x][S])break;if(!this.$defaultOptions[x][S])return!1}var U=this.$defaultOptions[x]||(this.$defaultOptions[x]={});U[S]&&(U.forwardTo?this.setDefaultValue(U.forwardTo,S,w):U[S].value=w)},this.setDefaultValues=function(x,S){Object.keys(S).forEach((function(w){this.setDefaultValue(x,w,S[w])}),this)},this.warn=s,this.reportError=a}).call(c.prototype),S.AppConfig=c})),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],(function(x,S,U){var G=x("./lib/lang"),H=(x("./lib/oop"),x("./lib/net")),z=x("./lib/app_config").AppConfig;U.exports=S=new z;var j=function(){return this||"undefined"!=typeof window&&window}(),X={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1};S.get=function(x){if(!X.hasOwnProperty(x))throw new Error("Unknown config key: "+x);return X[x]},S.set=function(x,S){if(X.hasOwnProperty(x))X[x]=S;else if(0==this.setDefaultValue("",x,S))throw new Error("Unknown config key: "+x)},S.all=function(){return G.copyObject(X)},S.$modes={},S.moduleUrl=function(x,S){if(X.$moduleUrls[x])return X.$moduleUrls[x];var w=x.split("/"),U="snippets"==(S=S||w[w.length-2]||"")?"/":"-",G=w[w.length-1];if("worker"==S&&"-"==U){var H=new RegExp("^"+S+"[\\-_]|[\\-_]"+S+"$","g");G=G.replace(H,"")}(!G||G==S)&&w.length>1&&(G=w[w.length-2]);var z=X[S+"Path"];return null==z?z=X.basePath:"/"==U&&(S=U=""),z&&"/"!=z.slice(-1)&&(z+="/"),z+S+U+G+this.get("suffix")},S.setModuleUrl=function(x,S){return X.$moduleUrls[x]=S},S.$loading={},S.loadModule=function(w,U){var G,z;Array.isArray(w)&&(z=w[0],w=w[1]);try{G=x(w)}catch(x){}if(G&&!S.$loading[w])return U&&U(G);if(S.$loading[w]||(S.$loading[w]=[]),S.$loading[w].push(U),!(S.$loading[w].length>1)){var a=function(){x([w],(function(x){S._emit("load.module",{name:w,module:x});var U=S.$loading[w];S.$loading[w]=null,U.forEach((function(S){S&&S(x)}))}))};if(!S.get("packaged"))return a();H.loadScript(S.moduleUrl(w,z),a),l()}};var l=function(){X.basePath||X.workerPath||X.modePath||X.themePath||Object.keys(X.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),l=function(){})};function u(G){if(j&&j.document){X.packaged=G||x.packaged||U.packaged||j.define&&w(3).packaged;for(var H,z={},K="",q=document.currentScript||document._currentScript,Y=(q&&q.ownerDocument||document).getElementsByTagName("script"),Z=0;Z<Y.length;Z++){var J=Y[Z],Q=J.src||J.getAttribute("src");if(Q){for(var ee=J.attributes,te=0,ne=ee.length;te<ne;te++){var ie=ee[te];0===ie.name.indexOf("data-ace-")&&(z[(H=ie.name.replace(/^data-ace-/,""),H.replace(/-(.)/g,(function(x,S){return S.toUpperCase()})))]=ie.value)}var re=Q.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);re&&(K=re[1])}}for(var oe in K&&(z.base=z.base||K,z.packaged=!0),z.basePath=z.base,z.workerPath=z.workerPath||z.base,z.modePath=z.modePath||z.base,z.themePath=z.themePath||z.base,delete z.base,z)void 0!==z[oe]&&S.set(oe,z[oe])}}u(!0),S.init=u,S.version="1.4.7"})),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/mouse/touch_handler","ace/config"],(function(x,S,w){"use strict";var U=x("../lib/event"),G=x("../lib/useragent"),H=x("./default_handlers").DefaultHandlers,z=x("./default_gutter_handler").GutterHandler,j=x("./mouse_event").MouseEvent,X=x("./dragdrop_handler").DragdropHandler,K=x("./touch_handler").addTouchListeners,q=x("../config"),h=function(x){var S=this;this.editor=x,new H(this),new z(this),new X(this);var n=function(S){(!document.hasFocus||!document.hasFocus()||!x.isFocused()&&document.activeElement==(x.textInput&&x.textInput.getElement()))&&window.focus(),x.focus()},w=x.renderer.getMouseEventTarget();U.addListener(w,"click",this.onMouseEvent.bind(this,"click")),U.addListener(w,"mousemove",this.onMouseMove.bind(this,"mousemove")),U.addMultiMouseDownListener([w,x.renderer.scrollBarV&&x.renderer.scrollBarV.inner,x.renderer.scrollBarH&&x.renderer.scrollBarH.inner,x.textInput&&x.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),U.addMouseWheelListener(x.container,this.onMouseWheel.bind(this,"mousewheel")),K(x.container,x);var j=x.renderer.$gutter;U.addListener(j,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),U.addListener(j,"click",this.onMouseEvent.bind(this,"gutterclick")),U.addListener(j,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),U.addListener(j,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),U.addListener(w,"mousedown",n),U.addListener(j,"mousedown",n),G.isIE&&x.renderer.scrollBarV&&(U.addListener(x.renderer.scrollBarV.element,"mousedown",n),U.addListener(x.renderer.scrollBarH.element,"mousedown",n)),x.on("mousemove",(function(w){if(!S.state&&!S.$dragDelay&&S.$dragEnabled){var U=x.renderer.screenToTextCoordinates(w.x,w.y),G=x.session.selection.getRange(),H=x.renderer;!G.isEmpty()&&G.insideStart(U.row,U.column)?H.setCursorStyle("default"):H.setCursorStyle("")}}))};(function(){this.onMouseEvent=function(x,S){this.editor._emit(x,new j(S,this.editor))},this.onMouseMove=function(x,S){var w=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;w&&w.length&&this.editor._emit(x,new j(S,this.editor))},this.onMouseWheel=function(x,S){var w=new j(S,this.editor);w.speed=2*this.$scrollSpeed,w.wheelX=S.wheelX,w.wheelY=S.wheelY,this.editor._emit(x,w)},this.setState=function(x){this.state=x},this.captureMouse=function(x,S){this.x=x.x,this.y=x.y,this.isMousePressed=!0;var w=this.editor,H=this.editor.renderer;H.$isMousePressed=!0;var z=this,c=function(x){if(x){if(G.isWebKit&&!x.which&&z.releaseMouse)return z.releaseMouse();z.x=x.clientX,z.y=x.clientY,S&&S(x),z.mouseEvent=new j(x,z.editor),z.$mouseMoved=!0}},l=function(x){w.off("beforeEndOperation",h),clearInterval(X),u(),z[z.state+"End"]&&z[z.state+"End"](x),z.state="",z.isMousePressed=H.$isMousePressed=!1,H.$keepTextAreaAtCursor&&H.$moveTextAreaToCursor(),z.$onCaptureMouseMove=z.releaseMouse=null,x&&z.onMouseEvent("mouseup",x),w.endOperation()},u=function(){z[z.state]&&z[z.state](),z.$mouseMoved=!1};if(G.isOldIE&&"dblclick"==x.domEvent.type)return setTimeout((function(){l(x)}));var h=function(x){z.releaseMouse&&w.curOp.command.name&&w.curOp.selectionChanged&&(z[z.state+"End"]&&z[z.state+"End"](),z.state="",z.releaseMouse())};w.on("beforeEndOperation",h),w.startOperation({command:{name:"mouse"}}),z.$onCaptureMouseMove=c,z.releaseMouse=U.capture(this.editor.container,c,l);var X=setInterval(u,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var x=function(S){S&&S.domEvent&&"contextmenu"!=S.domEvent.type||(this.editor.off("nativecontextmenu",x),S&&S.domEvent&&U.stopEvent(S.domEvent))}.bind(this);setTimeout(x,10),this.editor.on("nativecontextmenu",x)}}).call(h.prototype),q.defineOptions(h.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:G.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),S.MouseHandler=h})),ace.define("ace/mouse/fold_handler",["require","exports","module","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("../lib/dom");S.FoldHandler=function(x){x.on("click",(function(S){var w=S.getDocumentPosition(),G=x.session,H=G.getFoldAt(w.row,w.column,1);H&&(S.getAccelKey()?G.removeFold(H):G.expandFold(H),S.stop());var z=S.domEvent&&S.domEvent.target;z&&U.hasCssClass(z,"ace_inline_button")&&U.hasCssClass(z,"ace_toggle_wrap")&&(G.setOption("wrap",!G.getUseWrapMode()),x.renderer.scrollCursorIntoView())})),x.on("gutterclick",(function(S){if("foldWidgets"==x.renderer.$gutterLayer.getRegion(S)){var w=S.getDocumentPosition().row,U=x.session;U.foldWidgets&&U.foldWidgets[w]&&x.session.onFoldWidgetClick(w,S),x.isFocused()||x.focus(),S.stop()}})),x.on("gutterdblclick",(function(S){if("foldWidgets"==x.renderer.$gutterLayer.getRegion(S)){var w=S.getDocumentPosition().row,U=x.session,G=U.getParentFoldRangeData(w,!0),H=G.range||G.firstRange;if(H){w=H.start.row;var z=U.getFoldAt(w,U.getLine(w).length,1);z?U.removeFold(z):(U.addFold("...",H),x.renderer.scrollCursorIntoView({row:H.start.row,column:0}))}S.stop()}}))}})),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],(function(x,S,w){"use strict";var U=x("../lib/keys"),G=x("../lib/event"),o=function(x){this.$editor=x,this.$data={editor:x},this.$handlers=[],this.setDefaultHandler(x.commands)};(function(){this.setDefaultHandler=function(x){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=x,this.addKeyboardHandler(x,0)},this.setKeyboardHandler=function(x){var S=this.$handlers;if(S[S.length-1]!=x){for(;S[S.length-1]&&S[S.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(S[S.length-1]);this.addKeyboardHandler(x,1)}},this.addKeyboardHandler=function(x,S){if(x){"function"!=typeof x||x.handleKeyboard||(x.handleKeyboard=x);var w=this.$handlers.indexOf(x);-1!=w&&this.$handlers.splice(w,1),null==S?this.$handlers.push(x):this.$handlers.splice(S,0,x),-1==w&&x.attach&&x.attach(this.$editor)}},this.removeKeyboardHandler=function(x){var S=this.$handlers.indexOf(x);return-1!=S&&(this.$handlers.splice(S,1),x.detach&&x.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var x=this.$data,S=x.editor;return this.$handlers.map((function(w){return w.getStatusText&&w.getStatusText(S,x)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(x,S,w,U){for(var H,z=!1,j=this.$editor.commands,X=this.$handlers.length;X--&&!((H=this.$handlers[X].handleKeyboard(this.$data,x,S,w,U))&&H.command&&((z="null"==H.command||j.exec(H.command,this.$editor,H.args,U))&&U&&-1!=x&&1!=H.passEvent&&1!=H.command.passEvent&&G.stopEvent(U),z)););return z||-1!=x||(H={command:"insertstring"},z=j.exec("insertstring",this.$editor,S)),z&&this.$editor._signal&&this.$editor._signal("keyboardActivity",H),z},this.onCommandKey=function(x,S,w){var G=U.keyCodeToString(w);return this.$callKeyboardHandlers(S,G,w,x)},this.onTextInput=function(x){return this.$callKeyboardHandlers(-1,x)}}).call(o.prototype),S.KeyBinding=o})),ace.define("ace/lib/bidiutil",["require","exports","module"],(function(x,S,w){"use strict";var U=0,G=0,H=!1,z=!1,j=!1,X=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],K=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],q=[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4],Y=[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function d(x,S,w){if(!(G<x))if(1!=x||1!=U||z)for(var H,j,X,K,q=w.length,Y=0;Y<q;){if(S[Y]>=x){for(H=Y+1;H<q&&S[H]>=x;)H++;for(j=Y,X=H-1;j<X;j++,X--)K=w[j],w[j]=w[X],w[X]=K;Y=H}Y++}else w.reverse()}function p(x,S,w,G){var X,K,q,Y,Z=S[G];switch(Z){case 0:case 1:H=!1;case 4:case 3:return Z;case 2:return H?3:2;case 7:return H=!0,1;case 8:return 4;case 9:return G<1||G+1>=S.length||2!=(X=w[G-1])&&3!=X||2!=(K=S[G+1])&&3!=K?4:(H&&(K=3),K==X?K:4);case 10:return 2==(X=G>0?w[G-1]:5)&&G+1<S.length&&2==S[G+1]?2:4;case 11:if(G>0&&2==w[G-1])return 2;if(H)return 4;for(Y=G+1,q=S.length;Y<q&&11==S[Y];)Y++;return Y<q&&2==S[Y]?2:4;case 12:for(q=S.length,Y=G+1;Y<q&&12==S[Y];)Y++;if(Y<q){var J=x[G],Q=J>=1425&&J<=2303||64286==J;if(X=S[Y],Q&&(1==X||7==X))return 1}return G<1||5==(X=S[G-1])?4:w[G-1];case 5:return H=!1,z=!0,U;case 6:return j=!0,4;case 13:case 14:case 16:case 17:case 15:H=!1;case 18:return 4}}function m(x){var S=x.charCodeAt(0),w=S>>8;return 0==w?S>191?0:q[S]:5==w?/[\u0591-\u05f4]/.test(x)?1:0:6==w?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(x)?12:/[\u0660-\u0669\u066b-\u066c]/.test(x)?3:1642==S?11:/[\u06f0-\u06f9]/.test(x)?2:7:32==w&&S<=8287?Y[255&S]:254==w&&S>=65136?7:4}S.L=0,S.R=1,S.EN=2,S.ON_R=3,S.AN=4,S.R_H=5,S.B=6,S.RLE=7,S.DOT="·",S.doBidiReorder=function(x,w,q){if(x.length<2)return{};var Y=x.split(""),Z=new Array(Y.length),J=new Array(Y.length),Q=[];U=q?1:0,function(x,S,w,q){var Y=U?K:X,Z=null,J=null,Q=null,ee=0,te=null,ne=-1,ie=null,re=null,oe=[];if(!q)for(ie=0,q=[];ie<w;ie++)q[ie]=m(x[ie]);for(G=U,H=!1,z=!1,j=!1,re=0;re<w;re++){if(Z=ee,oe[re]=J=p(x,q,oe,re),te=240&(ee=Y[Z][J]),ee&=15,S[re]=Q=Y[ee][5],te>0)if(16==te){for(ie=ne;ie<re;ie++)S[ie]=1;ne=-1}else ne=-1;if(Y[ee][6])-1==ne&&(ne=re);else if(ne>-1){for(ie=ne;ie<re;ie++)S[ie]=Q;ne=-1}5==q[re]&&(S[re]=0),G|=Q}if(j)for(ie=0;ie<w;ie++)if(6==q[ie]){S[ie]=U;for(var ae=ie-1;ae>=0&&8==q[ae];ae--)S[ae]=U}}(Y,Q,Y.length,w);for(var ee=0;ee<Z.length;Z[ee]=ee,ee++);for(d(2,Q,Z),d(1,Q,Z),ee=0;ee<Z.length-1;ee++)3===w[ee]?Q[ee]=S.AN:1===Q[ee]&&(w[ee]>7&&w[ee]<13||4===w[ee]||18===w[ee])?Q[ee]=S.ON_R:ee>0&&"ل"===Y[ee-1]&&/\u0622|\u0623|\u0625|\u0627/.test(Y[ee])&&(Q[ee-1]=Q[ee]=S.R_H,ee++);for(Y[Y.length-1]===S.DOT&&(Q[Y.length-1]=S.B),"‫"===Y[0]&&(Q[0]=S.RLE),ee=0;ee<Z.length;ee++)J[ee]=Q[Z[ee]];return{logicalFromVisual:Z,bidiLevels:J}},S.hasBidiCharacters=function(x,S){for(var w=!1,U=0;U<x.length;U++)S[U]=m(x.charAt(U)),w||1!=S[U]&&7!=S[U]&&3!=S[U]||(w=!0);return w},S.getVisualFromLogicalIdx=function(x,S){for(var w=0;w<S.logicalFromVisual.length;w++)if(S.logicalFromVisual[w]==x)return w;return 0}})),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang"],(function(x,S,w){"use strict";var U=x("./lib/bidiutil"),G=x("./lib/lang"),H=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,s=function(x){this.session=x,this.bidiMap={},this.currentRow=null,this.bidiUtil=U,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=H.test(x.getValue())};(function(){this.isBidiRow=function(x,S,w){return!!this.seenBidi&&(x!==this.currentRow&&(this.currentRow=x,this.updateRowLine(S,w),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(x){this.seenBidi?this.currentRow=null:"insert"==x.action&&H.test(x.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var x=0,S=this.session.$screenRowCache;if(S.length){var w=this.session.$getRowCacheIndex(S,this.currentRow);w>=0&&(x=this.session.$docRowCache[w])}return x},this.getSplitIndex=function(){var x=0,S=this.session.$screenRowCache;if(S.length)for(var w,U=this.session.$getRowCacheIndex(S,this.currentRow);this.currentRow-x>0&&(w=this.session.$getRowCacheIndex(S,this.currentRow-x-1))===U;)U=w,x++;else x=this.currentRow;return x},this.updateRowLine=function(x,S){void 0===x&&(x=this.getDocumentRow());var w=x===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(x),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var H=this.session.$wrapData[x];H&&(void 0===S&&(S=this.getSplitIndex()),S>0&&H.length?(this.wrapIndent=H.indent,this.wrapOffset=this.wrapIndent*this.charWidths[U.L],this.line=S<H.length?this.line.substring(H[S-1],H[S]):this.line.substring(H[H.length-1])):this.line=this.line.substring(0,H[S])),S==H.length&&(this.line+=this.showInvisibles?w:U.DOT)}else this.line+=this.showInvisibles?w:U.DOT;var z,j=this.session,X=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(x,S){return"\t"===x||j.isFullWidth(x.charCodeAt(0))?(z="\t"===x?j.getScreenTabSize(S+X):2,X+=z-1,G.stringRepeat(U.DOT,z)):x})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==U.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},this.updateBidiMap=function(){var x=[];U.hasBidiCharacters(this.line,x)||this.isRtlDir?this.bidiMap=U.doBidiReorder(this.line,x,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(x){if(this.characterWidth!==x.$characterSize.width){this.fontMetrics=x;var S=this.characterWidth=x.$characterSize.width,w=x.$measureCharWidth("ה");this.charWidths[U.L]=this.charWidths[U.EN]=this.charWidths[U.ON_R]=S,this.charWidths[U.R]=this.charWidths[U.AN]=w,this.charWidths[U.R_H]=.45*w,this.charWidths[U.B]=this.charWidths[U.RLE]=0,this.currentRow=null}},this.setShowInvisibles=function(x){this.showInvisibles=x,this.currentRow=null},this.setEolChar=function(x){this.EOL=x},this.setContentWidth=function(x){this.contentWidth=x},this.isRtlLine=function(x){return!!this.$isRtl||(null!=x?this.session.getLine(x).charAt(0)==this.RLE:this.isRtlDir)},this.setRtlDirection=function(x,S){for(var w=x.getCursorPosition(),U=x.selection.getSelectionAnchor().row;U<=w.row;U++)S||x.session.getLine(U).charAt(0)!==x.session.$bidiHandler.RLE?S&&x.session.getLine(U).charAt(0)!==x.session.$bidiHandler.RLE&&x.session.doc.insert({column:0,row:U},x.session.$bidiHandler.RLE):x.session.doc.removeInLine(U,0,1)},this.getPosLeft=function(x){x-=this.wrapIndent;var S=this.line.charAt(0)===this.RLE?1:0,w=x>S?this.session.getOverwrite()?x:x-1:S,G=U.getVisualFromLogicalIdx(w,this.bidiMap),H=this.bidiMap.bidiLevels,z=0;!this.session.getOverwrite()&&x<=S&&H[G]%2!=0&&G++;for(var j=0;j<G;j++)z+=this.charWidths[H[j]];return!this.session.getOverwrite()&&x>S&&H[G]%2==0&&(z+=this.charWidths[H[G]]),this.wrapIndent&&(z+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(z+=this.rtlLineOffset),z},this.getSelections=function(x,S){var w,U=this.bidiMap,G=U.bidiLevels,H=[],z=0,j=Math.min(x,S)-this.wrapIndent,X=Math.max(x,S)-this.wrapIndent,K=!1,q=!1,Y=0;this.wrapIndent&&(z+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var Z,J=0;J<G.length;J++)Z=U.logicalFromVisual[J],w=G[J],(K=Z>=j&&Z<X)&&!q?Y=z:!K&&q&&H.push({left:Y,width:z-Y}),z+=this.charWidths[w],q=K;if(K&&J===G.length&&H.push({left:Y,width:z-Y}),this.isRtlDir)for(var Q=0;Q<H.length;Q++)H[Q].left+=this.rtlLineOffset;return H},this.offsetToCol=function(x){this.isRtlDir&&(x-=this.rtlLineOffset);var S=0,w=(x=Math.max(x,0),0),U=0,G=this.bidiMap.bidiLevels,H=this.charWidths[G[U]];for(this.wrapIndent&&(x-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);x>w+H/2;){if(w+=H,U===G.length-1){H=0;break}H=this.charWidths[G[++U]]}return U>0&&G[U-1]%2!=0&&G[U]%2==0?(x<w&&U--,S=this.bidiMap.logicalFromVisual[U]):U>0&&G[U-1]%2==0&&G[U]%2!=0?S=1+(x>w?this.bidiMap.logicalFromVisual[U]:this.bidiMap.logicalFromVisual[U-1]):this.isRtlDir&&U===G.length-1&&0===H&&G[U-1]%2==0||!this.isRtlDir&&0===U&&G[U]%2!=0?S=1+this.bidiMap.logicalFromVisual[U]:(U>0&&G[U-1]%2!=0&&0!==H&&U--,S=this.bidiMap.logicalFromVisual[U]),0===S&&this.isRtlDir&&S++,S+this.wrapIndent}}).call(s.prototype),S.BidiHandler=s})),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/lang"),H=x("./lib/event_emitter").EventEmitter,z=x("./range").Range,a=function(x){this.session=x,this.doc=x.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var S=this;this.cursor.on("change",(function(x){S.$cursorChanged=!0,S.$silent||S._emit("changeCursor"),S.$isEmpty||S.$silent||S._emit("changeSelection"),S.$keepDesiredColumnOnChange||x.old.column==x.value.column||(S.$desiredColumn=null)})),this.anchor.on("change",(function(){S.$anchorChanged=!0,S.$isEmpty||S.$silent||S._emit("changeSelection")}))};(function(){U.implement(this,H),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(x,S){this.$isEmpty=!1,this.anchor.setPosition(x,S)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var x=this.anchor,S=this.lead;return x.row>S.row||x.row==S.row&&x.column>S.column},this.getRange=function(){var x=this.anchor,S=this.lead;return this.$isEmpty?z.fromPoints(S,S):this.isBackwards()?z.fromPoints(S,x):z.fromPoints(x,S)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(x,S){var w=S?x.end:x.start,U=S?x.start:x.end;this.$setSelection(w.row,w.column,U.row,U.column)},this.$setSelection=function(x,S,w,U){var G=this.$isEmpty,H=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(x,S),this.cursor.setPosition(w,U),this.$isEmpty=!z.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||G!=this.$isEmpty||H)&&this._emit("changeSelection")},this.$moveSelection=function(x){var S=this.lead;this.$isEmpty&&this.setSelectionAnchor(S.row,S.column),x.call(this)},this.selectTo=function(x,S){this.$moveSelection((function(){this.moveCursorTo(x,S)}))},this.selectToPosition=function(x){this.$moveSelection((function(){this.moveCursorToPosition(x)}))},this.moveTo=function(x,S){this.clearSelection(),this.moveCursorTo(x,S)},this.moveToPosition=function(x){this.clearSelection(),this.moveCursorToPosition(x)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(x,S){if(void 0===S){var w=x||this.lead;x=w.row,S=w.column}return this.session.getWordRange(x,S)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var x=this.getCursor(),S=this.session.getAWordRange(x.row,x.column);this.setSelectionRange(S)},this.getLineRange=function(x,S){var w,U="number"==typeof x?x:this.lead.row,G=this.session.getFoldLine(U);return G?(U=G.start.row,w=G.end.row):w=U,!0===S?new z(U,0,w,this.session.getLine(w).length):new z(U,0,w+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(x,S,w){var U=x.column,G=x.column+S;return w<0&&(U=x.column-S,G=x.column),this.session.isTabStop(x)&&this.doc.getLine(x.row).slice(U,G).split(" ").length-1==S},this.moveCursorLeft=function(){var x,S=this.lead.getPosition();if(x=this.session.getFoldAt(S.row,S.column,-1))this.moveCursorTo(x.start.row,x.start.column);else if(0===S.column)S.row>0&&this.moveCursorTo(S.row-1,this.doc.getLine(S.row-1).length);else{var w=this.session.getTabSize();this.wouldMoveIntoSoftTab(S,w,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-w):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var x,S=this.lead.getPosition();if(x=this.session.getFoldAt(S.row,S.column,1))this.moveCursorTo(x.end.row,x.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var w=this.session.getTabSize();S=this.lead,this.wouldMoveIntoSoftTab(S,w,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,w):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var x=this.lead.row,S=this.lead.column,w=this.session.documentToScreenRow(x,S),U=this.session.screenToDocumentPosition(w,0),G=this.session.getDisplayLine(x,null,U.row,U.column).match(/^\s*/);G[0].length==S||this.session.$useEmacsStyleLineStart||(U.column+=G[0].length),this.moveCursorToPosition(U)},this.moveCursorLineEnd=function(){var x=this.lead,S=this.session.getDocumentLastRowColumnPosition(x.row,x.column);if(this.lead.column==S.column){var w=this.session.getLine(S.row);if(S.column==w.length){var U=w.search(/\s+$/);U>0&&(S.column=U)}}this.moveCursorTo(S.row,S.column)},this.moveCursorFileEnd=function(){var x=this.doc.getLength()-1,S=this.doc.getLine(x).length;this.moveCursorTo(x,S)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var x=this.lead.row,S=this.lead.column,w=this.doc.getLine(x),U=w.substring(S);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var G=this.session.getFoldAt(x,S,1);if(G)this.moveCursorTo(G.end.row,G.end.column);else{if(this.session.nonTokenRe.exec(U)&&(S+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,U=w.substring(S)),S>=w.length)return this.moveCursorTo(x,w.length),this.moveCursorRight(),void(x<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(U)&&(S+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(x,S)}},this.moveCursorLongWordLeft=function(){var x,S=this.lead.row,w=this.lead.column;if(x=this.session.getFoldAt(S,w,-1))this.moveCursorTo(x.start.row,x.start.column);else{var U=this.session.getFoldStringAt(S,w,-1);null==U&&(U=this.doc.getLine(S).substring(0,w));var H=G.stringReverse(U);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(H)&&(w-=this.session.nonTokenRe.lastIndex,H=H.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),w<=0)return this.moveCursorTo(S,0),this.moveCursorLeft(),void(S>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(H)&&(w-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(S,w)}},this.$shortWordEndIndex=function(x){var S,w=0,U=/\s/,G=this.session.tokenRe;if(G.lastIndex=0,this.session.tokenRe.exec(x))w=this.session.tokenRe.lastIndex;else{for(;(S=x[w])&&U.test(S);)w++;if(w<1)for(G.lastIndex=0;(S=x[w])&&!G.test(S);)if(G.lastIndex=0,w++,U.test(S)){if(w>2){w--;break}for(;(S=x[w])&&U.test(S);)w++;if(w>2)break}}return G.lastIndex=0,w},this.moveCursorShortWordRight=function(){var x=this.lead.row,S=this.lead.column,w=this.doc.getLine(x),U=w.substring(S),G=this.session.getFoldAt(x,S,1);if(G)return this.moveCursorTo(G.end.row,G.end.column);if(S==w.length){var H=this.doc.getLength();do{x++,U=this.doc.getLine(x)}while(x<H&&/^\s*$/.test(U));/^\s+/.test(U)||(U=""),S=0}var z=this.$shortWordEndIndex(U);this.moveCursorTo(x,S+z)},this.moveCursorShortWordLeft=function(){var x,S=this.lead.row,w=this.lead.column;if(x=this.session.getFoldAt(S,w,-1))return this.moveCursorTo(x.start.row,x.start.column);var U=this.session.getLine(S).substring(0,w);if(0===w){do{S--,U=this.doc.getLine(S)}while(S>0&&/^\s*$/.test(U));w=U.length,/\s+$/.test(U)||(U="")}var H=G.stringReverse(U),z=this.$shortWordEndIndex(H);return this.moveCursorTo(S,w-z)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(x,S){var w,U=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===S&&(0!==x&&(this.session.$bidiHandler.isBidiRow(U.row,this.lead.row)?(w=this.session.$bidiHandler.getPosLeft(U.column),U.column=Math.round(w/this.session.$bidiHandler.charWidths[0])):w=U.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?U.column=this.$desiredColumn:this.$desiredColumn=U.column);var G=this.session.screenToDocumentPosition(U.row+x,U.column,w);0!==x&&0===S&&G.row===this.lead.row&&G.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[G.row]&&(G.row>0||x>0)&&G.row++,this.moveCursorTo(G.row,G.column+S,0===S)},this.moveCursorToPosition=function(x){this.moveCursorTo(x.row,x.column)},this.moveCursorTo=function(x,S,w){var U=this.session.getFoldAt(x,S,1);U&&(x=U.start.row,S=U.start.column),this.$keepDesiredColumnOnChange=!0;var G=this.session.getLine(x);/[\uDC00-\uDFFF]/.test(G.charAt(S))&&G.charAt(S-1)&&(this.lead.row==x&&this.lead.column==S+1?S-=1:S+=1),this.lead.setPosition(x,S),this.$keepDesiredColumnOnChange=!1,w||(this.$desiredColumn=null)},this.moveCursorToScreen=function(x,S,w){var U=this.session.screenToDocumentPosition(x,S);this.moveCursorTo(U.row,U.column,w)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(x){this.setSelectionRange(x,x.cursor==x.start),this.$desiredColumn=x.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(x){var S=this.getRange();return x?(x.start.column=S.start.column,x.start.row=S.start.row,x.end.column=S.end.column,x.end.row=S.end.row):x=S,x.cursor=this.isBackwards()?x.start:x.end,x.desiredColumn=this.$desiredColumn,x},this.getRangeOfMovements=function(x){var S=this.getCursor();try{x(this);var w=this.getCursor();return z.fromPoints(S,w)}catch(x){return z.fromPoints(S,S)}finally{this.moveCursorToPosition(S)}},this.toJSON=function(){if(this.rangeCount)var x=this.ranges.map((function(x){var S=x.clone();return S.isBackwards=x.cursor==x.start,S}));else(x=this.getRange()).isBackwards=this.isBackwards();return x},this.fromJSON=function(x){if(null==x.start){if(this.rangeList&&x.length>1){this.toSingleRange(x[0]);for(var S=x.length;S--;){var w=z.fromPoints(x[S].start,x[S].end);x[S].isBackwards&&(w.cursor=w.start),this.addRange(w,!0)}return}x=x[0]}this.rangeList&&this.toSingleRange(x),this.setSelectionRange(x,x.isBackwards)},this.isEqual=function(x){if((x.length||this.rangeCount)&&x.length!=this.rangeCount)return!1;if(!x.length||!this.ranges)return this.getRange().isEqual(x);for(var S=this.ranges.length;S--;)if(!this.ranges[S].isEqual(x[S]))return!1;return!0}}).call(a.prototype),S.Selection=a})),ace.define("ace/tokenizer",["require","exports","module","ace/config"],(function(x,S,w){"use strict";var U=x("./config"),G=2e3,o=function(x){for(var S in this.states=x,this.regExps={},this.matchMappings={},this.states){for(var w=this.states[S],U=[],G=0,H=this.matchMappings[S]={defaultToken:"text"},z="g",j=[],X=0;X<w.length;X++){var K=w[X];if(K.defaultToken&&(H.defaultToken=K.defaultToken),K.caseInsensitive&&(z="gi"),null!=K.regex){K.regex instanceof RegExp&&(K.regex=K.regex.toString().slice(1,-1));var q=K.regex,Y=new RegExp("(?:("+q+")|(.))").exec("a").length-2;Array.isArray(K.token)?1==K.token.length||1==Y?K.token=K.token[0]:Y-1!=K.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:K,groupCount:Y-1}),K.token=K.token[0]):(K.tokenArray=K.token,K.token=null,K.onMatch=this.$arrayTokens):"function"!=typeof K.token||K.onMatch||(K.onMatch=Y>1?this.$applyToken:K.token),Y>1&&(/\\\d/.test(K.regex)?q=K.regex.replace(/\\([0-9]+)/g,(function(x,S){return"\\"+(parseInt(S,10)+G+1)})):(Y=1,q=this.removeCapturingGroups(K.regex)),K.splitRegex||"string"==typeof K.token||j.push(K)),H[G]=X,G+=Y,U.push(q),K.onMatch||(K.onMatch=null)}}U.length||(H[0]=0,U.push("$")),j.forEach((function(x){x.splitRegex=this.createSplitterRegexp(x.regex,z)}),this),this.regExps[S]=new RegExp("("+U.join(")|(")+")|($)",z)}};(function(){this.$setMaxTokenCount=function(x){G=0|x},this.$applyToken=function(x){var S=this.splitRegex.exec(x).slice(1),w=this.token.apply(this,S);if("string"==typeof w)return[{type:w,value:x}];for(var U=[],G=0,H=w.length;G<H;G++)S[G]&&(U[U.length]={type:w[G],value:S[G]});return U},this.$arrayTokens=function(x){if(!x)return[];var S=this.splitRegex.exec(x);if(!S)return"text";for(var w=[],U=this.tokenArray,G=0,H=U.length;G<H;G++)S[G+1]&&(w[w.length]={type:U[G],value:S[G+1]});return w},this.removeCapturingGroups=function(x){return x.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,(function(x,S){return S?"(?:":x}))},this.createSplitterRegexp=function(x,S){if(-1!=x.indexOf("(?=")){var w=0,U=!1,G={};x.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(x,S,H,z,j,X){return U?U="]"!=j:j?U=!0:z?(w==G.stack&&(G.end=X+1,G.stack=-1),w--):H&&(w++,1!=H.length&&(G.stack=w,G.start=X)),x})),null!=G.end&&/^\)*$/.test(x.substr(G.end))&&(x=x.substring(0,G.start)+x.substr(G.end))}return"^"!=x.charAt(0)&&(x="^"+x),"$"!=x.charAt(x.length-1)&&(x+="$"),new RegExp(x,(S||"").replace("g",""))},this.getLineTokens=function(x,S){if(S&&"string"!=typeof S){var w=S.slice(0);"#tmp"===(S=w[0])&&(w.shift(),S=w.shift())}else w=[];var U=S||"start",H=this.states[U];H||(U="start",H=this.states[U]);var z=this.matchMappings[U],j=this.regExps[U];j.lastIndex=0;for(var X,K=[],q=0,Y=0,Z={type:null,value:""};X=j.exec(x);){var J=z.defaultToken,Q=null,ee=X[0],te=j.lastIndex;if(te-ee.length>q){var ne=x.substring(q,te-ee.length);Z.type==J?Z.value+=ne:(Z.type&&K.push(Z),Z={type:J,value:ne})}for(var ie=0;ie<X.length-2;ie++)if(void 0!==X[ie+1]){J=(Q=H[z[ie]]).onMatch?Q.onMatch(ee,U,w,x):Q.token,Q.next&&(U="string"==typeof Q.next?Q.next:Q.next(U,w),(H=this.states[U])||(this.reportError("state doesn't exist",U),U="start",H=this.states[U]),z=this.matchMappings[U],q=te,(j=this.regExps[U]).lastIndex=te),Q.consumeLineEnd&&(q=te);break}if(ee)if("string"==typeof J)Q&&!1===Q.merge||Z.type!==J?(Z.type&&K.push(Z),Z={type:J,value:ee}):Z.value+=ee;else if(J)for(Z.type&&K.push(Z),Z={type:null,value:""},ie=0;ie<J.length;ie++)K.push(J[ie]);if(q==x.length)break;if(q=te,Y++>G){for(Y>2*x.length&&this.reportError("infinite loop with in ace tokenizer",{startState:S,line:x});q<x.length;)Z.type&&K.push(Z),Z={value:x.substring(q,q+=500),type:"overflow"};U="start",w=[];break}}return Z.type&&K.push(Z),w.length>1&&w[0]!==U&&w.unshift("#tmp",U),{tokens:K,state:w.length?w:U}},this.reportError=U.reportError}).call(o.prototype),S.Tokenizer=o})),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],(function(x,S,w){"use strict";var U=x("../lib/lang"),r=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(x,S){if(S)for(var w in x){for(var U=x[w],G=0;G<U.length;G++){var H=U[G];(H.next||H.onMatch)&&("string"==typeof H.next&&0!==H.next.indexOf(S)&&(H.next=S+H.next),H.nextState&&0!==H.nextState.indexOf(S)&&(H.nextState=S+H.nextState))}this.$rules[S+w]=U}else for(var w in x)this.$rules[w]=x[w]},this.getRules=function(){return this.$rules},this.embedRules=function(x,S,w,G,H){var z="function"==typeof x?(new x).getRules():x;if(G)for(var j=0;j<G.length;j++)G[j]=S+G[j];else for(var X in G=[],z)G.push(S+X);if(this.addRules(z,S),w){var K=Array.prototype[H?"push":"unshift"];for(j=0;j<G.length;j++)K.apply(this.$rules[G[j]],U.deepCopy(w))}this.$embeds||(this.$embeds=[]),this.$embeds.push(S)},this.getEmbeds=function(){return this.$embeds};var e=function(x,S){return("start"!=x||S.length)&&S.unshift(this.nextState,x),this.nextState},t=function(x,S){return S.shift(),S.shift()||"start"};this.normalizeRules=function(){var x=0,S=this.$rules;Object.keys(S).forEach((function r(w){var U=S[w];U.processed=!0;for(var G=0;G<U.length;G++){var H=U[G],z=null;Array.isArray(H)&&(z=H,H={}),!H.regex&&H.start&&(H.regex=H.start,H.next||(H.next=[]),H.next.push({defaultToken:H.token},{token:H.token+".end",regex:H.end||H.start,next:"pop"}),H.token=H.token+".start",H.push=!0);var j=H.next||H.push;if(j&&Array.isArray(j)){var X=H.stateName;X||("string"!=typeof(X=H.token)&&(X=X[0]||""),S[X]&&(X+=x++)),S[X]=j,H.next=X,r(X)}else"pop"==j&&(H.next=t);if(H.push&&(H.nextState=H.next||H.push,H.next=e,delete H.push),H.rules)for(var K in H.rules)S[K]?S[K].push&&S[K].push.apply(S[K],H.rules[K]):S[K]=H.rules[K];var q="string"==typeof H?H:H.include;if(q&&(z=Array.isArray(q)?q.map((function(x){return S[x]})):S[q]),z){var Y=[G,1].concat(z);H.noEscape&&(Y=Y.filter((function(x){return!x.next}))),U.splice.apply(U,Y),G--}H.keywordMap&&(H.token=this.createKeywordMapper(H.keywordMap,H.defaultToken||"text",H.caseInsensitive),delete H.defaultToken)}}),this)},this.createKeywordMapper=function(x,S,w,U){var G=Object.create(null);return Object.keys(x).forEach((function(S){var H=x[S];w&&(H=H.toLowerCase());for(var z=H.split(U||"|"),j=z.length;j--;)G[z[j]]=S})),Object.getPrototypeOf(G)&&(G.__proto__=null),this.$keywordList=Object.keys(G),x=null,w?function(x){return G[x.toLowerCase()]||S}:function(x){return G[x]||S}},this.getKeywords=function(){return this.$keywords}}).call(r.prototype),S.TextHighlightRules=r})),ace.define("ace/mode/behaviour",["require","exports","module"],(function(x,S,w){"use strict";var i=function(){this.$behaviours={}};(function(){this.add=function(x,S,w){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[x]:this.$behaviours[x]={}}this.$behaviours[x][S]=w},this.addBehaviours=function(x){for(var S in x)for(var w in x[S])this.add(S,w,x[S][w])},this.remove=function(x){this.$behaviours&&this.$behaviours[x]&&delete this.$behaviours[x]},this.inherit=function(x,S){if("function"==typeof x)var w=(new x).getBehaviours(S);else w=x.getBehaviours(S);this.addBehaviours(w)},this.getBehaviours=function(x){if(x){for(var S={},w=0;w<x.length;w++)this.$behaviours[x[w]]&&(S[x[w]]=this.$behaviours[x[w]]);return S}return this.$behaviours}}).call(i.prototype),S.Behaviour=i})),ace.define("ace/token_iterator",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var U=x("./range").Range,r=function(x,S,w){this.$session=x,this.$row=S,this.$rowTokens=x.getTokens(S);var U=x.getTokenAt(S,w);this.$tokenIndex=U?U.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var x;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,x||(x=this.$session.getLength()),this.$row>=x)return this.$row=x-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var x=this.$rowTokens,S=this.$tokenIndex,w=x[S].start;if(void 0!==w)return w;for(w=0;S>0;)w+=x[S-=1].value.length;return w},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var x=this.$rowTokens[this.$tokenIndex],S=this.getCurrentTokenColumn();return new U(this.$row,S,this.$row,S+x.value.length)}}).call(r.prototype),S.TokenIterator=r})),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(x,S,w){"use strict";var U,G=x("../../lib/oop"),H=x("../behaviour").Behaviour,z=x("../../token_iterator").TokenIterator,j=x("../../lib/lang"),X=["text","paren.rparen","rparen","paren","punctuation.operator"],K=["text","paren.rparen","rparen","paren","punctuation.operator","comment"],q={},Y={'"':'"',"'":"'"},d=function(x){var S=-1;if(x.multiSelect&&(S=x.selection.index,q.rangeCount!=x.multiSelect.rangeCount&&(q={rangeCount:x.multiSelect.rangeCount})),q[S])return U=q[S];U=q[S]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},p=function(x,S,w,U){var G=x.end.row-x.start.row;return{text:w+S+U,selection:[0,x.start.column+1,G,x.end.column+(G?0:1)]}},m=function(x){this.add("braces","insertion",(function(S,w,G,H,z){var X=G.getCursorPosition(),K=H.doc.getLine(X.row);if("{"==z){d(G);var q=G.getSelectionRange(),Y=H.doc.getTextRange(q);if(""!==Y&&"{"!==Y&&G.getWrapBehavioursEnabled())return p(q,Y,"{","}");if(m.isSaneInsertion(G,H))return/[\]\}\)]/.test(K[X.column])||G.inMultiSelectMode||x&&x.braces?(m.recordAutoInsert(G,H,"}"),{text:"{}",selection:[1,1]}):(m.recordMaybeInsert(G,H,"{"),{text:"{",selection:[1,1]})}else if("}"==z){if(d(G),"}"==K.substring(X.column,X.column+1)&&null!==H.$findOpeningBracket("}",{column:X.column+1,row:X.row})&&m.isAutoInsertedClosing(X,K,z))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==z||"\r\n"==z){d(G);var Z="";if(m.isMaybeInsertedClosing(X,K)&&(Z=j.stringRepeat("}",U.maybeInsertedBrackets),m.clearMaybeInsertedClosing()),"}"===K.substring(X.column,X.column+1)){var J=H.findMatchingBracket({row:X.row,column:X.column+1},"}");if(!J)return null;var Q=this.$getIndent(H.getLine(J.row))}else{if(!Z)return void m.clearMaybeInsertedClosing();Q=this.$getIndent(K)}var ee=Q+H.getTabString();return{text:"\n"+ee+"\n"+Q+Z,selection:[1,ee.length,1,ee.length]}}m.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(x,S,w,G,H){var z=G.doc.getTextRange(H);if(!H.isMultiLine()&&"{"==z){if(d(w),"}"==G.doc.getLine(H.start.row).substring(H.end.column,H.end.column+1))return H.end.column++,H;U.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(x,S,w,U,G){if("("==G){d(w);var H=w.getSelectionRange(),z=U.doc.getTextRange(H);if(""!==z&&w.getWrapBehavioursEnabled())return p(H,z,"(",")");if(m.isSaneInsertion(w,U))return m.recordAutoInsert(w,U,")"),{text:"()",selection:[1,1]}}else if(")"==G){d(w);var j=w.getCursorPosition(),X=U.doc.getLine(j.row);if(")"==X.substring(j.column,j.column+1)&&null!==U.$findOpeningBracket(")",{column:j.column+1,row:j.row})&&m.isAutoInsertedClosing(j,X,G))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(x,S,w,U,G){var H=U.doc.getTextRange(G);if(!G.isMultiLine()&&"("==H&&(d(w),")"==U.doc.getLine(G.start.row).substring(G.start.column+1,G.start.column+2)))return G.end.column++,G})),this.add("brackets","insertion",(function(x,S,w,U,G){if("["==G){d(w);var H=w.getSelectionRange(),z=U.doc.getTextRange(H);if(""!==z&&w.getWrapBehavioursEnabled())return p(H,z,"[","]");if(m.isSaneInsertion(w,U))return m.recordAutoInsert(w,U,"]"),{text:"[]",selection:[1,1]}}else if("]"==G){d(w);var j=w.getCursorPosition(),X=U.doc.getLine(j.row);if("]"==X.substring(j.column,j.column+1)&&null!==U.$findOpeningBracket("]",{column:j.column+1,row:j.row})&&m.isAutoInsertedClosing(j,X,G))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(x,S,w,U,G){var H=U.doc.getTextRange(G);if(!G.isMultiLine()&&"["==H&&(d(w),"]"==U.doc.getLine(G.start.row).substring(G.start.column+1,G.start.column+2)))return G.end.column++,G})),this.add("string_dquotes","insertion",(function(x,S,w,U,G){var H=U.$mode.$quotes||Y;if(1==G.length&&H[G]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(G))return;d(w);var z=G,j=w.getSelectionRange(),X=U.doc.getTextRange(j);if(!(""===X||1==X.length&&H[X])&&w.getWrapBehavioursEnabled())return p(j,X,z,z);if(!X){var K=w.getCursorPosition(),q=U.doc.getLine(K.row),Z=q.substring(K.column-1,K.column),J=q.substring(K.column,K.column+1),Q=U.getTokenAt(K.row,K.column),ee=U.getTokenAt(K.row,K.column+1);if("\\"==Z&&Q&&/escape/.test(Q.type))return null;var te,ne=Q&&/string|escape/.test(Q.type),ie=!ee||/string|escape/.test(ee.type);if(J==z)(te=ne!==ie)&&/string\.end/.test(ee.type)&&(te=!1);else{if(ne&&!ie)return null;if(ne&&ie)return null;var re=U.$mode.tokenRe;re.lastIndex=0;var oe=re.test(Z);re.lastIndex=0;var ae=re.test(Z);if(oe||ae)return null;if(J&&!/[\s;,.})\]\\]/.test(J))return null;var se=q[K.column-2];if(Z==z&&(se==z||re.test(se)))return null;te=!0}return{text:te?z+z:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(x,S,w,U,G){var H=U.$mode.$quotes||Y,z=U.doc.getTextRange(G);if(!G.isMultiLine()&&H.hasOwnProperty(z)&&(d(w),U.doc.getLine(G.start.row).substring(G.start.column+1,G.start.column+2)==z))return G.end.column++,G}))};m.isSaneInsertion=function(x,S){var w=x.getCursorPosition(),U=new z(S,w.row,w.column);if(!this.$matchTokenType(U.getCurrentToken()||"text",X)){if(/[)}\]]/.test(x.session.getLine(w.row)[w.column]))return!0;var G=new z(S,w.row,w.column+1);if(!this.$matchTokenType(G.getCurrentToken()||"text",X))return!1}return U.stepForward(),U.getCurrentTokenRow()!==w.row||this.$matchTokenType(U.getCurrentToken()||"text",K)},m.$matchTokenType=function(x,S){return S.indexOf(x.type||x)>-1},m.recordAutoInsert=function(x,S,w){var G=x.getCursorPosition(),H=S.doc.getLine(G.row);this.isAutoInsertedClosing(G,H,U.autoInsertedLineEnd[0])||(U.autoInsertedBrackets=0),U.autoInsertedRow=G.row,U.autoInsertedLineEnd=w+H.substr(G.column),U.autoInsertedBrackets++},m.recordMaybeInsert=function(x,S,w){var G=x.getCursorPosition(),H=S.doc.getLine(G.row);this.isMaybeInsertedClosing(G,H)||(U.maybeInsertedBrackets=0),U.maybeInsertedRow=G.row,U.maybeInsertedLineStart=H.substr(0,G.column)+w,U.maybeInsertedLineEnd=H.substr(G.column),U.maybeInsertedBrackets++},m.isAutoInsertedClosing=function(x,S,w){return U.autoInsertedBrackets>0&&x.row===U.autoInsertedRow&&w===U.autoInsertedLineEnd[0]&&S.substr(x.column)===U.autoInsertedLineEnd},m.isMaybeInsertedClosing=function(x,S){return U.maybeInsertedBrackets>0&&x.row===U.maybeInsertedRow&&S.substr(x.column)===U.maybeInsertedLineEnd&&S.substr(0,x.column)==U.maybeInsertedLineStart},m.popAutoInsertedClosing=function(){U.autoInsertedLineEnd=U.autoInsertedLineEnd.substr(1),U.autoInsertedBrackets--},m.clearMaybeInsertedClosing=function(){U&&(U.maybeInsertedBrackets=0,U.maybeInsertedRow=-1)},G.inherits(m,H),S.CstyleBehaviour=m})),ace.define("ace/unicode",["require","exports","module"],(function(x,S,w){"use strict";for(var U=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],G=0,H=[],z=0;z<U.length;z+=2)H.push(G+=U[z]),U[z+1]&&H.push(45,G+=U[z+1]);S.wordChars=String.fromCharCode.apply(null,H)})),ace.define("ace/mode/text",["require","exports","module","ace/config","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],(function(x,S,w){"use strict";var U=x("../config"),G=x("../tokenizer").Tokenizer,H=x("./text_highlight_rules").TextHighlightRules,z=x("./behaviour/cstyle").CstyleBehaviour,j=x("../unicode"),X=x("../lib/lang"),K=x("../token_iterator").TokenIterator,q=x("../range").Range,h=function(){this.HighlightRules=H};(function(){this.$defaultBehaviour=new z,this.tokenRe=new RegExp("^["+j.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+j.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new G(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(x,S,w,U){var G=S.doc,H=!0,z=!0,j=1/0,K=S.getTabSize(),q=!1;if(this.lineCommentStart){Array.isArray(this.lineCommentStart)?(ee=this.lineCommentStart.map(X.escapeRegExp).join("|"),J=this.lineCommentStart[0]):(ee=X.escapeRegExp(this.lineCommentStart),J=this.lineCommentStart),ee=new RegExp("^(\\s*)(?:"+ee+") ?"),q=S.getUseSoftTabs(),_=function(x,S){var w=x.match(ee);if(w){var U=w[1].length,H=w[0].length;Z(x,U,H)||" "!=w[0][H-1]||H--,G.removeInLine(S,U,H)}};var Y=J+" ",Z=(v=function(x,S){H&&!/\S/.test(x)||(Z(x,j,j)?G.insertInLine({row:S,column:j},Y):G.insertInLine({row:S,column:j},J))},E=function(x,S){return ee.test(x)},function(x,S,w){for(var U=0;S--&&" "==x.charAt(S);)U++;if(U%K!=0)return!1;for(U=0;" "==x.charAt(w++);)U++;return K>2?U%K!=K-1:U%K==0})}else{if(!this.blockComment)return!1;var J=this.blockComment.start,Q=this.blockComment.end,ee=new RegExp("^(\\s*)(?:"+X.escapeRegExp(J)+")"),te=new RegExp("(?:"+X.escapeRegExp(Q)+")\\s*$"),v=function(x,S){E(x,S)||H&&!/\S/.test(x)||(G.insertInLine({row:S,column:x.length},Q),G.insertInLine({row:S,column:j},J))},_=function(x,S){var w;(w=x.match(te))&&G.removeInLine(S,x.length-w[0].length,x.length),(w=x.match(ee))&&G.removeInLine(S,w[1].length,w[0].length)},E=function(x,w){if(ee.test(x))return!0;for(var U=S.getTokens(w),G=0;G<U.length;G++)if("comment"===U[G].type)return!0}}function C(x){for(var S=w;S<=U;S++)x(G.getLine(S),S)}var ne=1/0;C((function(x,S){var w=x.search(/\S/);-1!==w?(w<j&&(j=w),z&&!E(x,S)&&(z=!1)):ne>x.length&&(ne=x.length)})),j==1/0&&(j=ne,H=!1,z=!1),q&&j%K!=0&&(j=Math.floor(j/K)*K),C(z?_:v)},this.toggleBlockComment=function(x,S,w,U){var G=this.blockComment;if(G){!G.start&&G[0]&&(G=G[0]);var H,z,j=(ee=new K(S,U.row,U.column)).getCurrentToken(),X=(S.selection,S.selection.toOrientedRange());if(j&&/comment/.test(j.type)){for(var Y,Z;j&&/comment/.test(j.type);){if(-1!=(te=j.value.indexOf(G.start))){var J=ee.getCurrentTokenRow(),Q=ee.getCurrentTokenColumn()+te;Y=new q(J,Q,J,Q+G.start.length);break}j=ee.stepBackward()}var ee;for(j=(ee=new K(S,U.row,U.column)).getCurrentToken();j&&/comment/.test(j.type);){var te;if(-1!=(te=j.value.indexOf(G.end))){J=ee.getCurrentTokenRow(),Q=ee.getCurrentTokenColumn()+te,Z=new q(J,Q,J,Q+G.end.length);break}j=ee.stepForward()}Z&&S.remove(Z),Y&&(S.remove(Y),H=Y.start.row,z=-G.start.length)}else z=G.start.length,H=w.start.row,S.insert(w.end,G.end),S.insert(w.start,G.start);X.start.row==H&&(X.start.column+=z),X.end.row==H&&(X.end.column+=z),S.selection.fromOrientedRange(X)}},this.getNextLineIndent=function(x,S,w){return this.$getIndent(S)},this.checkOutdent=function(x,S,w){return!1},this.autoOutdent=function(x,S,w){},this.$getIndent=function(x){return x.match(/^\s*/)[0]},this.createWorker=function(x){return null},this.createModeDelegates=function(x){for(var S in this.$embeds=[],this.$modes={},x)if(x[S]){var w=x[S],G=w.prototype.$id,H=U.$modes[G];H||(U.$modes[G]=H=new w),U.$modes[S]||(U.$modes[S]=H),this.$embeds.push(S),this.$modes[S]=H}var z=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(S=0;S<z.length;S++)!function(x){var w=z[S],U=x[w];x[z[S]]=function(){return this.$delegator(w,arguments,U)}}(this)},this.$delegator=function(x,S,w){var U=S[0]||"start";if("string"!=typeof U){if(Array.isArray(U[2])){var G=U[2][U[2].length-1];if(z=this.$modes[G])return z[x].apply(z,[U[1]].concat([].slice.call(S,1)))}U=U[0]||"start"}for(var H=0;H<this.$embeds.length;H++)if(this.$modes[this.$embeds[H]]){var z,j=U.split(this.$embeds[H]);if(!j[0]&&j[1])return S[0]=j[1],(z=this.$modes[this.$embeds[H]])[x].apply(z,S)}var X=w.apply(this,S);return w?X:void 0},this.transformAction=function(x,S,w,U,G){if(this.$behaviour){var H=this.$behaviour.getBehaviours();for(var z in H)if(H[z][S]){var j=H[z][S].apply(this,arguments);if(j)return j}}},this.getKeywords=function(x){if(!this.completionKeywords){var S=this.$tokenizer.rules,w=[];for(var U in S)for(var G=S[U],H=0,z=G.length;H<z;H++)if("string"==typeof G[H].token)/keyword|support|storage/.test(G[H].token)&&w.push(G[H].regex);else if("object"==typeof G[H].token)for(var j=0,X=G[H].token.length;j<X;j++)/keyword|support|storage/.test(G[H].token[j])&&(U=G[H].regex.match(/\(.+?\)/g)[j],w.push(U.substr(1,U.length-2)));this.completionKeywords=w}return x?w.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(x,S,w,U){return(this.$keywordList||this.$createKeywordList()).map((function(x){return{name:x,value:x,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(h.prototype),S.Mode=h})),ace.define("ace/apply_delta",["require","exports","module"],(function(x,S,w){"use strict";S.applyDelta=function(x,S,w){var U=S.start.row,G=S.start.column,H=x[U]||"";switch(S.action){case"insert":if(1===S.lines.length)x[U]=H.substring(0,G)+S.lines[0]+H.substring(G);else{var z=[U,1].concat(S.lines);x.splice.apply(x,z),x[U]=H.substring(0,G)+x[U],x[U+S.lines.length-1]+=H.substring(G)}break;case"remove":var j=S.end.column,X=S.end.row;U===X?x[U]=H.substring(0,G)+H.substring(j):x.splice(U,X-U+1,H.substring(0,G)+x[X].substring(j))}}})),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/event_emitter").EventEmitter,H=S.Anchor=function(x,S,w){this.$onChange=this.onChange.bind(this),this.attach(x),void 0===w?this.setPosition(S.row,S.column):this.setPosition(S,w)};(function(){function e(x,S,w){var U=w?x.column<=S.column:x.column<S.column;return x.row<S.row||x.row==S.row&&U}U.implement(this,G),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(x){if(!(x.start.row==x.end.row&&x.start.row!=this.row||x.start.row>this.row)){var S=function(x,S,w){var U="insert"==x.action,G=(U?1:-1)*(x.end.row-x.start.row),H=(U?1:-1)*(x.end.column-x.start.column),z=x.start,j=U?z:x.end;return e(S,z,w)?{row:S.row,column:S.column}:e(j,S,!w)?{row:S.row+G,column:S.column+(S.row==j.row?H:0)}:{row:z.row,column:z.column}}(x,{row:this.row,column:this.column},this.$insertRight);this.setPosition(S.row,S.column,!0)}},this.setPosition=function(x,S,w){var U;if(U=w?{row:x,column:S}:this.$clipPositionToDocument(x,S),this.row!=U.row||this.column!=U.column){var G={row:this.row,column:this.column};this.row=U.row,this.column=U.column,this._signal("change",{old:G,value:U})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(x){this.document=x||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(x,S){var w={};return x>=this.document.getLength()?(w.row=Math.max(0,this.document.getLength()-1),w.column=this.document.getLine(w.row).length):x<0?(w.row=0,w.column=0):(w.row=x,w.column=Math.min(this.document.getLine(w.row).length,Math.max(0,S))),S<0&&(w.column=0),w}}).call(H.prototype)})),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./apply_delta").applyDelta,H=x("./lib/event_emitter").EventEmitter,z=x("./range").Range,j=x("./anchor").Anchor,c=function(x){this.$lines=[""],0===x.length?this.$lines=[""]:Array.isArray(x)?this.insertMergedLines({row:0,column:0},x):this.insert({row:0,column:0},x)};(function(){U.implement(this,H),this.setValue=function(x){var S=this.getLength()-1;this.remove(new z(0,0,S,this.getLine(S).length)),this.insert({row:0,column:0},x)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(x,S){return new j(this,x,S)},0==="aaa".split(/a/).length?this.$split=function(x){return x.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(x){return x.split(/\r\n|\r|\n/)},this.$detectNewLine=function(x){var S=x.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=S?S[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(x){this.$newLineMode!==x&&(this.$newLineMode=x,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(x){return"\r\n"==x||"\r"==x||"\n"==x},this.getLine=function(x){return this.$lines[x]||""},this.getLines=function(x,S){return this.$lines.slice(x,S+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(x){return this.getLinesForRange(x).join(this.getNewLineCharacter())},this.getLinesForRange=function(x){var S;if(x.start.row===x.end.row)S=[this.getLine(x.start.row).substring(x.start.column,x.end.column)];else{(S=this.getLines(x.start.row,x.end.row))[0]=(S[0]||"").substring(x.start.column);var w=S.length-1;x.end.row-x.start.row==w&&(S[w]=S[w].substring(0,x.end.column))}return S},this.insertLines=function(x,S){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(x,S)},this.removeLines=function(x,S){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(x,S)},this.insertNewLine=function(x){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(x,["",""])},this.insert=function(x,S){return this.getLength()<=1&&this.$detectNewLine(S),this.insertMergedLines(x,this.$split(S))},this.insertInLine=function(x,S){var w=this.clippedPos(x.row,x.column),U=this.pos(x.row,x.column+S.length);return this.applyDelta({start:w,end:U,action:"insert",lines:[S]},!0),this.clonePos(U)},this.clippedPos=function(x,S){var w=this.getLength();void 0===x?x=w:x<0?x=0:x>=w&&(x=w-1,S=void 0);var U=this.getLine(x);return null==S&&(S=U.length),{row:x,column:S=Math.min(Math.max(S,0),U.length)}},this.clonePos=function(x){return{row:x.row,column:x.column}},this.pos=function(x,S){return{row:x,column:S}},this.$clipPosition=function(x){var S=this.getLength();return x.row>=S?(x.row=Math.max(0,S-1),x.column=this.getLine(S-1).length):(x.row=Math.max(0,x.row),x.column=Math.min(Math.max(x.column,0),this.getLine(x.row).length)),x},this.insertFullLines=function(x,S){var w=0;(x=Math.min(Math.max(x,0),this.getLength()))<this.getLength()?(S=S.concat([""]),w=0):(S=[""].concat(S),x--,w=this.$lines[x].length),this.insertMergedLines({row:x,column:w},S)},this.insertMergedLines=function(x,S){var w=this.clippedPos(x.row,x.column),U={row:w.row+S.length-1,column:(1==S.length?w.column:0)+S[S.length-1].length};return this.applyDelta({start:w,end:U,action:"insert",lines:S}),this.clonePos(U)},this.remove=function(x){var S=this.clippedPos(x.start.row,x.start.column),w=this.clippedPos(x.end.row,x.end.column);return this.applyDelta({start:S,end:w,action:"remove",lines:this.getLinesForRange({start:S,end:w})}),this.clonePos(S)},this.removeInLine=function(x,S,w){var U=this.clippedPos(x,S),G=this.clippedPos(x,w);return this.applyDelta({start:U,end:G,action:"remove",lines:this.getLinesForRange({start:U,end:G})},!0),this.clonePos(U)},this.removeFullLines=function(x,S){x=Math.min(Math.max(0,x),this.getLength()-1);var w=(S=Math.min(Math.max(0,S),this.getLength()-1))==this.getLength()-1&&x>0,U=S<this.getLength()-1,G=w?x-1:x,H=w?this.getLine(G).length:0,j=U?S+1:S,X=U?0:this.getLine(j).length,K=new z(G,H,j,X),q=this.$lines.slice(x,S+1);return this.applyDelta({start:K.start,end:K.end,action:"remove",lines:this.getLinesForRange(K)}),q},this.removeNewLine=function(x){x<this.getLength()-1&&x>=0&&this.applyDelta({start:this.pos(x,this.getLine(x).length),end:this.pos(x+1,0),action:"remove",lines:["",""]})},this.replace=function(x,S){return x instanceof z||(x=z.fromPoints(x.start,x.end)),0===S.length&&x.isEmpty()?x.start:S==this.getTextRange(x)?x.end:(this.remove(x),S?this.insert(x.start,S):x.start)},this.applyDeltas=function(x){for(var S=0;S<x.length;S++)this.applyDelta(x[S])},this.revertDeltas=function(x){for(var S=x.length-1;S>=0;S--)this.revertDelta(x[S])},this.applyDelta=function(x,S){var w="insert"==x.action;(w?x.lines.length<=1&&!x.lines[0]:!z.comparePoints(x.start,x.end))||(w&&x.lines.length>2e4?this.$splitAndapplyLargeDelta(x,2e4):(G(this.$lines,x,S),this._signal("change",x)))},this.$splitAndapplyLargeDelta=function(x,S){for(var w=x.lines,U=w.length-S+1,G=x.start.row,H=x.start.column,z=0,j=0;z<U;z=j){j+=S-1;var X=w.slice(z,j);X.push(""),this.applyDelta({start:this.pos(G+z,H),end:this.pos(G+j,H=0),action:x.action,lines:X},!0)}x.lines=w.slice(z),x.start.row=G+z,x.start.column=H,this.applyDelta(x,!0)},this.revertDelta=function(x){this.applyDelta({start:this.clonePos(x.start),end:this.clonePos(x.end),action:"insert"==x.action?"remove":"insert",lines:x.lines.slice()})},this.indexToPosition=function(x,S){for(var w=this.$lines||this.getAllLines(),U=this.getNewLineCharacter().length,G=S||0,H=w.length;G<H;G++)if((x-=w[G].length+U)<0)return{row:G,column:x+w[G].length+U};return{row:H-1,column:x+w[H-1].length+U}},this.positionToIndex=function(x,S){for(var w=this.$lines||this.getAllLines(),U=this.getNewLineCharacter().length,G=0,H=Math.min(x.row,w.length),z=S||0;z<H;++z)G+=w[z].length+U;return G+x.column}}).call(c.prototype),S.Document=c})),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/event_emitter").EventEmitter,o=function(x,S){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=x;var w=this;this.$worker=function(){if(w.running){for(var x=new Date,S=w.currentLine,U=-1,G=w.doc,H=S;w.lines[S];)S++;var z=G.getLength(),j=0;for(w.running=!1;S<z;){w.$tokenizeRow(S),U=S;do{S++}while(w.lines[S]);if(++j%5==0&&new Date-x>20){w.running=setTimeout(w.$worker,20);break}}w.currentLine=S,-1==U&&(U=S),H<=U&&w.fireUpdateEvent(H,U)}}};(function(){U.implement(this,G),this.setTokenizer=function(x){this.tokenizer=x,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(x){this.doc=x,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(x,S){var w={first:x,last:S};this._signal("update",{data:w})},this.start=function(x){this.currentLine=Math.min(x||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(x){var S=x.start.row,w=x.end.row-S;if(0===w)this.lines[S]=null;else if("remove"==x.action)this.lines.splice(S,w+1,null),this.states.splice(S,w+1,null);else{var U=Array(w+1);U.unshift(S,1),this.lines.splice.apply(this.lines,U),this.states.splice.apply(this.states,U)}this.currentLine=Math.min(S,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(x){return this.lines[x]||this.$tokenizeRow(x)},this.getState=function(x){return this.currentLine==x&&this.$tokenizeRow(x),this.states[x]||"start"},this.$tokenizeRow=function(x){var S=this.doc.getLine(x),w=this.states[x-1],U=this.tokenizer.getLineTokens(S,w,x);return this.states[x]+""!=U.state+""?(this.states[x]=U.state,this.lines[x+1]=null,this.currentLine>x+1&&(this.currentLine=x+1)):this.currentLine==x&&(this.currentLine=x+1),this.lines[x]=U.tokens}}).call(o.prototype),S.BackgroundTokenizer=o})),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(x,S,w){"use strict";var U=x("./lib/lang"),G=(x("./lib/oop"),x("./range").Range),o=function(x,S,w){this.setRegexp(x),this.clazz=S,this.type=w||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(x){this.regExp+""!=x+""&&(this.regExp=x,this.cache=[])},this.update=function(x,S,w,H){if(this.regExp)for(var z=H.firstRow,j=H.lastRow,X=z;X<=j;X++){var K=this.cache[X];null==K&&((K=U.getMatchOffsets(w.getLine(X),this.regExp)).length>this.MAX_RANGES&&(K=K.slice(0,this.MAX_RANGES)),K=K.map((function(x){return new G(X,x.offset,X,x.offset+x.length)})),this.cache[X]=K.length?K:"");for(var q=K.length;q--;)S.drawSingleLineMarker(x,K[q].toScreenRange(w),this.clazz,H)}}}).call(o.prototype),S.SearchHighlight=o})),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var U=x("../range").Range;function r(x,S){this.foldData=x,Array.isArray(S)?this.folds=S:S=this.folds=[S];var w=S[S.length-1];this.range=new U(S[0].start.row,S[0].start.column,w.end.row,w.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(x){x.setFoldLine(this)}),this)}(function(){this.shiftRow=function(x){this.start.row+=x,this.end.row+=x,this.folds.forEach((function(S){S.start.row+=x,S.end.row+=x}))},this.addFold=function(x){if(x.sameRow){if(x.start.row<this.startRow||x.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(x),this.folds.sort((function(x,S){return-x.range.compareEnd(S.start.row,S.start.column)})),this.range.compareEnd(x.start.row,x.start.column)>0?(this.end.row=x.end.row,this.end.column=x.end.column):this.range.compareStart(x.end.row,x.end.column)<0&&(this.start.row=x.start.row,this.start.column=x.start.column)}else if(x.start.row==this.end.row)this.folds.push(x),this.end.row=x.end.row,this.end.column=x.end.column;else{if(x.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(x),this.start.row=x.start.row,this.start.column=x.start.column}x.foldLine=this},this.containsRow=function(x){return x>=this.start.row&&x<=this.end.row},this.walk=function(x,S,w){var U,G,H=0,z=this.folds,j=!0;null==S&&(S=this.end.row,w=this.end.column);for(var X=0;X<z.length;X++){if(-1==(G=(U=z[X]).range.compareStart(S,w)))return void x(null,S,w,H,j);if(!x(null,U.start.row,U.start.column,H,j)&&x(U.placeholder,U.start.row,U.start.column,H)||0===G)return;j=!U.sameRow,H=U.end.column}x(null,S,w,H,j)},this.getNextFoldTo=function(x,S){for(var w,U,G=0;G<this.folds.length;G++){if(-1==(U=(w=this.folds[G]).range.compareEnd(x,S)))return{fold:w,kind:"after"};if(0===U)return{fold:w,kind:"inside"}}return null},this.addRemoveChars=function(x,S,w){var U,G,H=this.getNextFoldTo(x,S);if(H)if(U=H.fold,"inside"==H.kind&&U.start.column!=S&&U.start.row!=x)window.console&&window.console.log(x,S,U);else if(U.start.row==x){var z=(G=this.folds).indexOf(U);for(0===z&&(this.start.column+=w);z<G.length;z++){if((U=G[z]).start.column+=w,!U.sameRow)return;U.end.column+=w}this.end.column+=w}},this.split=function(x,S){var w=this.getNextFoldTo(x,S);if(!w||"inside"==w.kind)return null;var U=w.fold,G=this.folds,H=this.foldData,z=G.indexOf(U),j=G[z-1];this.end.row=j.end.row,this.end.column=j.end.column;var X=new r(H,G=G.splice(z,G.length-z));return H.splice(H.indexOf(this)+1,0,X),X},this.merge=function(x){for(var S=x.folds,w=0;w<S.length;w++)this.addFold(S[w]);var U=this.foldData;U.splice(U.indexOf(x),1)},this.toString=function(){var x=[this.range.toString()+": ["];return this.folds.forEach((function(S){x.push("  "+S.toString())})),x.push("]"),x.join("\n")},this.idxToPosition=function(x){for(var S=0,w=0;w<this.folds.length;w++){var U=this.folds[w];if((x-=U.start.column-S)<0)return{row:U.start.row,column:U.start.column+x};if((x-=U.placeholder.length)<0)return U.start;S=U.end.column}return{row:this.end.row,column:this.end.column+x}}}).call(r.prototype),S.FoldLine=r})),ace.define("ace/range_list",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var U=x("./range").Range.comparePoints,r=function(){this.ranges=[],this.$bias=1};(function(){this.comparePoints=U,this.pointIndex=function(x,S,w){for(var G=this.ranges,H=w||0;H<G.length;H++){var z=G[H],j=U(x,z.end);if(!(j>0)){var X=U(x,z.start);return 0===j?S&&0!==X?-H-2:H:X>0||0===X&&!S?H:-H-1}}return-H-1},this.add=function(x){var S=!x.isEmpty(),w=this.pointIndex(x.start,S);w<0&&(w=-w-1);var U=this.pointIndex(x.end,S,w);return U<0?U=-U-1:U++,this.ranges.splice(w,U-w,x)},this.addList=function(x){for(var S=[],w=x.length;w--;)S.push.apply(S,this.add(x[w]));return S},this.substractPoint=function(x){var S=this.pointIndex(x);if(S>=0)return this.ranges.splice(S,1)},this.merge=function(){for(var x,S=[],w=this.ranges,G=(w=w.sort((function(x,S){return U(x.start,S.start)})))[0],H=1;H<w.length;H++){x=G,G=w[H];var z=U(x.end,G.start);z<0||(0!=z||x.isEmpty()||G.isEmpty())&&(U(x.end,G.end)<0&&(x.end.row=G.end.row,x.end.column=G.end.column),w.splice(H,1),S.push(G),G=x,H--)}return this.ranges=w,S},this.contains=function(x,S){return this.pointIndex({row:x,column:S})>=0},this.containsPoint=function(x){return this.pointIndex(x)>=0},this.rangeAtPoint=function(x){var S=this.pointIndex(x);if(S>=0)return this.ranges[S]},this.clipRows=function(x,S){var w=this.ranges;if(w[0].start.row>S||w[w.length-1].start.row<x)return[];var U=this.pointIndex({row:x,column:0});U<0&&(U=-U-1);var G=this.pointIndex({row:S,column:0},U);G<0&&(G=-G-1);for(var H=[],z=U;z<G;z++)H.push(w[z]);return H},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(x){this.session&&this.detach(),this.session=x,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(x){for(var S=x.start,w=x.end,U=S.row,G=w.row,H=this.ranges,z=0,j=H.length;z<j&&!((q=H[z]).end.row>=U);z++);if("insert"==x.action){for(var X=G-U,K=-S.column+w.column;z<j&&!((q=H[z]).start.row>U);z++)if(q.start.row==U&&q.start.column>=S.column&&(q.start.column==S.column&&this.$bias<=0||(q.start.column+=K,q.start.row+=X)),q.end.row==U&&q.end.column>=S.column){if(q.end.column==S.column&&this.$bias<0)continue;q.end.column==S.column&&K>0&&z<j-1&&q.end.column>q.start.column&&q.end.column==H[z+1].start.column&&(q.end.column-=K),q.end.column+=K,q.end.row+=X}}else for(X=U-G,K=S.column-w.column;z<j&&!((q=H[z]).start.row>G);z++)q.end.row<G&&(U<q.end.row||U==q.end.row&&S.column<q.end.column)?(q.end.row=U,q.end.column=S.column):q.end.row==G?q.end.column<=w.column?(X||q.end.column>S.column)&&(q.end.column=S.column,q.end.row=S.row):(q.end.column+=K,q.end.row+=X):q.end.row>G&&(q.end.row+=X),q.start.row<G&&(U<q.start.row||U==q.start.row&&S.column<q.start.column)?(q.start.row=U,q.start.column=S.column):q.start.row==G?q.start.column<=w.column?(X||q.start.column>S.column)&&(q.start.column=S.column,q.start.row=S.row):(q.start.column+=K,q.start.row+=X):q.start.row>G&&(q.start.row+=X);if(0!=X&&z<j)for(;z<j;z++){var q;(q=H[z]).start.row+=X,q.end.row+=X}}}).call(r.prototype),S.RangeList=r})),ace.define("ace/edit_session/fold",["require","exports","module","ace/range_list","ace/lib/oop"],(function(x,S,w){"use strict";var U=x("../range_list").RangeList,G=x("../lib/oop"),H=S.Fold=function(x,S){this.foldLine=null,this.placeholder=S,this.range=x,this.start=x.start,this.end=x.end,this.sameRow=x.start.row==x.end.row,this.subFolds=this.ranges=[]};function s(x,S){x.row-=S.row,0==x.row&&(x.column-=S.column)}function a(x,S){0==x.row&&(x.column+=S.column),x.row+=S.row}G.inherits(H,U),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(x){this.foldLine=x,this.subFolds.forEach((function(S){S.setFoldLine(x)}))},this.clone=function(){var x=this.range.clone(),S=new H(x,this.placeholder);return this.subFolds.forEach((function(x){S.subFolds.push(x.clone())})),S.collapseChildren=this.collapseChildren,S},this.addSubFold=function(x){if(!this.range.isEqual(x)){var S,w;S=x,w=this.start,s(S.start,w),s(S.end,w);for(var U=x.start.row,G=x.start.column,H=0,z=-1;H<this.subFolds.length&&1==(z=this.subFolds[H].range.compare(U,G));H++);var j=this.subFolds[H],X=0;if(0==z){if(j.range.containsRange(x))return j.addSubFold(x);X=1}U=x.range.end.row,G=x.range.end.column;var K=H;for(z=-1;K<this.subFolds.length&&1==(z=this.subFolds[K].range.compare(U,G));K++);0==z&&K++;for(var q=this.subFolds.splice(H,K-H,x),Y=0==z?q.length-1:q.length,Z=X;Z<Y;Z++)x.addSubFold(q[Z]);return x.setFoldLine(this.foldLine),x}},this.restoreRange=function(x){return function(x,S){a(x.start,S),a(x.end,S)}(x,this.start)}}.call(H.prototype)})),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],(function(x,S,w){"use strict";var U=x("../range").Range,G=x("./fold_line").FoldLine,H=x("./fold").Fold,z=x("../token_iterator").TokenIterator;S.Folding=function(){this.getFoldAt=function(x,S,w){var U=this.getFoldLine(x);if(!U)return null;for(var G=U.folds,H=0;H<G.length;H++){var z=G[H].range;if(z.contains(x,S)){if(1==w&&z.isEnd(x,S)&&!z.isEmpty())continue;if(-1==w&&z.isStart(x,S)&&!z.isEmpty())continue;return G[H]}}},this.getFoldsInRange=function(x){var S=x.start,w=x.end,U=this.$foldData,G=[];S.column+=1,w.column-=1;for(var H=0;H<U.length;H++){var z=U[H].range.compareRange(x);if(2!=z){if(-2==z)break;for(var j=U[H].folds,X=0;X<j.length;X++){var K=j[X];if(-2==(z=K.range.compareRange(x)))break;if(2!=z){if(42==z)break;G.push(K)}}}}return S.column-=1,w.column+=1,G},this.getFoldsInRangeList=function(x){if(Array.isArray(x)){var S=[];x.forEach((function(x){S=S.concat(this.getFoldsInRange(x))}),this)}else S=this.getFoldsInRange(x);return S},this.getAllFolds=function(){for(var x=[],S=this.$foldData,w=0;w<S.length;w++)for(var U=0;U<S[w].folds.length;U++)x.push(S[w].folds[U]);return x},this.getFoldStringAt=function(x,S,w,U){if(!(U=U||this.getFoldLine(x)))return null;for(var G,H,z={end:{column:0}},j=0;j<U.folds.length;j++){var X=(H=U.folds[j]).range.compareEnd(x,S);if(-1==X){G=this.getLine(H.start.row).substring(z.end.column,H.start.column);break}if(0===X)return null;z=H}return G||(G=this.getLine(H.start.row).substring(z.end.column)),-1==w?G.substring(0,S-z.end.column):1==w?G.substring(S-z.end.column):G},this.getFoldLine=function(x,S){var w=this.$foldData,U=0;for(S&&(U=w.indexOf(S)),-1==U&&(U=0);U<w.length;U++){var G=w[U];if(G.start.row<=x&&G.end.row>=x)return G;if(G.end.row>x)return null}return null},this.getNextFoldLine=function(x,S){var w=this.$foldData,U=0;for(S&&(U=w.indexOf(S)),-1==U&&(U=0);U<w.length;U++){var G=w[U];if(G.end.row>=x)return G}return null},this.getFoldedRowCount=function(x,S){for(var w=this.$foldData,U=S-x+1,G=0;G<w.length;G++){var H=w[G],z=H.end.row,j=H.start.row;if(z>=S){j<S&&(j>=x?U-=S-j:U=0);break}z>=x&&(U-=j>=x?z-j:z-x+1)}return U},this.$addFoldLine=function(x){return this.$foldData.push(x),this.$foldData.sort((function(x,S){return x.start.row-S.start.row})),x},this.addFold=function(x,S){var w,U=this.$foldData,z=!1;x instanceof H?w=x:(w=new H(S,x)).collapseChildren=S.collapseChildren,this.$clipRangeToDocument(w.range);var j=w.start.row,X=w.start.column,K=w.end.row,q=w.end.column,Y=this.getFoldAt(j,X,1),Z=this.getFoldAt(K,q,-1);if(Y&&Z==Y)return Y.addSubFold(w);Y&&!Y.range.isStart(j,X)&&this.removeFold(Y),Z&&!Z.range.isEnd(K,q)&&this.removeFold(Z);var J=this.getFoldsInRange(w.range);J.length>0&&(this.removeFolds(J),J.forEach((function(x){w.addSubFold(x)})));for(var Q=0;Q<U.length;Q++){var ee=U[Q];if(K==ee.start.row){ee.addFold(w),z=!0;break}if(j==ee.end.row){if(ee.addFold(w),z=!0,!w.sameRow){var te=U[Q+1];if(te&&te.start.row==K){ee.merge(te);break}}break}if(K<=ee.start.row)break}return z||(ee=this.$addFoldLine(new G(this.$foldData,w))),this.$useWrapMode?this.$updateWrapData(ee.start.row,ee.start.row):this.$updateRowLengthCache(ee.start.row,ee.start.row),this.$modified=!0,this._signal("changeFold",{data:w,action:"add"}),w},this.addFolds=function(x){x.forEach((function(x){this.addFold(x)}),this)},this.removeFold=function(x){var S=x.foldLine,w=S.start.row,U=S.end.row,G=this.$foldData,H=S.folds;if(1==H.length)G.splice(G.indexOf(S),1);else if(S.range.isEnd(x.end.row,x.end.column))H.pop(),S.end.row=H[H.length-1].end.row,S.end.column=H[H.length-1].end.column;else if(S.range.isStart(x.start.row,x.start.column))H.shift(),S.start.row=H[0].start.row,S.start.column=H[0].start.column;else if(x.sameRow)H.splice(H.indexOf(x),1);else{var z=S.split(x.start.row,x.start.column);(H=z.folds).shift(),z.start.row=H[0].start.row,z.start.column=H[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(w,U):this.$updateRowLengthCache(w,U)),this.$modified=!0,this._signal("changeFold",{data:x,action:"remove"})},this.removeFolds=function(x){for(var S=[],w=0;w<x.length;w++)S.push(x[w]);S.forEach((function(x){this.removeFold(x)}),this),this.$modified=!0},this.expandFold=function(x){this.removeFold(x),x.subFolds.forEach((function(S){x.restoreRange(S),this.addFold(S)}),this),x.collapseChildren>0&&this.foldAll(x.start.row+1,x.end.row,x.collapseChildren-1),x.subFolds=[]},this.expandFolds=function(x){x.forEach((function(x){this.expandFold(x)}),this)},this.unfold=function(x,S){var w,G;if(null==x?(w=new U(0,0,this.getLength(),0),S=!0):w="number"==typeof x?new U(x,0,x,this.getLine(x).length):"row"in x?U.fromPoints(x,x):x,G=this.getFoldsInRangeList(w),S)this.removeFolds(G);else for(var H=G;H.length;)this.expandFolds(H),H=this.getFoldsInRangeList(w);if(G.length)return G},this.isRowFolded=function(x,S){return!!this.getFoldLine(x,S)},this.getRowFoldEnd=function(x,S){var w=this.getFoldLine(x,S);return w?w.end.row:x},this.getRowFoldStart=function(x,S){var w=this.getFoldLine(x,S);return w?w.start.row:x},this.getFoldDisplayLine=function(x,S,w,U,G){null==U&&(U=x.start.row),null==G&&(G=0),null==S&&(S=x.end.row),null==w&&(w=this.getLine(S).length);var H=this.doc,z="";return x.walk((function(x,S,w,j){if(!(S<U)){if(S==U){if(w<G)return;j=Math.max(G,j)}z+=null!=x?x:H.getLine(S).substring(j,w)}}),S,w),z},this.getDisplayLine=function(x,S,w,U){var G,H=this.getFoldLine(x);return H?this.getFoldDisplayLine(H,x,S,w,U):(G=this.doc.getLine(x)).substring(U||0,S||G.length)},this.$cloneFoldData=function(){var x=[];return x=this.$foldData.map((function(S){var w=S.folds.map((function(x){return x.clone()}));return new G(x,w)}))},this.toggleFold=function(x){var S,w,U=this.selection.getRange();if(U.isEmpty()){var G=U.start;if(S=this.getFoldAt(G.row,G.column))return void this.expandFold(S);(w=this.findMatchingBracket(G))?1==U.comparePoint(w)?U.end=w:(U.start=w,U.start.column++,U.end.column--):(w=this.findMatchingBracket({row:G.row,column:G.column+1}))?(1==U.comparePoint(w)?U.end=w:U.start=w,U.start.column++):U=this.getCommentFoldRange(G.row,G.column)||U}else{var H=this.getFoldsInRange(U);if(x&&H.length)return void this.expandFolds(H);1==H.length&&(S=H[0])}if(S||(S=this.getFoldAt(U.start.row,U.start.column)),S&&S.range.toString()==U.toString())this.expandFold(S);else{var z="...";if(!U.isMultiLine()){if((z=this.getTextRange(U)).length<4)return;z=z.trim().substring(0,2)+".."}this.addFold(z,U)}},this.getCommentFoldRange=function(x,S,w){var G=new z(this,x,S),H=G.getCurrentToken(),j=H.type;if(H&&/^comment|string/.test(j)){"comment"==(j=j.match(/comment|string/)[0])&&(j+="|doc-start");var X=new RegExp(j),K=new U;if(1!=w){do{H=G.stepBackward()}while(H&&X.test(H.type));G.stepForward()}if(K.start.row=G.getCurrentTokenRow(),K.start.column=G.getCurrentTokenColumn()+2,G=new z(this,x,S),-1!=w){var q=-1;do{if(H=G.stepForward(),-1==q){var Y=this.getState(G.$row);X.test(Y)||(q=G.$row)}else if(G.$row>q)break}while(H&&X.test(H.type));H=G.stepBackward()}else H=G.getCurrentToken();return K.end.row=G.getCurrentTokenRow(),K.end.column=G.getCurrentTokenColumn()+H.value.length-2,K}},this.foldAll=function(x,S,w){null==w&&(w=1e5);var U=this.foldWidgets;if(U){S=S||this.getLength();for(var G=x=x||0;G<S;G++)if(null==U[G]&&(U[G]=this.getFoldWidget(G)),"start"==U[G]){var H=this.getFoldWidgetRange(G);if(H&&H.isMultiLine()&&H.end.row<=S&&H.start.row>=x){G=H.end.row;try{var z=this.addFold("...",H);z&&(z.collapseChildren=w)}catch(x){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(x){if(!this.$foldStyles[x])throw new Error("invalid fold style: "+x+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=x){this.$foldStyle=x,"manual"==x&&this.unfold();var S=this.$foldMode;this.$setFolding(null),this.$setFolding(S)}},this.$setFolding=function(x){this.$foldMode!=x&&(this.$foldMode=x,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),x&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=x.getFoldWidget.bind(x,this,this.$foldStyle),this.getFoldWidgetRange=x.getFoldWidgetRange.bind(x,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(x,S){var w=this.foldWidgets;if(!w||S&&w[x])return{};for(var U,G=x-1;G>=0;){var H=w[G];if(null==H&&(H=w[G]=this.getFoldWidget(G)),"start"==H){var z=this.getFoldWidgetRange(G);if(U||(U=z),z&&z.end.row>=x)break}G--}return{range:-1!==G&&z,firstRange:U}},this.onFoldWidgetClick=function(x,S){var w={children:(S=S.domEvent).shiftKey,all:S.ctrlKey||S.metaKey,siblings:S.altKey};if(!this.$toggleFoldWidget(x,w)){var U=S.target||S.srcElement;U&&/ace_fold-widget/.test(U.className)&&(U.className+=" ace_invalid")}},this.$toggleFoldWidget=function(x,S){if(this.getFoldWidget){var w=this.getFoldWidget(x),U=this.getLine(x),G="end"===w?-1:1,H=this.getFoldAt(x,-1===G?0:U.length,G);if(H)return S.children||S.all?this.removeFold(H):this.expandFold(H),H;var z=this.getFoldWidgetRange(x,!0);if(z&&!z.isMultiLine()&&(H=this.getFoldAt(z.start.row,z.start.column,1))&&z.isEqual(H.range))return this.removeFold(H),H;if(S.siblings){var j=this.getParentFoldRangeData(x);if(j.range)var X=j.range.start.row+1,K=j.range.end.row;this.foldAll(X,K,S.all?1e4:0)}else S.children?(K=z?z.end.row:this.getLength(),this.foldAll(x+1,K,S.all?1e4:0)):z&&(S.all&&(z.collapseChildren=1e4),this.addFold("...",z));return z}},this.toggleFoldWidget=function(x){var S=this.selection.getCursor().row;S=this.getRowFoldStart(S);var w=this.$toggleFoldWidget(S,{});if(!w){var U=this.getParentFoldRangeData(S,!0);if(w=U.range||U.firstRange){S=w.start.row;var G=this.getFoldAt(S,this.getLine(S).length,1);G?this.removeFold(G):this.addFold("...",w)}}},this.updateFoldWidgets=function(x){var S=x.start.row,w=x.end.row-S;if(0===w)this.foldWidgets[S]=null;else if("remove"==x.action)this.foldWidgets.splice(S,w+1,null);else{var U=Array(w+1);U.unshift(S,1),this.foldWidgets.splice.apply(this.foldWidgets,U)}},this.tokenizerUpdateFoldWidgets=function(x){var S=x.data;S.first!=S.last&&this.foldWidgets.length>S.first&&this.foldWidgets.splice(S.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],(function(x,S,w){"use strict";var U=x("../token_iterator").TokenIterator,G=x("../range").Range;S.BracketMatch=function(){this.findMatchingBracket=function(x,S){if(0==x.column)return null;var w=S||this.getLine(x.row).charAt(x.column-1);if(""==w)return null;var U=w.match(/([\(\[\{])|([\)\]\}])/);return U?U[1]?this.$findClosingBracket(U[1],x):this.$findOpeningBracket(U[2],x):null},this.getBracketRange=function(x){var S,w=this.getLine(x.row),U=!0,H=w.charAt(x.column-1),z=H&&H.match(/([\(\[\{])|([\)\]\}])/);if(z||(H=w.charAt(x.column),x={row:x.row,column:x.column+1},z=H&&H.match(/([\(\[\{])|([\)\]\}])/),U=!1),!z)return null;if(z[1]){if(!(j=this.$findClosingBracket(z[1],x)))return null;S=G.fromPoints(x,j),U||(S.end.column++,S.start.column--),S.cursor=S.end}else{var j;if(!(j=this.$findOpeningBracket(z[2],x)))return null;S=G.fromPoints(j,x),U||(S.start.column++,S.end.column--),S.cursor=S.start}return S},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(x,S,w){var G=this.$brackets[x],H=1,z=new U(this,S.row,S.column),j=z.getCurrentToken();if(j||(j=z.stepForward()),j){w||(w=new RegExp("(\\.?"+j.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var X=S.column-z.getCurrentTokenColumn()-2,K=j.value;;){for(;X>=0;){var q=K.charAt(X);if(q==G){if(0==(H-=1))return{row:z.getCurrentTokenRow(),column:X+z.getCurrentTokenColumn()}}else q==x&&(H+=1);X-=1}do{j=z.stepBackward()}while(j&&!w.test(j.type));if(null==j)break;X=(K=j.value).length-1}return null}},this.$findClosingBracket=function(x,S,w){var G=this.$brackets[x],H=1,z=new U(this,S.row,S.column),j=z.getCurrentToken();if(j||(j=z.stepForward()),j){w||(w=new RegExp("(\\.?"+j.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var X=S.column-z.getCurrentTokenColumn();;){for(var K=j.value,q=K.length;X<q;){var Y=K.charAt(X);if(Y==G){if(0==(H-=1))return{row:z.getCurrentTokenRow(),column:X+z.getCurrentTokenColumn()}}else Y==x&&(H+=1);X+=1}do{j=z.stepForward()}while(j&&!w.test(j.type));if(null==j)break;X=0}return null}}}})),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/lang"),H=x("./bidihandler").BidiHandler,z=x("./config"),j=x("./lib/event_emitter").EventEmitter,X=x("./selection").Selection,K=x("./mode/text").Mode,q=x("./range").Range,Y=x("./document").Document,Z=x("./background_tokenizer").BackgroundTokenizer,J=x("./search_highlight").SearchHighlight,m=function(x,S){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++m.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof x&&x.getLine||(x=new Y(x)),this.setDocument(x),this.selection=new X(this),this.$bidiHandler=new H(this),z.resetOptions(this),this.setMode(S),z._signal("session",this)};m.$uid=0,function(){U.implement(this,j),this.setDocument=function(x){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=x,x.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(x){if(!x)return this.$docRowCache=[],void(this.$screenRowCache=[]);var S=this.$docRowCache.length,w=this.$getRowCacheIndex(this.$docRowCache,x)+1;S>w&&(this.$docRowCache.splice(w,S),this.$screenRowCache.splice(w,S))},this.$getRowCacheIndex=function(x,S){for(var w=0,U=x.length-1;w<=U;){var G=w+U>>1,H=x[G];if(S>H)w=G+1;else{if(!(S<H))return G;U=G-1}}return w-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(x){var S=x.data;this.$resetRowCache(S.start.row)},this.onChange=function(x){this.$modified=!0,this.$bidiHandler.onChange(x),this.$resetRowCache(x.start.row);var S=this.$updateInternalDataOnChange(x);!this.$fromUndo&&this.$undoManager&&(S&&S.length&&(this.$undoManager.add({action:"removeFolds",folds:S},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(x,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(x),this._signal("change",x)},this.setValue=function(x){this.doc.setValue(x),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(x){return this.bgTokenizer.getState(x)},this.getTokens=function(x){return this.bgTokenizer.getTokens(x)},this.getTokenAt=function(x,S){var w,U=this.bgTokenizer.getTokens(x),G=0;if(null==S){var H=U.length-1;G=this.getLine(x).length}else for(H=0;H<U.length&&!((G+=U[H].value.length)>=S);H++);return(w=U[H])?(w.index=H,w.start=G-w.value.length,w):null},this.setUndoManager=function(x){if(this.$undoManager=x,this.$informUndoManager&&this.$informUndoManager.cancel(),x){var S=this;x.addSession(this),this.$syncInformUndoManager=function(){S.$informUndoManager.cancel(),S.mergeUndoDeltas=!1},this.$informUndoManager=G.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},hasUndo:function(){},hasRedo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?G.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(x){this.setOption("useSoftTabs",x)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(x){this.setOption("tabSize",x)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(x){return this.$useSoftTabs&&x.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(x){this.setOption("navigateWithinSoftTabs",x)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(x){this.setOption("overwrite",x)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(x,S){this.$decorations[x]||(this.$decorations[x]=""),this.$decorations[x]+=" "+S,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(x,S){this.$decorations[x]=(this.$decorations[x]||"").replace(" "+S,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(x){this.$breakpoints=[];for(var S=0;S<x.length;S++)this.$breakpoints[x[S]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(x,S){void 0===S&&(S="ace_breakpoint"),S?this.$breakpoints[x]=S:delete this.$breakpoints[x],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(x){delete this.$breakpoints[x],this._signal("changeBreakpoint",{})},this.addMarker=function(x,S,w,U){var G=this.$markerId++,H={range:x,type:w||"line",renderer:"function"==typeof w?w:null,clazz:S,inFront:!!U,id:G};return U?(this.$frontMarkers[G]=H,this._signal("changeFrontMarker")):(this.$backMarkers[G]=H,this._signal("changeBackMarker")),G},this.addDynamicMarker=function(x,S){if(x.update){var w=this.$markerId++;return x.id=w,x.inFront=!!S,S?(this.$frontMarkers[w]=x,this._signal("changeFrontMarker")):(this.$backMarkers[w]=x,this._signal("changeBackMarker")),x}},this.removeMarker=function(x){var S=this.$frontMarkers[x]||this.$backMarkers[x];S&&(delete(S.inFront?this.$frontMarkers:this.$backMarkers)[x],this._signal(S.inFront?"changeFrontMarker":"changeBackMarker"))},this.getMarkers=function(x){return x?this.$frontMarkers:this.$backMarkers},this.highlight=function(x){if(!this.$searchHighlight){var S=new J(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(S)}this.$searchHighlight.setRegexp(x)},this.highlightLines=function(x,S,w,U){"number"!=typeof S&&(w=S,S=x),w||(w="ace_step");var G=new q(x,0,S,1/0);return G.id=this.addMarker(G,w,"fullLine",U),G},this.setAnnotations=function(x){this.$annotations=x,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(x){var S=x.match(/^.*?(\r?\n)/m);this.$autoNewLine=S?S[1]:"\n"},this.getWordRange=function(x,S){var w=this.getLine(x),U=!1;if(S>0&&(U=!!w.charAt(S-1).match(this.tokenRe)),U||(U=!!w.charAt(S).match(this.tokenRe)),U)var G=this.tokenRe;else G=/^\s+$/.test(w.slice(S-1,S+1))?/\s/:this.nonTokenRe;var H=S;if(H>0){do{H--}while(H>=0&&w.charAt(H).match(G));H++}for(var z=S;z<w.length&&w.charAt(z).match(G);)z++;return new q(x,H,x,z)},this.getAWordRange=function(x,S){for(var w=this.getWordRange(x,S),U=this.getLine(w.end.row);U.charAt(w.end.column).match(/[ \t]/);)w.end.column+=1;return w},this.setNewLineMode=function(x){this.doc.setNewLineMode(x)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(x){this.setOption("useWorker",x)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(x){var S=x.data;this.bgTokenizer.start(S.first),this._signal("tokenizerUpdate",x)},this.$modes=z.$modes,this.$mode=null,this.$modeId=null,this.setMode=function(x,S){if(x&&"object"==typeof x){if(x.getTokenizer)return this.$onChangeMode(x);var w=x,U=w.path}else U=x||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new K),this.$modes[U]&&!w)return this.$onChangeMode(this.$modes[U]),void(S&&S());this.$modeId=U,z.loadModule(["mode",U],function(x){if(this.$modeId!==U)return S&&S();this.$modes[U]&&!w?this.$onChangeMode(this.$modes[U]):x&&x.Mode&&(x=new x.Mode(w),w||(this.$modes[U]=x,x.$id=U),this.$onChangeMode(x)),S&&S()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(x,S){if(S||(this.$modeId=x.$id),this.$mode!==x){this.$mode=x,this.$stopWorker(),this.$useWorker&&this.$startWorker();var w=x.getTokenizer();if(void 0!==w.addEventListener){var U=this.onReloadTokenizer.bind(this);w.addEventListener("update",U)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(w);else{this.bgTokenizer=new Z(w);var G=this;this.bgTokenizer.addEventListener("update",(function(x){G._signal("tokenizerUpdate",x)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=x.tokenRe,this.nonTokenRe=x.nonTokenRe,S||(x.attachToSession&&x.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(x.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(x){z.warn("Could not load worker",x),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(x){this.$scrollTop===x||isNaN(x)||(this.$scrollTop=x,this._signal("changeScrollTop",x))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(x){this.$scrollLeft===x||isNaN(x)||(this.$scrollLeft=x,this._signal("changeScrollLeft",x))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var x=0;return this.lineWidgets.forEach((function(S){S&&S.screenWidth>x&&(x=S.screenWidth)})),this.lineWidgetWidth=x},this.$computeWidth=function(x){if(this.$modified||x){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var S=this.doc.getAllLines(),w=this.$rowLengthCache,U=0,G=0,H=this.$foldData[G],z=H?H.start.row:1/0,j=S.length,X=0;X<j;X++){if(X>z){if((X=H.end.row+1)>=j)break;z=(H=this.$foldData[G++])?H.start.row:1/0}null==w[X]&&(w[X]=this.$getStringScreenWidth(S[X])[0]),w[X]>U&&(U=w[X])}this.screenWidth=U}},this.getLine=function(x){return this.doc.getLine(x)},this.getLines=function(x,S){return this.doc.getLines(x,S)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(x){return this.doc.getTextRange(x||this.selection.getRange())},this.insert=function(x,S){return this.doc.insert(x,S)},this.remove=function(x){return this.doc.remove(x)},this.removeFullLines=function(x,S){return this.doc.removeFullLines(x,S)},this.undoChanges=function(x,S){if(x.length){this.$fromUndo=!0;for(var w=x.length-1;-1!=w;w--){var U=x[w];"insert"==U.action||"remove"==U.action?this.doc.revertDelta(U):U.folds&&this.addFolds(U.folds)}!S&&this.$undoSelect&&(x.selectionBefore?this.selection.fromJSON(x.selectionBefore):this.selection.setRange(this.$getUndoSelection(x,!0))),this.$fromUndo=!1}},this.redoChanges=function(x,S){if(x.length){this.$fromUndo=!0;for(var w=0;w<x.length;w++){var U=x[w];"insert"!=U.action&&"remove"!=U.action||this.doc.applyDelta(U)}!S&&this.$undoSelect&&(x.selectionAfter?this.selection.fromJSON(x.selectionAfter):this.selection.setRange(this.$getUndoSelection(x,!1))),this.$fromUndo=!1}},this.setUndoSelect=function(x){this.$undoSelect=x},this.$getUndoSelection=function(x,S){function n(x){return S?"insert"!==x.action:"insert"===x.action}for(var w,U,G=0;G<x.length;G++){var H=x[G];H.start&&(w?n(H)?(U=H.start,-1==w.compare(U.row,U.column)&&w.setStart(U),U=H.end,1==w.compare(U.row,U.column)&&w.setEnd(U)):(U=H.start,-1==w.compare(U.row,U.column)&&(w=q.fromPoints(H.start,H.start))):w=n(H)?q.fromPoints(H.start,H.end):q.fromPoints(H.start,H.start))}return w},this.replace=function(x,S){return this.doc.replace(x,S)},this.moveText=function(x,S,w){var U=this.getTextRange(x),G=this.getFoldsInRange(x),H=q.fromPoints(S,S);if(!w){this.remove(x);var z=x.start.row-x.end.row;(K=z?-x.end.column:x.start.column-x.end.column)&&(H.start.row==x.end.row&&H.start.column>x.end.column&&(H.start.column+=K),H.end.row==x.end.row&&H.end.column>x.end.column&&(H.end.column+=K)),z&&H.start.row>=x.end.row&&(H.start.row+=z,H.end.row+=z)}if(H.end=this.insert(H.start,U),G.length){var j=x.start,X=H.start,K=(z=X.row-j.row,X.column-j.column);this.addFolds(G.map((function(x){return(x=x.clone()).start.row==j.row&&(x.start.column+=K),x.end.row==j.row&&(x.end.column+=K),x.start.row+=z,x.end.row+=z,x})))}return H},this.indentRows=function(x,S,w){w=w.replace(/\t/g,this.getTabString());for(var U=x;U<=S;U++)this.doc.insertInLine({row:U,column:0},w)},this.outdentRows=function(x){for(var S=x.collapseRows(),w=new q(0,0,0,0),U=this.getTabSize(),G=S.start.row;G<=S.end.row;++G){var H=this.getLine(G);w.start.row=G,w.end.row=G;for(var z=0;z<U&&" "==H.charAt(z);++z);z<U&&"\t"==H.charAt(z)?(w.start.column=z,w.end.column=z+1):(w.start.column=0,w.end.column=z),this.remove(w)}},this.$moveLines=function(x,S,w){if(x=this.getRowFoldStart(x),S=this.getRowFoldEnd(S),w<0){if((G=this.getRowFoldStart(x+w))<0)return 0;var U=G-x}else if(w>0){var G;if((G=this.getRowFoldEnd(S+w))>this.doc.getLength()-1)return 0;U=G-S}else x=this.$clipRowToDocument(x),U=(S=this.$clipRowToDocument(S))-x+1;var H=new q(x,0,S,Number.MAX_VALUE),z=this.getFoldsInRange(H).map((function(x){return(x=x.clone()).start.row+=U,x.end.row+=U,x})),j=0==w?this.doc.getLines(x,S):this.doc.removeFullLines(x,S);return this.doc.insertFullLines(x+U,j),z.length&&this.addFolds(z),U},this.moveLinesUp=function(x,S){return this.$moveLines(x,S,-1)},this.moveLinesDown=function(x,S){return this.$moveLines(x,S,1)},this.duplicateLines=function(x,S){return this.$moveLines(x,S,0)},this.$clipRowToDocument=function(x){return Math.max(0,Math.min(x,this.doc.getLength()-1))},this.$clipColumnToRow=function(x,S){return S<0?0:Math.min(this.doc.getLine(x).length,S)},this.$clipPositionToDocument=function(x,S){if(S=Math.max(0,S),x<0)x=0,S=0;else{var w=this.doc.getLength();x>=w?(x=w-1,S=this.doc.getLine(w-1).length):S=Math.min(this.doc.getLine(x).length,S)}return{row:x,column:S}},this.$clipRangeToDocument=function(x){x.start.row<0?(x.start.row=0,x.start.column=0):x.start.column=this.$clipColumnToRow(x.start.row,x.start.column);var S=this.doc.getLength()-1;return x.end.row>S?(x.end.row=S,x.end.column=this.doc.getLine(S).length):x.end.column=this.$clipColumnToRow(x.end.row,x.end.column),x},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(x){if(x!=this.$useWrapMode){if(this.$useWrapMode=x,this.$modified=!0,this.$resetRowCache(0),x){var S=this.getLength();this.$wrapData=Array(S),this.$updateWrapData(0,S-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(x,S){this.$wrapLimitRange.min===x&&this.$wrapLimitRange.max===S||(this.$wrapLimitRange={min:x,max:S},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(x,S){var w=this.$wrapLimitRange;w.max<0&&(w={min:S,max:S});var U=this.$constrainWrapLimit(x,w.min,w.max);return U!=this.$wrapLimit&&U>1&&(this.$wrapLimit=U,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(x,S,w){return S&&(x=Math.max(S,x)),w&&(x=Math.min(w,x)),x},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(x){this.setWrapLimitRange(x,x)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(x){var S=this.$useWrapMode,w=x.action,U=x.start,G=x.end,H=U.row,z=G.row,j=z-H,X=null;if(this.$updating=!0,0!=j)if("remove"===w){this[S?"$wrapData":"$rowLengthCache"].splice(H,j);var K=this.$foldData;X=this.getFoldsInRange(x),this.removeFolds(X);var q=0;if(ee=this.getFoldLine(G.row)){ee.addRemoveChars(G.row,G.column,U.column-G.column),ee.shiftRow(-j);var Y=this.getFoldLine(H);Y&&Y!==ee&&(Y.merge(ee),ee=Y),q=K.indexOf(ee)+1}for(;q<K.length;q++)(ee=K[q]).start.row>=G.row&&ee.shiftRow(-j);z=H}else{var Z=Array(j);Z.unshift(H,0);var J=S?this.$wrapData:this.$rowLengthCache;if(J.splice.apply(J,Z),K=this.$foldData,q=0,ee=this.getFoldLine(H)){var Q=ee.range.compareInside(U.row,U.column);0==Q?(ee=ee.split(U.row,U.column))&&(ee.shiftRow(j),ee.addRemoveChars(z,0,G.column-U.column)):-1==Q&&(ee.addRemoveChars(H,0,G.column-U.column),ee.shiftRow(j)),q=K.indexOf(ee)+1}for(;q<K.length;q++){var ee;(ee=K[q]).start.row>=H&&ee.shiftRow(j)}}else j=Math.abs(x.start.column-x.end.column),"remove"===w&&(X=this.getFoldsInRange(x),this.removeFolds(X),j=-j),(ee=this.getFoldLine(H))&&ee.addRemoveChars(H,U.column,j);return S&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,S?this.$updateWrapData(H,z):this.$updateRowLengthCache(H,z),X},this.$updateRowLengthCache=function(x,S,w){this.$rowLengthCache[x]=null,this.$rowLengthCache[S]=null},this.$updateWrapData=function(w,U){var G,H,z=this.doc.getAllLines(),j=this.getTabSize(),X=this.$wrapData,K=this.$wrapLimit,q=w;for(U=Math.min(U,z.length-1);q<=U;)(H=this.getFoldLine(q,H))?(G=[],H.walk(function(w,U,H,j){var X;if(null!=w){(X=this.$getDisplayTokens(w,G.length))[0]=x;for(var K=1;K<X.length;K++)X[K]=S}else X=this.$getDisplayTokens(z[U].substring(j,H),G.length);G=G.concat(X)}.bind(this),H.end.row,z[H.end.row].length+1),X[H.start.row]=this.$computeWrapSplits(G,K,j),q=H.end.row+1):(G=this.$getDisplayTokens(z[q]),X[q]=this.$computeWrapSplits(G,K,j),q++)};var x=3,S=4;function n(x){return!(x<4352)&&(x>=4352&&x<=4447||x>=4515&&x<=4519||x>=4602&&x<=4607||x>=9001&&x<=9002||x>=11904&&x<=11929||x>=11931&&x<=12019||x>=12032&&x<=12245||x>=12272&&x<=12283||x>=12288&&x<=12350||x>=12353&&x<=12438||x>=12441&&x<=12543||x>=12549&&x<=12589||x>=12593&&x<=12686||x>=12688&&x<=12730||x>=12736&&x<=12771||x>=12784&&x<=12830||x>=12832&&x<=12871||x>=12880&&x<=13054||x>=13056&&x<=19903||x>=19968&&x<=42124||x>=42128&&x<=42182||x>=43360&&x<=43388||x>=44032&&x<=55203||x>=55216&&x<=55238||x>=55243&&x<=55291||x>=63744&&x<=64255||x>=65040&&x<=65049||x>=65072&&x<=65106||x>=65108&&x<=65126||x>=65128&&x<=65131||x>=65281&&x<=65376||x>=65504&&x<=65510)}this.$computeWrapSplits=function(w,U,G){if(0==w.length)return[];var H=[],z=w.length,j=0,X=0,K=this.$wrapAsCode,q=this.$indentedSoftWrap,Y=U<=Math.max(2*G,8)||!1===q?0:Math.floor(U/2);function d(x){for(var S=x-j,U=j;U<x;U++){var z=w[U];12!==z&&2!==z||(S-=1)}H.length||(Z=function(){var x=0;if(0===Y)return x;if(q)for(var S=0;S<w.length;S++){var U=w[S];if(10==U)x+=1;else{if(11!=U){if(12==U)continue;break}x+=G}}return K&&!1!==q&&(x+=G),Math.min(x,Y)}(),H.indent=Z),X+=S,H.push(X),j=x}for(var Z=0;z-j>U-Z;){var J=j+U-Z;if(w[J-1]>=10&&w[J]>=10)d(J);else if(w[J]!=x&&w[J]!=S){for(var Q=Math.max(J-(U-(U>>2)),j-1);J>Q&&w[J]<x;)J--;if(K){for(;J>Q&&w[J]<x;)J--;for(;J>Q&&9==w[J];)J--}else for(;J>Q&&w[J]<10;)J--;J>Q?d(++J):(2==w[J=j+U]&&J--,d(J-Z))}else{for(;J!=j-1&&w[J]!=x;J--);if(J>j){d(J);continue}for(J=j+U;J<w.length&&w[J]==S;J++);if(J==w.length)break;d(J)}}return H},this.$getDisplayTokens=function(x,S){var w,U=[];S=S||0;for(var G=0;G<x.length;G++){var H=x.charCodeAt(G);if(9==H){w=this.getScreenTabSize(U.length+S),U.push(11);for(var z=1;z<w;z++)U.push(12)}else 32==H?U.push(10):H>39&&H<48||H>57&&H<64?U.push(9):H>=4352&&n(H)?U.push(1,2):U.push(1)}return U},this.$getStringScreenWidth=function(x,S,w){if(0==S)return[0,0];var U,G;for(null==S&&(S=1/0),w=w||0,G=0;G<x.length&&(9==(U=x.charCodeAt(G))?w+=this.getScreenTabSize(w):U>=4352&&n(U)?w+=2:w+=1,!(w>S));G++);return[w,G]},this.lineWidgets=null,this.getRowLength=function(x){if(this.lineWidgets)var S=this.lineWidgets[x]&&this.lineWidgets[x].rowCount||0;else S=0;return this.$useWrapMode&&this.$wrapData[x]?this.$wrapData[x].length+1+S:1+S},this.getRowLineCount=function(x){return this.$useWrapMode&&this.$wrapData[x]?this.$wrapData[x].length+1:1},this.getRowWrapIndent=function(x){if(this.$useWrapMode){var S=this.screenToDocumentPosition(x,Number.MAX_VALUE),w=this.$wrapData[S.row];return w.length&&w[0]<S.column?w.indent:0}return 0},this.getScreenLastRowColumn=function(x){var S=this.screenToDocumentPosition(x,Number.MAX_VALUE);return this.documentToScreenColumn(S.row,S.column)},this.getDocumentLastRowColumn=function(x,S){var w=this.documentToScreenRow(x,S);return this.getScreenLastRowColumn(w)},this.getDocumentLastRowColumnPosition=function(x,S){var w=this.documentToScreenRow(x,S);return this.screenToDocumentPosition(w,Number.MAX_VALUE/10)},this.getRowSplitData=function(x){return this.$useWrapMode?this.$wrapData[x]:void 0},this.getScreenTabSize=function(x){return this.$tabSize-(x%this.$tabSize|0)},this.screenToDocumentRow=function(x,S){return this.screenToDocumentPosition(x,S).row},this.screenToDocumentColumn=function(x,S){return this.screenToDocumentPosition(x,S).column},this.screenToDocumentPosition=function(x,S,w){if(x<0)return{row:0,column:0};var U,G,H=0,z=0,j=0,X=0,K=this.$screenRowCache,q=this.$getRowCacheIndex(K,x),Y=K.length;if(Y&&q>=0){j=K[q],H=this.$docRowCache[q];var Z=x>K[Y-1]}else Z=!Y;for(var J=this.getLength()-1,Q=this.getNextFoldLine(H),ee=Q?Q.start.row:1/0;j<=x&&!(j+(X=this.getRowLength(H))>x||H>=J);)j+=X,++H>ee&&(H=Q.end.row+1,ee=(Q=this.getNextFoldLine(H,Q))?Q.start.row:1/0),Z&&(this.$docRowCache.push(H),this.$screenRowCache.push(j));if(Q&&Q.start.row<=H)U=this.getFoldDisplayLine(Q),H=Q.start.row;else{if(j+X<=x||H>J)return{row:J,column:this.getLine(J).length};U=this.getLine(H),Q=null}var te=0,ne=Math.floor(x-j);if(this.$useWrapMode){var ie=this.$wrapData[H];ie&&(G=ie[ne],ne>0&&ie.length&&(te=ie.indent,z=ie[ne-1]||ie[ie.length-1],U=U.substring(z)))}return void 0!==w&&this.$bidiHandler.isBidiRow(j+ne,H,ne)&&(S=this.$bidiHandler.offsetToCol(w)),z+=this.$getStringScreenWidth(U,S-te)[1],this.$useWrapMode&&z>=G&&(z=G-1),Q?Q.idxToPosition(z):{row:H,column:z}},this.documentToScreenPosition=function(x,S){if(void 0===S)var w=this.$clipPositionToDocument(x.row,x.column);else w=this.$clipPositionToDocument(x,S);x=w.row,S=w.column;var U,G=0,H=null;(U=this.getFoldAt(x,S,1))&&(x=U.start.row,S=U.start.column);var z,j=0,X=this.$docRowCache,K=this.$getRowCacheIndex(X,x),q=X.length;if(q&&K>=0){j=X[K],G=this.$screenRowCache[K];var Y=x>X[q-1]}else Y=!q;for(var Z=this.getNextFoldLine(j),J=Z?Z.start.row:1/0;j<x;){if(j>=J){if((z=Z.end.row+1)>x)break;J=(Z=this.getNextFoldLine(z,Z))?Z.start.row:1/0}else z=j+1;G+=this.getRowLength(j),j=z,Y&&(this.$docRowCache.push(j),this.$screenRowCache.push(G))}var Q="";Z&&j>=J?(Q=this.getFoldDisplayLine(Z,x,S),H=Z.start.row):(Q=this.getLine(x).substring(0,S),H=x);var ee=0;if(this.$useWrapMode){var te=this.$wrapData[H];if(te){for(var ne=0;Q.length>=te[ne];)G++,ne++;Q=Q.substring(te[ne-1]||0,Q.length),ee=ne>0?te.indent:0}}return{row:G,column:ee+this.$getStringScreenWidth(Q)[0]}},this.documentToScreenColumn=function(x,S){return this.documentToScreenPosition(x,S).column},this.documentToScreenRow=function(x,S){return this.documentToScreenPosition(x,S).row},this.getScreenLength=function(){var x=0,S=null;if(this.$useWrapMode)for(var w=this.$wrapData.length,U=0,G=(j=0,(S=this.$foldData[j++])?S.start.row:1/0);U<w;){var H=this.$wrapData[U];x+=H?H.length+1:1,++U>G&&(U=S.end.row+1,G=(S=this.$foldData[j++])?S.start.row:1/0)}else{x=this.getLength();for(var z=this.$foldData,j=0;j<z.length;j++)x-=(S=z[j]).end.row-S.start.row}return this.lineWidgets&&(x+=this.$getWidgetScreenLength()),x},this.$setFontMetrics=function(x){this.$enableVarChar&&(this.$getStringScreenWidth=function(S,w,U){if(0===w)return[0,0];var G,H;for(w||(w=1/0),U=U||0,H=0;H<S.length&&!((U+="\t"===(G=S.charAt(H))?this.getScreenTabSize(U):x.getCharacterWidth(G))>w);H++);return[U,H]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=n}.call(m.prototype),x("./edit_session/folding").Folding.call(m.prototype),x("./edit_session/bracket_match").BracketMatch.call(m.prototype),z.defineOptions(m.prototype,"session",{wrap:{set:function(x){if(x&&"off"!=x?"free"==x?x=!0:"printMargin"==x?x=-1:"string"==typeof x&&(x=parseInt(x,10)||!1):x=!1,this.$wrap!=x)if(this.$wrap=x,x){var S="number"==typeof x?x:null;this.setWrapLimitRange(S,S),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(x){(x="auto"==x?"text"!=this.$mode.type:"text"!=x)!=this.$wrapAsCode&&(this.$wrapAsCode=x,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(x){this.$useWorker=x,this.$stopWorker(),x&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(x){(x=parseInt(x))>0&&this.$tabSize!==x&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=x,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(x){this.setFoldStyle(x)},handlesSet:!0},overwrite:{set:function(x){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(x){this.doc.setNewLineMode(x)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(x){this.setMode(x)},get:function(){return this.$modeId},handlesSet:!0}}),S.EditSession=m})),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(x,S,w){"use strict";var U=x("./lib/lang"),G=x("./lib/oop"),H=x("./range").Range,s=function(){this.$options={}};(function(){this.set=function(x){return G.mixin(this.$options,x),this},this.getOptions=function(){return U.copyObject(this.$options)},this.setOptions=function(x){this.$options=x},this.find=function(x){var S=this.$options,w=this.$matchIterator(x,S);if(!w)return!1;var U=null;return w.forEach((function(x,w,G,z){return U=new H(x,w,G,z),!(w==z&&S.start&&S.start.start&&0!=S.skipCurrent&&U.isEqual(S.start)&&(U=null,1))})),U},this.findAll=function(x){var S=this.$options;if(!S.needle)return[];this.$assembleRegExp(S);var w=S.range,G=w?x.getLines(w.start.row,w.end.row):x.doc.getAllLines(),z=[],j=S.re;if(S.$isMultiLine){var X,K=j.length,q=G.length-K;e:for(var Y=j.offset||0;Y<=q;Y++){for(var Z=0;Z<K;Z++)if(-1==G[Y+Z].search(j[Z]))continue e;var J=G[Y],Q=G[Y+K-1],ee=J.length-J.match(j[0])[0].length,te=Q.match(j[K-1])[0].length;X&&X.end.row===Y&&X.end.column>ee||(z.push(X=new H(Y,ee,Y+K-1,te)),K>2&&(Y=Y+K-2))}}else for(var ne=0;ne<G.length;ne++){var ie=U.getMatchOffsets(G[ne],j);for(Z=0;Z<ie.length;Z++){var re=ie[Z];z.push(new H(ne,re.offset,ne,re.offset+re.length))}}if(w){var oe=w.start.column,ae=w.start.column;for(ne=0,Z=z.length-1;ne<Z&&z[ne].start.column<oe&&z[ne].start.row==w.start.row;)ne++;for(;ne<Z&&z[Z].end.column>ae&&z[Z].end.row==w.end.row;)Z--;for(z=z.slice(ne,Z+1),ne=0,Z=z.length;ne<Z;ne++)z[ne].start.row+=w.start.row,z[ne].end.row+=w.start.row}return z},this.replace=function(x,S){var w=this.$options,U=this.$assembleRegExp(w);if(w.$isMultiLine)return S;if(U){var G=U.exec(x);if(!G||G[0].length!=x.length)return null;if(S=x.replace(U,S),w.preserveCase){S=S.split("");for(var H=Math.min(x.length,x.length);H--;){var z=x[H];z&&z.toLowerCase()!=z?S[H]=S[H].toUpperCase():S[H]=S[H].toLowerCase()}S=S.join("")}return S}},this.$assembleRegExp=function(x,S){if(x.needle instanceof RegExp)return x.re=x.needle;var w=x.needle;if(!x.needle)return x.re=!1;x.regExp||(w=U.escapeRegExp(w)),x.wholeWord&&(w=function(x,S){function n(x){return/\w/.test(x)||S.regExp?"\\b":""}return n(x[0])+x+n(x[x.length-1])}(w,x));var G=x.caseSensitive?"gm":"gmi";if(x.$isMultiLine=!S&&/[\n\r]/.test(w),x.$isMultiLine)return x.re=this.$assembleMultilineRegExp(w,G);try{var H=new RegExp(w,G)}catch(x){H=!1}return x.re=H},this.$assembleMultilineRegExp=function(x,S){for(var w=x.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),U=[],G=0;G<w.length;G++)try{U.push(new RegExp(w[G],S))}catch(x){return!1}return U},this.$matchIterator=function(x,S){var w=this.$assembleRegExp(S);if(!w)return!1;var U=1==S.backwards,G=0!=S.skipCurrent,H=S.range,z=S.start;z||(z=H?H[U?"end":"start"]:x.selection.getRange()),z.start&&(z=z[G!=U?"end":"start"]);var j=H?H.start.row:0,X=H?H.end.row:x.getLength()-1;if(U)var l=function(x){var w=z.row;if(!h(w,z.column,x)){for(w--;w>=j;w--)if(h(w,Number.MAX_VALUE,x))return;if(0!=S.wrap)for(w=X,j=z.row;w>=j;w--)if(h(w,Number.MAX_VALUE,x))return}};else l=function(x){var w=z.row;if(!h(w,z.column,x)){for(w+=1;w<=X;w++)if(h(w,0,x))return;if(0!=S.wrap)for(w=j,X=z.row;w<=X;w++)if(h(w,0,x))return}};if(S.$isMultiLine)var K=w.length,h=function(S,G,H){var z=U?S-K+1:S;if(!(z<0)){var j=x.getLine(z),X=j.search(w[0]);if(!(!U&&X<G||-1===X)){for(var q=1;q<K;q++)if(-1==(j=x.getLine(z+q)).search(w[q]))return;var Y=j.match(w[K-1])[0].length;if(!(U&&Y>G))return!!H(z,X,z+K-1,Y)||void 0}}};else h=U?function(S,U,G){var H,z=x.getLine(S),j=[],X=0;for(w.lastIndex=0;H=w.exec(z);){var K=H[0].length;if(X=H.index,!K){if(X>=z.length)break;w.lastIndex=X+=1}if(H.index+K>U)break;j.push(H.index,K)}for(var q=j.length-1;q>=0;q-=2){var Y=j[q-1];if(G(S,Y,S,Y+(K=j[q])))return!0}}:function(S,U,G){var H,z,j=x.getLine(S);for(w.lastIndex=U;z=w.exec(j);){var X=z[0].length;if(G(S,H=z.index,S,H+X))return!0;if(!X&&(w.lastIndex=H+=1,H>=j.length))return!1}};return{forEach:l}}}).call(s.prototype),S.Search=s})),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("../lib/keys"),G=x("../lib/useragent"),H=U.KEY_MODS;function s(x,S){this.platform=S||(G.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(x),this.$singleCommand=!0}function a(x,S){s.call(this,x,S),this.$singleCommand=!1}a.prototype=s.prototype,function(){function e(x){return"object"==typeof x&&x.bindKey&&x.bindKey.position||(x.isDefault?-100:0)}this.addCommand=function(x){this.commands[x.name]&&this.removeCommand(x),this.commands[x.name]=x,x.bindKey&&this._buildKeyHash(x)},this.removeCommand=function(x,S){var w=x&&("string"==typeof x?x:x.name);x=this.commands[w],S||delete this.commands[w];var U=this.commandKeyBinding;for(var G in U){var H=U[G];if(H==x)delete U[G];else if(Array.isArray(H)){var z=H.indexOf(x);-1!=z&&(H.splice(z,1),1==H.length&&(U[G]=H[0]))}}},this.bindKey=function(x,S,w){if("object"==typeof x&&x&&(null==w&&(w=x.position),x=x[this.platform]),x)return"function"==typeof S?this.addCommand({exec:S,bindKey:x,name:S.name||x}):void x.split("|").forEach((function(x){var U="";if(-1!=x.indexOf(" ")){var G=x.split(/\s+/);x=G.pop(),G.forEach((function(x){var S=this.parseKeys(x),w=H[S.hashId]+S.key;U+=(U?" ":"")+w,this._addCommandToBinding(U,"chainKeys")}),this),U+=" "}var z=this.parseKeys(x),j=H[z.hashId]+z.key;this._addCommandToBinding(U+j,S,w)}),this)},this._addCommandToBinding=function(x,S,w){var U,G=this.commandKeyBinding;if(S)if(!G[x]||this.$singleCommand)G[x]=S;else{Array.isArray(G[x])?-1!=(U=G[x].indexOf(S))&&G[x].splice(U,1):G[x]=[G[x]],"number"!=typeof w&&(w=e(S));var H=G[x];for(U=0;U<H.length&&!(e(H[U])>w);U++);H.splice(U,0,S)}else delete G[x]},this.addCommands=function(x){x&&Object.keys(x).forEach((function(S){var w=x[S];if(w){if("string"==typeof w)return this.bindKey(w,S);"function"==typeof w&&(w={exec:w}),"object"==typeof w&&(w.name||(w.name=S),this.addCommand(w))}}),this)},this.removeCommands=function(x){Object.keys(x).forEach((function(S){this.removeCommand(x[S])}),this)},this.bindKeys=function(x){Object.keys(x).forEach((function(S){this.bindKey(S,x[S])}),this)},this._buildKeyHash=function(x){this.bindKey(x.bindKey,x)},this.parseKeys=function(x){var S=x.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(x){return x})),w=S.pop(),G=U[w];if(U.FUNCTION_KEYS[G])w=U.FUNCTION_KEYS[G].toLowerCase();else{if(!S.length)return{key:w,hashId:-1};if(1==S.length&&"shift"==S[0])return{key:w.toUpperCase(),hashId:-1}}for(var H=0,z=S.length;z--;){var j=U.KEY_MODS[S[z]];if(null==j)return"undefined"!=typeof console&&console.error("invalid modifier "+S[z]+" in "+x),!1;H|=j}return{key:w,hashId:H}},this.findKeyCommand=function(x,S){var w=H[x]+S;return this.commandKeyBinding[w]},this.handleKeyboard=function(x,S,w,U){if(!(U<0)){var G=H[S]+w,z=this.commandKeyBinding[G];return x.$keyChain&&(x.$keyChain+=" "+G,z=this.commandKeyBinding[x.$keyChain]||z),!z||"chainKeys"!=z&&"chainKeys"!=z[z.length-1]?(x.$keyChain&&(S&&4!=S||1!=w.length?(-1==S||U>0)&&(x.$keyChain=""):x.$keyChain=x.$keyChain.slice(0,-G.length-1)),{command:z}):(x.$keyChain=x.$keyChain||G,{command:"null"})}},this.getStatusText=function(x,S){return S.$keyChain||""}}.call(s.prototype),S.HashHandler=s,S.MultiHashHandler=a})),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("../keyboard/hash_handler").MultiHashHandler,H=x("../lib/event_emitter").EventEmitter,s=function(x,S){G.call(this,S,x),this.byName=this.commands,this.setDefaultHandler("exec",(function(x){return x.command.exec(x.editor,x.args||{})}))};U.inherits(s,G),function(){U.implement(this,H),this.exec=function(x,S,w){if(Array.isArray(x)){for(var U=x.length;U--;)if(this.exec(x[U],S,w))return!0;return!1}if("string"==typeof x&&(x=this.commands[x]),!x)return!1;if(S&&S.$readOnly&&!x.readOnly)return!1;if(0!=this.$checkCommandState&&x.isAvailable&&!x.isAvailable(S))return!1;var G={editor:S,command:x,args:w};return G.returnValue=this._emit("exec",G),this._signal("afterExec",G),!1!==G.returnValue},this.toggleRecording=function(x){if(!this.$inReplay)return x&&x._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(x){this.macro.push([x.command,x.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(x){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(x);try{this.$inReplay=!0,this.macro.forEach((function(S){"string"==typeof S?this.exec(S,x):this.exec(S[0],x,S[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(x){return x.map((function(x){return"string"!=typeof x[0]&&(x[0]=x[0].name),x[1]||(x=x[0]),x}))}}.call(s.prototype),S.CommandManager=s})),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],(function(x,S,w){"use strict";var U=x("../lib/lang"),G=x("../config"),H=x("../range").Range;function s(x,S){return{win:x,mac:S}}S.commands=[{name:"showSettingsMenu",bindKey:s("Ctrl-,","Command-,"),exec:function(x){G.loadModule("ace/ext/settings_menu",(function(S){S.init(x),x.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:s("Alt-E","F4"),exec:function(x){G.loadModule("./ext/error_marker",(function(S){S.showErrorMarker(x,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:s("Alt-Shift-E","Shift-F4"),exec:function(x){G.loadModule("./ext/error_marker",(function(S){S.showErrorMarker(x,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:s("Ctrl-A","Command-A"),exec:function(x){x.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:s(null,"Ctrl-L"),exec:function(x){x.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:s("Ctrl-L","Command-L"),exec:function(x,S){"number"!=typeof S||isNaN(S)||x.gotoLine(S),x.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:s("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(x){x.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:s("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(x){x.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:s("F2","F2"),exec:function(x){x.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:s("Alt-F2","Alt-F2"),exec:function(x){x.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(x){x.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:s("Alt-0","Command-Option-0"),exec:function(x){x.session.foldAll(),x.session.unfold(x.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:s("Alt-Shift-0","Command-Option-Shift-0"),exec:function(x){x.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:s("Ctrl-K","Command-G"),exec:function(x){x.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:s("Ctrl-Shift-K","Command-Shift-G"),exec:function(x){x.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:s("Alt-K","Ctrl-G"),exec:function(x){x.selection.isEmpty()?x.selection.selectWord():x.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:s("Alt-Shift-K","Ctrl-Shift-G"),exec:function(x){x.selection.isEmpty()?x.selection.selectWord():x.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:s("Ctrl-F","Command-F"),exec:function(x){G.loadModule("ace/ext/searchbox",(function(S){S.Search(x)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(x){x.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:s("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(x){x.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:s("Ctrl-Home","Command-Home|Command-Up"),exec:function(x){x.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:s("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(x){x.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:s("Up","Up|Ctrl-P"),exec:function(x,S){x.navigateUp(S.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:s("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(x){x.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:s("Ctrl-End","Command-End|Command-Down"),exec:function(x){x.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:s("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(x){x.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:s("Down","Down|Ctrl-N"),exec:function(x,S){x.navigateDown(S.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:s("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(x){x.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:s("Ctrl-Left","Option-Left"),exec:function(x){x.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:s("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(x){x.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:s("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(x){x.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:s("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(x){x.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:s("Left","Left|Ctrl-B"),exec:function(x,S){x.navigateLeft(S.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:s("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(x){x.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:s("Ctrl-Right","Option-Right"),exec:function(x){x.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:s("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(x){x.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:s("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(x){x.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:s("Shift-Right","Shift-Right"),exec:function(x){x.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:s("Right","Right|Ctrl-F"),exec:function(x,S){x.navigateRight(S.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(x){x.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:s(null,"Option-PageDown"),exec:function(x){x.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:s("PageDown","PageDown|Ctrl-V"),exec:function(x){x.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(x){x.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:s(null,"Option-PageUp"),exec:function(x){x.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(x){x.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:s("Ctrl-Up",null),exec:function(x){x.renderer.scrollBy(0,-2*x.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:s("Ctrl-Down",null),exec:function(x){x.renderer.scrollBy(0,2*x.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(x){x.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(x){x.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:s("Ctrl-Alt-E","Command-Option-E"),exec:function(x){x.commands.toggleRecording(x)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:s("Ctrl-Shift-E","Command-Shift-E"),exec:function(x){x.commands.replay(x)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:s("Ctrl-\\|Ctrl-P","Command-\\"),exec:function(x){x.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:s("Ctrl-Shift-\\|Ctrl-Shift-P","Command-Shift-\\"),exec:function(x){x.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:s("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(x){x.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:s(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(x){},readOnly:!0},{name:"cut",description:"Cut",exec:function(x){var S=x.$copyWithEmptySelection&&x.selection.isEmpty()?x.selection.getLineRange():x.selection.getRange();x._emit("cut",S),S.isEmpty()||x.session.remove(S),x.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(x,S){x.$handlePaste(S)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:s("Ctrl-D","Command-D"),exec:function(x){x.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:s("Ctrl-Shift-D","Command-Shift-D"),exec:function(x){x.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:s("Ctrl-Alt-S","Command-Alt-S"),exec:function(x){x.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:s("Ctrl-/","Command-/"),exec:function(x){x.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:s("Ctrl-Shift-/","Command-Shift-/"),exec:function(x){x.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:s("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(x){x.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:s("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(x){x.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:s("Ctrl-H","Command-Option-F"),exec:function(x){G.loadModule("ace/ext/searchbox",(function(S){S.Search(x,!0)}))}},{name:"undo",description:"Undo",bindKey:s("Ctrl-Z","Command-Z"),exec:function(x){x.undo()}},{name:"redo",description:"Redo",bindKey:s("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(x){x.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:s("Alt-Shift-Up","Command-Option-Up"),exec:function(x){x.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:s("Alt-Up","Option-Up"),exec:function(x){x.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:s("Alt-Shift-Down","Command-Option-Down"),exec:function(x){x.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:s("Alt-Down","Option-Down"),exec:function(x){x.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:s("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(x){x.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:s("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(x){x.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:s("Shift-Delete",null),exec:function(x){if(!x.selection.isEmpty())return!1;x.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:s("Alt-Backspace","Command-Backspace"),exec:function(x){x.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:s("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(x){x.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:s("Ctrl-Shift-Backspace",null),exec:function(x){var S=x.selection.getRange();S.start.column=0,x.session.remove(S)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:s("Ctrl-Shift-Delete",null),exec:function(x){var S=x.selection.getRange();S.end.column=Number.MAX_VALUE,x.session.remove(S)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:s("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(x){x.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:s("Ctrl-Delete","Alt-Delete"),exec:function(x){x.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:s("Shift-Tab","Shift-Tab"),exec:function(x){x.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:s("Tab","Tab"),exec:function(x){x.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:s("Ctrl-[","Ctrl-["),exec:function(x){x.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:s("Ctrl-]","Ctrl-]"),exec:function(x){x.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(x,S){x.insert(S)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(x,S){x.insert(U.stringRepeat(S.text||"",S.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:s(null,"Ctrl-O"),exec:function(x){x.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:s("Alt-Shift-X","Ctrl-T"),exec:function(x){x.transposeLetters()},multiSelectAction:function(x){x.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:s("Ctrl-U","Ctrl-U"),exec:function(x){x.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:s("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(x){x.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",description:"Expand to line",bindKey:s("Ctrl-Shift-L","Command-Shift-L"),exec:function(x){var S=x.selection.getRange();S.start.column=S.end.column=0,S.end.row++,x.selection.setRange(S,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",description:"Join lines",bindKey:s(null,null),exec:function(x){for(var S=x.selection.isBackwards(),w=S?x.selection.getSelectionLead():x.selection.getSelectionAnchor(),G=S?x.selection.getSelectionAnchor():x.selection.getSelectionLead(),z=x.session.doc.getLine(w.row).length,j=x.session.doc.getTextRange(x.selection.getRange()).replace(/\n\s*/," ").length,X=x.session.doc.getLine(w.row),K=w.row+1;K<=G.row+1;K++){var q=U.stringTrimLeft(U.stringTrimRight(x.session.doc.getLine(K)));0!==q.length&&(q=" "+q),X+=q}G.row+1<x.session.doc.getLength()-1&&(X+=x.session.doc.getNewLineCharacter()),x.clearSelection(),x.session.doc.replace(new H(w.row,0,G.row+2,0),X),j>0?(x.selection.moveCursorTo(w.row,w.column),x.selection.selectTo(w.row,w.column+j)):(z=x.session.doc.getLine(w.row).length>z?z+1:z,x.selection.moveCursorTo(w.row,z))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:s(null,null),exec:function(x){var S=x.session.doc.getLength()-1,w=x.session.doc.getLine(S).length,U=x.selection.rangeList.ranges,G=[];U.length<1&&(U=[x.selection.getRange()]);for(var z=0;z<U.length;z++)z==U.length-1&&(U[z].end.row===S&&U[z].end.column===w||G.push(new H(U[z].end.row,U[z].end.column,S,w))),0===z?0===U[z].start.row&&0===U[z].start.column||G.push(new H(0,0,U[z].start.row,U[z].start.column)):G.push(new H(U[z-1].end.row,U[z-1].end.column,U[z].start.row,U[z].start.column));for(x.exitMultiSelectMode(),x.clearSelection(),z=0;z<G.length;z++)x.selection.addRange(G[z],!1)},readOnly:!0,scrollIntoView:"none"},{name:"openCommandPallete",description:"Open command pallete",bindKey:s("F1","F1"),exec:function(x){x.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:s(null,null),exec:function(x){x.prompt({$type:"modes"})},readOnly:!0}]})),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator","ace/clipboard"],(function(x,S,w){"use strict";x("./lib/fixoldbrowsers");var U=x("./lib/oop"),G=x("./lib/dom"),H=x("./lib/lang"),z=x("./lib/useragent"),j=x("./keyboard/textinput").TextInput,X=x("./mouse/mouse_handler").MouseHandler,K=x("./mouse/fold_handler").FoldHandler,q=x("./keyboard/keybinding").KeyBinding,Y=x("./edit_session").EditSession,Z=x("./search").Search,J=x("./range").Range,Q=x("./lib/event_emitter").EventEmitter,ee=x("./commands/command_manager").CommandManager,te=x("./commands/default_commands").commands,ne=x("./config"),ie=x("./token_iterator").TokenIterator,re=x("./clipboard"),C=function(x,S,w){var U=x.getContainerElement();this.container=U,this.renderer=x,this.id="editor"+ ++C.$uid,this.commands=new ee(z.isMac?"mac":"win",te),"object"==typeof document&&(this.textInput=new j(x.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new X(this),new K(this)),this.keyBinding=new q(this),this.$search=(new Z).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=H.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(x,S){S._$emitInputEvent.schedule(31)})),this.setSession(S||w&&w.session||new Y("")),ne.resetOptions(this),w&&this.setOptions(w),ne._signal("editor",this)};C.$uid=0,function(){U.implement(this,Q),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=H.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(x){if(this.curOp){if(!x||this.curOp.command)return;this.prevOp=this.curOp}x||(this.previousCommand=null,x={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:x.command||{},args:x.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(x){if(this.curOp){if(x&&!1===x.returnValue)return this.curOp=null;if(1==x&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var S=this.curOp.command,w=S&&S.scrollIntoView;if(w){switch(w){case"center-animate":w="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var U=this.selection.getRange(),G=this.renderer.layerConfig;(U.start.row>=G.lastRow||U.end.row<=G.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==w&&this.renderer.animateScrolling(this.curOp.scrollTop)}var H=this.selection.toJSON();this.curOp.selectionAfter=H,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(H),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(x){if(this.$mergeUndoDeltas){var S=this.prevOp,w=this.$mergeableCommands,U=S.command&&x.command.name==S.command.name;if("insertstring"==x.command.name){var G=x.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),U=U&&this.mergeNextCommand&&(!/\s/.test(G)||/\s/.test(S.args)),this.mergeNextCommand=!0}else U=U&&-1!==w.indexOf(x.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(U=!1),U?this.session.mergeUndoDeltas=!0:-1!==w.indexOf(x.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(x,S){if(x&&"string"==typeof x&&"ace"!=x){this.$keybindingId=x;var w=this;ne.loadModule(["keybinding",x],(function(U){w.$keybindingId==x&&w.keyBinding.setKeyboardHandler(U&&U.handler),S&&S()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(x),S&&S()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(x){if(this.session!=x){this.curOp&&this.endOperation(),this.curOp={};var S=this.session;if(S){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var w=this.session.getSelection();w.off("changeCursor",this.$onCursorChange),w.off("changeSelection",this.$onSelectionChange)}this.session=x,x?(this.$onDocumentChange=this.onDocumentChange.bind(this),x.on("change",this.$onDocumentChange),this.renderer.setSession(x),this.$onChangeMode=this.onChangeMode.bind(this),x.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),x.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),x.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),x.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),x.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),x.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=x.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(x)),this._signal("changeSession",{session:x,oldSession:S}),this.curOp=null,S&&S._signal("changeEditor",{oldEditor:this}),x&&x._signal("changeEditor",{editor:this}),x&&x.bgTokenizer&&x.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(x,S){return this.session.doc.setValue(x),S?1==S?this.navigateFileEnd():-1==S&&this.navigateFileStart():this.selectAll(),x},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(x){this.renderer.onResize(x)},this.setTheme=function(x,S){this.renderer.setTheme(x,S)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(x){this.renderer.setStyle(x)},this.unsetStyle=function(x){this.renderer.unsetStyle(x)},this.getFontSize=function(){return this.getOption("fontSize")||G.computedStyle(this.container).fontSize},this.setFontSize=function(x){this.setOption("fontSize",x)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var x=this;this.$highlightPending=!0,setTimeout((function(){x.$highlightPending=!1;var S=x.session;if(S&&S.bgTokenizer){var w=S.findMatchingBracket(x.getCursorPosition());if(w)var U=new J(w.row,w.column,w.row,w.column+1);else S.$mode.getMatching&&(U=S.$mode.getMatching(x.session));U&&(S.$bracketHighlight=S.addMarker(U,"ace_bracket","text"))}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var x=this;this.$highlightTagPending=!0,setTimeout((function(){x.$highlightTagPending=!1;var S=x.session;if(S&&S.bgTokenizer){var w=x.getCursorPosition(),U=new ie(x.session,w.row,w.column),G=U.getCurrentToken();if(!G||!/\b(?:tag-open|tag-name)/.test(G.type))return S.removeMarker(S.$tagHighlight),void(S.$tagHighlight=null);if(-1==G.type.indexOf("tag-open")||(G=U.stepForward())){var H=G.value,z=0,j=U.stepBackward();if("<"==j.value)do{j=G,(G=U.stepForward())&&G.value===H&&-1!==G.type.indexOf("tag-name")&&("<"===j.value?z++:"</"===j.value&&z--)}while(G&&z>=0);else{do{G=j,j=U.stepBackward(),G&&G.value===H&&-1!==G.type.indexOf("tag-name")&&("<"===j.value?z++:"</"===j.value&&z--)}while(j&&z<=0);U.stepForward()}if(!G)return S.removeMarker(S.$tagHighlight),void(S.$tagHighlight=null);var X=U.getCurrentTokenRow(),K=U.getCurrentTokenColumn(),q=new J(X,K,X,K+G.value.length),Y=S.$backMarkers[S.$tagHighlight];S.$tagHighlight&&null!=Y&&0!==q.compareRange(Y.range)&&(S.removeMarker(S.$tagHighlight),S.$tagHighlight=null),S.$tagHighlight||(S.$tagHighlight=S.addMarker(q,"ace_bracket","text"))}}}),50)}},this.focus=function(){var x=this;setTimeout((function(){x.isFocused()||x.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(x){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",x))},this.onBlur=function(x){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",x))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(x){var S=this.session.$useWrapMode,w=x.start.row==x.end.row?x.end.row:1/0;this.renderer.updateLines(x.start.row,w,S),this._signal("change",x),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(x){var S=x.data;this.renderer.updateLines(S.first,S.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var x,S=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(x=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(x=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(x=!1)),S.$highlightLineMarker&&!x)S.removeMarker(S.$highlightLineMarker.id),S.$highlightLineMarker=null;else if(!S.$highlightLineMarker&&x){var w=new J(x.row,x.column,x.row,1/0);w.id=S.addMarker(w,"ace_active-line","screenLine"),S.$highlightLineMarker=w}else x&&(S.$highlightLineMarker.start.row=x.row,S.$highlightLineMarker.end.row=x.row,S.$highlightLineMarker.start.column=x.column,S._signal("changeBackMarker"))},this.onSelectionChange=function(x){var S=this.session;if(S.$selectionMarker&&S.removeMarker(S.$selectionMarker),S.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var w=this.selection.getRange(),U=this.getSelectionStyle();S.$selectionMarker=S.addMarker(w,"ace_selection",U)}var G=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(G),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var x=this.session,S=this.getSelectionRange();if(!S.isEmpty()&&!S.isMultiLine()){var w=S.start.column,U=S.end.column,G=x.getLine(S.start.row),H=G.substring(w,U);if(!(H.length>5e3)&&/[\w\d]/.test(H)){var z=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:H}),j=G.substring(w-1,U+1);if(z.test(j))return z}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(x){this.renderer.updateText(),this._emit("changeMode",x)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var x=this.getSelectedText(),S=this.session.doc.getNewLineCharacter(),w=!1;if(!x&&this.$copyWithEmptySelection){w=!0;for(var U=this.selection.getAllRanges(),G=0;G<U.length;G++){var H=U[G];G&&U[G-1].start.row==H.start.row||(x+=this.session.getLine(H.start.row)+S)}}var z={text:x};return this._signal("copy",z),re.lineMode=w?z.text:"",z.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(x,S){var w={text:x,event:S};this.commands.exec("paste",this,w)},this.$handlePaste=function(x){"string"==typeof x&&(x={text:x}),this._signal("paste",x);var S=x.text,w=S==re.lineMode,U=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)w?U.insert({row:this.selection.lead.row,column:0},S):this.insert(S);else if(w)this.selection.rangeList.ranges.forEach((function(x){U.insert({row:x.start.row,column:0},S)}));else{var G=S.split(/\r\n|\r|\n/),H=this.selection.rangeList.ranges,z=!(2!=G.length||G[0]&&G[1]);if(G.length!=H.length||z)return this.commands.exec("insertstring",this,S);for(var j=H.length;j--;){var X=H[j];X.isEmpty()||U.remove(X),U.insert(X.start,G[j])}}},this.execCommand=function(x,S){return this.commands.exec(x,this,S)},this.insert=function(x,S){var w=this.session,U=w.getMode(),G=this.getCursorPosition();if(this.getBehavioursEnabled()&&!S){var H=U.transformAction(w.getState(G.row),"insertion",this,w,x);H&&(x!==H.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),x=H.text)}if("\t"==x&&(x=this.session.getTabString()),this.selection.isEmpty())this.session.getOverwrite()&&-1==x.indexOf("\n")&&((z=new J.fromPoints(G,G)).end.column+=x.length,this.session.remove(z));else{var z=this.getSelectionRange();G=this.session.remove(z),this.clearSelection()}if("\n"==x||"\r\n"==x){var j=w.getLine(G.row);if(G.column>j.search(/\S|$/)){var X=j.substr(G.column).search(/\S|$/);w.doc.removeInLine(G.row,G.column,G.column+X)}}this.clearSelection();var K=G.column,q=w.getState(G.row),Y=(j=w.getLine(G.row),U.checkOutdent(q,j,x));if(w.insert(G,x),H&&H.selection&&(2==H.selection.length?this.selection.setSelectionRange(new J(G.row,K+H.selection[0],G.row,K+H.selection[1])):this.selection.setSelectionRange(new J(G.row+H.selection[0],H.selection[1],G.row+H.selection[2],H.selection[3]))),w.getDocument().isNewLine(x)){var Z=U.getNextLineIndent(q,j.slice(0,G.column),w.getTabString());w.insert({row:G.row+1,column:0},Z)}Y&&U.autoOutdent(q,w,G.row)},this.onTextInput=function(x,S){if(!S)return this.keyBinding.onTextInput(x);this.startOperation({command:{name:"insertstring"}});var w=this.applyComposition.bind(this,x,S);this.selection.rangeCount?this.forEachSelection(w):w(),this.endOperation()},this.applyComposition=function(x,S){var w;(S.extendLeft||S.extendRight)&&((w=this.selection.getRange()).start.column-=S.extendLeft,w.end.column+=S.extendRight,this.selection.setRange(w),x||w.isEmpty()||this.remove()),!x&&this.selection.isEmpty()||this.insert(x,!0),(S.restoreStart||S.restoreEnd)&&((w=this.selection.getRange()).start.column-=S.restoreStart,w.end.column-=S.restoreEnd,this.selection.setRange(w))},this.onCommandKey=function(x,S,w){return this.keyBinding.onCommandKey(x,S,w)},this.setOverwrite=function(x){this.session.setOverwrite(x)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(x){this.setOption("scrollSpeed",x)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(x){this.setOption("dragDelay",x)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(x){this.setOption("selectionStyle",x)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(x){this.setOption("highlightActiveLine",x)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(x){this.setOption("highlightGutterLine",x)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(x){this.setOption("highlightSelectedWord",x)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(x){this.renderer.setAnimatedScroll(x)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(x){this.renderer.setShowInvisibles(x)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(x){this.renderer.setDisplayIndentGuides(x)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(x){this.renderer.setShowPrintMargin(x)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(x){this.renderer.setPrintMarginColumn(x)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(x){this.setOption("readOnly",x)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(x){this.setOption("behavioursEnabled",x)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(x){this.setOption("wrapBehavioursEnabled",x)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(x){this.setOption("showFoldWidgets",x)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(x){this.setOption("fadeFoldWidgets",x)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(x){this.selection.isEmpty()&&("left"==x?this.selection.selectLeft():this.selection.selectRight());var S=this.getSelectionRange();if(this.getBehavioursEnabled()){var w=this.session,U=w.getState(S.start.row),G=w.getMode().transformAction(U,"deletion",this,w,S);if(0===S.end.column){var H=w.getTextRange(S);if("\n"==H[H.length-1]){var z=w.getLine(S.end.row);/^\s+$/.test(z)&&(S.end.column=z.length)}}G&&(S=G)}this.session.remove(S),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var x=this.getSelectionRange();x.start.column==x.end.column&&x.start.row==x.end.row&&(x.end.column=0,x.end.row++),this.session.remove(x),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var x=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(x)},this.transposeLetters=function(){if(this.selection.isEmpty()){var x=this.getCursorPosition(),S=x.column;if(0!==S){var w,U,G=this.session.getLine(x.row);S<G.length?(w=G.charAt(S)+G.charAt(S-1),U=new J(x.row,S-1,x.row,S+1)):(w=G.charAt(S-1)+G.charAt(S-2),U=new J(x.row,S-2,x.row,S)),this.session.replace(U,w),this.session.selection.moveToPosition(U.end)}}},this.toLowerCase=function(){var x=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var S=this.getSelectionRange(),w=this.session.getTextRange(S);this.session.replace(S,w.toLowerCase()),this.selection.setSelectionRange(x)},this.toUpperCase=function(){var x=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var S=this.getSelectionRange(),w=this.session.getTextRange(S);this.session.replace(S,w.toUpperCase()),this.selection.setSelectionRange(x)},this.indent=function(){var x=this.session,S=this.getSelectionRange();if(!(S.start.row<S.end.row)){if(S.start.column<S.end.column){var w=x.getTextRange(S);if(!/^\s+$/.test(w))return q=this.$getSelectedRows(),void x.indentRows(q.first,q.last,"\t")}var U=x.getLine(S.start.row),G=S.start,z=x.getTabSize(),j=x.documentToScreenColumn(G.row,G.column);if(this.session.getUseSoftTabs())var X=z-j%z,K=H.stringRepeat(" ",X);else{for(X=j%z;" "==U[S.start.column-1]&&X;)S.start.column--,X--;this.selection.setSelectionRange(S),K="\t"}return this.insert(K)}var q=this.$getSelectedRows();x.indentRows(q.first,q.last,"\t")},this.blockIndent=function(){var x=this.$getSelectedRows();this.session.indentRows(x.first,x.last,"\t")},this.blockOutdent=function(){var x=this.session.getSelection();this.session.outdentRows(x.getRange())},this.sortLines=function(){for(var x=this.$getSelectedRows(),S=this.session,w=[],U=x.first;U<=x.last;U++)w.push(S.getLine(U));w.sort((function(x,S){return x.toLowerCase()<S.toLowerCase()?-1:x.toLowerCase()>S.toLowerCase()?1:0}));var G=new J(0,0,0,0);for(U=x.first;U<=x.last;U++){var H=S.getLine(U);G.start.row=U,G.end.row=U,G.end.column=H.length,S.replace(G,w[U-x.first])}},this.toggleCommentLines=function(){var x=this.session.getState(this.getCursorPosition().row),S=this.$getSelectedRows();this.session.getMode().toggleCommentLines(x,this.session,S.first,S.last)},this.toggleBlockComment=function(){var x=this.getCursorPosition(),S=this.session.getState(x.row),w=this.getSelectionRange();this.session.getMode().toggleBlockComment(S,this.session,w,x)},this.getNumberAt=function(x,S){var w=/[\-]?[0-9]+(?:\.[0-9]+)?/g;w.lastIndex=0;for(var U=this.session.getLine(x);w.lastIndex<S;){var G=w.exec(U);if(G.index<=S&&G.index+G[0].length>=S)return{value:G[0],start:G.index,end:G.index+G[0].length}}return null},this.modifyNumber=function(x){var S=this.selection.getCursor().row,w=this.selection.getCursor().column,U=new J(S,w-1,S,w),G=this.session.getTextRange(U);if(!isNaN(parseFloat(G))&&isFinite(G)){var H=this.getNumberAt(S,w);if(H){var z=H.value.indexOf(".")>=0?H.start+H.value.indexOf(".")+1:H.end,j=H.start+H.value.length-z,X=parseFloat(H.value);X*=Math.pow(10,j),z!==H.end&&w<z?x*=Math.pow(10,H.end-w-1):x*=Math.pow(10,H.end-w),X+=x;var K=(X/=Math.pow(10,j)).toFixed(j),q=new J(S,H.start,S,H.end);this.session.replace(q,K),this.moveCursorTo(S,Math.max(H.start+1,w+K.length-H.value.length))}}else this.toggleWord()},this.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["in","out"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],this.toggleWord=function(){var x=this.selection.getCursor().row,S=this.selection.getCursor().column;this.selection.selectWord();var w=this.getSelectedText(),U=this.selection.getWordRange().start.column,G=w.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),z=S-U-1;z<0&&(z=0);var j=0,X=0,K=this;w.match(/[A-Za-z0-9_]+/)&&G.forEach((function(S,G){X=j+S.length,z>=j&&z<=X&&(w=S,K.selection.clearSelection(),K.moveCursorTo(x,j+U),K.selection.selectTo(x,X+U)),j=X}));for(var q,Y=this.$toggleWordPairs,Z=0;Z<Y.length;Z++)for(var J=Y[Z],Q=0;Q<=1;Q++){var ee=+!Q,te=w.match(new RegExp("^\\s?_?("+H.escapeRegExp(J[Q])+")\\s?$","i"));te&&w.match(new RegExp("([_]|^|\\s)("+H.escapeRegExp(te[1])+")($|\\s)","g"))&&(q=w.replace(new RegExp(H.escapeRegExp(J[Q]),"i"),(function(x){var S=J[ee];return x.toUpperCase()==x?S=S.toUpperCase():x.charAt(0).toUpperCase()==x.charAt(0)&&(S=S.substr(0,0)+J[ee].charAt(0).toUpperCase()+S.substr(1)),S})),this.insert(q),q="")}},this.removeLines=function(){var x=this.$getSelectedRows();this.session.removeFullLines(x.first,x.last),this.clearSelection()},this.duplicateSelection=function(){var x=this.selection,S=this.session,w=x.getRange(),U=x.isBackwards();if(w.isEmpty()){var G=w.start.row;S.duplicateLines(G,G)}else{var H=U?w.start:w.end,z=S.insert(H,S.getTextRange(w),!1);w.start=H,w.end=z,x.setSelectionRange(w,U)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(x,S,w){return this.session.moveText(x,S,w)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(x,S){var w,U,G=this.selection;if(!G.inMultiSelectMode||this.inVirtualSelectionMode){var H=G.toOrientedRange();w=this.$getSelectedRows(H),U=this.session.$moveLines(w.first,w.last,S?0:x),S&&-1==x&&(U=0),H.moveBy(U,0),G.fromOrientedRange(H)}else{var z=G.rangeList.ranges;G.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var j=0,X=0,K=z.length,q=0;q<K;q++){var Y=q;z[q].moveBy(j,0);for(var Z=(w=this.$getSelectedRows(z[q])).first,J=w.last;++q<K;){X&&z[q].moveBy(X,0);var Q=this.$getSelectedRows(z[q]);if(S&&Q.first!=J)break;if(!S&&Q.first>J+1)break;J=Q.last}for(q--,j=this.session.$moveLines(Z,J,S?0:x),S&&-1==x&&(Y=q+1);Y<=q;)z[Y].moveBy(j,0),Y++;S||(j=0),X+=j}G.fromOrientedRange(G.ranges[0]),G.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(x){return x=(x||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(x.start.row),last:this.session.getRowFoldEnd(x.end.row)}},this.onCompositionStart=function(x){this.renderer.showComposition(x)},this.onCompositionUpdate=function(x){this.renderer.setCompositionText(x)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(x){return x>=this.getFirstVisibleRow()&&x<=this.getLastVisibleRow()},this.isRowFullyVisible=function(x){return x>=this.renderer.getFirstFullyVisibleRow()&&x<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(x,S){var w=this.renderer,U=this.renderer.layerConfig,G=x*Math.floor(U.height/U.lineHeight);!0===S?this.selection.$moveSelection((function(){this.moveCursorBy(G,0)})):!1===S&&(this.selection.moveCursorBy(G,0),this.selection.clearSelection());var H=w.scrollTop;w.scrollBy(0,G*U.lineHeight),null!=S&&w.scrollCursorIntoView(null,.5),w.animateScrolling(H)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(x){this.renderer.scrollToRow(x)},this.scrollToLine=function(x,S,w,U){this.renderer.scrollToLine(x,S,w,U)},this.centerSelection=function(){var x=this.getSelectionRange(),S={row:Math.floor(x.start.row+(x.end.row-x.start.row)/2),column:Math.floor(x.start.column+(x.end.column-x.start.column)/2)};this.renderer.alignCursor(S,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(x,S){this.selection.moveCursorTo(x,S)},this.moveCursorToPosition=function(x){this.selection.moveCursorToPosition(x)},this.jumpToMatching=function(x,S){var w=this.getCursorPosition(),U=new ie(this.session,w.row,w.column),G=U.getCurrentToken(),H=G||U.stepForward();if(H){var z,j,X=!1,K={},q=w.column-H.start,Y={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(H.value.match(/[{}()\[\]]/g)){for(;q<H.value.length&&!X;q++)if(Y[H.value[q]])switch(j=Y[H.value[q]]+"."+H.type.replace("rparen","lparen"),isNaN(K[j])&&(K[j]=0),H.value[q]){case"(":case"[":case"{":K[j]++;break;case")":case"]":case"}":K[j]--,-1===K[j]&&(z="bracket",X=!0)}}else-1!==H.type.indexOf("tag-name")&&(isNaN(K[H.value])&&(K[H.value]=0),"<"===G.value?K[H.value]++:"</"===G.value&&K[H.value]--,-1===K[H.value]&&(z="tag",X=!0));X||(G=H,H=U.stepForward(),q=0)}while(H&&!X);if(z){var Z,Q;if("bracket"===z)(Z=this.session.getBracketRange(w))||(Q=(Z=new J(U.getCurrentTokenRow(),U.getCurrentTokenColumn()+q-1,U.getCurrentTokenRow(),U.getCurrentTokenColumn()+q-1)).start,(S||Q.row===w.row&&Math.abs(Q.column-w.column)<2)&&(Z=this.session.getBracketRange(Q)));else if("tag"===z){if(!H||-1===H.type.indexOf("tag-name"))return;var ee=H.value;if(0===(Z=new J(U.getCurrentTokenRow(),U.getCurrentTokenColumn()-2,U.getCurrentTokenRow(),U.getCurrentTokenColumn()-2)).compare(w.row,w.column)){X=!1;do{H=G,(G=U.stepBackward())&&(-1!==G.type.indexOf("tag-close")&&Z.setEnd(U.getCurrentTokenRow(),U.getCurrentTokenColumn()+1),H.value===ee&&-1!==H.type.indexOf("tag-name")&&("<"===G.value?K[ee]++:"</"===G.value&&K[ee]--,0===K[ee]&&(X=!0)))}while(G&&!X)}H&&H.type.indexOf("tag-name")&&(Q=Z.start).row==w.row&&Math.abs(Q.column-w.column)<2&&(Q=Z.end)}(Q=Z&&Z.cursor||Q)&&(x?Z&&S?this.selection.setRange(Z):Z&&Z.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(Q.row,Q.column):this.selection.moveTo(Q.row,Q.column))}}},this.gotoLine=function(x,S,w){this.selection.clearSelection(),this.session.unfold({row:x-1,column:S||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(x-1,S||0),this.isRowFullyVisible(x-1)||this.scrollToLine(x-1,!0,w)},this.navigateTo=function(x,S){this.selection.moveTo(x,S)},this.navigateUp=function(x){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var S=this.selection.anchor.getPosition();return this.moveCursorToPosition(S)}this.selection.clearSelection(),this.selection.moveCursorBy(-x||-1,0)},this.navigateDown=function(x){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var S=this.selection.anchor.getPosition();return this.moveCursorToPosition(S)}this.selection.clearSelection(),this.selection.moveCursorBy(x||1,0)},this.navigateLeft=function(x){if(this.selection.isEmpty())for(x=x||1;x--;)this.selection.moveCursorLeft();else{var S=this.getSelectionRange().start;this.moveCursorToPosition(S)}this.clearSelection()},this.navigateRight=function(x){if(this.selection.isEmpty())for(x=x||1;x--;)this.selection.moveCursorRight();else{var S=this.getSelectionRange().end;this.moveCursorToPosition(S)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(x,S){S&&this.$search.set(S);var w=this.$search.find(this.session),U=0;return w?(this.$tryReplace(w,x)&&(U=1),this.selection.setSelectionRange(w),this.renderer.scrollSelectionIntoView(w.start,w.end),U):U},this.replaceAll=function(x,S){S&&this.$search.set(S);var w=this.$search.findAll(this.session),U=0;if(!w.length)return U;var G=this.getSelectionRange();this.selection.moveTo(0,0);for(var H=w.length-1;H>=0;--H)this.$tryReplace(w[H],x)&&U++;return this.selection.setSelectionRange(G),U},this.$tryReplace=function(x,S){var w=this.session.getTextRange(x);return null!==(S=this.$search.replace(w,S))?(x.end=this.session.replace(x,S),x):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(x,S,w){S||(S={}),"string"==typeof x||x instanceof RegExp?S.needle=x:"object"==typeof x&&U.mixin(S,x);var G=this.selection.getRange();null==S.needle&&((x=this.session.getTextRange(G)||this.$search.$options.needle)||(G=this.session.getWordRange(G.start.row,G.start.column),x=this.session.getTextRange(G)),this.$search.set({needle:x})),this.$search.set(S),S.start||this.$search.set({start:G});var H=this.$search.find(this.session);return S.preventScroll?H:H?(this.revealRange(H,w),H):(S.backwards?G.start=G.end:G.end=G.start,void this.selection.setRange(G))},this.findNext=function(x,S){this.find({skipCurrent:!0,backwards:!1},x,S)},this.findPrevious=function(x,S){this.find(x,{skipCurrent:!0,backwards:!0},S)},this.revealRange=function(x,S){this.session.unfold(x),this.selection.setSelectionRange(x);var w=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(x.start,x.end,.5),!1!==S&&this.renderer.animateScrolling(w)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(x){if(x){var S,w=this,U=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var G=this.$scrollAnchor;G.style.cssText="position:absolute",this.container.insertBefore(G,this.container.firstChild);var H=this.on("changeSelection",(function(){U=!0})),z=this.renderer.on("beforeRender",(function(){U&&(S=w.renderer.container.getBoundingClientRect())})),j=this.renderer.on("afterRender",(function(){if(U&&S&&(w.isFocused()||w.searchBox&&w.searchBox.isFocused())){var x=w.renderer,H=x.$cursorLayer.$pixelPos,z=x.layerConfig,j=H.top-z.offset;null!=(U=H.top>=0&&j+S.top<0||!(H.top<z.height&&H.top+S.top+z.lineHeight>window.innerHeight)&&null)&&(G.style.top=j+"px",G.style.left=H.left+"px",G.style.height=z.lineHeight+"px",G.scrollIntoView(U)),U=S=null}}));this.setAutoScrollEditorIntoView=function(x){x||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",H),this.renderer.off("afterRender",j),this.renderer.off("beforeRender",z))}}},this.$resetCursorStyle=function(){var x=this.$cursorStyle||"ace",S=this.renderer.$cursorLayer;S&&(S.setSmoothBlinking(/smooth/.test(x)),S.isBlinking=!this.$readOnly&&"wide"!=x,G.setCssClass(S.element,"ace_slim-cursors",/slim/.test(x)))},this.prompt=function(x,S,w){var U=this;ne.loadModule("./ext/prompt",(function(G){G.prompt(U,x,S,w)}))}}.call(C.prototype),ne.defineOptions(C.prototype,"editor",{selectionStyle:{set:function(x){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:x})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(x){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(x){this.textInput.setReadOnly(x),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(x){this.textInput.setCopyWithEmptySelection(x)},initialValue:!1},cursorStyle:{set:function(x){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(x){this.setAutoScrollEditorIntoView(x)}},keyboardHandler:{set:function(x){this.setKeyboardHandler(x)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(x){this.session.setValue(x)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(x){this.setSession(x)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(x){this.renderer.$gutterLayer.setShowLineNumbers(x),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),x&&this.$relativeLineNumbers?oe.attach(this):oe.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(x){this.$showLineNumbers&&x?oe.attach(this):oe.detach(this)}},placeholder:{set:function(x){this.$updatePlaceholder||(this.$updatePlaceholder=function(){var x=this.renderer.$composition||this.getValue();if(x&&this.renderer.placeholderNode)this.renderer.off("afterRender",this.$updatePlaceholder),G.removeCssClass(this.container,"ace_hasPlaceholder"),this.renderer.placeholderNode.remove(),this.renderer.placeholderNode=null;else if(!x&&!this.renderer.placeholderNode){this.renderer.on("afterRender",this.$updatePlaceholder),G.addCssClass(this.container,"ace_hasPlaceholder");var S=G.createElement("div");S.className="ace_placeholder",S.textContent=this.$placeholder||"",this.renderer.placeholderNode=S,this.renderer.content.appendChild(this.renderer.placeholderNode)}}.bind(this),this.on("input",this.$updatePlaceholder)),this.$updatePlaceholder()}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var oe={getText:function(x,S){return(Math.abs(x.selection.lead.row-S)||S+1+(S<9?"·":""))+""},getWidth:function(x,S,w){return Math.max(S.toString().length,(w.lastRow+1).toString().length,2)*w.characterWidth},update:function(x,S){S.renderer.$loop.schedule(S.renderer.CHANGE_GUTTER)},attach:function(x){x.renderer.$gutterLayer.$renderer=this,x.on("changeSelection",this.update),this.update(null,x)},detach:function(x){x.renderer.$gutterLayer.$renderer==this&&(x.renderer.$gutterLayer.$renderer=null),x.off("changeSelection",this.update),this.update(null,x)}};S.Editor=C})),ace.define("ace/undomanager",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var i=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(x){this.$session=x},this.add=function(x,S,w){this.$fromUndo||x!=this.$lastDelta&&(!1!==S&&this.lastDeltas||(this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),x.id=this.$rev=++this.$maxRev),"remove"!=x.action&&"insert"!=x.action||(this.$lastDelta=x),this.lastDeltas.push(x))},this.addSelection=function(x,S){this.selections.push({value:x,rev:S||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(x,S){null==S&&(S=this.$rev+1);for(var w=this.$undoStack,U=w.length;U--;){var G=w[U][0];if(G.id<=x)break;G.id<S&&(G.ignore=!0)}this.lastDeltas=null},this.getSelection=function(x,S){for(var w=this.selections,U=w.length;U--;){var G=w[U];if(G.rev<x)return S&&(G=w[U+1]),G}},this.getRevision=function(){return this.$rev},this.getDeltas=function(x,S){null==S&&(S=this.$rev+1);for(var w=this.$undoStack,U=null,G=0,H=w.length;H--;){var z=w[H][0];if(z.id<S&&!U&&(U=H+1),z.id<=x){G=H+1;break}}return w.slice(G,U)},this.getChangedRanges=function(x,S){null==S&&(S=this.$rev+1)},this.getChangedLines=function(x,S){null==S&&(S=this.$rev+1)},this.undo=function(x,S){this.lastDeltas=null;var w=this.$undoStack;if(function(x,S){for(var w=S;w--;){var U=x[w];if(U&&!U[0].ignore){for(;w<S-1;){var G=u(x[w],x[w+1]);x[w]=G[0],x[w+1]=G[1],w++}return!0}}}(w,w.length)){x||(x=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var U=w.pop(),G=null;return U&&U.length&&(G=x.undoChanges(U,S),this.$redoStack.push(U),this.$syncRev()),this.$fromUndo=!1,G}},this.redo=function(x,S){if(this.lastDeltas=null,x||(x=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var w=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(x,S){for(var w=0;w<S.length;w++)for(var U=S[w],G=0;G<U.length;G++)f(x,U[G])}(this.$redoStack,w),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(x){x[0].id=++this.$maxRev}),this)}var U=this.$redoStack.pop(),G=null;return U&&(G=x.redoChanges(U,S),this.$undoStack.push(U),this.$syncRev()),this.$fromUndo=!1,G},this.$syncRev=function(){var x=this.$undoStack,S=x[x.length-1],w=S&&S[0].id||0;this.$redoStackBaseRev=w,this.$rev=w},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(x){null==x&&(x=this.$rev),this.mark=x},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(x){return x?a(x):a(this.$undoStack)+"\n---\n"+a(this.$redoStack)}}).call(i.prototype);var U=x("./range").Range,G=U.comparePoints;function s(x){return{row:x.row,column:x.column}}function a(x){if(x=x||this,Array.isArray(x))return x.map(a).join("\n");var S="";return x.action?(S="insert"==x.action?"+":"-",S+="["+x.lines+"]"):x.value&&(S=Array.isArray(x.value)?x.value.map(c).join("\n"):c(x.value)),x.start&&(S+=c(x)),(x.id||x.rev)&&(S+="\t("+(x.id||x.rev)+")"),S}function c(x){return x.start.row+":"+x.start.column+"=>"+x.end.row+":"+x.end.column}function l(x,S){var w="insert"==x.action,U="insert"==S.action;if(w&&U)if(G(S.start,x.end)>=0)d(S,x,-1);else{if(!(G(S.start,x.start)<=0))return null;d(x,S,1)}else if(w&&!U)if(G(S.start,x.end)>=0)d(S,x,-1);else{if(!(G(S.end,x.start)<=0))return null;d(x,S,-1)}else if(!w&&U)if(G(S.start,x.start)>=0)d(S,x,1);else{if(!(G(S.start,x.start)<=0))return null;d(x,S,1)}else if(!w&&!U)if(G(S.start,x.start)>=0)d(S,x,1);else{if(!(G(S.end,x.start)<=0))return null;d(x,S,-1)}return[S,x]}function u(x,S){for(var w=x.length;w--;)for(var U=0;U<S.length;U++)if(!l(x[w],S[U])){for(;w<x.length;){for(;U--;)l(S[U],x[w]);U=S.length,w++}return[x,S]}return x.selectionBefore=S.selectionBefore=x.selectionAfter=S.selectionAfter=null,[S,x]}function h(x,S){var w="insert"==x.action,H="insert"==S.action;if(w&&H)G(x.start,S.start)<0?d(S,x,1):d(x,S,1);else if(w&&!H)G(x.start,S.end)>=0?d(x,S,-1):(G(x.start,S.start)<=0||d(x,U.fromPoints(S.start,x.start),-1),d(S,x,1));else if(!w&&H)G(S.start,x.end)>=0?d(S,x,-1):(G(S.start,x.start)<=0||d(S,U.fromPoints(x.start,S.start),-1),d(x,S,1));else if(!w&&!H)if(G(S.start,x.end)>=0)d(S,x,-1);else{var z,j;if(!(G(S.end,x.start)<=0))return G(x.start,S.start)<0&&(z=x,x=m(x,S.start)),G(x.end,S.end)>0&&(j=m(x,S.end)),p(S.end,x.start,x.end,-1),j&&!z&&(x.lines=j.lines,x.start=j.start,x.end=j.end,j=x),[S,z,j].filter(Boolean);d(x,S,-1)}return[S,x]}function d(x,S,w){p(x.start,S.start,S.end,w),p(x.end,S.start,S.end,w)}function p(x,S,w,U){x.row==(1==U?S:w).row&&(x.column+=U*(w.column-S.column)),x.row+=U*(w.row-S.row)}function m(x,S){var w=x.lines,U=x.end;x.end=s(S);var G=x.end.row-x.start.row,H=w.splice(G,w.length),z=G?S.column:S.column-x.start.column;return w.push(H[0].substring(0,z)),H[0]=H[0].substr(z),{start:s(S),end:U,lines:H,action:x.action}}function f(x,S){S=function(x){return{start:s(x.start),end:s(x.end),action:x.action,lines:x.lines.slice()}}(S);for(var w=x.length;w--;){for(var U=x[w],G=0;G<U.length;G++){var H=h(U[G],S);S=H[0],2!=H.length&&(H[2]?(U.splice(G+1,1,H[1],H[2]),G++):H[1]||(U.splice(G,1),G--))}U.length||x.splice(w,1)}return x}U.comparePoints,S.UndoManager=i})),ace.define("ace/layer/lines",["require","exports","module","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("../lib/dom"),r=function(x,S){this.element=x,this.canvasHeight=S||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0};(function(){this.moveContainer=function(x){U.translate(this.element,0,-x.firstRowScreen*x.lineHeight%this.canvasHeight-x.offset*this.$offsetCoefficient)},this.pageChanged=function(x,S){return Math.floor(x.firstRowScreen*x.lineHeight/this.canvasHeight)!==Math.floor(S.firstRowScreen*S.lineHeight/this.canvasHeight)},this.computeLineTop=function(x,S,w){var U=S.firstRowScreen*S.lineHeight,G=Math.floor(U/this.canvasHeight);return w.documentToScreenRow(x,0)*S.lineHeight-G*this.canvasHeight},this.computeLineHeight=function(x,S,w){return S.lineHeight*w.getRowLength(x)},this.getLength=function(){return this.cells.length},this.get=function(x){return this.cells[x]},this.shift=function(){this.$cacheCell(this.cells.shift())},this.pop=function(){this.$cacheCell(this.cells.pop())},this.push=function(x){if(Array.isArray(x)){this.cells.push.apply(this.cells,x);for(var S=U.createFragment(this.element),w=0;w<x.length;w++)S.appendChild(x[w].element);this.element.appendChild(S)}else this.cells.push(x),this.element.appendChild(x.element)},this.unshift=function(x){if(Array.isArray(x)){this.cells.unshift.apply(this.cells,x);for(var S=U.createFragment(this.element),w=0;w<x.length;w++)S.appendChild(x[w].element);this.element.firstChild?this.element.insertBefore(S,this.element.firstChild):this.element.appendChild(S)}else this.cells.unshift(x),this.element.insertAdjacentElement("afterbegin",x.element)},this.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},this.$cacheCell=function(x){x&&(x.element.remove(),this.cellCache.push(x))},this.createCell=function(x,S,w,G){var H=this.cellCache.pop();if(!H){var z=U.createElement("div");G&&G(z),this.element.appendChild(z),H={element:z,text:"",row:x}}return H.row=x,H}}).call(r.prototype),S.Lines=r})),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/layer/lines"],(function(x,S,w){"use strict";var U=x("../lib/dom"),G=x("../lib/oop"),H=x("../lib/lang"),z=x("../lib/event_emitter").EventEmitter,j=x("./lines").Lines,c=function(x){this.element=U.createElement("div"),this.element.className="ace_layer ace_gutter-layer",x.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new j(this.element),this.$lines.$offsetCoefficient=1};function l(x){var S=document.createTextNode("");x.appendChild(S);var w=U.createElement("span");return x.appendChild(w),x}(function(){G.implement(this,z),this.setSession=function(x){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=x,x&&x.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(x,S){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(x,S)},this.removeGutterDecoration=function(x,S){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(x,S)},this.setAnnotations=function(x){this.$annotations=[];for(var S=0;S<x.length;S++){var w=x[S],U=w.row,G=this.$annotations[U];G||(G=this.$annotations[U]={text:[]});var z=w.text;z=z?H.escapeHTML(z):w.html||"",-1===G.text.indexOf(z)&&G.text.push(z);var j=w.type;"error"==j?G.className=" ace_error":"warning"==j&&" ace_error"!=G.className?G.className=" ace_warning":"info"!=j||G.className||(G.className=" ace_info")}},this.$updateAnnotations=function(x){if(this.$annotations.length){var S=x.start.row,w=x.end.row-S;if(0===w);else if("remove"==x.action)this.$annotations.splice(S,w+1,null);else{var U=new Array(w+1);U.unshift(S,1),this.$annotations.splice.apply(this.$annotations,U)}}},this.update=function(x){this.config=x;var S=this.session,w=x.firstRow,U=Math.min(x.lastRow+x.gutterOffset,S.getLength()-1);this.oldLastRow=U,this.config=x,this.$lines.moveContainer(x),this.$updateCursorRow();for(var G=S.getNextFoldLine(w),H=G?G.start.row:1/0,z=null,j=-1,X=w;;){if(X>H&&(X=G.end.row+1,H=(G=S.getNextFoldLine(X,G))?G.start.row:1/0),X>U){for(;this.$lines.getLength()>j+1;)this.$lines.pop();break}(z=this.$lines.get(++j))?z.row=X:(z=this.$lines.createCell(X,x,this.session,l),this.$lines.push(z)),this.$renderCell(z,x,G,X),X++}this._signal("afterRender"),this.$updateGutterWidth(x)},this.$updateGutterWidth=function(x){var S=this.session,w=S.gutterRenderer||this.$renderer,U=S.$firstLineNumber,G=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||S.$useWrapMode)&&(G=S.getLength()+U-1);var H=w?w.getWidth(S,G,x):G.toString().length*x.characterWidth,z=this.$padding||this.$computePadding();(H+=z.left+z.right)===this.gutterWidth||isNaN(H)||(this.gutterWidth=H,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",H))},this.$updateCursorRow=function(){if(this.$highlightGutterLine){var x=this.session.selection.getCursor();this.$cursorRow!==x.row&&(this.$cursorRow=x.row)}},this.updateLineHighlight=function(){if(this.$highlightGutterLine){var x=this.session.selection.cursor.row;if(this.$cursorRow=x,!this.$cursorCell||this.$cursorCell.row!=x){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var S=this.$lines.cells;this.$cursorCell=null;for(var w=0;w<S.length;w++){var U=S[w];if(U.row>=this.$cursorRow){if(U.row>this.$cursorRow){var G=this.session.getFoldLine(this.$cursorRow);if(!(w>0&&G&&G.start.row==S[w-1].row))break;U=S[w-1]}U.element.className="ace_gutter-active-line "+U.element.className,this.$cursorCell=U;break}}}}},this.scrollLines=function(x){var S=this.config;if(this.config=x,this.$updateCursorRow(),this.$lines.pageChanged(S,x))return this.update(x);this.$lines.moveContainer(x);var w=Math.min(x.lastRow+x.gutterOffset,this.session.getLength()-1),U=this.oldLastRow;if(this.oldLastRow=w,!S||U<x.firstRow)return this.update(x);if(w<S.firstRow)return this.update(x);if(S.firstRow<x.firstRow)for(var G=this.session.getFoldedRowCount(S.firstRow,x.firstRow-1);G>0;G--)this.$lines.shift();if(U>w)for(G=this.session.getFoldedRowCount(w+1,U);G>0;G--)this.$lines.pop();x.firstRow<S.firstRow&&this.$lines.unshift(this.$renderLines(x,x.firstRow,S.firstRow-1)),w>U&&this.$lines.push(this.$renderLines(x,U+1,w)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(x)},this.$renderLines=function(x,S,w){for(var U=[],G=S,H=this.session.getNextFoldLine(G),z=H?H.start.row:1/0;G>z&&(G=H.end.row+1,z=(H=this.session.getNextFoldLine(G,H))?H.start.row:1/0),!(G>w);){var j=this.$lines.createCell(G,x,this.session,l);this.$renderCell(j,x,H,G),U.push(j),G++}return U},this.$renderCell=function(x,S,w,G){var H=x.element,z=this.session,j=H.childNodes[0],X=H.childNodes[1],K=z.$firstLineNumber,q=z.$breakpoints,Y=z.$decorations,Z=z.gutterRenderer||this.$renderer,J=this.$showFoldWidgets&&z.foldWidgets,Q=w?w.start.row:Number.MAX_VALUE,ee="ace_gutter-cell ";if(this.$highlightGutterLine&&(G==this.$cursorRow||w&&G<this.$cursorRow&&G>=Q&&this.$cursorRow<=w.end.row)&&(ee+="ace_gutter-active-line ",this.$cursorCell!=x&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=x)),q[G]&&(ee+=q[G]),Y[G]&&(ee+=Y[G]),this.$annotations[G]&&(ee+=this.$annotations[G].className),H.className!=ee&&(H.className=ee),J){var te=J[G];null==te&&(te=J[G]=z.getFoldWidget(G))}if(te){ee="ace_fold-widget ace_"+te,"start"==te&&G==Q&&G<w.end.row?ee+=" ace_closed":ee+=" ace_open",X.className!=ee&&(X.className=ee);var ne=S.lineHeight+"px";U.setStyle(X.style,"height",ne),U.setStyle(X.style,"display","inline-block")}else X&&U.setStyle(X.style,"display","none");var ie=(Z?Z.getText(z,G):G+K).toString();return ie!==j.data&&(j.data=ie),U.setStyle(x.element.style,"height",this.$lines.computeLineHeight(G,S,z)+"px"),U.setStyle(x.element.style,"top",this.$lines.computeLineTop(G,S,z)+"px"),x.text=ie,x},this.$fixedWidth=!1,this.$highlightGutterLine=!0,this.$renderer="",this.setHighlightGutterLine=function(x){this.$highlightGutterLine=x},this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(x){this.$renderer=!x&&{getWidth:function(){return 0},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(x){x?U.addCssClass(this.element,"ace_folding-enabled"):U.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=x,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var x=U.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(x.borderLeftWidth)||0)+(parseInt(x.paddingLeft)||0)+1,this.$padding.right=(parseInt(x.borderRightWidth)||0)+(parseInt(x.paddingRight)||0),this.$padding},this.getRegion=function(x){var S=this.$padding||this.$computePadding(),w=this.element.getBoundingClientRect();return x.x<S.left+w.left?"markers":this.$showFoldWidgets&&x.x>w.right-S.right?"foldWidgets":void 0}}).call(c.prototype),S.Gutter=c})),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("../range").Range,G=x("../lib/dom"),o=function(x){this.element=G.createElement("div"),this.element.className="ace_layer ace_marker-layer",x.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(x){this.$padding=x},this.setSession=function(x){this.session=x},this.setMarkers=function(x){this.markers=x},this.elt=function(x,S){var w=-1!=this.i&&this.element.childNodes[this.i];w?this.i++:(w=document.createElement("div"),this.element.appendChild(w),this.i=-1),w.style.cssText=S,w.className=x},this.update=function(x){if(x){var S;for(var w in this.config=x,this.i=0,this.markers){var U=this.markers[w];if(U.range){var G=U.range.clipRows(x.firstRow,x.lastRow);if(!G.isEmpty())if(G=G.toScreenRange(this.session),U.renderer){var H=this.$getTop(G.start.row,x),z=this.$padding+G.start.column*x.characterWidth;U.renderer(S,G,z,H,x)}else"fullLine"==U.type?this.drawFullLineMarker(S,G,U.clazz,x):"screenLine"==U.type?this.drawScreenLineMarker(S,G,U.clazz,x):G.isMultiLine()?"text"==U.type?this.drawTextMarker(S,G,U.clazz,x):this.drawMultiLineMarker(S,G,U.clazz,x):this.drawSingleLineMarker(S,G,U.clazz+" ace_start ace_br15",x)}else U.update(S,this,this.session,x)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},this.$getTop=function(x,S){return(x-S.firstRowScreen)*S.lineHeight},this.drawTextMarker=function(x,S,w,G,H){for(var z=this.session,j=S.start.row,X=S.end.row,K=j,q=0,Y=0,Z=z.getScreenLastRowColumn(K),J=new U(K,S.start.column,K,Y);K<=X;K++)J.start.row=J.end.row=K,J.start.column=K==j?S.start.column:z.getRowWrapIndent(K),J.end.column=Z,q=Y,Y=Z,Z=K+1<X?z.getScreenLastRowColumn(K+1):K==X?0:S.end.column,this.drawSingleLineMarker(x,J,w+(K==j?" ace_start":"")+" ace_br"+((K==j||K==j+1&&S.start.column?1:0)|(q<Y?2:0)|(Y>Z?4:0)|(K==X?8:0)),G,K==X?0:1,H)},this.drawMultiLineMarker=function(x,S,w,U,G){var H=this.$padding,z=U.lineHeight,j=this.$getTop(S.start.row,U),X=H+S.start.column*U.characterWidth;if(G=G||"",this.session.$bidiHandler.isBidiRow(S.start.row)?((K=S.clone()).end.row=K.start.row,K.end.column=this.session.getLine(K.start.row).length,this.drawBidiSingleLineMarker(x,K,w+" ace_br1 ace_start",U,null,G)):this.elt(w+" ace_br1 ace_start","height:"+z+"px;right:0;top:"+j+"px;left:"+X+"px;"+(G||"")),this.session.$bidiHandler.isBidiRow(S.end.row)){var K;(K=S.clone()).start.row=K.end.row,K.start.column=0,this.drawBidiSingleLineMarker(x,K,w+" ace_br12",U,null,G)}else{j=this.$getTop(S.end.row,U);var q=S.end.column*U.characterWidth;this.elt(w+" ace_br12","height:"+z+"px;width:"+q+"px;top:"+j+"px;left:"+H+"px;"+(G||""))}if(!((z=(S.end.row-S.start.row-1)*U.lineHeight)<=0)){j=this.$getTop(S.start.row+1,U);var Y=(S.start.column?1:0)|(S.end.column?0:8);this.elt(w+(Y?" ace_br"+Y:""),"height:"+z+"px;right:0;top:"+j+"px;left:"+H+"px;"+(G||""))}},this.drawSingleLineMarker=function(x,S,w,U,G,H){if(this.session.$bidiHandler.isBidiRow(S.start.row))return this.drawBidiSingleLineMarker(x,S,w,U,G,H);var z=U.lineHeight,j=(S.end.column+(G||0)-S.start.column)*U.characterWidth,X=this.$getTop(S.start.row,U),K=this.$padding+S.start.column*U.characterWidth;this.elt(w,"height:"+z+"px;width:"+j+"px;top:"+X+"px;left:"+K+"px;"+(H||""))},this.drawBidiSingleLineMarker=function(x,S,w,U,G,H){var z=U.lineHeight,j=this.$getTop(S.start.row,U),X=this.$padding;this.session.$bidiHandler.getSelections(S.start.column,S.end.column).forEach((function(x){this.elt(w,"height:"+z+"px;width:"+x.width+(G||0)+"px;top:"+j+"px;left:"+(X+x.left)+"px;"+(H||""))}),this)},this.drawFullLineMarker=function(x,S,w,U,G){var H=this.$getTop(S.start.row,U),z=U.lineHeight;S.start.row!=S.end.row&&(z+=this.$getTop(S.end.row,U)-H),this.elt(w,"height:"+z+"px;top:"+H+"px;left:0;right:0;"+(G||""))},this.drawScreenLineMarker=function(x,S,w,U,G){var H=this.$getTop(S.start.row,U),z=U.lineHeight;this.elt(w,"height:"+z+"px;top:"+H+"px;left:0;right:0;"+(G||""))}}).call(o.prototype),S.Marker=o})),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/layer/lines","ace/lib/event_emitter"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("../lib/dom"),H=x("../lib/lang"),z=x("./lines").Lines,j=x("../lib/event_emitter").EventEmitter,c=function(x){this.dom=G,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",x.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new z(this.element)};(function(){U.implement(this,j),this.EOF_CHAR="¶",this.EOL_CHAR_LF="¬",this.EOL_CHAR_CRLF="¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="—",this.SPACE_CHAR="·",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var x=this.session.doc,S="\n"==x.getNewLineCharacter()&&"windows"!=x.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=S)return this.EOL_CHAR=S,!0},this.setPadding=function(x){this.$padding=x,this.element.style.margin="0 "+x+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(x){this.$fontMetrics=x,this.$fontMetrics.on("changeCharacterSize",function(x){this._signal("changeCharacterSize",x)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(x){this.session=x,x&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(x){return this.showInvisibles!=x&&(this.showInvisibles=x,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(x){return this.displayIndentGuides!=x&&(this.displayIndentGuides=x,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var x=this.session.getTabSize();this.tabSize=x;for(var S=this.$tabStrings=[0],w=1;w<x+1;w++)this.showInvisibles?((U=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",U.textContent=H.stringRepeat(this.TAB_CHAR,w),S.push(U)):S.push(this.dom.createTextNode(H.stringRepeat(" ",w),this.element));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var U,G="ace_indent-guide",z="",j="";if(this.showInvisibles){G+=" ace_invisible",z=" ace_invisible_space",j=" ace_invisible_tab";var X=H.stringRepeat(this.SPACE_CHAR,this.tabSize),K=H.stringRepeat(this.TAB_CHAR,this.tabSize)}else K=X=H.stringRepeat(" ",this.tabSize);(U=this.dom.createElement("span")).className=G+z,U.textContent=X,this.$tabStrings[" "]=U,(U=this.dom.createElement("span")).className=G+j,U.textContent=K,this.$tabStrings["\t"]=U}},this.updateLines=function(x,S,w){if(this.config.lastRow!=x.lastRow||this.config.firstRow!=x.firstRow)return this.update(x);this.config=x;for(var U=Math.max(S,x.firstRow),G=Math.min(w,x.lastRow),H=this.element.childNodes,z=0,j=x.firstRow;j<U;j++){if(X=this.session.getFoldLine(j)){if(X.containsRow(U)){U=X.start.row;break}j=X.end.row}z++}for(var X,K=!1,q=(j=U,(X=this.session.getNextFoldLine(j))?X.start.row:1/0);j>q&&(j=X.end.row+1,q=(X=this.session.getNextFoldLine(j,X))?X.start.row:1/0),!(j>G);){var Y=H[z++];if(Y){this.dom.removeChildren(Y),this.$renderLine(Y,j,j==q&&X),K&&(Y.style.top=this.$lines.computeLineTop(j,x,this.session)+"px");var Z=x.lineHeight*this.session.getRowLength(j)+"px";Y.style.height!=Z&&(K=!0,Y.style.height=Z)}j++}if(K)for(;z<this.$lines.cells.length;){var J=this.$lines.cells[z++];J.element.style.top=this.$lines.computeLineTop(J.row,x,this.session)+"px"}},this.scrollLines=function(x){var S=this.config;if(this.config=x,this.$lines.pageChanged(S,x))return this.update(x);this.$lines.moveContainer(x);var w=x.lastRow,U=S?S.lastRow:-1;if(!S||U<x.firstRow)return this.update(x);if(w<S.firstRow)return this.update(x);if(!S||S.lastRow<x.firstRow)return this.update(x);if(x.lastRow<S.firstRow)return this.update(x);if(S.firstRow<x.firstRow)for(var G=this.session.getFoldedRowCount(S.firstRow,x.firstRow-1);G>0;G--)this.$lines.shift();if(S.lastRow>x.lastRow)for(G=this.session.getFoldedRowCount(x.lastRow+1,S.lastRow);G>0;G--)this.$lines.pop();x.firstRow<S.firstRow&&this.$lines.unshift(this.$renderLinesFragment(x,x.firstRow,S.firstRow-1)),x.lastRow>S.lastRow&&this.$lines.push(this.$renderLinesFragment(x,S.lastRow+1,x.lastRow))},this.$renderLinesFragment=function(x,S,w){for(var U=[],H=S,z=this.session.getNextFoldLine(H),j=z?z.start.row:1/0;H>j&&(H=z.end.row+1,j=(z=this.session.getNextFoldLine(H,z))?z.start.row:1/0),!(H>w);){var X=this.$lines.createCell(H,x,this.session),K=X.element;this.dom.removeChildren(K),G.setStyle(K.style,"height",this.$lines.computeLineHeight(H,x,this.session)+"px"),G.setStyle(K.style,"top",this.$lines.computeLineTop(H,x,this.session)+"px"),this.$renderLine(K,H,H==j&&z),this.$useLineGroups()?K.className="ace_line_group":K.className="ace_line",U.push(X),H++}return U},this.update=function(x){this.$lines.moveContainer(x),this.config=x;for(var S=x.firstRow,w=x.lastRow,U=this.$lines;U.getLength();)U.pop();U.push(this.$renderLinesFragment(x,S,w))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(x,S,w,U){for(var G,z=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,j=this.dom.createFragment(this.element),X=0;G=z.exec(U);){var K=G[1],q=G[2],Y=G[3],Z=G[4],J=G[5];if(this.showInvisibles||!q){var Q=X!=G.index?U.slice(X,G.index):"";if(X=G.index+G[0].length,Q&&j.appendChild(this.dom.createTextNode(Q,this.element)),K){var ee=this.session.getScreenTabSize(S+G.index);j.appendChild(this.$tabStrings[ee].cloneNode(!0)),S+=ee-1}else q?this.showInvisibles?((ne=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",ne.textContent=H.stringRepeat(this.SPACE_CHAR,q.length),j.appendChild(ne)):j.appendChild(this.com.createTextNode(q,this.element)):Y?((ne=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",ne.textContent=H.stringRepeat(this.SPACE_CHAR,Y.length),j.appendChild(ne)):Z?(S+=1,(ne=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",ne.className=this.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",ne.textContent=this.showInvisibles?this.SPACE_CHAR:Z,j.appendChild(ne)):J&&(S+=1,(ne=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",ne.className="ace_cjk",ne.textContent=J,j.appendChild(ne))}}if(j.appendChild(this.dom.createTextNode(X?U.slice(X):U,this.element)),this.$textToken[w.type])x.appendChild(j);else{var te="ace_"+w.type.replace(/\./g," ace_"),ne=this.dom.createElement("span");"fold"==w.type&&(ne.style.width=w.value.length*this.config.characterWidth+"px"),ne.className=te,ne.appendChild(j),x.appendChild(ne)}return S+U.length},this.renderIndentGuide=function(x,S,w){var U=S.search(this.$indentGuideRe);if(U<=0||U>=w)return S;if(" "==S[0]){for(var G=(U-=U%this.tabSize)/this.tabSize,H=0;H<G;H++)x.appendChild(this.$tabStrings[" "].cloneNode(!0));return S.substr(U)}if("\t"==S[0]){for(H=0;H<U;H++)x.appendChild(this.$tabStrings["\t"].cloneNode(!0));return S.substr(U)}return S},this.$createLineElement=function(x){var S=this.dom.createElement("div");return S.className="ace_line",S.style.height=this.config.lineHeight+"px",S},this.$renderWrappedLine=function(x,S,w){var U=0,G=0,z=w[0],j=0,X=this.$createLineElement();x.appendChild(X);for(var K=0;K<S.length;K++){var q=S[K],Y=q.value;if(0==K&&this.displayIndentGuides){if(U=Y.length,!(Y=this.renderIndentGuide(X,Y,z)))continue;U-=Y.length}if(U+Y.length<z)j=this.$renderToken(X,j,q,Y),U+=Y.length;else{for(;U+Y.length>=z;)j=this.$renderToken(X,j,q,Y.substring(0,z-U)),Y=Y.substring(z-U),U=z,X=this.$createLineElement(),x.appendChild(X),X.appendChild(this.dom.createTextNode(H.stringRepeat(" ",w.indent),this.element)),j=0,z=w[++G]||Number.MAX_VALUE;0!=Y.length&&(U+=Y.length,j=this.$renderToken(X,j,q,Y))}}w[w.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(X,j,null,"",!0)},this.$renderSimpleLine=function(x,S){var w=0,U=S[0],G=U.value;this.displayIndentGuides&&(G=this.renderIndentGuide(x,G)),G&&(w=this.$renderToken(x,w,U,G));for(var H=1;H<S.length;H++){if(w+(G=(U=S[H]).value).length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(x,w,U,G);w=this.$renderToken(x,w,U,G)}},this.$renderOverflowMessage=function(x,S,w,U,G){w&&this.$renderToken(x,S,w,U.slice(0,this.MAX_LINE_LENGTH-S));var H=this.dom.createElement("span");H.className="ace_inline_button ace_keyword ace_toggle_wrap",H.textContent=G?"<hide>":"<click to see more...>",x.appendChild(H)},this.$renderLine=function(x,S,w){if(w||0==w||(w=this.session.getFoldLine(S)),w)var U=this.$getFoldLineTokens(S,w);else U=this.session.getTokens(S);var G=x;if(U.length){var H=this.session.getRowSplitData(S);H&&H.length?(this.$renderWrappedLine(x,U,H),G=x.lastChild):(G=x,this.$useLineGroups()&&(G=this.$createLineElement(),x.appendChild(G)),this.$renderSimpleLine(G,U))}else this.$useLineGroups()&&(G=this.$createLineElement(),x.appendChild(G));if(this.showInvisibles&&G){w&&(S=w.end.row);var z=this.dom.createElement("span");z.className="ace_invisible ace_invisible_eol",z.textContent=S==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,G.appendChild(z)}},this.$getFoldLineTokens=function(x,S){var w=this.session,U=[],G=w.getTokens(x);return S.walk((function(x,S,H,z,j){null!=x?U.push({type:"fold",value:x}):(j&&(G=w.getTokens(S)),G.length&&function(x,S,w){for(var G=0,H=0;H+x[G].value.length<S;)if(H+=x[G].value.length,++G==x.length)return;for(H!=S&&((z=x[G].value.substring(S-H)).length>w-S&&(z=z.substring(0,w-S)),U.push({type:x[G].type,value:z}),H=S+z.length,G+=1);H<w&&G<x.length;){var z;(z=x[G].value).length+H>w?U.push({type:x[G].type,value:z.substring(0,w-H)}):U.push(x[G]),H+=z.length,G+=1}}(G,z,H))}),S.end.row,this.session.getLine(S.end.row).length),U},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){}}).call(c.prototype),S.Text=c})),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],(function(x,S,w){"use strict";var U=x("../lib/dom"),r=function(x){this.element=U.createElement("div"),this.element.className="ace_layer ace_cursor-layer",x.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),U.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)};(function(){this.$updateOpacity=function(x){for(var S=this.cursors,w=S.length;w--;)U.setStyle(S[w].style,"opacity",x?"":"0")},this.$startCssAnimation=function(){for(var x=this.cursors,S=x.length;S--;)x[S].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){U.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){U.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(x){this.$padding=x},this.setSession=function(x){this.session=x},this.setBlinking=function(x){x!=this.isBlinking&&(this.isBlinking=x,this.restartTimer())},this.setBlinkInterval=function(x){x!=this.blinkInterval&&(this.blinkInterval=x,this.restartTimer())},this.setSmoothBlinking=function(x){x!=this.smoothBlinking&&(this.smoothBlinking=x,U.setCssClass(this.element,"ace_smooth-blinking",x),this.$updateCursors(!0),this.restartTimer())},this.addCursor=function(){var x=U.createElement("div");return x.className="ace_cursor",this.element.appendChild(x),this.cursors.push(x),x},this.removeCursor=function(){if(this.cursors.length>1){var x=this.cursors.pop();return x.parentNode.removeChild(x),x}},this.hideCursor=function(){this.isVisible=!1,U.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,U.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var x=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&U.removeCssClass(this.element,"ace_smooth-blinking"),x(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&setTimeout(function(){U.addCssClass(this.element,"ace_smooth-blinking")}.bind(this)),U.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var S=function(){this.timeoutId=setTimeout((function(){x(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){x(!0),S()}),this.blinkInterval),S()}else this.$stopCssAnimation()},this.getPixelPosition=function(x,S){if(!this.config||!this.session)return{left:0,top:0};x||(x=this.session.selection.getCursor());var w=this.session.documentToScreenPosition(x);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(w.row,x.row)?this.session.$bidiHandler.getPosLeft(w.column):w.column*this.config.characterWidth),top:(w.row-(S?this.config.firstRowScreen:0))*this.config.lineHeight}},this.isCursorInView=function(x,S){return x.top>=0&&x.top<S.maxHeight},this.update=function(x){this.config=x;var S=this.session.$selectionMarkers,w=0,G=0;void 0!==S&&0!==S.length||(S=[{cursor:null}]),w=0;for(var H=S.length;w<H;w++){var z=this.getPixelPosition(S[w].cursor,!0);if(!((z.top>x.height+x.offset||z.top<0)&&w>1)){var j=this.cursors[G++]||this.addCursor(),X=j.style;this.drawCursor?this.drawCursor(j,z,x,S[w],this.session):this.isCursorInView(z,x)?(U.setStyle(X,"display","block"),U.translate(j,z.left,z.top),U.setStyle(X,"width",Math.round(x.characterWidth)+"px"),U.setStyle(X,"height",x.lineHeight+"px")):U.setStyle(X,"display","none")}}for(;this.cursors.length>G;)this.removeCursor();var K=this.session.getOverwrite();this.$setOverwrite(K),this.$pixelPos=z,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(x){x!=this.overwrite&&(this.overwrite=x,x?U.addCssClass(this.element,"ace_overwrite-cursors"):U.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(r.prototype),S.Cursor=r})),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/dom"),H=x("./lib/event"),z=x("./lib/event_emitter").EventEmitter,a=function(x){this.element=G.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=G.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent=" ",this.element.appendChild(this.inner),x.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,H.addListener(this.element,"scroll",this.onScroll.bind(this)),H.addListener(this.element,"mousedown",H.preventDefault)};(function(){U.implement(this,z),this.setVisible=function(x){this.element.style.display=x?"":"none",this.isVisible=x,this.coeff=1}}).call(a.prototype);var c=function(x,S){a.call(this,x),this.scrollTop=0,this.scrollHeight=0,S.$scrollbarWidth=this.width=G.scrollbarWidth(x.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};U.inherits(c,a),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var x=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-x)/(this.coeff-x)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(x){this.element.style.height=x+"px"},this.setInnerHeight=this.setScrollHeight=function(x){this.scrollHeight=x,x>32768?(this.coeff=32768/x,x=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=x+"px"},this.setScrollTop=function(x){this.scrollTop!=x&&(this.skipEvent=!0,this.scrollTop=x,this.element.scrollTop=x*this.coeff)}}.call(c.prototype);var l=function(x,S){a.call(this,x),this.scrollLeft=0,this.height=S.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};U.inherits(l,a),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(x){this.element.style.width=x+"px"},this.setInnerWidth=function(x){this.inner.style.width=x+"px"},this.setScrollWidth=function(x){this.inner.style.width=x+"px"},this.setScrollLeft=function(x){this.scrollLeft!=x&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=x)}}.call(l.prototype),S.ScrollBar=c,S.ScrollBarV=c,S.ScrollBarH=l,S.VScrollBar=c,S.HScrollBar=l})),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],(function(x,S,w){"use strict";var U=x("./lib/event"),r=function(x,S){this.onRender=x,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=S||window;var w=this;this._flush=function(x){w.pending=!1;var S=w.changes;if(S&&(U.blockIdle(100),w.changes=0,w.onRender(S)),w.changes){if(w.$recursionLimit--<0)return;w.schedule()}else w.$recursionLimit=2}};(function(){this.schedule=function(x){this.changes=this.changes|x,this.changes&&!this.pending&&(U.nextFrame(this._flush),this.pending=!0)},this.clear=function(x){var S=this.changes;return this.changes=0,S}}).call(r.prototype),S.RenderLoop=r})),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/lib/useragent","ace/lib/event_emitter"],(function(x,S,w){var U=x("../lib/oop"),G=x("../lib/dom"),H=x("../lib/lang"),z=x("../lib/event"),j=x("../lib/useragent"),X=x("../lib/event_emitter").EventEmitter,K="function"==typeof ResizeObserver,q=200,Y=S.FontMetrics=function(x){this.el=G.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=G.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=G.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),x.appendChild(this.el),this.$measureNode.innerHTML=H.stringRepeat("X",256),this.$characterSize={width:0,height:0},K?this.$addObserver():this.checkForSizeChanges()};(function(){U.implement(this,X),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(x,S){x.width=x.height="auto",x.left=x.top="0px",x.visibility="hidden",x.position="absolute",x.whiteSpace="pre",j.isIE<8?x["font-family"]="inherit":x.font="inherit",x.overflow=S?"hidden":"visible"},this.checkForSizeChanges=function(x){if(void 0===x&&(x=this.$measureSizes()),x&&(this.$characterSize.width!==x.width||this.$characterSize.height!==x.height)){this.$measureNode.style.fontWeight="bold";var S=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=x,this.charSizes=Object.create(null),this.allowBoldFonts=S&&S.width===x.width&&S.height===x.height,this._emit("changeCharacterSize",{data:x})}},this.$addObserver=function(){var x=this;this.$observer=new window.ResizeObserver((function(S){var w=S[0].contentRect;x.checkForSizeChanges({height:w.height,width:w.width/256})})),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var x=this;return this.$pollSizeChangesTimer=z.onIdle((function t(){x.checkForSizeChanges(),z.onIdle(t,500)}),500)},this.setPolling=function(x){x?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(x){var S={height:(x||this.$measureNode).clientHeight,width:(x||this.$measureNode).clientWidth/256};return 0===S.width||0===S.height?null:S},this.$measureCharWidth=function(x){return this.$main.innerHTML=H.stringRepeat(x,256),this.$main.getBoundingClientRect().width/256},this.getCharacterWidth=function(x){var S=this.charSizes[x];return void 0===S&&(S=this.charSizes[x]=this.$measureCharWidth(x)/this.$characterSize.width),S},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(x){return x?(window.getComputedStyle(x).zoom||1)*e(x.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(x,S){return["div",{style:"position: absolute;top:"+x+"px;left:"+S+"px;"}]};this.els=G.buildDom([e(0,0),e(q,0),e(0,q),e(q,q)],this.el)},this.transformCoordinates=function(x,S){function n(x,S,w){var U=x[1]*S[0]-x[0]*S[1];return[(-S[1]*w[0]+S[0]*w[1])/U,(+x[1]*w[0]-x[0]*w[1])/U]}function i(x,S){return[x[0]-S[0],x[1]-S[1]]}function r(x,S){return[x[0]+S[0],x[1]+S[1]]}function o(x,S){return[x*S[0],x*S[1]]}function s(x){var S=x.getBoundingClientRect();return[S.left,S.top]}x&&(x=o(1/this.$getZoom(this.el),x)),this.els||this.$initTransformMeasureNodes();var w=s(this.els[0]),U=s(this.els[1]),G=s(this.els[2]),H=s(this.els[3]),z=n(i(H,U),i(H,G),i(r(U,G),r(H,w))),j=o(1+z[0],i(U,w)),X=o(1+z[1],i(G,w));if(S){var K=S,Y=z[0]*K[0]/q+z[1]*K[1]/q+1,Z=r(o(K[0],j),o(K[1],X));return r(o(1/Y/q,Z),w)}var J=i(x,w),Q=n(i(j,o(z[0],J)),i(X,o(z[1],J)),J);return o(q,Q)}}).call(Y.prototype)})),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter","ace/lib/useragent"],(function(x,S,w){"use strict";var U=x("./lib/oop"),G=x("./lib/dom"),H=x("./config"),z=x("./layer/gutter").Gutter,j=x("./layer/marker").Marker,X=x("./layer/text").Text,K=x("./layer/cursor").Cursor,q=x("./scrollbar").HScrollBar,Y=x("./scrollbar").VScrollBar,Z=x("./renderloop").RenderLoop,J=x("./layer/font_metrics").FontMetrics,Q=x("./lib/event_emitter").EventEmitter,ee='.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;perspective: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {opacity: 0;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_mobile-menu {position: absolute;line-height: 1.5;border-radius: 4px;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;background: white;box-shadow: 1px 3px 2px grey;border: 1px solid #dcdcdc;color: black;}.ace_dark > .ace_mobile-menu {background: #333;color: #ccc;box-shadow: 1px 3px 2px grey;border: 1px solid #444;}.ace_mobile-button {padding: 2px;cursor: pointer;overflow: hidden;}.ace_mobile-button:hover {background-color: #eee;opacity:1;}.ace_mobile-button:active {background-color: #ddd;}.ace_placeholder {font-family: arial;transform: scale(0.9);opacity: 0.7;transform-origin: left;text-indent: 10px;}',te=x("./lib/useragent"),ne=te.isIE;G.importCssString(ee,"ace_editor.css");var _=function(x,S){var w=this;this.container=x||G.createElement("div"),G.addCssClass(this.container,"ace_editor"),G.HI_DPI&&G.addCssClass(this.container,"ace_hidpi"),this.setTheme(S),this.$gutter=G.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=G.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=G.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new z(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new j(this.content);var U=this.$textLayer=new X(this.content);this.canvas=U.element,this.$markerFront=new j(this.content),this.$cursorLayer=new K(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new Y(this.container,this),this.scrollBarH=new q(this.container,this),this.scrollBarV.addEventListener("scroll",(function(x){w.$scrollAnimation||w.session.setScrollTop(x.data-w.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(x){w.$scrollAnimation||w.session.setScrollLeft(x.data-w.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new J(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",(function(x){w.updateCharacterSize(),w.onResize(!0,w.gutterWidth,w.$size.width,w.$size.height),w._signal("changeCharacterSize",x)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!te.isIOS,this.$loop=new Z(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),H.resetOptions(this),H._signal("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,U.implement(this,Q),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin(),G.setStyle(this.scroller.style,"line-height",this.lineHeight+"px")},this.setSession=function(x){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=x,x&&this.scrollMargin.top&&x.getScrollTop()<=0&&x.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(x),this.$markerBack.setSession(x),this.$markerFront.setSession(x),this.$gutterLayer.setSession(x),this.$textLayer.setSession(x),x&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(x,S,w){if(void 0===S&&(S=1/0),this.$changedLines?(this.$changedLines.firstRow>x&&(this.$changedLines.firstRow=x),this.$changedLines.lastRow<S&&(this.$changedLines.lastRow=S)):this.$changedLines={firstRow:x,lastRow:S},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!w)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(x){x?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(x,S,w,U){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=x?1:0;var G=this.container;U||(U=G.clientHeight||G.scrollHeight),w||(w=G.clientWidth||G.scrollWidth);var H=this.$updateCachedSize(x,S,w,U);if(!this.$size.scrollerHeight||!w&&!U)return this.resizing=0;x&&(this.$gutterLayer.$padding=null),x?this.$renderChanges(H|this.$changes,!0):this.$loop.schedule(H|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(x,S,w,U){U-=this.$extraHeight||0;var H=0,z=this.$size,j={width:z.width,height:z.height,scrollerHeight:z.scrollerHeight,scrollerWidth:z.scrollerWidth};if(U&&(x||z.height!=U)&&(z.height=U,H|=this.CHANGE_SIZE,z.scrollerHeight=z.height,this.$horizScroll&&(z.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",H|=this.CHANGE_SCROLL),w&&(x||z.width!=w)){H|=this.CHANGE_SIZE,z.width=w,null==S&&(S=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=S,G.setStyle(this.scrollBarH.element.style,"left",S+"px"),G.setStyle(this.scroller.style,"left",S+this.margin.left+"px"),z.scrollerWidth=Math.max(0,w-S-this.scrollBarV.getWidth()-this.margin.h),G.setStyle(this.$gutter.style,"left",this.margin.left+"px");var X=this.scrollBarV.getWidth()+"px";G.setStyle(this.scrollBarH.element.style,"right",X),G.setStyle(this.scroller.style,"right",X),G.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||x)&&(H|=this.CHANGE_FULL)}return z.$dirty=!w||!U,H&&this._signal("resize",j),H},this.onGutterResize=function(x){var S=this.$showGutter?x:0;S!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,S,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},this.adjustWrapLimit=function(){var x=this.$size.scrollerWidth-2*this.$padding,S=Math.floor(x/this.characterWidth);return this.session.adjustWrapLimit(S,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(x){this.setOption("animatedScroll",x)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(x){this.setOption("showInvisibles",x),this.session.$bidiHandler.setShowInvisibles(x)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(x){this.setOption("displayIndentGuides",x)},this.setShowPrintMargin=function(x){this.setOption("showPrintMargin",x)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(x){this.setOption("printMarginColumn",x)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(x){return this.setOption("showGutter",x)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(x){this.setOption("fadeFoldWidgets",x)},this.setHighlightGutterLine=function(x){this.setOption("highlightGutterLine",x)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var x=G.createElement("div");x.className="ace_layer ace_print-margin-layer",this.$printMarginEl=G.createElement("div"),this.$printMarginEl.className="ace_print-margin",x.appendChild(this.$printMarginEl),this.content.insertBefore(x,this.content.firstChild)}var S=this.$printMarginEl.style;S.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",S.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var x=this.textarea.style,S=this.$composition;if(this.$keepTextAreaAtCursor||S){var w=this.$cursorLayer.$pixelPos;if(w){S&&S.markerRange&&(w=this.$cursorLayer.getPixelPosition(S.markerRange.start,!0));var U=this.layerConfig,H=w.top,z=w.left;H-=U.offset;var j=S&&S.useTextareaForIME?this.lineHeight:ne?0:1;if(H<0||H>U.height-j)G.translate(this.textarea,0,0);else{var X=1,K=this.$size.height-j;if(S)if(S.useTextareaForIME){var q=this.textarea.value;X=this.characterWidth*this.session.$getStringScreenWidth(q)[0]}else H+=this.lineHeight+2;else H+=this.lineHeight;(z-=this.scrollLeft)>this.$size.scrollerWidth-X&&(z=this.$size.scrollerWidth-X),z+=this.gutterWidth+this.margin.left,G.setStyle(x,"height",j+"px"),G.setStyle(x,"width",X+"px"),G.translate(this.textarea,Math.min(z,this.$size.scrollerWidth-X),Math.min(H,K))}}}else G.translate(this.textarea,-100,0)}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var x=this.layerConfig,S=x.lastRow;return this.session.documentToScreenRow(S,0)*x.lineHeight-this.session.getScrollTop()>x.height-x.lineHeight?S-1:S},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(x){this.$padding=x,this.$textLayer.setPadding(x),this.$cursorLayer.setPadding(x),this.$markerFront.setPadding(x),this.$markerBack.setPadding(x),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(x,S,w,U){var G=this.scrollMargin;G.top=0|x,G.bottom=0|S,G.right=0|U,G.left=0|w,G.v=G.top+G.bottom,G.h=G.left+G.right,G.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-G.top),this.updateFull()},this.setMargin=function(x,S,w,U){var G=this.margin;G.top=0|x,G.bottom=0|S,G.right=0|U,G.left=0|w,G.v=G.top+G.bottom,G.h=G.left+G.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(x){this.setOption("hScrollBarAlwaysVisible",x)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(x){this.setOption("vScrollBarAlwaysVisible",x)},this.$updateScrollBarV=function(){var x=this.layerConfig.maxHeight,S=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(x-=(S-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>x-S&&(x=this.scrollTop+S,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(x+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(x,S){if(this.$changes&&(x|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(x||S)){if(this.$size.$dirty)return this.$changes|=x,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var w=this.layerConfig;if(x&this.CHANGE_FULL||x&this.CHANGE_SIZE||x&this.CHANGE_TEXT||x&this.CHANGE_LINES||x&this.CHANGE_SCROLL||x&this.CHANGE_H_SCROLL){if(x|=this.$computeLayerConfig()|this.$loop.clear(),w.firstRow!=this.layerConfig.firstRow&&w.firstRowScreen==this.layerConfig.firstRowScreen){var U=this.scrollTop+(w.firstRow-this.layerConfig.firstRow)*this.lineHeight;U>0&&(this.scrollTop=U,x|=this.CHANGE_SCROLL,x|=this.$computeLayerConfig()|this.$loop.clear())}w=this.layerConfig,this.$updateScrollBarV(),x&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),G.translate(this.content,-this.scrollLeft,-w.offset);var H=w.width+2*this.$padding+"px",z=w.minHeight+"px";G.setStyle(this.content.style,"width",H),G.setStyle(this.content.style,"height",z)}if(x&this.CHANGE_H_SCROLL&&(G.translate(this.content,-this.scrollLeft,-w.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),x&this.CHANGE_FULL)return this.$changedLines=null,this.$textLayer.update(w),this.$showGutter&&this.$gutterLayer.update(w),this.$markerBack.update(w),this.$markerFront.update(w),this.$cursorLayer.update(w),this.$moveTextAreaToCursor(),void this._signal("afterRender");if(x&this.CHANGE_SCROLL)return this.$changedLines=null,x&this.CHANGE_TEXT||x&this.CHANGE_LINES?this.$textLayer.update(w):this.$textLayer.scrollLines(w),this.$showGutter&&(x&this.CHANGE_GUTTER||x&this.CHANGE_LINES?this.$gutterLayer.update(w):this.$gutterLayer.scrollLines(w)),this.$markerBack.update(w),this.$markerFront.update(w),this.$cursorLayer.update(w),this.$moveTextAreaToCursor(),void this._signal("afterRender");x&this.CHANGE_TEXT?(this.$changedLines=null,this.$textLayer.update(w),this.$showGutter&&this.$gutterLayer.update(w)):x&this.CHANGE_LINES?(this.$updateLines()||x&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(w):x&this.CHANGE_TEXT||x&this.CHANGE_GUTTER?this.$showGutter&&this.$gutterLayer.update(w):x&this.CHANGE_CURSOR&&this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(w),x&this.CHANGE_CURSOR&&(this.$cursorLayer.update(w),this.$moveTextAreaToCursor()),x&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(w),x&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(w),this._signal("afterRender")}else this.$changes|=x},this.$autosize=function(){var x=this.session.getScreenLength()*this.lineHeight,S=this.$maxLines*this.lineHeight,w=Math.min(S,Math.max((this.$minLines||1)*this.lineHeight,x))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(w+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&w>this.$maxPixelHeight&&(w=this.$maxPixelHeight);var U=!(w<=2*this.lineHeight)&&x>S;if(w!=this.desiredHeight||this.$size.height!=this.desiredHeight||U!=this.$vScroll){U!=this.$vScroll&&(this.$vScroll=U,this.scrollBarV.setVisible(U));var G=this.container.clientWidth;this.container.style.height=w+"px",this.$updateCachedSize(!0,this.$gutterWidth,G,w),this.desiredHeight=w,this._signal("autosize")}},this.$computeLayerConfig=function(){var x=this.session,S=this.$size,w=S.height<=2*this.lineHeight,U=this.session.getScreenLength()*this.lineHeight,G=this.$getLongestLine(),H=!w&&(this.$hScrollBarAlwaysVisible||S.scrollerWidth-G-2*this.$padding<0),z=this.$horizScroll!==H;z&&(this.$horizScroll=H,this.scrollBarH.setVisible(H));var j=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var X=S.scrollerHeight+this.lineHeight,K=!this.$maxLines&&this.$scrollPastEnd?(S.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;U+=K;var q=this.scrollMargin;this.session.setScrollTop(Math.max(-q.top,Math.min(this.scrollTop,U-S.scrollerHeight+q.bottom))),this.session.setScrollLeft(Math.max(-q.left,Math.min(this.scrollLeft,G+2*this.$padding-S.scrollerWidth+q.right)));var Y=!w&&(this.$vScrollBarAlwaysVisible||S.scrollerHeight-U+K<0||this.scrollTop>q.top),Z=j!==Y;Z&&(this.$vScroll=Y,this.scrollBarV.setVisible(Y));var J,Q,ee=this.scrollTop%this.lineHeight,te=Math.ceil(X/this.lineHeight)-1,ne=Math.max(0,Math.round((this.scrollTop-ee)/this.lineHeight)),ie=ne+te,re=this.lineHeight;ne=x.screenToDocumentRow(ne,0);var oe=x.getFoldLine(ne);oe&&(ne=oe.start.row),J=x.documentToScreenRow(ne,0),Q=x.getRowLength(ne)*re,ie=Math.min(x.screenToDocumentRow(ie,0),x.getLength()-1),X=S.scrollerHeight+x.getRowLength(ie)*re+Q,ee=this.scrollTop-J*re;var ae=0;return(this.layerConfig.width!=G||z)&&(ae=this.CHANGE_H_SCROLL),(z||Z)&&(ae|=this.$updateCachedSize(!0,this.gutterWidth,S.width,S.height),this._signal("scrollbarVisibilityChanged"),Z&&(G=this.$getLongestLine())),this.layerConfig={width:G,padding:this.$padding,firstRow:ne,firstRowScreen:J,lastRow:ie,lineHeight:re,characterWidth:this.characterWidth,minHeight:X,maxHeight:U,offset:ee,gutterOffset:re?Math.max(0,Math.ceil((ee+S.height-S.scrollerHeight)/re)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(G-this.$padding),ae},this.$updateLines=function(){if(this.$changedLines){var x=this.$changedLines.firstRow,S=this.$changedLines.lastRow;this.$changedLines=null;var w=this.layerConfig;if(!(x>w.lastRow+1||S<w.firstRow))return S===1/0?(this.$showGutter&&this.$gutterLayer.update(w),void this.$textLayer.update(w)):(this.$textLayer.updateLines(w,x,S),!0)}},this.$getLongestLine=function(){var x=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(x+=1),this.$textLayer&&x>this.$textLayer.MAX_LINE_LENGTH&&(x=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(x*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(x,S){this.$gutterLayer.addGutterDecoration(x,S)},this.removeGutterDecoration=function(x,S){this.$gutterLayer.removeGutterDecoration(x,S)},this.updateBreakpoints=function(x){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(x){this.$gutterLayer.setAnnotations(x),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(x,S,w){this.scrollCursorIntoView(x,w),this.scrollCursorIntoView(S,w)},this.scrollCursorIntoView=function(x,S,w){if(0!==this.$size.scrollerHeight){var U=this.$cursorLayer.getPixelPosition(x),G=U.left,H=U.top,z=w&&w.top||0,j=w&&w.bottom||0,X=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;X+z>H?(S&&X+z>H+this.lineHeight&&(H-=S*this.$size.scrollerHeight),0===H&&(H=-this.scrollMargin.top),this.session.setScrollTop(H)):X+this.$size.scrollerHeight-j<H+this.lineHeight&&(S&&X+this.$size.scrollerHeight-j<H-this.lineHeight&&(H+=S*this.$size.scrollerHeight),this.session.setScrollTop(H+this.lineHeight+j-this.$size.scrollerHeight));var K=this.scrollLeft;K>G?(G<this.$padding+2*this.layerConfig.characterWidth&&(G=-this.scrollMargin.left),this.session.setScrollLeft(G)):K+this.$size.scrollerWidth<G+this.characterWidth?this.session.setScrollLeft(Math.round(G+this.characterWidth-this.$size.scrollerWidth)):K<=this.$padding&&G-K<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(x){this.session.setScrollTop(x*this.lineHeight)},this.alignCursor=function(x,S){"number"==typeof x&&(x={row:x,column:0});var w=this.$cursorLayer.getPixelPosition(x),U=this.$size.scrollerHeight-this.lineHeight,G=w.top-U*(S||0);return this.session.setScrollTop(G),G},this.STEPS=8,this.$calcSteps=function(x,S){var w,U,G=0,H=this.STEPS,z=[];for(G=0;G<H;++G)z.push((w=G/this.STEPS,U=x,(S-x)*(Math.pow(w-1,3)+1)+U));return z},this.scrollToLine=function(x,S,w,U){var G=this.$cursorLayer.getPixelPosition({row:x,column:0}).top;S&&(G-=this.$size.scrollerHeight/2);var H=this.scrollTop;this.session.setScrollTop(G),!1!==w&&this.animateScrolling(H,U)},this.animateScrolling=function(x,S){var w=this.scrollTop;if(this.$animatedScroll){var U=this;if(x!=w){if(this.$scrollAnimation){var G=this.$scrollAnimation.steps;if(G.length&&(x=G[0])==w)return}var H=U.$calcSteps(x,w);this.$scrollAnimation={from:x,to:w,steps:H},clearInterval(this.$timer),U.session.setScrollTop(H.shift()),U.session.$scrollTop=w,this.$timer=setInterval((function(){H.length?(U.session.setScrollTop(H.shift()),U.session.$scrollTop=w):null!=w?(U.session.$scrollTop=-1,U.session.setScrollTop(w),w=null):(U.$timer=clearInterval(U.$timer),U.$scrollAnimation=null,S&&S())}),10)}}},this.scrollToY=function(x){this.scrollTop!==x&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=x)},this.scrollToX=function(x){this.scrollLeft!==x&&(this.scrollLeft=x),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(x,S){this.session.setScrollTop(S),this.session.setScrollLeft(S)},this.scrollBy=function(x,S){S&&this.session.setScrollTop(this.session.getScrollTop()+S),x&&this.session.setScrollLeft(this.session.getScrollLeft()+x)},this.isScrollableBy=function(x,S){return S<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||S>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||x<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||x>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0},this.pixelToScreenCoordinates=function(x,S){var w;if(this.$hasCssTransforms){w={top:0,left:0};var U=this.$fontMetrics.transformCoordinates([x,S]);x=U[1]-this.gutterWidth-this.margin.left,S=U[0]}else w=this.scroller.getBoundingClientRect();var G=x+this.scrollLeft-w.left-this.$padding,H=G/this.characterWidth,z=Math.floor((S+this.scrollTop-w.top)/this.lineHeight),j=this.$blockCursor?Math.floor(H):Math.round(H);return{row:z,column:j,side:H-j>0?1:-1,offsetX:G}},this.screenToTextCoordinates=function(x,S){var w;if(this.$hasCssTransforms){w={top:0,left:0};var U=this.$fontMetrics.transformCoordinates([x,S]);x=U[1]-this.gutterWidth-this.margin.left,S=U[0]}else w=this.scroller.getBoundingClientRect();var G=x+this.scrollLeft-w.left-this.$padding,H=G/this.characterWidth,z=this.$blockCursor?Math.floor(H):Math.round(H),j=Math.floor((S+this.scrollTop-w.top)/this.lineHeight);return this.session.screenToDocumentPosition(j,Math.max(z,0),G)},this.textToScreenCoordinates=function(x,S){var w=this.scroller.getBoundingClientRect(),U=this.session.documentToScreenPosition(x,S),G=this.$padding+(this.session.$bidiHandler.isBidiRow(U.row,x)?this.session.$bidiHandler.getPosLeft(U.column):Math.round(U.column*this.characterWidth)),H=U.row*this.lineHeight;return{pageX:w.left+G-this.scrollLeft,pageY:w.top+H-this.scrollTop}},this.visualizeFocus=function(){G.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){G.removeCssClass(this.container,"ace_focus")},this.showComposition=function(x){this.$composition=x,x.cssText||(x.cssText=this.textarea.style.cssText),x.useTextareaForIME=this.$useTextareaForIME,this.$useTextareaForIME?(G.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):x.markerId=this.session.addMarker(x.markerRange,"ace_composition_marker","text")},this.setCompositionText=function(x){var S=this.session.selection.cursor;this.addToken(x,"composition_placeholder",S.row,S.column),this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),G.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText,this.$composition=null,this.$cursorLayer.element.style.display="")},this.addToken=function(x,S,w,U){var G=this.session;G.bgTokenizer.lines[w]=null;var H={type:S,value:x},z=G.getTokens(w);if(null==U)z.push(H);else for(var j=0,X=0;X<z.length;X++){var K=z[X];if(U<=(j+=K.value.length)){var q=K.value.length-(j-U),Y=K.value.slice(0,q),Z=K.value.slice(q);z.splice(X,1,{type:K.type,value:Y},H,{type:K.type,value:Z});break}}this.updateLines(w,w)},this.setTheme=function(x,S){var w=this;if(this.$themeId=x,w._dispatchEvent("themeChange",{theme:x}),x&&"string"!=typeof x)s(x);else{var U=x||this.$options.theme.initialValue;H.loadModule(["theme",U],s)}function s(U){if(w.$themeId!=x)return S&&S();if(!U||!U.cssClass)throw new Error("couldn't load module "+x+" or it didn't call define");U.$id&&(w.$themeId=U.$id),G.importCssString(U.cssText,U.cssClass,w.container),w.theme&&G.removeCssClass(w.container,w.theme.cssClass);var H="padding"in U?U.padding:"padding"in(w.theme||{})?4:w.$padding;w.$padding&&H!=w.$padding&&w.setPadding(H),w.$theme=U.cssClass,w.theme=U,G.addCssClass(w.container,U.cssClass),G.setCssClass(w.container,"ace_dark",U.isDark),w.$size&&(w.$size.width=0,w.$updateSizeAsync()),w._dispatchEvent("themeLoaded",{theme:U}),S&&S()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(x,S){G.setCssClass(this.container,x,!1!==S)},this.unsetStyle=function(x){G.removeCssClass(this.container,x)},this.setCursorStyle=function(x){G.setStyle(this.scroller.style,"cursor",x)},this.setMouseCursor=function(x){G.setStyle(this.scroller.style,"cursor",x)},this.attachToShadowRoot=function(){G.importCssString(ee,"ace_editor.css",this.container)},this.destroy=function(){this.freeze(),this.$fontMetrics.destroy(),this.$cursorLayer.destroy()}}).call(_.prototype),H.defineOptions(_.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(x){this.$textLayer.setShowInvisibles(x)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(x){"number"==typeof x&&(this.$printMarginColumn=x),this.$showPrintMargin=!!x,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(x){this.$gutter.style.display=x?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(x){G.setCssClass(this.$gutter,"ace_fade-fold-widgets",x)},initialValue:!1},showFoldWidgets:{set:function(x){this.$gutterLayer.setShowFoldWidgets(x),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(x){this.$textLayer.setDisplayIndentGuides(x)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(x){this.$gutterLayer.setHighlightGutterLine(x),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(x){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(x){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(x){"number"==typeof x&&(x+="px"),this.container.style.fontSize=x,this.updateFontSize()},initialValue:12},fontFamily:{set:function(x){this.container.style.fontFamily=x,this.updateFontSize()}},maxLines:{set:function(x){this.updateFull()}},minLines:{set:function(x){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(x){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(x){x=+x||0,this.$scrollPastEnd!=x&&(this.$scrollPastEnd=x,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(x){this.$gutterLayer.$fixedWidth=!!x,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(x){this.setTheme(x)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!te.isMobile&&!te.isIE}}),S.VirtualRenderer=_})),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("../lib/net"),H=x("../lib/event_emitter").EventEmitter,z=x("../config");function a(x){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(z.get("loadWorkerFromBlob")){var S=function(x){var S="importScripts('"+G.qualifyURL(x)+"');";try{return new Blob([S],{type:"application/javascript"})}catch(x){var w=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return w.append(S),w.getBlob("application/javascript")}}(x),w=(window.URL||window.webkitURL).createObjectURL(S);return new Worker(w)}return new Worker(x)}var c=function(x){x.postMessage||(x=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=x,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){U.implement(this,H),this.$createWorkerFromOldConfig=function(S,w,U,G,H){if(x.nameToUrl&&!x.toUrl&&(x.toUrl=x.nameToUrl),z.get("packaged")||!x.toUrl)G=G||z.moduleUrl(w,"worker");else{var j=this.$normalizePath;G=G||j(x.toUrl("ace/worker/worker.js",null,"_"));var X={};S.forEach((function(S){X[S]=j(x.toUrl(S,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=a(G),H&&this.send("importScripts",H),this.$worker.postMessage({init:!0,tlns:X,module:w,classname:U}),this.$worker},this.onMessage=function(x){var S=x.data;switch(S.type){case"event":this._signal(S.name,{data:S.data});break;case"call":var w=this.callbacks[S.id];w&&(w(S.data),delete this.callbacks[S.id]);break;case"error":this.reportError(S.data);break;case"log":window.console&&console.log&&console.log.apply(console,S.data)}},this.reportError=function(x){window.console&&console.error&&console.error(x)},this.$normalizePath=function(x){return G.qualifyURL(x)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(x,S){this.$worker.postMessage({command:x,args:S})},this.call=function(x,S,w){if(w){var U=this.callbackId++;this.callbacks[U]=w,S.push(U)}this.send(x,S)},this.emit=function(x,S){try{S.data&&S.data.err&&(S.data.err={message:S.data.err.message,stack:S.data.err.stack,code:S.data.err.code}),this.$worker.postMessage({event:x,data:{data:S.data}})}catch(x){console.error(x.stack)}},this.attachToDocument=function(x){this.$doc&&this.terminate(),this.$doc=x,this.call("setValue",[x.getValue()]),x.on("change",this.changeListener)},this.changeListener=function(x){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==x.action?this.deltaQueue.push(x.start,x.lines):this.deltaQueue.push(x.start,x.end)},this.$sendDeltaQueue=function(){var x=this.deltaQueue;x&&(this.deltaQueue=null,x.length>50&&x.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:x}))}}).call(c.prototype),S.UIWorkerClient=function(x,S,w){var U=null,G=!1,j=Object.create(H),X=[],K=new c({messageBuffer:X,terminate:function(){},postMessage:function(x){X.push(x),U&&(G?setTimeout(h):h())}});K.setEmitSync=function(x){G=x};var h=function(){var x=X.shift();x.command?U[x.command].apply(U,x.args):x.event&&j._signal(x.event,x.data)};return j.postMessage=function(x){K.onMessage({data:x})},j.callback=function(x,S){this.postMessage({type:"call",id:S,data:x})},j.emit=function(x,S){this.postMessage({type:"event",name:x,data:S})},z.loadModule(["worker",S],(function(x){for(U=new x[w](j);X.length;)h()})),K},S.WorkerClient=c,S.createWorker=a})),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],(function(x,S,w){"use strict";var U=x("./range").Range,G=x("./lib/event_emitter").EventEmitter,H=x("./lib/oop"),s=function(x,S,w,U,G,H){var z=this;this.length=S,this.session=x,this.doc=x.getDocument(),this.mainClass=G,this.othersClass=H,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=U,this.$onCursorChange=function(){setTimeout((function(){z.onCursorChange()}))},this.$pos=w;var j=x.getUndoManager().$undoStack||x.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=j.length,this.setup(),x.selection.on("changeCursor",this.$onCursorChange)};(function(){H.implement(this,G),this.setup=function(){var x=this,S=this.doc,w=this.session;this.selectionBefore=w.selection.toJSON(),w.selection.inMultiSelectMode&&w.selection.toSingleRange(),this.pos=S.createAnchor(this.$pos.row,this.$pos.column);var G=this.pos;G.$insertRight=!0,G.detach(),G.markerId=w.addMarker(new U(G.row,G.column,G.row,G.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(w){var U=S.createAnchor(w.row,w.column);U.$insertRight=!0,U.detach(),x.others.push(U)})),w.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var x=this.session,S=this;this.othersActive=!0,this.others.forEach((function(w){w.markerId=x.addMarker(new U(w.row,w.column,w.row,w.column+S.length),S.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var x=0;x<this.others.length;x++)this.session.removeMarker(this.others[x].markerId)}},this.onUpdate=function(x){if(this.$updating)return this.updateAnchors(x);var S=x;if(S.start.row===S.end.row&&S.start.row===this.pos.row){this.$updating=!0;var w="insert"===x.action?S.end.column-S.start.column:S.start.column-S.end.column,G=S.start.column>=this.pos.column&&S.start.column<=this.pos.column+this.length+1,H=S.start.column-this.pos.column;if(this.updateAnchors(x),G&&(this.length+=w),G&&!this.session.$fromUndo)if("insert"===x.action)for(var z=this.others.length-1;z>=0;z--){var j={row:(X=this.others[z]).row,column:X.column+H};this.doc.insertMergedLines(j,x.lines)}else if("remove"===x.action)for(z=this.others.length-1;z>=0;z--){var X;j={row:(X=this.others[z]).row,column:X.column+H},this.doc.remove(new U(j.row,j.column,j.row,j.column-w))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(x){this.pos.onChange(x);for(var S=this.others.length;S--;)this.others[S].onChange(x);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var x=this,S=this.session,n=function(w,G){S.removeMarker(w.markerId),w.markerId=S.addMarker(new U(w.row,w.column,w.row,w.column+x.length),G,null,!1)};n(this.pos,this.mainClass);for(var w=this.others.length;w--;)n(this.others[w],this.othersClass)}},this.onCursorChange=function(x){if(!this.$updating&&this.session){var S=this.session.selection.getCursor();S.row===this.pos.row&&S.column>=this.pos.column&&S.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",x)):(this.hideOtherMarkers(),this._emit("cursorLeave",x))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var x=this.session.getUndoManager(),S=(x.$undoStack||x.$undostack).length-this.$undoStackDepth,w=0;w<S;w++)x.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(s.prototype),S.PlaceHolder=s})),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(x,S,w){var U=x("../lib/event"),G=x("../lib/useragent");function o(x,S){return x.row==S.row&&x.column==S.column}S.onMouseDown=function(x){var S=x.domEvent,w=S.altKey,H=S.shiftKey,z=S.ctrlKey,j=x.getAccelKey(),X=x.getButton();if(z&&G.isMac&&(X=S.button),x.editor.inMultiSelectMode&&2==X)x.editor.textInput.onContextMenu(x.domEvent);else if(z||w||j){if(0===X){var K,q=x.editor,Y=q.selection,Z=q.inMultiSelectMode,J=x.getDocumentPosition(),Q=Y.getCursor(),ee=x.inSelection()||Y.isEmpty()&&o(J,Q),te=x.x,ne=x.y,ie=q.session,re=q.renderer.pixelToScreenCoordinates(te,ne),oe=re;if(q.$mouseHandler.$enableJumpToDef)z&&w||j&&w?K=H?"block":"add":w&&q.$blockSelectEnabled&&(K="block");else if(j&&!w){if(K="add",!Z&&H)return}else w&&q.$blockSelectEnabled&&(K="block");if(K&&G.isMac&&S.ctrlKey&&q.$mouseHandler.cancelContextMenu(),"add"==K){if(!Z&&ee)return;if(!Z){var ae=Y.toOrientedRange();q.addSelectionMarker(ae)}var se=Y.rangeList.rangeAtPoint(J);q.inVirtualSelectionMode=!0,H&&(se=null,ae=Y.ranges[0]||ae,q.removeSelectionMarker(ae)),q.once("mouseup",(function(){var x=Y.toOrientedRange();se&&x.isEmpty()&&o(se.cursor,x.cursor)?Y.substractPoint(x.cursor):(H?Y.substractPoint(ae.cursor):ae&&(q.removeSelectionMarker(ae),Y.addRange(ae)),Y.addRange(x)),q.inVirtualSelectionMode=!1}))}else if("block"==K){var le;x.stop(),q.inVirtualSelectionMode=!0;var ce=[],b=function(){var x=q.renderer.pixelToScreenCoordinates(te,ne),S=ie.screenToDocumentPosition(x.row,x.column,x.offsetX);o(oe,x)&&o(S,Y.lead)||(oe=x,q.selection.moveToPosition(S),q.renderer.scrollCursorIntoView(),q.removeSelectionMarkers(ce),ce=Y.rectangularRangeBlock(oe,re),q.$mouseHandler.$clickSelection&&1==ce.length&&ce[0].isEmpty()&&(ce[0]=q.$mouseHandler.$clickSelection.clone()),ce.forEach(q.addSelectionMarker,q),q.updateSelectionMarkers())};Z&&!j?Y.toSingleRange():!Z&&j&&(le=Y.toOrientedRange(),q.addSelectionMarker(le)),H?re=ie.documentToScreenPosition(Y.lead):Y.moveToPosition(J),oe={row:-1,column:-1};var ue=b;U.capture(q.container,(function(x){te=x.clientX,ne=x.clientY}),(function(x){b(),clearInterval(he),q.removeSelectionMarkers(ce),ce.length||(ce=[Y.toOrientedRange()]),le&&(q.removeSelectionMarker(le),Y.toSingleRange(le));for(var S=0;S<ce.length;S++)Y.addRange(ce[S]);q.inVirtualSelectionMode=!1,q.$mouseHandler.$clickSelection=null}));var he=setInterval((function(){ue()}),20);return x.preventDefault()}}}else 0===X&&x.editor.inMultiSelectMode&&x.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],(function(x,S,w){S.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(x){x.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(x){x.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(x){x.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(x){x.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(x){x.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(x){x.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(x){x.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(x){x.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",description:"Split into lines",exec:function(x){x.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(x){x.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(x){x.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],S.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(x){x.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(x){return x&&x.inMultiSelectMode}}];var U=x("../keyboard/hash_handler").HashHandler;S.keyboardHandler=new U(S.multiSelectCommands)})),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],(function(x,S,w){var U=x("./range_list").RangeList,G=x("./range").Range,H=x("./selection").Selection,z=x("./mouse/multi_select_handler").onMouseDown,j=x("./lib/event"),X=x("./lib/lang"),K=x("./commands/multi_select_commands");S.commands=K.defaultCommands.concat(K.multiSelectCommands);var q=new(0,x("./search").Search),Y=x("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(Y.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(x,S){if(x){if(!this.inMultiSelectMode&&0===this.rangeCount){var w=this.toOrientedRange();if(this.rangeList.add(w),this.rangeList.add(x),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),S||this.fromOrientedRange(x);this.rangeList.removeAll(),this.rangeList.add(w),this.$onAddRange(w)}x.cursor||(x.cursor=x.end);var U=this.rangeList.add(x);return this.$onAddRange(x),U.length&&this.$onRemoveRange(U),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),S||this.fromOrientedRange(x)}},this.toSingleRange=function(x){x=x||this.ranges[0];var S=this.rangeList.removeAll();S.length&&this.$onRemoveRange(S),x&&this.fromOrientedRange(x)},this.substractPoint=function(x){var S=this.rangeList.substractPoint(x);if(S)return this.$onRemoveRange(S),S[0]},this.mergeOverlappingRanges=function(){var x=this.rangeList.merge();x.length&&this.$onRemoveRange(x)},this.$onAddRange=function(x){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(x),this._signal("addRange",{range:x})},this.$onRemoveRange=function(x){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var S=this.rangeList.ranges.pop();x.push(S),this.rangeCount=0}for(var w=x.length;w--;){var U=this.ranges.indexOf(x[w]);this.ranges.splice(U,1)}this._signal("removeRange",{ranges:x}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(S=S||this.ranges[0])&&!S.isEqual(this.getRange())&&this.fromOrientedRange(S)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new U,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var x=this.rangeList.ranges,S=x[x.length-1],w=G.fromPoints(x[0].start,S.end);this.toSingleRange(),this.setSelectionRange(w,S.cursor==S.start)}else{w=this.getRange();var U=this.isBackwards(),H=w.start.row,z=w.end.row;if(H==z){if(U)var j=w.end,X=w.start;else j=w.start,X=w.end;return this.addRange(G.fromPoints(X,X)),void this.addRange(G.fromPoints(j,j))}var K=[],q=this.getLineRange(H,!0);q.start.column=w.start.column,K.push(q);for(var Y=H+1;Y<z;Y++)K.push(this.getLineRange(Y,!0));(q=this.getLineRange(z,!0)).end.column=w.end.column,K.push(q),K.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var x=this.rangeList.ranges,S=x[x.length-1],w=G.fromPoints(x[0].start,S.end);this.toSingleRange(),this.setSelectionRange(w,S.cursor==S.start)}else{var U=this.session.documentToScreenPosition(this.cursor),H=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(U,H).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(x,S,w){var U=[],H=x.column<S.column;if(H)var z=x.column,j=S.column,X=x.offsetX,K=S.offsetX;else z=S.column,j=x.column,X=S.offsetX,K=x.offsetX;var q,Y,Z,J=x.row<S.row;if(J)var Q=x.row,ee=S.row;else Q=S.row,ee=x.row;z<0&&(z=0),Q<0&&(Q=0),Q==ee&&(w=!0);for(var te=Q;te<=ee;te++){var ne=G.fromPoints(this.session.screenToDocumentPosition(te,z,X),this.session.screenToDocumentPosition(te,j,K));if(ne.isEmpty()){if(q&&(Z=q,(Y=ne.end).row==Z.row&&Y.column==Z.column))break;q=ne.end}ne.cursor=H?ne.start:ne.end,U.push(ne)}if(J&&U.reverse(),!w){for(var ie=U.length-1;U[ie].isEmpty()&&ie>0;)ie--;if(ie>0)for(var re=0;U[re].isEmpty();)re++;for(var oe=ie;oe>=re;oe--)U[oe].isEmpty()&&U.splice(oe,1)}return U}}.call(H.prototype);var Z=x("./editor").Editor;function p(x){x.$multiselectOnSessionChange||(x.$onAddRange=x.$onAddRange.bind(x),x.$onRemoveRange=x.$onRemoveRange.bind(x),x.$onMultiSelect=x.$onMultiSelect.bind(x),x.$onSingleSelect=x.$onSingleSelect.bind(x),x.$multiselectOnSessionChange=S.onSessionChange.bind(x),x.$checkMultiselectChange=x.$checkMultiselectChange.bind(x),x.$multiselectOnSessionChange(x),x.on("changeSession",x.$multiselectOnSessionChange),x.on("mousedown",z),x.commands.addCommands(K.defaultCommands),function(x){if(x.textInput){var S=x.textInput.getElement(),w=!1;j.addListener(S,"keydown",(function(S){var U=18==S.keyCode&&!(S.ctrlKey||S.shiftKey||S.metaKey);x.$blockSelectEnabled&&U?w||(x.renderer.setMouseCursor("crosshair"),w=!0):w&&i()})),j.addListener(S,"keyup",i),j.addListener(S,"blur",i)}function i(S){w&&(x.renderer.setMouseCursor(""),w=!1)}}(x))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(x){x.cursor||(x.cursor=x.end);var S=this.getSelectionStyle();return x.marker=this.session.addMarker(x,"ace_selection",S),this.session.$selectionMarkers.push(x),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,x},this.removeSelectionMarker=function(x){if(x.marker){this.session.removeMarker(x.marker);var S=this.session.$selectionMarkers.indexOf(x);-1!=S&&this.session.$selectionMarkers.splice(S,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(x){for(var S=this.session.$selectionMarkers,w=x.length;w--;){var U=x[w];if(U.marker){this.session.removeMarker(U.marker);var G=S.indexOf(U);-1!=G&&S.splice(G,1)}}this.session.selectionMarkerCount=S.length},this.$onAddRange=function(x){this.addSelectionMarker(x.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(x){this.removeSelectionMarkers(x.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(x){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(K.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(x){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(K.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(x){var S=x.command,w=x.editor;if(w.multiSelect){if(S.multiSelectAction)"forEach"==S.multiSelectAction?U=w.forEachSelection(S,x.args):"forEachLine"==S.multiSelectAction?U=w.forEachSelection(S,x.args,!0):"single"==S.multiSelectAction?(w.exitMultiSelectMode(),U=S.exec(w,x.args||{})):U=S.multiSelectAction(w,x.args||{});else{var U=S.exec(w,x.args||{});w.multiSelect.addRange(w.multiSelect.toOrientedRange()),w.multiSelect.mergeOverlappingRanges()}return U}},this.forEachSelection=function(x,S,w){if(!this.inVirtualSelectionMode){var U,G=w&&w.keepOrder,z=1==w||w&&w.$byLines,j=this.session,X=this.selection,K=X.rangeList,q=(G?X:K).ranges;if(!q.length)return x.exec?x.exec(this,S||{}):x(this,S||{});var Y=X._eventRegistry;X._eventRegistry={};var Z=new H(j);this.inVirtualSelectionMode=!0;for(var J=q.length;J--;){if(z)for(;J>0&&q[J].start.row==q[J-1].end.row;)J--;Z.fromOrientedRange(q[J]),Z.index=J,this.selection=j.selection=Z;var Q=x.exec?x.exec(this,S||{}):x(this,S||{});U||void 0===Q||(U=Q),Z.toOrientedRange(q[J])}Z.detach(),this.selection=j.selection=X,this.inVirtualSelectionMode=!1,X._eventRegistry=Y,X.mergeOverlappingRanges(),X.ranges[0]&&X.fromOrientedRange(X.ranges[0]);var ee=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),ee&&ee.from==ee.to&&this.renderer.animateScrolling(ee.from),U}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var x="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var S=this.multiSelect.rangeList.ranges,w=[],U=0;U<S.length;U++)w.push(this.session.getTextRange(S[U]));var G=this.session.getDocument().getNewLineCharacter();(x=w.join(G)).length==(w.length-1)*G.length&&(x="")}else this.selection.isEmpty()||(x=this.session.getTextRange(this.getSelectionRange()));return x},this.$checkMultiselectChange=function(x,S){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var w=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&S==this.multiSelect.anchor)return;var U=S==this.multiSelect.anchor?w.cursor==w.start?w.end:w.start:w.cursor;U.row!=S.row||this.session.$clipPositionToDocument(U.row,U.column).column!=S.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(x,S,w){if((S=S||{}).needle=x||S.needle,null==S.needle){var U=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();S.needle=this.session.getTextRange(U)}this.$search.set(S);var G=this.$search.findAll(this.session);if(!G.length)return 0;var H=this.multiSelect;w||H.toSingleRange(G[0]);for(var z=G.length;z--;)H.addRange(G[z],!0);return U&&H.rangeList.rangeAtPoint(U.start)&&H.addRange(U,!0),G.length},this.selectMoreLines=function(x,S){var w=this.selection.toOrientedRange(),U=w.cursor==w.end,H=this.session.documentToScreenPosition(w.cursor);this.selection.$desiredColumn&&(H.column=this.selection.$desiredColumn);var z,j=this.session.screenToDocumentPosition(H.row+x,H.column);if(w.isEmpty())K=j;else var X=this.session.documentToScreenPosition(U?w.end:w.start),K=this.session.screenToDocumentPosition(X.row+x,X.column);if(U?(z=G.fromPoints(j,K)).cursor=z.start:(z=G.fromPoints(K,j)).cursor=z.end,z.desiredColumn=H.column,this.selection.inMultiSelectMode){if(S)var q=w.cursor}else this.selection.addRange(w);this.selection.addRange(z),q&&this.selection.substractPoint(q)},this.transposeSelections=function(x){for(var S=this.session,w=S.multiSelect,U=w.ranges,G=U.length;G--;)if((j=U[G]).isEmpty()){var H=S.getWordRange(j.start.row,j.start.column);j.start.row=H.start.row,j.start.column=H.start.column,j.end.row=H.end.row,j.end.column=H.end.column}w.mergeOverlappingRanges();var z=[];for(G=U.length;G--;){var j=U[G];z.unshift(S.getTextRange(j))}for(x<0?z.unshift(z.pop()):z.push(z.shift()),G=U.length;G--;)H=(j=U[G]).clone(),S.replace(j,z[G]),j.start.row=H.start.row,j.start.column=H.start.column;w.fromOrientedRange(w.ranges[0])},this.selectMore=function(x,S,w){var U=this.session,G=U.multiSelect.toOrientedRange();if(!G.isEmpty()||((G=U.getWordRange(G.start.row,G.start.column)).cursor=-1==x?G.start:G.end,this.multiSelect.addRange(G),!w)){var H=U.getTextRange(G),z=function(x,S,w){return q.$options.wrap=!0,q.$options.needle=S,q.$options.backwards=-1==w,q.find(x)}(U,H,x);z&&(z.cursor=-1==x?z.start:z.end,this.session.unfold(z),this.multiSelect.addRange(z),this.renderer.scrollCursorIntoView(null,.5)),S&&this.multiSelect.substractPoint(G.cursor)}},this.alignCursors=function(){var x=this.session,S=x.multiSelect,w=S.ranges,U=-1,H=w.filter((function(x){if(x.cursor.row==U)return!0;U=x.cursor.row}));if(w.length&&H.length!=w.length-1){H.forEach((function(x){S.substractPoint(x.cursor)}));var z=0,j=1/0,K=w.map((function(S){var w=S.cursor,U=x.getLine(w.row).substr(w.column).search(/\S/g);return-1==U&&(U=0),w.column>z&&(z=w.column),U<j&&(j=U),U}));w.forEach((function(S,w){var U=S.cursor,H=z-U.column,q=K[w]-j;H>q?x.insert(U,X.stringRepeat(" ",H-q)):x.remove(new G(U.row,U.column,U.row,U.column-H+q)),S.start.column=S.end.column=z,S.start.row=S.end.row=U.row,S.cursor=S.end})),S.fromOrientedRange(w[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var q=this.selection.getRange(),Y=q.start.row,Z=q.end.row,J=Y==Z;if(J){var Q,ee=this.session.getLength();do{Q=this.session.getLine(Z)}while(/[=:]/.test(Q)&&++Z<ee);do{Q=this.session.getLine(Y)}while(/[=:]/.test(Q)&&--Y>0);Y<0&&(Y=0),Z>=ee&&(Z=ee-1)}var te=this.session.removeFullLines(Y,Z);te=this.$reAlignText(te,J),this.session.insert({row:Y,column:0},te.join("\n")+"\n"),J||(q.start.column=0,q.end.column=te[te.length-1].length),this.selection.setRange(q)}},this.$reAlignText=function(x,S){var w,U,G,H=!0,z=!0;return x.map((function(x){var S=x.match(/(\s*)(.*?)(\s*)([=:].*)/);return S?null==w?(w=S[1].length,U=S[2].length,G=S[3].length,S):(w+U+G!=S[1].length+S[2].length+S[3].length&&(z=!1),w!=S[1].length&&(H=!1),w>S[1].length&&(w=S[1].length),U<S[2].length&&(U=S[2].length),G>S[3].length&&(G=S[3].length),S):[x]})).map(S?l:H?z?function(x){return x[2]?a(w+U-x[2].length)+x[2]+a(G)+x[4].replace(/^([=:])\s+/,"$1 "):x[0]}:l:function(x){return x[2]?a(w)+x[2]+a(G)+x[4].replace(/^([=:])\s+/,"$1 "):x[0]});function a(x){return X.stringRepeat(" ",x)}function l(x){return x[2]?a(w)+x[2]+a(U-x[2].length+G)+x[4].replace(/^([=:])\s+/,"$1 "):x[0]}}}).call(Z.prototype),S.onSessionChange=function(x){var S=x.session;S&&!S.multiSelect&&(S.$selectionMarkers=[],S.selection.$initRangeList(),S.multiSelect=S.selection),this.multiSelect=S&&S.multiSelect;var w=x.oldSession;w&&(w.multiSelect.off("addRange",this.$onAddRange),w.multiSelect.off("removeRange",this.$onRemoveRange),w.multiSelect.off("multiSelect",this.$onMultiSelect),w.multiSelect.off("singleSelect",this.$onSingleSelect),w.multiSelect.lead.off("change",this.$checkMultiselectChange),w.multiSelect.anchor.off("change",this.$checkMultiselectChange)),S&&(S.multiSelect.on("addRange",this.$onAddRange),S.multiSelect.on("removeRange",this.$onRemoveRange),S.multiSelect.on("multiSelect",this.$onMultiSelect),S.multiSelect.on("singleSelect",this.$onSingleSelect),S.multiSelect.lead.on("change",this.$checkMultiselectChange),S.multiSelect.anchor.on("change",this.$checkMultiselectChange)),S&&this.inMultiSelectMode!=S.selection.inMultiSelectMode&&(S.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},S.MultiSelect=p,x("./config").defineOptions(Z.prototype,"editor",{enableMultiselect:{set:function(x){p(this),x?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",z)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",z))},value:!0},enableBlockSelect:{set:function(x){this.$blockSelectEnabled=x},value:!0}})})),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var U=x("../../range").Range,G=S.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(x,S,w){var U=x.getLine(w);return this.foldingStartMarker.test(U)?"start":"markbeginend"==S&&this.foldingStopMarker&&this.foldingStopMarker.test(U)?"end":""},this.getFoldWidgetRange=function(x,S,w){return null},this.indentationBlock=function(x,S,w){var G=/\S/,H=x.getLine(S),z=H.search(G);if(-1!=z){for(var j=w||H.length,X=x.getLength(),K=S,q=S;++S<X;){var Y=x.getLine(S).search(G);if(-1!=Y){if(Y<=z){var Z=x.getTokenAt(S,0);if(!Z||"string"!==Z.type)break}q=S}}if(q>K){var J=x.getLine(q).length;return new U(K,j,q,J)}}},this.openingBracketBlock=function(x,S,w,G,H){var z={row:w,column:G+1},j=x.$findClosingBracket(S,z,H);if(j){var X=x.foldWidgets[j.row];return null==X&&(X=x.getFoldWidget(j.row)),"start"==X&&j.row>z.row&&(j.row--,j.column=x.getLine(j.row).length),U.fromPoints(z,j)}},this.closingBracketBlock=function(x,S,w,G,H){var z={row:w,column:G},j=x.$findOpeningBracket(S,z);if(j)return j.column++,z.column--,U.fromPoints(j,z)}}).call(G.prototype)})),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(x,S,w){"use strict";S.isDark=!1,S.cssClass="ace-tm",S.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',S.$id="ace/theme/textmate",x("../lib/dom").importCssString(S.cssText,S.cssClass)})),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],(function(x,S,w){"use strict";x("./lib/oop");var U=x("./lib/dom");function r(x){this.session=x,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}x("./range").Range,function(){this.getRowLength=function(x){var S;return S=this.lineWidgets&&this.lineWidgets[x]&&this.lineWidgets[x].rowCount||0,this.$useWrapMode&&this.$wrapData[x]?this.$wrapData[x].length+1+S:1+S},this.$getWidgetScreenLength=function(){var x=0;return this.lineWidgets.forEach((function(S){S&&S.rowCount&&!S.hidden&&(x+=S.rowCount)})),x},this.$onChangeEditor=function(x){this.attach(x.editor)},this.attach=function(x){x&&x.widgetManager&&x.widgetManager!=this&&x.widgetManager.detach(),this.editor!=x&&(this.detach(),this.editor=x,x&&(x.widgetManager=this,x.renderer.on("beforeRender",this.measureWidgets),x.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(x){var S=this.editor;if(S){this.editor=null,S.widgetManager=null,S.renderer.off("beforeRender",this.measureWidgets),S.renderer.off("afterRender",this.renderWidgets);var w=this.session.lineWidgets;w&&w.forEach((function(x){x&&x.el&&x.el.parentNode&&(x._inDocument=!1,x.el.parentNode.removeChild(x.el))}))}},this.updateOnFold=function(x,S){var w=S.lineWidgets;if(w&&x.action){for(var U=x.data,G=U.start.row,H=U.end.row,z="add"==x.action,j=G+1;j<H;j++)w[j]&&(w[j].hidden=z);w[H]&&(z?w[G]?w[H].hidden=z:w[G]=w[H]:(w[G]==w[H]&&(w[G]=void 0),w[H].hidden=z))}},this.updateOnChange=function(x){var S=this.session.lineWidgets;if(S){var w=x.start.row,U=x.end.row-w;if(0===U);else if("remove"==x.action)S.splice(w+1,U).forEach((function(x){x&&this.removeLineWidget(x)}),this),this.$updateRows();else{var G=new Array(U);G.unshift(w,0),S.splice.apply(S,G),this.$updateRows()}}},this.$updateRows=function(){var x=this.session.lineWidgets;if(x){var S=!0;x.forEach((function(x,w){if(x)for(S=!1,x.row=w;x.$oldWidget;)x.$oldWidget.row=w,x=x.$oldWidget})),S&&(this.session.lineWidgets=null)}},this.addLineWidget=function(x){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var S=this.session.lineWidgets[x.row];S&&(x.$oldWidget=S,S.el&&S.el.parentNode&&(S.el.parentNode.removeChild(S.el),S._inDocument=!1)),this.session.lineWidgets[x.row]=x,x.session=this.session;var w=this.editor.renderer;x.html&&!x.el&&(x.el=U.createElement("div"),x.el.innerHTML=x.html),x.el&&(U.addCssClass(x.el,"ace_lineWidgetContainer"),x.el.style.position="absolute",x.el.style.zIndex=5,w.container.appendChild(x.el),x._inDocument=!0),x.coverGutter||(x.el.style.zIndex=3),null==x.pixelHeight&&(x.pixelHeight=x.el.offsetHeight),null==x.rowCount&&(x.rowCount=x.pixelHeight/w.layerConfig.lineHeight);var G=this.session.getFoldAt(x.row,0);if(x.$fold=G,G){var H=this.session.lineWidgets;x.row!=G.end.row||H[G.start.row]?x.hidden=!0:H[G.start.row]=x}return this.session._emit("changeFold",{data:{start:{row:x.row}}}),this.$updateRows(),this.renderWidgets(null,w),this.onWidgetChanged(x),x},this.removeLineWidget=function(x){if(x._inDocument=!1,x.session=null,x.el&&x.el.parentNode&&x.el.parentNode.removeChild(x.el),x.editor&&x.editor.destroy)try{x.editor.destroy()}catch(x){}if(this.session.lineWidgets){var S=this.session.lineWidgets[x.row];if(S==x)this.session.lineWidgets[x.row]=x.$oldWidget,x.$oldWidget&&this.onWidgetChanged(x.$oldWidget);else for(;S;){if(S.$oldWidget==x){S.$oldWidget=x.$oldWidget;break}S=S.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:x.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(x){for(var S=this.session.lineWidgets,w=S&&S[x],U=[];w;)U.push(w),w=w.$oldWidget;return U},this.onWidgetChanged=function(x){this.session._changedWidgets.push(x),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(x,S){var w=this.session._changedWidgets,U=S.layerConfig;if(w&&w.length){for(var G=1/0,H=0;H<w.length;H++){var z=w[H];if(z&&z.el&&z.session==this.session){if(!z._inDocument){if(this.session.lineWidgets[z.row]!=z)continue;z._inDocument=!0,S.container.appendChild(z.el)}z.h=z.el.offsetHeight,z.fixedWidth||(z.w=z.el.offsetWidth,z.screenWidth=Math.ceil(z.w/U.characterWidth));var j=z.h/U.lineHeight;z.coverLine&&(j-=this.session.getRowLineCount(z.row))<0&&(j=0),z.rowCount!=j&&(z.rowCount=j,z.row<G&&(G=z.row))}}G!=1/0&&(this.session._emit("changeFold",{data:{start:{row:G}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(x,S){var w=S.layerConfig,U=this.session.lineWidgets;if(U){for(var G=Math.min(this.firstRow,w.firstRow),H=Math.max(this.lastRow,w.lastRow,U.length);G>0&&!U[G];)G--;this.firstRow=w.firstRow,this.lastRow=w.lastRow,S.$cursorLayer.config=w;for(var z=G;z<=H;z++){var j=U[z];if(j&&j.el)if(j.hidden)j.el.style.top=-100-(j.pixelHeight||0)+"px";else{j._inDocument||(j._inDocument=!0,S.container.appendChild(j.el));var X=S.$cursorLayer.getPixelPosition({row:z,column:0},!0).top;j.coverLine||(X+=w.lineHeight*this.session.getRowLineCount(j.row)),j.el.style.top=X-w.offset+"px";var K=j.coverGutter?0:S.gutterWidth;j.fixedWidth||(K-=S.scrollLeft),j.el.style.left=K+"px",j.fullWidth&&j.screenWidth&&(j.el.style.minWidth=w.width+2*w.padding+"px"),j.fixedWidth?j.el.style.right=S.scrollBar.getWidth()+"px":j.el.style.right=""}}}}}.call(r.prototype),S.LineWidgets=r})),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],(function(x,S,w){"use strict";var U=x("../line_widgets").LineWidgets,G=x("../lib/dom"),H=x("../range").Range;S.showErrorMarker=function(x,S){var w=x.session;w.widgetManager||(w.widgetManager=new U(w),w.widgetManager.attach(x));var z=x.getCursorPosition(),j=z.row,X=w.widgetManager.getWidgetsAtRow(j).filter((function(x){return"errorMarker"==x.type}))[0];X?X.destroy():j-=S;var K,q=function(x,S,w){var U=x.getAnnotations().sort(H.comparePoints);if(U.length){var G=function(x,S,w){for(var U=0,G=x.length-1;U<=G;){var H=U+G>>1,z=w(S,x[H]);if(z>0)U=H+1;else{if(!(z<0))return H;G=H-1}}return-(U+1)}(U,{row:S,column:-1},H.comparePoints);G<0&&(G=-G-1),G>=U.length?G=w>0?0:U.length-1:0===G&&w<0&&(G=U.length-1);var z=U[G];if(z&&w){if(z.row===S){do{z=U[G+=w]}while(z&&z.row===S);if(!z)return U.slice()}var j=[];S=z.row;do{j[w<0?"unshift":"push"](z),z=U[G+=w]}while(z&&z.row==S);return j.length&&j}}}(w,j,S);if(q){var Y=q[0];z.column=(Y.pos&&"number"!=typeof Y.column?Y.pos.sc:Y.column)||0,z.row=Y.row,K=x.renderer.$gutterLayer.$annotations[z.row]}else{if(X)return;K={text:["Looks good!"],className:"ace_ok"}}x.session.unfold(z.row),x.selection.moveToPosition(z);var Z={row:z.row,fixedWidth:!0,coverGutter:!0,el:G.createElement("div"),type:"errorMarker"},J=Z.el.appendChild(G.createElement("div")),Q=Z.el.appendChild(G.createElement("div"));Q.className="error_widget_arrow "+K.className;var ee=x.renderer.$cursorLayer.getPixelPosition(z).left;Q.style.left=ee+x.renderer.gutterWidth-5+"px",Z.el.className="error_widget_wrapper",J.className="error_widget "+K.className,J.innerHTML=K.text.join("<br>"),J.appendChild(G.createElement("div"));var g=function(x,S,w){if(0===S&&("esc"===w||"return"===w))return Z.destroy(),{command:"null"}};Z.destroy=function(){x.$mouseHandler.isMousePressed||(x.keyBinding.removeKeyboardHandler(g),w.widgetManager.removeLineWidget(Z),x.off("changeSelection",Z.destroy),x.off("changeSession",Z.destroy),x.off("mouseup",Z.destroy),x.off("change",Z.destroy))},x.keyBinding.addKeyboardHandler(g),x.on("changeSelection",Z.destroy),x.on("changeSession",Z.destroy),x.on("mouseup",Z.destroy),x.on("change",Z.destroy),x.session.widgetManager.addLineWidget(Z),Z.el.onmousedown=x.focus.bind(x),x.renderer.scrollCursorIntoView(null,.5,{bottom:Z.el.offsetHeight})},G.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/range","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],(function(x,S,U){"use strict";x("./lib/fixoldbrowsers");var G=x("./lib/dom"),H=x("./lib/event"),z=x("./range").Range,j=x("./editor").Editor,X=x("./edit_session").EditSession,K=x("./undomanager").UndoManager,q=x("./virtual_renderer").VirtualRenderer;x("./worker/worker_client"),x("./keyboard/hash_handler"),x("./placeholder"),x("./multi_select"),x("./mode/folding/fold_mode"),x("./theme/textmate"),x("./ext/error_marker"),S.config=x("./config"),S.require=x,S.define=w(3),S.edit=function(x,w){if("string"==typeof x){var U=x;if(!(x=document.getElementById(U)))throw new Error("ace.edit can't find div #"+U)}if(x&&x.env&&x.env.editor instanceof j)return x.env.editor;var z="";if(x&&/input|textarea/i.test(x.tagName)){var X=x;z=X.value,x=G.createElement("pre"),X.parentNode.replaceChild(x,X)}else x&&(z=x.textContent,x.innerHTML="");var K=S.createEditSession(z),Y=new j(new q(x),K,w),Z={document:K,editor:Y,onResize:Y.resize.bind(Y,null)};return X&&(Z.textarea=X),H.addListener(window,"resize",Z.onResize),Y.on("destroy",(function(){H.removeListener(window,"resize",Z.onResize),Z.editor.container.env=null})),Y.container.env=Y.env=Z,Y},S.createEditSession=function(x,S){var w=new X(x,S);return w.setUndoManager(new K),w},S.Range=z,S.Editor=j,S.EditSession=X,S.UndoManager=K,S.VirtualRenderer=q,S.version=S.config.version})),ace.require(["ace/ace"],(function(S){for(var w in S&&(S.config.init(!0),S.define=ace.define),window.ace||(window.ace=S),S)S.hasOwnProperty(w)&&(window.ace[w]=S[w]);window.ace.default=window.ace,x&&(x.exports=window.ace)})),x.exports=ace}).call(this,w(0)(x))},function(x,S,w){(function(x){ace.define("ace/mode/doc_comment_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"comment.doc.tag",regex:"@[\\w\\d_]+"},o.getTagRule(),{defaultToken:"comment.doc",caseInsensitive:!0}]}};U.inherits(o,G),o.getTagRule=function(x){return{token:"comment.doc.tag.storage.type",regex:"\\b(?:TODO|FIXME|XXX|HACK)\\b"}},o.getStartRule=function(x){return{token:"comment.doc",regex:"\\/\\*(?=\\*)",next:x}},o.getEndRule=function(x){return{token:"comment.doc",regex:"\\*\\/",next:x}},S.DocCommentHighlightRules=o})),ace.define("ace/mode/c_cpp_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/doc_comment_highlight_rules","ace/mode/text_highlight_rules"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("./doc_comment_highlight_rules").DocCommentHighlightRules,H=x("./text_highlight_rules").TextHighlightRules,z=S.cFunctions="\\b(?:hypot(?:f|l)?|s(?:scanf|ystem|nprintf|ca(?:nf|lb(?:n(?:f|l)?|ln(?:f|l)?))|i(?:n(?:h(?:f|l)?|f|l)?|gn(?:al|bit))|tr(?:s(?:tr|pn)|nc(?:py|at|mp)|c(?:spn|hr|oll|py|at|mp)|to(?:imax|d|u(?:l(?:l)?|max)|k|f|l(?:d|l)?)|error|pbrk|ftime|len|rchr|xfrm)|printf|et(?:jmp|vbuf|locale|buf)|qrt(?:f|l)?|w(?:scanf|printf)|rand)|n(?:e(?:arbyint(?:f|l)?|xt(?:toward(?:f|l)?|after(?:f|l)?))|an(?:f|l)?)|c(?:s(?:in(?:h(?:f|l)?|f|l)?|qrt(?:f|l)?)|cos(?:h(?:f)?|f|l)?|imag(?:f|l)?|t(?:ime|an(?:h(?:f|l)?|f|l)?)|o(?:s(?:h(?:f|l)?|f|l)?|nj(?:f|l)?|pysign(?:f|l)?)|p(?:ow(?:f|l)?|roj(?:f|l)?)|e(?:il(?:f|l)?|xp(?:f|l)?)|l(?:o(?:ck|g(?:f|l)?)|earerr)|a(?:sin(?:h(?:f|l)?|f|l)?|cos(?:h(?:f|l)?|f|l)?|tan(?:h(?:f|l)?|f|l)?|lloc|rg(?:f|l)?|bs(?:f|l)?)|real(?:f|l)?|brt(?:f|l)?)|t(?:ime|o(?:upper|lower)|an(?:h(?:f|l)?|f|l)?|runc(?:f|l)?|gamma(?:f|l)?|mp(?:nam|file))|i(?:s(?:space|n(?:ormal|an)|cntrl|inf|digit|u(?:nordered|pper)|p(?:unct|rint)|finite|w(?:space|c(?:ntrl|type)|digit|upper|p(?:unct|rint)|lower|al(?:num|pha)|graph|xdigit|blank)|l(?:ower|ess(?:equal|greater)?)|al(?:num|pha)|gr(?:eater(?:equal)?|aph)|xdigit|blank)|logb(?:f|l)?|max(?:div|abs))|di(?:v|fftime)|_Exit|unget(?:c|wc)|p(?:ow(?:f|l)?|ut(?:s|c(?:har)?|wc(?:har)?)|error|rintf)|e(?:rf(?:c(?:f|l)?|f|l)?|x(?:it|p(?:2(?:f|l)?|f|l|m1(?:f|l)?)?))|v(?:s(?:scanf|nprintf|canf|printf|w(?:scanf|printf))|printf|f(?:scanf|printf|w(?:scanf|printf))|w(?:scanf|printf)|a_(?:start|copy|end|arg))|qsort|f(?:s(?:canf|e(?:tpos|ek))|close|tell|open|dim(?:f|l)?|p(?:classify|ut(?:s|c|w(?:s|c))|rintf)|e(?:holdexcept|set(?:e(?:nv|xceptflag)|round)|clearexcept|testexcept|of|updateenv|r(?:aiseexcept|ror)|get(?:e(?:nv|xceptflag)|round))|flush|w(?:scanf|ide|printf|rite)|loor(?:f|l)?|abs(?:f|l)?|get(?:s|c|pos|w(?:s|c))|re(?:open|e|ad|xp(?:f|l)?)|m(?:in(?:f|l)?|od(?:f|l)?|a(?:f|l|x(?:f|l)?)?))|l(?:d(?:iv|exp(?:f|l)?)|o(?:ngjmp|cal(?:time|econv)|g(?:1(?:p(?:f|l)?|0(?:f|l)?)|2(?:f|l)?|f|l|b(?:f|l)?)?)|abs|l(?:div|abs|r(?:int(?:f|l)?|ound(?:f|l)?))|r(?:int(?:f|l)?|ound(?:f|l)?)|gamma(?:f|l)?)|w(?:scanf|c(?:s(?:s(?:tr|pn)|nc(?:py|at|mp)|c(?:spn|hr|oll|py|at|mp)|to(?:imax|d|u(?:l(?:l)?|max)|k|f|l(?:d|l)?|mbs)|pbrk|ftime|len|r(?:chr|tombs)|xfrm)|to(?:b|mb)|rtomb)|printf|mem(?:set|c(?:hr|py|mp)|move))|a(?:s(?:sert|ctime|in(?:h(?:f|l)?|f|l)?)|cos(?:h(?:f|l)?|f|l)?|t(?:o(?:i|f|l(?:l)?)|exit|an(?:h(?:f|l)?|2(?:f|l)?|f|l)?)|b(?:s|ort))|g(?:et(?:s|c(?:har)?|env|wc(?:har)?)|mtime)|r(?:int(?:f|l)?|ound(?:f|l)?|e(?:name|alloc|wind|m(?:ove|quo(?:f|l)?|ainder(?:f|l)?))|a(?:nd|ise))|b(?:search|towc)|m(?:odf(?:f|l)?|em(?:set|c(?:hr|py|mp)|move)|ktime|alloc|b(?:s(?:init|towcs|rtowcs)|towc|len|r(?:towc|len))))\\b",a=function(){var x=this.$keywords=this.createKeywordMapper({"keyword.control":"break|case|continue|default|do|else|for|goto|if|_Pragma|return|switch|while|catch|operator|try|throw|using","storage.type":"asm|__asm__|auto|bool|_Bool|char|_Complex|double|enum|float|_Imaginary|int|long|short|signed|struct|typedef|union|unsigned|void|class|wchar_t|template|char16_t|char32_t","storage.modifier":"const|extern|register|restrict|static|volatile|inline|private|protected|public|friend|explicit|virtual|export|mutable|typename|constexpr|new|delete|alignas|alignof|decltype|noexcept|thread_local","keyword.operator":"and|and_eq|bitand|bitor|compl|not|not_eq|or|or_eq|typeid|xor|xor_eq|const_cast|dynamic_cast|reinterpret_cast|static_cast|sizeof|namespace","variable.language":"this","constant.language":"NULL|true|false|TRUE|FALSE|nullptr"},"identifier"),S=/\\(?:['"?\\abfnrtv]|[0-7]{1,3}|x[a-fA-F\d]{2}|u[a-fA-F\d]{4}U[a-fA-F\d]{8}|.)/.source,w="%"+/(\d+\$)?/.source+/[#0\- +']*/.source+/[,;:_]?/.source+/((-?\d+)|\*(-?\d+\$)?)?/.source+/(\.((-?\d+)|\*(-?\d+\$)?)?)?/.source+/(hh|h|ll|l|j|t|z|q|L|vh|vl|v|hv|hl)?/.source+/(\[[^"\]]+\]|[diouxXDOUeEfFgGaACcSspn%])/.source;this.$rules={start:[{token:"comment",regex:"//$",next:"start"},{token:"comment",regex:"//",next:"singleLineComment"},G.getStartRule("doc-start"),{token:"comment",regex:"\\/\\*",next:"comment"},{token:"string",regex:"'(?:"+S+"|.)?'"},{token:"string.start",regex:'"',stateName:"qqstring",next:[{token:"string",regex:/\\\s*$/,next:"qqstring"},{token:"constant.language.escape",regex:S},{token:"constant.language.escape",regex:w},{token:"string.end",regex:'"|$',next:"start"},{defaultToken:"string"}]},{token:"string.start",regex:'R"\\(',stateName:"rawString",next:[{token:"string.end",regex:'\\)"',next:"start"},{defaultToken:"string"}]},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+(L|l|UL|ul|u|U|F|f|ll|LL|ull|ULL)?\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?(L|l|UL|ul|u|U|F|f|ll|LL|ull|ULL)?\\b"},{token:"keyword",regex:"#\\s*(?:include|import|pragma|line|define|undef|version)\\b",next:"directive"},{token:"keyword",regex:"#\\s*(?:endif|if|ifdef|else|elif|ifndef)\\b"},{token:"support.function.C99.c",regex:z},{token:x,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*"},{token:"keyword.operator",regex:/--|\+\+|<<=|>>=|>>>=|<>|&&|\|\||\?:|[*%\/+\-&\^|~!<>=]=?/},{token:"punctuation.operator",regex:"\\?|\\:|\\,|\\;|\\."},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],comment:[{token:"comment",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}],singleLineComment:[{token:"comment",regex:/\\$/,next:"singleLineComment"},{token:"comment",regex:/$/,next:"start"},{defaultToken:"comment"}],directive:[{token:"constant.other.multiline",regex:/\\/},{token:"constant.other.multiline",regex:/.*\\/},{token:"constant.other",regex:"\\s*<.+?>",next:"start"},{token:"constant.other",regex:'\\s*["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]',next:"start"},{token:"constant.other",regex:"\\s*['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']",next:"start"},{token:"constant.other",regex:/[^\\\/]+/,next:"start"}]},this.embedRules(G,"doc-",[G.getEndRule("start")]),this.normalizeRules()};U.inherits(a,H),S.c_cppHighlightRules=a})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(x,S,w){"use strict";var U=x("../range").Range,r=function(){};(function(){this.checkOutdent=function(x,S){return!!/^\s+$/.test(x)&&/^\s*\}/.test(S)},this.autoOutdent=function(x,S){var w=x.getLine(S).match(/^(\s*\})/);if(!w)return 0;var G=w[1].length,H=x.findMatchingBracket({row:S,column:G});if(!H||H.row==S)return 0;var z=this.$getIndent(x.getLine(H.row));x.replace(new U(S,0,S,G-1),z)},this.$getIndent=function(x){return x.match(/^\s*/)[0]}}).call(r.prototype),S.MatchingBraceOutdent=r})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(x,S,w){"use strict";var U=x("../../lib/oop"),G=x("../../range").Range,H=x("./fold_mode").FoldMode,z=S.FoldMode=function(x){x&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+x.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+x.end)))};U.inherits(z,H),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(x,S,w){var U=x.getLine(w);if(this.singleLineBlockCommentRe.test(U)&&!this.startRegionRe.test(U)&&!this.tripleStarBlockCommentRe.test(U))return"";var G=this._getFoldWidgetBase(x,S,w);return!G&&this.startRegionRe.test(U)?"start":G},this.getFoldWidgetRange=function(x,S,w,U){var G,H=x.getLine(w);if(this.startRegionRe.test(H))return this.getCommentRegionBlock(x,H,w);if(G=H.match(this.foldingStartMarker)){var z=G.index;if(G[1])return this.openingBracketBlock(x,G[1],w,z);var j=x.getCommentFoldRange(w,z+G[0].length,1);return j&&!j.isMultiLine()&&(U?j=this.getSectionRange(x,w):"all"!=S&&(j=null)),j}return"markbegin"!==S&&(G=H.match(this.foldingStopMarker))?(z=G.index+G[0].length,G[1]?this.closingBracketBlock(x,G[1],w,z):x.getCommentFoldRange(w,z,-1)):void 0},this.getSectionRange=function(x,S){for(var w=x.getLine(S),U=w.search(/\S/),H=S,z=w.length,j=S+=1,X=x.getLength();++S<X;){var K=(w=x.getLine(S)).search(/\S/);if(-1!==K){if(U>K)break;var q=this.getFoldWidgetRange(x,"all",S);if(q){if(q.start.row<=H)break;if(q.isMultiLine())S=q.end.row;else if(U==K)break}j=S}}return new G(H,z,j,x.getLine(j).length)},this.getCommentRegionBlock=function(x,S,w){for(var U=S.search(/\s*$/),H=x.getLength(),z=w,j=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,X=1;++w<H;){S=x.getLine(w);var K=j.exec(S);if(K&&(K[1]?X--:X++,!X))break}if(w>z)return new G(z,U,w,S.length)}}.call(z.prototype)})),ace.define("ace/mode/c_cpp",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/c_cpp_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("./text").Mode,H=x("./c_cpp_highlight_rules").c_cppHighlightRules,z=x("./matching_brace_outdent").MatchingBraceOutdent,j=(x("../range").Range,x("./behaviour/cstyle").CstyleBehaviour),X=x("./folding/cstyle").FoldMode,l=function(){this.HighlightRules=H,this.$outdent=new z,this.$behaviour=new j,this.foldingRules=new X};U.inherits(l,G),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(x,S,w){var U=this.$getIndent(S),G=this.getTokenizer().getLineTokens(S,x),H=G.tokens,z=G.state;if(H.length&&"comment"==H[H.length-1].type)return U;if("start"==x)(j=S.match(/^.*[\{\(\[]\s*$/))&&(U+=w);else if("doc-start"==x){if("start"==z)return"";var j;(j=S.match(/^\s*(\/?)\*/))&&(j[1]&&(U+=" "),U+="* ")}return U},this.checkOutdent=function(x,S,w){return this.$outdent.checkOutdent(S,w)},this.autoOutdent=function(x,S,w){this.$outdent.autoOutdent(S,w)},this.$id="ace/mode/c_cpp"}.call(l.prototype),S.Mode=l})),ace.define("ace/mode/glsl_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/c_cpp_highlight_rules"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("./c_cpp_highlight_rules").c_cppHighlightRules,o=function(){var x=this.createKeywordMapper({"variable.language":"this",keyword:"layout|attribute|const|uniform|varying|break|continue|do|for|while|if|else|in|out|inout|float|int|void|bool|true|false|lowp|mediump|highp|precision|invariant|discard|return|mat2|mat3|mat4|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|sampler2D|samplerCube|struct","constant.language":"radians|degrees|sin|cos|tan|asin|acos|atan|pow|exp|log|exp2|log2|sqrt|inversesqrt|abs|sign|floor|ceil|fract|mod|min|max|clamp|mix|step|smoothstep|length|distance|dot|cross|normalize|faceforward|reflect|refract|matrixCompMult|lessThan|lessThanEqual|greaterThan|greaterThanEqual|equal|notEqual|any|all|not|dFdx|dFdy|fwidth|texture2D|texture2DProj|texture2DLod|texture2DProjLod|textureCube|textureCubeLod|gl_MaxVertexAttribs|gl_MaxVertexUniformVectors|gl_MaxVaryingVectors|gl_MaxVertexTextureImageUnits|gl_MaxCombinedTextureImageUnits|gl_MaxTextureImageUnits|gl_MaxFragmentUniformVectors|gl_MaxDrawBuffers|gl_DepthRangeParameters|gl_DepthRange|gl_Position|gl_PointSize|gl_FragCoord|gl_FrontFacing|gl_PointCoord|gl_FragColor|gl_FragData"},"identifier");this.$rules=(new G).$rules,this.$rules.start.forEach((function(S){"function"==typeof S.token&&(S.token=x)}))};U.inherits(o,G),S.glslHighlightRules=o})),ace.define("ace/mode/glsl",["require","exports","module","ace/lib/oop","ace/mode/c_cpp","ace/mode/glsl_highlight_rules","ace/mode/matching_brace_outdent","ace/range","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle"],(function(x,S,w){"use strict";var U=x("../lib/oop"),G=x("./c_cpp").Mode,H=x("./glsl_highlight_rules").glslHighlightRules,z=x("./matching_brace_outdent").MatchingBraceOutdent,j=(x("../range").Range,x("./behaviour/cstyle").CstyleBehaviour),X=x("./folding/cstyle").FoldMode,l=function(){this.HighlightRules=H,this.$outdent=new z,this.$behaviour=new j,this.foldingRules=new X};U.inherits(l,G),function(){this.$id="ace/mode/glsl"}.call(l.prototype),S.Mode=l})),ace.require(["ace/mode/glsl"],(function(S){x&&(x.exports=S)}))}).call(this,w(0)(x))},function(x,S,w){(function(x){ace.define("ace/theme/monokai",["require","exports","module","ace/lib/dom"],(function(x,S,w){S.isDark=!0,S.cssClass="ace-monokai",S.cssText=".ace-monokai .ace_gutter {background: #2F3129;color: #8F908A}.ace-monokai .ace_print-margin {width: 1px;background: #555651}.ace-monokai {background-color: #272822;color: #F8F8F2}.ace-monokai .ace_cursor {color: #F8F8F0}.ace-monokai .ace_marker-layer .ace_selection {background: #49483E}.ace-monokai.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #272822;}.ace-monokai .ace_marker-layer .ace_step {background: rgb(102, 82, 0)}.ace-monokai .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #49483E}.ace-monokai .ace_marker-layer .ace_active-line {background: #202020}.ace-monokai .ace_gutter-active-line {background-color: #272727}.ace-monokai .ace_marker-layer .ace_selected-word {border: 1px solid #49483E}.ace-monokai .ace_invisible {color: #52524d}.ace-monokai .ace_entity.ace_name.ace_tag,.ace-monokai .ace_keyword,.ace-monokai .ace_meta.ace_tag,.ace-monokai .ace_storage {color: #F92672}.ace-monokai .ace_punctuation,.ace-monokai .ace_punctuation.ace_tag {color: #fff}.ace-monokai .ace_constant.ace_character,.ace-monokai .ace_constant.ace_language,.ace-monokai .ace_constant.ace_numeric,.ace-monokai .ace_constant.ace_other {color: #AE81FF}.ace-monokai .ace_invalid {color: #F8F8F0;background-color: #F92672}.ace-monokai .ace_invalid.ace_deprecated {color: #F8F8F0;background-color: #AE81FF}.ace-monokai .ace_support.ace_constant,.ace-monokai .ace_support.ace_function {color: #66D9EF}.ace-monokai .ace_fold {background-color: #A6E22E;border-color: #F8F8F2}.ace-monokai .ace_storage.ace_type,.ace-monokai .ace_support.ace_class,.ace-monokai .ace_support.ace_type {font-style: italic;color: #66D9EF}.ace-monokai .ace_entity.ace_name.ace_function,.ace-monokai .ace_entity.ace_other,.ace-monokai .ace_entity.ace_other.ace_attribute-name,.ace-monokai .ace_variable {color: #A6E22E}.ace-monokai .ace_variable.ace_parameter {font-style: italic;color: #FD971F}.ace-monokai .ace_string {color: #E6DB74}.ace-monokai .ace_comment {color: #75715E}.ace-monokai .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ0FD0ZXBzd/wPAAjVAoxeSgNeAAAAAElFTkSuQmCC) right repeat-y}",x("../lib/dom").importCssString(S.cssText,S.cssClass)})),ace.require(["ace/theme/monokai"],(function(S){x&&(x.exports=S)}))}).call(this,w(0)(x))},function(x,S,w){var U=w(1),G=w(9);"string"==typeof(G=G.__esModule?G.default:G)&&(G=[[x.i,G,""]]);var H=(U(G,{insert:"html",singleton:!1}),G.locals?G.locals:{});x.exports=H},function(x,S,w){(S=w(2)(!1)).push([x.i,".ace-monokai {\r\n    color: #f9f9f9;\r\n    font-size: 14px;\r\n}\r\n\r\n.ace-monokai .ace_entity.ace_name.ace_tag,\r\n.ace-monokai .ace_keyword,\r\n.ace-monokai .ace_meta.ace_tag,\r\n.ace-monokai .ace_storage {\r\n    color: #F0640D\r\n}\r\n\r\n.ace-monokai .ace_constant.ace_character,\r\n.ace-monokai .ace_constant.ace_other {\r\n    color: #5db0d7;\r\n}\r\n\r\n.ace-monokai .ace_marker-layer .ace_selection {\r\n    background: #a6e22e\r\n}\r\n\r\n.ace-monokai .ace_marker-layer .ace_bracket {\r\n    margin: -1px 0 0 -1px;\r\n    border: 1px solid #a6e22e;\r\n}\r\n\r\n.ace-monokai .ace_marker-layer .ace_active-line {\r\n    background: #2c2c2c\r\n}\r\n.ace-monokai .ace_gutter-active-line {\r\n    background-color: #2c2c2c\r\n}\r\n.ace-monokai .ace_marker-layer .ace_selected-word {\r\n    border: 1px solid #a6e22e\r\n}\r\n\r\n.ace-monokai .ace_constant.ace_language {\r\n    color: #e6db74\r\n}\r\n.ace-monokai .ace_constant.ace_numeric {\r\n    color: #ae81ff\r\n}\r\n\r\n.ace-monokai .ace_gutter {\r\n    background: #222;\r\n    color: #8F908A;\r\n}",""]),x.exports=S},function(x,S,w){(function(x){ace.define("ace/ext/searchbox",["require","exports","module","ace/lib/dom","ace/lib/lang","ace/lib/event","ace/keyboard/hash_handler","ace/lib/keys"],(function(x,S,w){"use strict";var U=x("../lib/dom"),G=x("../lib/lang"),H=x("../lib/event"),z='.ace_search {background-color: #ddd;color: #666;border: 1px solid #cbcbcb;border-top: 0 none;overflow: hidden;margin: 0;padding: 4px 6px 0 4px;position: absolute;top: 0;z-index: 99;white-space: normal;}.ace_search.left {border-left: 0 none;border-radius: 0px 0px 5px 0px;left: 0;}.ace_search.right {border-radius: 0px 0px 0px 5px;border-right: 0 none;right: 0;}.ace_search_form, .ace_replace_form {margin: 0 20px 4px 0;overflow: hidden;line-height: 1.9;}.ace_replace_form {margin-right: 0;}.ace_search_form.ace_nomatch {outline: 1px solid red;}.ace_search_field {border-radius: 3px 0 0 3px;background-color: white;color: black;border: 1px solid #cbcbcb;border-right: 0 none;outline: 0;padding: 0;font-size: inherit;margin: 0;line-height: inherit;padding: 0 6px;min-width: 17em;vertical-align: top;min-height: 1.8em;box-sizing: content-box;}.ace_searchbtn {border: 1px solid #cbcbcb;line-height: inherit;display: inline-block;padding: 0 6px;background: #fff;border-right: 0 none;border-left: 1px solid #dcdcdc;cursor: pointer;margin: 0;position: relative;color: #666;}.ace_searchbtn:last-child {border-radius: 0 3px 3px 0;border-right: 1px solid #cbcbcb;}.ace_searchbtn:disabled {background: none;cursor: default;}.ace_searchbtn:hover {background-color: #eef1f6;}.ace_searchbtn.prev, .ace_searchbtn.next {padding: 0px 0.7em}.ace_searchbtn.prev:after, .ace_searchbtn.next:after {content: "";border: solid 2px #888;width: 0.5em;height: 0.5em;border-width:  2px 0 0 2px;display:inline-block;transform: rotate(-45deg);}.ace_searchbtn.next:after {border-width: 0 2px 2px 0 ;}.ace_searchbtn_close {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;border-radius: 50%;border: 0 none;color: #656565;cursor: pointer;font: 16px/16px Arial;padding: 0;height: 14px;width: 14px;top: 9px;right: 7px;position: absolute;}.ace_searchbtn_close:hover {background-color: #656565;background-position: 50% 100%;color: white;}.ace_button {margin-left: 2px;cursor: pointer;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;overflow: hidden;opacity: 0.7;border: 1px solid rgba(100,100,100,0.23);padding: 1px;box-sizing:    border-box!important;color: black;}.ace_button:hover {background-color: #eee;opacity:1;}.ace_button:active {background-color: #ddd;}.ace_button.checked {border-color: #3399ff;opacity:1;}.ace_search_options{margin-bottom: 3px;text-align: right;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;clear: both;}.ace_search_counter {float: left;font-family: arial;padding: 0 8px;}',j=x("../keyboard/hash_handler").HashHandler,X=x("../lib/keys");U.importCssString(z,"ace_searchbox");var l=function(x,S,w){var G=U.createElement("div");U.buildDom(["div",{class:"ace_search right"},["span",{action:"hide",class:"ace_searchbtn_close"}],["div",{class:"ace_search_form"},["input",{class:"ace_search_field",placeholder:"Search for",spellcheck:"false"}],["span",{action:"findPrev",class:"ace_searchbtn prev"},"​"],["span",{action:"findNext",class:"ace_searchbtn next"},"​"],["span",{action:"findAll",class:"ace_searchbtn",title:"Alt-Enter"},"All"]],["div",{class:"ace_replace_form"},["input",{class:"ace_search_field",placeholder:"Replace with",spellcheck:"false"}],["span",{action:"replaceAndFindNext",class:"ace_searchbtn"},"Replace"],["span",{action:"replaceAll",class:"ace_searchbtn"},"All"]],["div",{class:"ace_search_options"},["span",{action:"toggleReplace",class:"ace_button",title:"Toggle Replace mode",style:"float:left;margin-top:-2px;padding:0 5px;"},"+"],["span",{class:"ace_search_counter"}],["span",{action:"toggleRegexpMode",class:"ace_button",title:"RegExp Search"},".*"],["span",{action:"toggleCaseSensitive",class:"ace_button",title:"CaseSensitive Search"},"Aa"],["span",{action:"toggleWholeWords",class:"ace_button",title:"Whole Word Search"},"\\b"],["span",{action:"searchInSelection",class:"ace_button",title:"Search In Selection"},"S"]]],G),this.element=G.firstChild,this.setSession=this.setSession.bind(this),this.$init(),this.setEditor(x),U.importCssString(z,"ace_searchbox",x.container)};(function(){this.setEditor=function(x){x.searchBox=this,x.renderer.scroller.appendChild(this.element),this.editor=x},this.setSession=function(x){this.searchRange=null,this.$syncOptions(!0)},this.$initElements=function(x){this.searchBox=x.querySelector(".ace_search_form"),this.replaceBox=x.querySelector(".ace_replace_form"),this.searchOption=x.querySelector("[action=searchInSelection]"),this.replaceOption=x.querySelector("[action=toggleReplace]"),this.regExpOption=x.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=x.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=x.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field"),this.searchCounter=x.querySelector(".ace_search_counter")},this.$init=function(){var x=this.element;this.$initElements(x);var S=this;H.addListener(x,"mousedown",(function(x){setTimeout((function(){S.activeInput.focus()}),0),H.stopPropagation(x)})),H.addListener(x,"click",(function(x){var w=(x.target||x.srcElement).getAttribute("action");w&&S[w]?S[w]():S.$searchBarKb.commands[w]&&S.$searchBarKb.commands[w].exec(S),H.stopPropagation(x)})),H.addCommandKeyListener(x,(function(x,w,U){var G=X.keyCodeToString(U),z=S.$searchBarKb.findKeyCommand(w,G);z&&z.exec&&(z.exec(S),H.stopEvent(x))})),this.$onChange=G.delayedCall((function(){S.find(!1,!1)})),H.addListener(this.searchInput,"input",(function(){S.$onChange.schedule(20)})),H.addListener(this.searchInput,"focus",(function(){S.activeInput=S.searchInput,S.searchInput.value&&S.highlight()})),H.addListener(this.replaceInput,"focus",(function(){S.activeInput=S.replaceInput,S.searchInput.value&&S.highlight()}))},this.$closeSearchBarKb=new j([{bindKey:"Esc",name:"closeSearchBar",exec:function(x){x.searchBox.hide()}}]),this.$searchBarKb=new j,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f":function(x){var S=x.isReplace=!x.isReplace;x.replaceBox.style.display=S?"":"none",x.replaceOption.checked=!1,x.$syncOptions(),x.searchInput.focus()},"Ctrl-H|Command-Option-F":function(x){x.editor.getReadOnly()||(x.replaceOption.checked=!0,x.$syncOptions(),x.replaceInput.focus())},"Ctrl-G|Command-G":function(x){x.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(x){x.findPrev()},esc:function(x){setTimeout((function(){x.hide()}))},Return:function(x){x.activeInput==x.replaceInput&&x.replace(),x.findNext()},"Shift-Return":function(x){x.activeInput==x.replaceInput&&x.replace(),x.findPrev()},"Alt-Return":function(x){x.activeInput==x.replaceInput&&x.replaceAll(),x.findAll()},Tab:function(x){(x.activeInput==x.replaceInput?x.searchInput:x.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(x){x.regExpOption.checked=!x.regExpOption.checked,x.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(x){x.caseSensitiveOption.checked=!x.caseSensitiveOption.checked,x.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(x){x.wholeWordOption.checked=!x.wholeWordOption.checked,x.$syncOptions()}},{name:"toggleReplace",exec:function(x){x.replaceOption.checked=!x.replaceOption.checked,x.$syncOptions()}},{name:"searchInSelection",exec:function(x){x.searchOption.checked=!x.searchRange,x.setSearchRange(x.searchOption.checked&&x.editor.getSelectionRange()),x.$syncOptions()}}]),this.setSearchRange=function(x){this.searchRange=x,x?this.searchRangeMarker=this.editor.session.addMarker(x,"ace_active-line"):this.searchRangeMarker&&(this.editor.session.removeMarker(this.searchRangeMarker),this.searchRangeMarker=null)},this.$syncOptions=function(x){U.setCssClass(this.replaceOption,"checked",this.searchRange),U.setCssClass(this.searchOption,"checked",this.searchOption.checked),this.replaceOption.textContent=this.replaceOption.checked?"-":"+",U.setCssClass(this.regExpOption,"checked",this.regExpOption.checked),U.setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked),U.setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked);var S=this.editor.getReadOnly();this.replaceOption.style.display=S?"none":"",this.replaceBox.style.display=this.replaceOption.checked&&!S?"":"none",this.find(!1,!1,x)},this.highlight=function(x){this.editor.session.highlight(x||this.editor.$search.$options.re),this.editor.renderer.updateBackMarkers()},this.find=function(x,S,w){var G=!this.editor.find(this.searchInput.value,{skipCurrent:x,backwards:S,wrap:!0,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked,preventScroll:w,range:this.searchRange})&&this.searchInput.value;U.setCssClass(this.searchBox,"ace_nomatch",G),this.editor._emit("findSearchBox",{match:!G}),this.highlight(),this.updateCounter()},this.updateCounter=function(){var x=this.editor,S=x.$search.$options.re,w=0,U=0;if(S){var G=this.searchRange?x.session.getTextRange(this.searchRange):x.getValue(),H=x.session.doc.positionToIndex(x.selection.anchor);this.searchRange&&(H-=x.session.doc.positionToIndex(this.searchRange.start));for(var z,j=S.lastIndex=0;(z=S.exec(G))&&(w++,(j=z.index)<=H&&U++,!(w>999))&&(z[0]||(S.lastIndex=j+=1,!(j>=G.length))););}this.searchCounter.textContent=U+" of "+(w>999?"999+":w)},this.findNext=function(){this.find(!0,!1)},this.findPrev=function(){this.find(!0,!0)},this.findAll=function(){var x=!this.editor.findAll(this.searchInput.value,{regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked})&&this.searchInput.value;U.setCssClass(this.searchBox,"ace_nomatch",x),this.editor._emit("findSearchBox",{match:!x}),this.highlight(),this.hide()},this.replace=function(){this.editor.getReadOnly()||this.editor.replace(this.replaceInput.value)},this.replaceAndFindNext=function(){this.editor.getReadOnly()||(this.editor.replace(this.replaceInput.value),this.findNext())},this.replaceAll=function(){this.editor.getReadOnly()||this.editor.replaceAll(this.replaceInput.value)},this.hide=function(){this.active=!1,this.setSearchRange(null),this.editor.off("changeSession",this.setSession),this.element.style.display="none",this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb),this.editor.focus()},this.show=function(x,S){this.active=!0,this.editor.on("changeSession",this.setSession),this.element.style.display="",this.replaceOption.checked=S,x&&(this.searchInput.value=x),this.searchInput.focus(),this.searchInput.select(),this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb),this.$syncOptions(!0)},this.isFocused=function(){var x=document.activeElement;return x==this.searchInput||x==this.replaceInput}}).call(l.prototype),S.SearchBox=l,S.Search=function(x,S){(x.searchBox||new l(x)).show(x.session.getTextRange(),S)}})),ace.require(["ace/ext/searchbox"],(function(S){x&&(x.exports=S)}))}).call(this,w(0)(x))},function(x,S,w){var U=w(1),G=w(12);"string"==typeof(G=G.__esModule?G.default:G)&&(G=[[x.i,G,""]]);var H=(U(G,{insert:"html",singleton:!1}),G.locals?G.locals:{});x.exports=H},function(x,S,w){(S=w(2)(!1)).push([x.i,"@import url(https://fonts.googleapis.com/css?family=Montserrat:300,400);"]),S.push([x.i,".captureMenuComponent{position:absolute;padding:7px;z-index:99999;top:10px;left:50%;margin-left:-209px;height:40px;width:400px;border:2px solid #222;background-color:#2c2c2c;visibility:hidden;display:none;color:#f9f9f9;font-family:Consolas, monaco, monospace;font-size:14px;font-weight:500}.captureMenuComponent.active{visibility:visible;display:block}.captureMenuComponent,.captureMenuComponent:after,.captureMenuComponent:before{box-sizing:content-box}.captureMenuLogComponent{position:absolute;padding:7px;z-index:80000;top:66px;left:50%;margin-left:-209px;height:40px;width:400px;border:2px solid #222;background-color:#2c2c2c;visibility:hidden;display:none;color:#f9f9f9;font-family:Consolas, monaco, monospace;font-size:14px;font-weight:500}.captureMenuLogComponent.active{visibility:visible;display:block}.captureMenuLogComponent,.captureMenuLogComponent:after,.captureMenuLogComponent:before{box-sizing:content-box}.captureMenuLogComponent span.error{color:red}.canvasListComponent{float:left;width:50%;height:100%}.canvasListComponent [commandName=onCanvasSelection]{vertical-align:center;line-height:40px;white-space:nowrap;text-overflow:ellipsis;width:190px;display:inline-block;overflow:hidden;margin:0px 5px}.canvasListComponent [commandName=onCanvasSelection]:hover{color:#c9c9c9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.canvasListComponent ul{margin:0px;padding:7px;list-style:none;position:absolute;top:54px;left:-2px;width:400px;border:2px solid #222;background-color:#2c2c2c}.canvasListComponent ul li{margin:5px}.canvasListComponent ul li:hover{color:#c9c9c9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.captureMenuActionsComponent{float:left;width:30%;height:100%;margin-top:7.5px}.captureMenuActionsComponent div{float:left}.captureMenuActionsComponent [commandName=onCaptureRequested]{border-radius:50%;background:#2c2c2c;border:2px solid red;width:21px;height:21px}.captureMenuActionsComponent [commandName=onCaptureRequested]:hover{background:red;cursor:pointer;transition:background .3s;-webkit-transition:background .3s;-moz-transition:background .3s}.captureMenuActionsComponent [commandName=onPlayRequested],.captureMenuActionsComponent [commandName=onPlayNextFrameRequested]{width:21px;height:21px;border:2px solid #f9f9f9;border-radius:50%;margin-left:9px}.captureMenuActionsComponent [commandName=onPlayRequested]:before,.captureMenuActionsComponent [commandName=onPlayNextFrameRequested]:before{content:'';position:absolute;display:inline-block;margin-top:6px;margin-left:4px;width:7px;height:7px;border-top:2px solid #f9f9f9;border-right:2px solid #f9f9f9;background-color:#f9f9f9;-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg);z-index:-20}.captureMenuActionsComponent [commandName=onPlayRequested]:after,.captureMenuActionsComponent [commandName=onPlayNextFrameRequested]:after{content:'';position:absolute;display:inline-block;width:8px;height:20px;background-color:#2c2c2c;z-index:-10}.captureMenuActionsComponent [commandName=onPlayRequested]:hover,.captureMenuActionsComponent :hover[commandName=onPlayNextFrameRequested]{cursor:pointer;border:2px solid #c9c9c9;transition:border .3s;-webkit-transition:border .3s;-moz-transition:border .3s}.captureMenuActionsComponent [commandName=onPauseRequested]{width:21px;height:21px;border:2px solid #f9f9f9;border-radius:50%;margin-left:9px}.captureMenuActionsComponent [commandName=onPauseRequested]:before{content:'';position:absolute;display:inline-block;width:2px;height:13px;margin-left:12px;margin-top:4px;background-color:#f9f9f9}.captureMenuActionsComponent [commandName=onPauseRequested]:after{content:'';position:absolute;display:inline-block;width:2px;height:13px;margin-left:7px;margin-top:4px;background-color:#f9f9f9}.captureMenuActionsComponent [commandName=onPauseRequested]:hover{cursor:pointer;border:2px solid #c9c9c9;transition:border .3s;-webkit-transition:border .3s;-moz-transition:border .3s}.captureMenuActionsComponent [commandName=onPlayNextFrameRequested]:before{background-color:#2c2c2c}.fpsCounterComponent{float:left;width:20%;vertical-align:center;line-height:40px;white-space:nowrap}\n",""]),x.exports=S},function(x,S,w){var U=w(1),G=w(14);"string"==typeof(G=G.__esModule?G.default:G)&&(G=[[x.i,G,""]]);var H=(U(G,{insert:"html",singleton:!1}),G.locals?G.locals:{});x.exports=H},function(x,S,w){(S=w(2)(!1)).push([x.i,"@import url(https://fonts.googleapis.com/css?family=Montserrat:300,400);"]),S.push([x.i,".resultViewComponent{position:absolute;z-index:99999;border:1px solid #000;top:0;left:0;bottom:0;right:0;background-color:#222;opacity:1;visibility:hidden;display:none;color:#f9f9f9;font-family:Consolas, monaco, monospace;font-size:14px;font-weight:500}.resultViewComponent.active{visibility:visible;display:block}.resultViewComponent,.resultViewComponent:after,.resultViewComponent:before{box-sizing:content-box}.resultViewMenuComponent{font-family:'Montserrat', sans-serif;font-size:13px;font-weight:300;line-height:40px;flex:1 100%;display:flex;flex-flow:row wrap;height:42px;outline:0 none;border-bottom:2px solid #222;box-sizing:border-box;list-style:none;margin:0;background:#2c2c2c;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-flex-flow:row wrap;flex-flow:row wrap;justify-content:flex-end}.resultViewMenuComponent .resultViewMenuOpen{display:none;visibility:hidden}.resultViewMenuComponent a{outline:0 none;text-decoration:none;display:block;padding:0 20px 0 20px;color:#ccc;background:#2c2c2c;box-sizing:border-box;height:100%}.resultViewMenuComponent a.active{background:#222;color:white;font-weight:400;border-bottom:2px solid #F0640D}.resultViewMenuComponent a:hover{background:#222;color:#c9c9c9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.resultViewMenuComponent a:hover.active{color:#F0640D;transition:color 0;-webkit-transition:color 0;-moz-transition:color 0}.resultViewMenuComponent a.clearSearch{padding:0px;margin-left:-30px;margin-right:20px;z-index:9000;color:#f9f9f9}.resultViewMenuComponent a.clearSearch:hover{background:#2c2c2c;color:#F0640D}@media all and (max-width: 1024px){.resultViewMenuComponent{padding:0px;position:absolute;overflow-y:visible;top:0px;left:0px;right:0px;bottom:0px;z-index:999999;display:block}.resultViewMenuComponent .resultViewMenuOpen{display:block;visibility:visible}.resultViewMenuComponent li:not(.resultViewMenuSmall){display:none;visibility:hidden}.resultViewMenuComponent li{background:#2c2c2c}.resultViewMenuComponent li.searchContainer{background:#464646}.resultViewMenuComponent a.active{background:#2c2c2c}}.resultViewMenuComponent input{border:0;font-family:'Montserrat', sans-serif;font-weight:300;padding:0 20px 0 20px;background:#464646;color:#f9f9f9;height:40px;position:relative;top:-1px;box-sizing:border-box}.resultViewMenuComponent input:focus{border:0;outline:0 none}.resultViewMenuComponent .clearSearch{position:relative;background:transparent;display:inline;padding:0px;margin-left:-30px;z-index:9000;color:#F0640D}.resultViewMenuComponent .clearSearch:hover{background:transparent !important}.resultViewMenuComponent ::-webkit-input-placeholder{color:#ccc}.resultViewMenuComponent :-moz-placeholder{color:#ccc}.resultViewMenuComponent ::-moz-placeholder{color:#ccc}.resultViewMenuComponent :-ms-input-placeholder{color:#ccc}.resultViewContentComponent{position:absolute;top:40px;left:0;bottom:0;right:0}.informationColumnLeftComponent{position:absolute;top:0;left:0;bottom:0;right:50%;overflow:auto;overflow-x:hidden;overflow-y:visible}.informationColumnRightComponent{position:absolute;top:0;left:50%;bottom:0;right:0;overflow:auto;overflow-x:hidden;overflow-y:visible}.captureListComponent{position:absolute;top:40px;left:0;bottom:0;right:0;background:#222;z-index:9000;display:none;visibility:hidden;overflow-y:visible;overflow-x:hidden}.captureListComponent.active{display:block;visibility:visible}.captureListComponent .openCaptureFile{border:1px dashed #f9f9f9;display:block;margin:5px;padding:5px;text-align:center;font-style:italic}.captureListComponent .openCaptureFile span{line-height:100%;vertical-align:middle}.captureListComponent ul{margin:0px;padding:0px;list-style:none;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-flex-flow:row wrap;flex-flow:row wrap;justify-content:flex-start}.captureListComponent ul li{margin:5px;border:1px solid #606060}.captureListComponent ul li img{width:295px;background-image:-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9));background-image:-moz-linear-gradient(45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(-45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(45deg, transparent 75%, #d9d9d9 75%),-moz-linear-gradient(-45deg, transparent 75%, #d9d9d9 75%);-webkit-background-size:50px 51px;-moz-background-size:50px 50px;background-size:50px 50px;background-position:0 0, 25px 0, 25px -25px, 0px 25px;display:block}.captureListComponent ul li span{display:block;text-align:center;border:5px solid #222}.captureListComponent ul li span .captureListItemSave{color:#f9f9f9;font-size:16px;margin-left:10px;position:relative;padding:3px 8px 3px 32px}.captureListComponent ul li span .captureListItemSave:before,.captureListComponent ul li span .captureListItemSave:after{box-sizing:border-box;content:\"\";position:absolute}.captureListComponent ul li span .captureListItemSave:before{background:#d9d9d9;border-color:#f9f9f9;border-style:solid;border-width:7px 2px 1px;border-radius:1px;height:16px;left:8px;top:5px;width:16px}.captureListComponent ul li span .captureListItemSave:after{background:#f9f9f9;border-color:#d9d9d9;border-style:solid;border-width:1px 1px 1px 4px;height:5px;left:13px;top:5px;width:7px}.captureListComponent ul li:hover{cursor:pointer}.captureListComponent ul li.active span{background:#F0640D;border:5px solid #F0640D}.captureListComponent ul li.active span .captureListItemSave:before{background:#F0640D}.captureListComponent ul li.active span .captureListItemSave:after{border-color:#F0640D}.visualStateListComponent{position:absolute;top:0;left:0;bottom:0;padding:5px;right:80%;overflow-y:visible;overflow-x:hidden}.visualStateListComponent ul{margin:0px;padding:0px;list-style:none}.visualStateListComponent ul li{margin:20px 15px 0px 15px;border:1px solid #606060}.visualStateListComponent ul li img{display:block;padding:0px;box-sizing:border-box;max-height:600px;width:100%;margin:0 auto;background-image:-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9));background-image:-moz-linear-gradient(45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(-45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(45deg, transparent 75%, #d9d9d9 75%),-moz-linear-gradient(-45deg, transparent 75%, #d9d9d9 75%);-webkit-background-size:50px 51px;-moz-background-size:50px 50px;background-size:50px 50px;background-position:0 0, 25px 0, 25px -25px, 0px 25px}.visualStateListComponent ul li:hover{cursor:pointer}.visualStateListComponent ul li span{border:5px solid #222;background:#222;box-sizing:border-box;display:inline-block;width:100%;margin:0px;padding:5px;word-wrap:break-word}.visualStateListComponent ul li.active{border:2px solid #F0640D}.commandListComponent{position:absolute;top:0;left:20%;right:40%;bottom:0;color:#d3d3d3}.commandListComponent ul{margin:0px;padding:0px;list-style:none;overflow-y:visible;overflow-x:hidden;height:100%}.commandListComponent ul li{padding:8px}.commandListComponent ul li span{word-wrap:break-word;line-height:22px}.commandListComponent ul li:hover{color:#f9f9f9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.commandListComponent ul li:nth-child(even){background:#2c2c2c}.commandListComponent ul li:nth-child(odd){background:#222}.commandListComponent ul li .important{font-weight:800}.commandListComponent ul li .important.deprecated{color:red}.commandListComponent ul li .important.unused{color:yellow}.commandListComponent ul li .important.disabled{color:gray}.commandListComponent ul li .important.redundant{color:orange}.commandListComponent ul li .important.valid{color:greenyellow}.commandListComponent ul li .marker{font-size:16px;font-weight:900;color:greenyellow}.commandListComponent ul li.active{background:#f37628;color:#222}.commandListComponent ul li.drawCall{background:#5db0d7;color:#222}.commandListComponent ul li a{margin-left:5px;margin-right:5px;color:#5db0d7;background:#222;padding:5px;font-weight:900;display:inline-block}.commandDetailComponent{position:absolute;top:0;left:60%;right:0;bottom:0;overflow-y:visible;overflow-x:hidden}.jsonGroupComponent{display:block;margin:10px;padding:10px;padding-bottom:5px}.jsonGroupComponent .jsonGroupComponentTitle{display:block;font-size:16px;color:#5db0d7;border-bottom:1px solid #5db0d7;padding-bottom:5px;margin-bottom:5px;text-transform:capitalize}.jsonGroupComponent ul{margin:0px;padding:0px;list-style:none}.jsonGroupComponent ul li:nth-child(even){background:#222}.jsonGroupComponent ul li:nth-child(odd){background:#222}.jsonItemComponentKey{color:#F0640D}.jsonItemComponentValue{white-space:pre-wrap}.jsonItemImageHolder{width:50%;margin:auto}.jsonItemImageHolder .jsonItemImage{margin:5px;display:block;border:1px solid #606060;width:100%}.jsonItemImageHolder .jsonItemImage img{width:100%;display:block;margin:auto;max-width:256px;background-image:-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9));background-image:-moz-linear-gradient(45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(-45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(45deg, transparent 75%, #d9d9d9 75%),-moz-linear-gradient(-45deg, transparent 75%, #d9d9d9 75%);-webkit-background-size:50px 51px;-moz-background-size:50px 50px;background-size:50px 50px;background-position:0 0, 25px 0, 25px -25px, 0px 25px}.jsonItemImageHolder .jsonItemImage span{margin:0px;padding:5px;word-wrap:break-word;display:inline-block;width:100%;box-sizing:border-box}[commandName=onOpenSourceClicked]:hover{color:#f9f9f9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.jsonVisualStateItemComponent{text-align:center;padding:10px}.jsonVisualStateItemComponent img{background-image:-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.25, #c9c9c9), color-stop(0.25, transparent)),-webkit-gradient(linear, 0 100%, 100% 0, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9)),-webkit-gradient(linear, 0 0, 100% 100%, color-stop(0.75, transparent), color-stop(0.75, #c9c9c9));background-image:-moz-linear-gradient(45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(-45deg, #d9d9d9 25%, transparent 25%),-moz-linear-gradient(45deg, transparent 75%, #d9d9d9 75%),-moz-linear-gradient(-45deg, transparent 75%, #d9d9d9 75%);-webkit-background-size:50px 51px;-moz-background-size:50px 50px;background-size:50px 50px;background-position:0 0, 25px 0, 25px -25px, 0px 25px;border:1px solid #606060;margin:5px;width:100%;max-width:512px;max-height:800px}.jsonVisualStateItemComponent span{display:block}.jsonContentComponent{position:absolute;top:0;left:0;right:0;bottom:0;padding:10px;overflow-y:visible;overflow-x:hidden}.jsonItemComponentValue{word-break:break-all;white-space:normal}.jsonSourceItemComponentOpen{font-weight:bold;color:#5db0d7;text-decoration:underline}.sourceCodeMenuComponentContainer{position:absolute;left:0;top:0;right:40%}.sourceCodeMenuComponent{font-family:'Montserrat', sans-serif;font-size:13px;font-weight:300;line-height:40px;flex:1 100%;display:flex;flex-flow:row wrap;height:42px;outline:0 none;border-bottom:2px solid #222;box-sizing:border-box;list-style:none;margin:0;background:#2c2c2c;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;-webkit-flex-flow:row wrap;flex-flow:row wrap;justify-content:flex-end}.sourceCodeMenuComponent .resultViewMenuOpen{display:none;visibility:hidden}.sourceCodeMenuComponent a{outline:0 none;text-decoration:none;display:block;padding:0 20px 0 20px;color:#ccc;background:#2c2c2c;box-sizing:border-box;height:100%}.sourceCodeMenuComponent a.active{background:#222;color:white;font-weight:400;border-bottom:2px solid #F0640D}.sourceCodeMenuComponent a:hover{background:#222;color:#c9c9c9;cursor:pointer;transition:color .3s;-webkit-transition:color .3s;-moz-transition:color .3s}.sourceCodeMenuComponent a:hover.active{color:#F0640D;transition:color 0;-webkit-transition:color 0;-moz-transition:color 0}.sourceCodeMenuComponent a.clearSearch{display:inline-block;padding:0px;margin-left:-30px;margin-right:20px;z-index:9000;color:#f9f9f9}.sourceCodeMenuComponent a.clearSearch:hover{background:#2c2c2c;color:#F0640D}.sourceCodeMenuComponent input{border:0;font-family:'Montserrat', sans-serif;font-weight:300;padding:0 20px 0 20px;background:#464646;color:#f9f9f9;height:100%;position:relative;top:-1px;box-sizing:border-box}.sourceCodeMenuComponent input:focus{border:0;outline:0 none}.sourceCodeMenuComponent .clearSearch{position:relative;background:transparent;display:inline;padding:0px;margin-left:-30px;z-index:9000;color:#F0640D}.sourceCodeMenuComponent .clearSearch:hover{background:transparent !important}.sourceCodeMenuComponent ::-webkit-input-placeholder{color:#ccc}.sourceCodeMenuComponent :-moz-placeholder{color:#ccc}.sourceCodeMenuComponent ::-moz-placeholder{color:#ccc}.sourceCodeMenuComponent :-ms-input-placeholder{color:#ccc}.sourceCodeComponent{position:absolute;top:42px;left:0;bottom:0;right:40%;background:#222;z-index:9000;overflow-x:visible;overflow:auto}.sourceCodeComponent .sourceCodeComponentTitle{font-size:16px;font-weight:800;line-height:50px;color:#F0640D;padding:1em;margin:.5em 0}\n",""]),x.exports=S},function(x,S,w){"use strict";w.r(S),w.d(S,"EmbeddedFrontend",(function(){return ar})),w.d(S,"Spector",(function(){return sr}));var U,G=function(){function e(){}return e.isBuildableProgram=function(x){return!!x&&!!x[this.rebuildProgramFunctionName]},e.rebuildProgram=function(x,S,w,U,G){this.isBuildableProgram(x)&&x[this.rebuildProgramFunctionName](S,w,U,G)},e.rebuildProgramFunctionName="__SPECTOR_rebuildProgram",e}();!function(x){x[x.noLog=0]="noLog",x[x.error=1]="error",x[x.warning=2]="warning",x[x.info=3]="info"}(U||(U={}));var H,z=function(){function e(){}return e.error=function(x){for(var S=[],w=1;w<arguments.length;w++)S[w-1]=arguments[w];this.level>0&&console.error(x,S)},e.warn=function(x){for(var S=[],w=1;w<arguments.length;w++)S[w-1]=arguments[w];this.level>1&&console.warn(x,S)},e.info=function(x){for(var S=[],w=1;w<arguments.length;w++)S[w-1]=arguments[w];this.level>2&&console.log(x,S)},e.level=U.warning,e}(),j=function(){function e(){this.callbacks=[],this.counter=-1}return e.prototype.add=function(x,S){return this.counter++,S&&(x=x.bind(S)),this.callbacks[this.counter]=x,this.counter},e.prototype.remove=function(x){delete this.callbacks[x]},e.prototype.clear=function(){this.callbacks={}},e.prototype.trigger=function(x){for(var S in this.callbacks)this.callbacks.hasOwnProperty(S)&&this.callbacks[S](x)},e}(),X=function(){function e(){if(window.performance&&window.performance.now)this.nowFunction=this.dateBasedPerformanceNow.bind(this);else{var x=new Date;this.nowFunction=x.getTime.bind(x)}}return e.prototype.dateBasedPerformanceNow=function(){return performance.timing.navigationStart+performance.now()},Object.defineProperty(e,"now",{get:function(){return e.instance.nowFunction()},enumerable:!0,configurable:!0}),e.instance=new e,e}(),K=function(){function e(x){this.options=x}return e.prototype.appendAnalysis=function(x){x.analyses=x.analyses||[];var S=this.getAnalysis(x);x.analyses.push(S)},e.prototype.getAnalysis=function(x){var S={analyserName:this.analyserName};return this.appendToAnalysis(x,S),S},e}(),q=(H=function(x,S){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)},function(x,S){function n(){this.constructor=x}H(x,S),x.prototype=null===S?Object.create(S):(n.prototype=S.prototype,new n)}),Y=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return q(t,x),Object.defineProperty(t.prototype,"analyserName",{get:function(){return t.analyserName},enumerable:!0,configurable:!0}),t.prototype.appendToAnalysis=function(x,S){if(x.commands){for(var w={},U=0,G=x.commands;U<G.length;U++){var H=G[U];w[H.name]=w[H.name]||0,w[H.name]++}var z=Object.keys(w).map((function(x){return[x,w[x]]}));z.sort((function(x,S){var w=S[1]-x[1];return 0===w?x[0].localeCompare(S[0]):w}));for(var j=0,X=z;j<X.length;j++){var K=X[j];S[K[0]]=K[1]}}},t.analyserName="Commands",t}(K),Z=["drawArrays","drawElements","drawArraysInstanced","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","drawRangeElements"],J=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Q=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return J(t,x),Object.defineProperty(t.prototype,"analyserName",{get:function(){return t.analyserName},enumerable:!0,configurable:!0}),t.prototype.appendToAnalysis=function(x,S){if(x.commands){S.total=x.commands.length,S.draw=0,S.clear=0;for(var w=0,U=x.commands;w<U.length;w++){var G=U[w];"clear"===G.name?S.clear++:Z.indexOf(G.name)>-1&&S.draw++}}},t.analyserName="CommandsSummary",t}(K),ee=function(){function e(){}return e.isWebGlConstant=function(x){return null!==ne[x]&&void 0!==ne[x]},e.stringifyWebGlConstant=function(x,S){if(0===x)return this.zeroMeaningByCommand[S]||"0";if(1===x)return this.oneMeaningByCommand[S]||"1";var w=ne[x];return w?w.name:x+""},e.DEPTH_BUFFER_BIT={name:"DEPTH_BUFFER_BIT",value:256,description:"Passed to clear to clear the current depth buffer."},e.STENCIL_BUFFER_BIT={name:"STENCIL_BUFFER_BIT",value:1024,description:"Passed to clear to clear the current stencil buffer."},e.COLOR_BUFFER_BIT={name:"COLOR_BUFFER_BIT",value:16384,description:"Passed to clear to clear the current color buffer."},e.POINTS={name:"POINTS",value:0,description:"Passed to drawElements or drawArrays to draw single points."},e.LINES={name:"LINES",value:1,description:"Passed to drawElements or drawArrays to draw lines. Each vertex connects to the one after it."},e.LINE_LOOP={name:"LINE_LOOP",value:2,description:"Passed to drawElements or drawArrays to draw lines. Each set of two vertices is treated as a separate line segment."},e.LINE_STRIP={name:"LINE_STRIP",value:3,description:"Passed to drawElements or drawArrays to draw a connected group of line segments from the first vertex to the last."},e.TRIANGLES={name:"TRIANGLES",value:4,description:"Passed to drawElements or drawArrays to draw triangles. Each set of three vertices creates a separate triangle."},e.TRIANGLE_STRIP={name:"TRIANGLE_STRIP",value:5,description:"Passed to drawElements or drawArrays to draw a connected group of triangles."},e.TRIANGLE_FAN={name:"TRIANGLE_FAN",value:6,description:"Passed to drawElements or drawArrays to draw a connected group of triangles. Each vertex connects to the previous and the first vertex in the fan."},e.ZERO={name:"ZERO",value:0,description:"Passed to blendFunc or blendFuncSeparate to turn off a component."},e.ONE={name:"ONE",value:1,description:"Passed to blendFunc or blendFuncSeparate to turn on a component."},e.SRC_COLOR={name:"SRC_COLOR",value:768,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by the source elements color."},e.ONE_MINUS_SRC_COLOR={name:"ONE_MINUS_SRC_COLOR",value:769,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by one minus the source elements color."},e.SRC_ALPHA={name:"SRC_ALPHA",value:770,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by the source's alpha."},e.ONE_MINUS_SRC_ALPHA={name:"ONE_MINUS_SRC_ALPHA",value:771,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by one minus the source's alpha."},e.DST_ALPHA={name:"DST_ALPHA",value:772,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by the destination's alpha."},e.ONE_MINUS_DST_ALPHA={name:"ONE_MINUS_DST_ALPHA",value:773,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by one minus the destination's alpha."},e.DST_COLOR={name:"DST_COLOR",value:774,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by the destination's color."},e.ONE_MINUS_DST_COLOR={name:"ONE_MINUS_DST_COLOR",value:775,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by one minus the destination's color."},e.SRC_ALPHA_SATURATE={name:"SRC_ALPHA_SATURATE",value:776,description:"Passed to blendFunc or blendFuncSeparate to multiply a component by the minimum of source's alpha or one minus the destination's alpha."},e.CONSTANT_COLOR={name:"CONSTANT_COLOR",value:32769,description:"Passed to blendFunc or blendFuncSeparate to specify a constant color blend function."},e.ONE_MINUS_CONSTANT_COLOR={name:"ONE_MINUS_CONSTANT_COLOR",value:32770,description:"Passed to blendFunc or blendFuncSeparate to specify one minus a constant color blend function."},e.CONSTANT_ALPHA={name:"CONSTANT_ALPHA",value:32771,description:"Passed to blendFunc or blendFuncSeparate to specify a constant alpha blend function."},e.ONE_MINUS_CONSTANT_ALPHA={name:"ONE_MINUS_CONSTANT_ALPHA",value:32772,description:"Passed to blendFunc or blendFuncSeparate to specify one minus a constant alpha blend function."},e.FUNC_ADD={name:"FUNC_ADD",value:32774,description:"Passed to blendEquation or blendEquationSeparate to set an addition blend function."},e.FUNC_SUBSTRACT={name:"FUNC_SUBSTRACT",value:32778,description:"Passed to blendEquation or blendEquationSeparate to specify a subtraction blend function (source - destination)."},e.FUNC_REVERSE_SUBTRACT={name:"FUNC_REVERSE_SUBTRACT",value:32779,description:"Passed to blendEquation or blendEquationSeparate to specify a reverse subtraction blend function (destination - source)."},e.BLEND_EQUATION={name:"BLEND_EQUATION",value:32777,description:"Passed to getParameter to get the current RGB blend function."},e.BLEND_EQUATION_RGB={name:"BLEND_EQUATION_RGB",value:32777,description:"Passed to getParameter to get the current RGB blend function. Same as BLEND_EQUATION"},e.BLEND_EQUATION_ALPHA={name:"BLEND_EQUATION_ALPHA",value:34877,description:"Passed to getParameter to get the current alpha blend function. Same as BLEND_EQUATION"},e.BLEND_DST_RGB={name:"BLEND_DST_RGB",value:32968,description:"Passed to getParameter to get the current destination RGB blend function."},e.BLEND_SRC_RGB={name:"BLEND_SRC_RGB",value:32969,description:"Passed to getParameter to get the current destination RGB blend function."},e.BLEND_DST_ALPHA={name:"BLEND_DST_ALPHA",value:32970,description:"Passed to getParameter to get the current destination alpha blend function."},e.BLEND_SRC_ALPHA={name:"BLEND_SRC_ALPHA",value:32971,description:"Passed to getParameter to get the current source alpha blend function."},e.BLEND_COLOR={name:"BLEND_COLOR",value:32773,description:"Passed to getParameter to return a the current blend color."},e.ARRAY_BUFFER_BINDING={name:"ARRAY_BUFFER_BINDING",value:34964,description:"Passed to getParameter to get the array buffer binding."},e.ELEMENT_ARRAY_BUFFER_BINDING={name:"ELEMENT_ARRAY_BUFFER_BINDING",value:34965,description:"Passed to getParameter to get the current element array buffer."},e.LINE_WIDTH={name:"LINE_WIDTH",value:2849,description:"Passed to getParameter to get the current lineWidth (set by the lineWidth method)."},e.ALIASED_POINT_SIZE_RANGE={name:"ALIASED_POINT_SIZE_RANGE",value:33901,description:"Passed to getParameter to get the current size of a point drawn with gl.POINTS"},e.ALIASED_LINE_WIDTH_RANGE={name:"ALIASED_LINE_WIDTH_RANGE",value:33902,description:"Passed to getParameter to get the range of available widths for a line. Returns a length-2 array with the lo value at 0, and hight at 1."},e.CULL_FACE_MODE={name:"CULL_FACE_MODE",value:2885,description:"Passed to getParameter to get the current value of cullFace. Should return FRONT, BACK, or FRONT_AND_BACK"},e.FRONT_FACE={name:"FRONT_FACE",value:2886,description:"Passed to getParameter to determine the current value of frontFace. Should return CW or CCW."},e.DEPTH_RANGE={name:"DEPTH_RANGE",value:2928,description:"Passed to getParameter to return a length-2 array of floats giving the current depth range."},e.DEPTH_WRITEMASK={name:"DEPTH_WRITEMASK",value:2930,description:"Passed to getParameter to determine if the depth write mask is enabled."},e.DEPTH_CLEAR_VALUE={name:"DEPTH_CLEAR_VALUE",value:2931,description:"Passed to getParameter to determine the current depth clear value."},e.DEPTH_FUNC={name:"DEPTH_FUNC",value:2932,description:"Passed to getParameter to get the current depth function. Returns NEVER, ALWAYS, LESS, EQUAL, LEQUAL, GREATER, GEQUAL, or NOTEQUAL."},e.STENCIL_CLEAR_VALUE={name:"STENCIL_CLEAR_VALUE",value:2961,description:"Passed to getParameter to get the value the stencil will be cleared to."},e.STENCIL_FUNC={name:"STENCIL_FUNC",value:2962,description:"Passed to getParameter to get the current stencil function. Returns NEVER, ALWAYS, LESS, EQUAL, LEQUAL, GREATER, GEQUAL, or NOTEQUAL."},e.STENCIL_FAIL={name:"STENCIL_FAIL",value:2964,description:"Passed to getParameter to get the current stencil fail function. Should return KEEP, REPLACE, INCR, DECR, INVERT, INCR_WRAP, or DECR_WRAP."},e.STENCIL_PASS_DEPTH_FAIL={name:"STENCIL_PASS_DEPTH_FAIL",value:2965,description:"Passed to getParameter to get the current stencil fail function should the depth buffer test fail. Should return KEEP, REPLACE, INCR, DECR, INVERT, INCR_WRAP, or DECR_WRAP."},e.STENCIL_PASS_DEPTH_PASS={name:"STENCIL_PASS_DEPTH_PASS",value:2966,description:"Passed to getParameter to get the current stencil fail function should the depth buffer test pass. Should return KEEP, REPLACE, INCR, DECR, INVERT, INCR_WRAP, or DECR_WRAP."},e.STENCIL_REF={name:"STENCIL_REF",value:2967,description:"Passed to getParameter to get the reference value used for stencil tests."},e.STENCIL_VALUE_MASK={name:"STENCIL_VALUE_MASK",value:2963,description:" "},e.STENCIL_WRITEMASK={name:"STENCIL_WRITEMASK",value:2968,description:" "},e.STENCIL_BACK_FUNC={name:"STENCIL_BACK_FUNC",value:34816,description:" "},e.STENCIL_BACK_FAIL={name:"STENCIL_BACK_FAIL",value:34817,description:" "},e.STENCIL_BACK_PASS_DEPTH_FAIL={name:"STENCIL_BACK_PASS_DEPTH_FAIL",value:34818,description:" "},e.STENCIL_BACK_PASS_DEPTH_PASS={name:"STENCIL_BACK_PASS_DEPTH_PASS",value:34819,description:" "},e.STENCIL_BACK_REF={name:"STENCIL_BACK_REF",value:36003,description:" "},e.STENCIL_BACK_VALUE_MASK={name:"STENCIL_BACK_VALUE_MASK",value:36004,description:" "},e.STENCIL_BACK_WRITEMASK={name:"STENCIL_BACK_WRITEMASK",value:36005,description:" "},e.VIEWPORT={name:"VIEWPORT",value:2978,description:"Returns an Int32Array with four elements for the current viewport dimensions."},e.SCISSOR_BOX={name:"SCISSOR_BOX",value:3088,description:"Returns an Int32Array with four elements for the current scissor box dimensions."},e.COLOR_CLEAR_VALUE={name:"COLOR_CLEAR_VALUE",value:3106,description:" "},e.COLOR_WRITEMASK={name:"COLOR_WRITEMASK",value:3107,description:" "},e.UNPACK_ALIGNMENT={name:"UNPACK_ALIGNMENT",value:3317,description:" "},e.PACK_ALIGNMENT={name:"PACK_ALIGNMENT",value:3333,description:" "},e.MAX_TEXTURE_SIZE={name:"MAX_TEXTURE_SIZE",value:3379,description:" "},e.MAX_VIEWPORT_DIMS={name:"MAX_VIEWPORT_DIMS",value:3386,description:" "},e.SUBPIXEL_BITS={name:"SUBPIXEL_BITS",value:3408,description:" "},e.RED_BITS={name:"RED_BITS",value:3410,description:" "},e.GREEN_BITS={name:"GREEN_BITS",value:3411,description:" "},e.BLUE_BITS={name:"BLUE_BITS",value:3412,description:" "},e.ALPHA_BITS={name:"ALPHA_BITS",value:3413,description:" "},e.DEPTH_BITS={name:"DEPTH_BITS",value:3414,description:" "},e.STENCIL_BITS={name:"STENCIL_BITS",value:3415,description:" "},e.POLYGON_OFFSET_UNITS={name:"POLYGON_OFFSET_UNITS",value:10752,description:" "},e.POLYGON_OFFSET_FACTOR={name:"POLYGON_OFFSET_FACTOR",value:32824,description:" "},e.TEXTURE_BINDING_2D={name:"TEXTURE_BINDING_2D",value:32873,description:" "},e.SAMPLE_BUFFERS={name:"SAMPLE_BUFFERS",value:32936,description:" "},e.SAMPLES={name:"SAMPLES",value:32937,description:" "},e.SAMPLE_COVERAGE_VALUE={name:"SAMPLE_COVERAGE_VALUE",value:32938,description:" "},e.SAMPLE_COVERAGE_INVERT={name:"SAMPLE_COVERAGE_INVERT",value:32939,description:" "},e.COMPRESSED_TEXTURE_FORMATS={name:"COMPRESSED_TEXTURE_FORMATS",value:34467,description:" "},e.VENDOR={name:"VENDOR",value:7936,description:" "},e.RENDERER={name:"RENDERER",value:7937,description:" "},e.VERSION={name:"VERSION",value:7938,description:" "},e.IMPLEMENTATION_COLOR_READ_TYPE={name:"IMPLEMENTATION_COLOR_READ_TYPE",value:35738,description:" "},e.IMPLEMENTATION_COLOR_READ_FORMAT={name:"IMPLEMENTATION_COLOR_READ_FORMAT",value:35739,description:" "},e.BROWSER_DEFAULT_WEBGL={name:"BROWSER_DEFAULT_WEBGL",value:37444,description:" "},e.STATIC_DRAW={name:"STATIC_DRAW",value:35044,description:"Passed to bufferData as a hint about whether the contents of the buffer are likely to be used often and not change often."},e.STREAM_DRAW={name:"STREAM_DRAW",value:35040,description:"Passed to bufferData as a hint about whether the contents of the buffer are likely to not be used often."},e.DYNAMIC_DRAW={name:"DYNAMIC_DRAW",value:35048,description:"Passed to bufferData as a hint about whether the contents of the buffer are likely to be used often and change often."},e.ARRAY_BUFFER={name:"ARRAY_BUFFER",value:34962,description:"Passed to bindBuffer or bufferData to specify the type of buffer being used."},e.ELEMENT_ARRAY_BUFFER={name:"ELEMENT_ARRAY_BUFFER",value:34963,description:"Passed to bindBuffer or bufferData to specify the type of buffer being used."},e.BUFFER_SIZE={name:"BUFFER_SIZE",value:34660,description:"Passed to getBufferParameter to get a buffer's size."},e.BUFFER_USAGE={name:"BUFFER_USAGE",value:34661,description:"Passed to getBufferParameter to get the hint for the buffer passed in when it was created."},e.CURRENT_VERTEX_ATTRIB={name:"CURRENT_VERTEX_ATTRIB",value:34342,description:"Passed to getVertexAttrib to read back the current vertex attribute."},e.VERTEX_ATTRIB_ARRAY_ENABLED={name:"VERTEX_ATTRIB_ARRAY_ENABLED",value:34338,description:" "},e.VERTEX_ATTRIB_ARRAY_SIZE={name:"VERTEX_ATTRIB_ARRAY_SIZE",value:34339,description:" "},e.VERTEX_ATTRIB_ARRAY_STRIDE={name:"VERTEX_ATTRIB_ARRAY_STRIDE",value:34340,description:" "},e.VERTEX_ATTRIB_ARRAY_TYPE={name:"VERTEX_ATTRIB_ARRAY_TYPE",value:34341,description:" "},e.VERTEX_ATTRIB_ARRAY_NORMALIZED={name:"VERTEX_ATTRIB_ARRAY_NORMALIZED",value:34922,description:" "},e.VERTEX_ATTRIB_ARRAY_POINTER={name:"VERTEX_ATTRIB_ARRAY_POINTER",value:34373,description:" "},e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING={name:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",value:34975,description:" "},e.CULL_FACE={name:"CULL_FACE",value:2884,description:"Passed to enable/disable to turn on/off culling. Can also be used with getParameter to find the current culling method."},e.FRONT={name:"FRONT",value:1028,description:"Passed to cullFace to specify that only front faces should be drawn."},e.BACK={name:"BACK",value:1029,description:"Passed to cullFace to specify that only back faces should be drawn."},e.FRONT_AND_BACK={name:"FRONT_AND_BACK",value:1032,description:"Passed to cullFace to specify that front and back faces should be drawn."},e.BLEND={name:"BLEND",value:3042,description:"Passed to enable/disable to turn on/off blending. Can also be used with getParameter to find the current blending method."},e.DEPTH_TEST={name:"DEPTH_TEST",value:2929,description:"Passed to enable/disable to turn on/off the depth test. Can also be used with getParameter to query the depth test."},e.DITHER={name:"DITHER",value:3024,description:"Passed to enable/disable to turn on/off dithering. Can also be used with getParameter to find the current dithering method."},e.POLYGON_OFFSET_FILL={name:"POLYGON_OFFSET_FILL",value:32823,description:"Passed to enable/disable to turn on/off the polygon offset. Useful for rendering hidden-line images, decals, and or solids with highlighted edges. Can also be used with getParameter to query the scissor test."},e.SAMPLE_ALPHA_TO_COVERAGE={name:"SAMPLE_ALPHA_TO_COVERAGE",value:32926,description:"Passed to enable/disable to turn on/off the alpha to coverage. Used in multi-sampling alpha channels."},e.SAMPLE_COVERAGE={name:"SAMPLE_COVERAGE",value:32928,description:"Passed to enable/disable to turn on/off the sample coverage. Used in multi-sampling."},e.SCISSOR_TEST={name:"SCISSOR_TEST",value:3089,description:"Passed to enable/disable to turn on/off the scissor test. Can also be used with getParameter to query the scissor test."},e.STENCIL_TEST={name:"STENCIL_TEST",value:2960,description:"Passed to enable/disable to turn on/off the stencil test. Can also be used with getParameter to query the stencil test."},e.NO_ERROR={name:"NO_ERROR",value:0,description:"Returned from getError."},e.INVALID_ENUM={name:"INVALID_ENUM",value:1280,description:"Returned from getError."},e.INVALID_VALUE={name:"INVALID_VALUE",value:1281,description:"Returned from getError."},e.INVALID_OPERATION={name:"INVALID_OPERATION",value:1282,description:"Returned from getError."},e.OUT_OF_MEMORY={name:"OUT_OF_MEMORY",value:1285,description:"Returned from getError."},e.CONTEXT_LOST_WEBGL={name:"CONTEXT_LOST_WEBGL",value:37442,description:"Returned from getError."},e.CW={name:"CW",value:2304,description:"Passed to frontFace to specify the front face of a polygon is drawn in the clockwise direction"},e.CCW={name:"CCW",value:2305,description:"Passed to frontFace to specify the front face of a polygon is drawn in the counter clockwise direction"},e.DONT_CARE={name:"DONT_CARE",value:4352,description:"There is no preference for this behavior."},e.FASTEST={name:"FASTEST",value:4353,description:"The most efficient behavior should be used."},e.NICEST={name:"NICEST",value:4354,description:"The most correct or the highest quality option should be used."},e.GENERATE_MIPMAP_HINT={name:"GENERATE_MIPMAP_HINT",value:33170,description:"Hint for the quality of filtering when generating mipmap images with WebGLRenderingContext.generateMipmap()."},e.BYTE={name:"BYTE",value:5120,description:" "},e.UNSIGNED_BYTE={name:"UNSIGNED_BYTE",value:5121,description:" "},e.SHORT={name:"SHORT",value:5122,description:" "},e.UNSIGNED_SHORT={name:"UNSIGNED_SHORT",value:5123,description:" "},e.INT={name:"INT",value:5124,description:" "},e.UNSIGNED_INT={name:"UNSIGNED_INT",value:5125,description:" "},e.FLOAT={name:"FLOAT",value:5126,description:" "},e.DEPTH_COMPONENT={name:"DEPTH_COMPONENT",value:6402,description:" "},e.ALPHA={name:"ALPHA",value:6406,description:" "},e.RGB={name:"RGB",value:6407,description:" "},e.RGBA={name:"RGBA",value:6408,description:" "},e.LUMINANCE={name:"LUMINANCE",value:6409,description:" "},e.LUMINANCE_ALPHA={name:"LUMINANCE_ALPHA",value:6410,description:" "},e.UNSIGNED_SHORT_4_4_4_4={name:"UNSIGNED_SHORT_4_4_4_4",value:32819,description:" "},e.UNSIGNED_SHORT_5_5_5_1={name:"UNSIGNED_SHORT_5_5_5_1",value:32820,description:" "},e.UNSIGNED_SHORT_5_6_5={name:"UNSIGNED_SHORT_5_6_5",value:33635,description:" "},e.FRAGMENT_SHADER={name:"FRAGMENT_SHADER",value:35632,description:"Passed to createShader to define a fragment shader."},e.VERTEX_SHADER={name:"VERTEX_SHADER",value:35633,description:"Passed to createShader to define a vertex shader"},e.COMPILE_STATUS={name:"COMPILE_STATUS",value:35713,description:"Passed to getShaderParamter to get the status of the compilation. Returns false if the shader was not compiled. You can then query getShaderInfoLog to find the exact error"},e.DELETE_STATUS={name:"DELETE_STATUS",value:35712,description:"Passed to getShaderParamter to determine if a shader was deleted via deleteShader. Returns true if it was, false otherwise."},e.LINK_STATUS={name:"LINK_STATUS",value:35714,description:"Passed to getProgramParameter after calling linkProgram to determine if a program was linked correctly. Returns false if there were errors. Use getProgramInfoLog to find the exact error."},e.VALIDATE_STATUS={name:"VALIDATE_STATUS",value:35715,description:"Passed to getProgramParameter after calling validateProgram to determine if it is valid. Returns false if errors were found."},e.ATTACHED_SHADERS={name:"ATTACHED_SHADERS",value:35717,description:"Passed to getProgramParameter after calling attachShader to determine if the shader was attached correctly. Returns false if errors occurred."},e.ACTIVE_ATTRIBUTES={name:"ACTIVE_ATTRIBUTES",value:35721,description:"Passed to getProgramParameter to get the number of attributes active in a program."},e.ACTIVE_UNIFORMS={name:"ACTIVE_UNIFORMS",value:35718,description:"Passed to getProgramParamter to get the number of uniforms active in a program."},e.MAX_VERTEX_ATTRIBS={name:"MAX_VERTEX_ATTRIBS",value:34921,description:" "},e.MAX_VERTEX_UNIFORM_VECTORS={name:"MAX_VERTEX_UNIFORM_VECTORS",value:36347,description:" "},e.MAX_VARYING_VECTORS={name:"MAX_VARYING_VECTORS",value:36348,description:" "},e.MAX_COMBINED_TEXTURE_IMAGE_UNITS={name:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",value:35661,description:" "},e.MAX_VERTEX_TEXTURE_IMAGE_UNITS={name:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",value:35660,description:" "},e.MAX_TEXTURE_IMAGE_UNITS={name:"MAX_TEXTURE_IMAGE_UNITS",value:34930,description:"Implementation dependent number of maximum texture units. At least 8."},e.MAX_FRAGMENT_UNIFORM_VECTORS={name:"MAX_FRAGMENT_UNIFORM_VECTORS",value:36349,description:" "},e.SHADER_TYPE={name:"SHADER_TYPE",value:35663,description:" "},e.SHADING_LANGUAGE_VERSION={name:"SHADING_LANGUAGE_VERSION",value:35724,description:" "},e.CURRENT_PROGRAM={name:"CURRENT_PROGRAM",value:35725,description:" "},e.NEVER={name:"NEVER",value:512,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will never pass. i.e. Nothing will be drawn."},e.ALWAYS={name:"ALWAYS",value:519,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will always pass. i.e. Pixels will be drawn in the order they are drawn."},e.LESS={name:"LESS",value:513,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is less than the stored value."},e.EQUAL={name:"EQUAL",value:514,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is equals to the stored value."},e.LEQUAL={name:"LEQUAL",value:515,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is less than or equal to the stored value."},e.GREATER={name:"GREATER",value:516,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is greater than the stored value."},e.GEQUAL={name:"GEQUAL",value:518,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is greater than or equal to the stored value."},e.NOTEQUAL={name:"NOTEQUAL",value:517,description:"Passed to depthFunction or stencilFunction to specify depth or stencil tests will pass if the new depth value is not equal to the stored value."},e.KEEP={name:"KEEP",value:7680,description:" "},e.REPLACE={name:"REPLACE",value:7681,description:" "},e.INCR={name:"INCR",value:7682,description:" "},e.DECR={name:"DECR",value:7683,description:" "},e.INVERT={name:"INVERT",value:5386,description:" "},e.INCR_WRAP={name:"INCR_WRAP",value:34055,description:" "},e.DECR_WRAP={name:"DECR_WRAP",value:34056,description:" "},e.NEAREST={name:"NEAREST",value:9728,description:" "},e.LINEAR={name:"LINEAR",value:9729,description:" "},e.NEAREST_MIPMAP_NEAREST={name:"NEAREST_MIPMAP_NEAREST",value:9984,description:" "},e.LINEAR_MIPMAP_NEAREST={name:"LINEAR_MIPMAP_NEAREST",value:9985,description:" "},e.NEAREST_MIPMAP_LINEAR={name:"NEAREST_MIPMAP_LINEAR",value:9986,description:" "},e.LINEAR_MIPMAP_LINEAR={name:"LINEAR_MIPMAP_LINEAR",value:9987,description:" "},e.TEXTURE_MAG_FILTER={name:"TEXTURE_MAG_FILTER",value:10240,description:" "},e.TEXTURE_MIN_FILTER={name:"TEXTURE_MIN_FILTER",value:10241,description:" "},e.TEXTURE_WRAP_S={name:"TEXTURE_WRAP_S",value:10242,description:" "},e.TEXTURE_WRAP_T={name:"TEXTURE_WRAP_T",value:10243,description:" "},e.TEXTURE_2D={name:"TEXTURE_2D",value:3553,description:" "},e.TEXTURE={name:"TEXTURE",value:5890,description:" "},e.TEXTURE_CUBE_MAP={name:"TEXTURE_CUBE_MAP",value:34067,description:" "},e.TEXTURE_BINDING_CUBE_MAP={name:"TEXTURE_BINDING_CUBE_MAP",value:34068,description:" "},e.TEXTURE_CUBE_MAP_POSITIVE_X={name:"TEXTURE_CUBE_MAP_POSITIVE_X",value:34069,description:" "},e.TEXTURE_CUBE_MAP_NEGATIVE_X={name:"TEXTURE_CUBE_MAP_NEGATIVE_X",value:34070,description:" "},e.TEXTURE_CUBE_MAP_POSITIVE_Y={name:"TEXTURE_CUBE_MAP_POSITIVE_Y",value:34071,description:" "},e.TEXTURE_CUBE_MAP_NEGATIVE_Y={name:"TEXTURE_CUBE_MAP_NEGATIVE_Y",value:34072,description:" "},e.TEXTURE_CUBE_MAP_POSITIVE_Z={name:"TEXTURE_CUBE_MAP_POSITIVE_Z",value:34073,description:" "},e.TEXTURE_CUBE_MAP_NEGATIVE_Z={name:"TEXTURE_CUBE_MAP_NEGATIVE_Z",value:34074,description:" "},e.MAX_CUBE_MAP_TEXTURE_SIZE={name:"MAX_CUBE_MAP_TEXTURE_SIZE",value:34076,description:" "},e.TEXTURE0={name:"TEXTURE0",value:33984,description:"A texture unit."},e.TEXTURE1={name:"TEXTURE1",value:33985,description:"A texture unit."},e.TEXTURE2={name:"TEXTURE2",value:33986,description:"A texture unit."},e.TEXTURE3={name:"TEXTURE3",value:33987,description:"A texture unit."},e.TEXTURE4={name:"TEXTURE4",value:33988,description:"A texture unit."},e.TEXTURE5={name:"TEXTURE5",value:33989,description:"A texture unit."},e.TEXTURE6={name:"TEXTURE6",value:33990,description:"A texture unit."},e.TEXTURE7={name:"TEXTURE7",value:33991,description:"A texture unit."},e.TEXTURE8={name:"TEXTURE8",value:33992,description:"A texture unit."},e.TEXTURE9={name:"TEXTURE9",value:33993,description:"A texture unit."},e.TEXTURE10={name:"TEXTURE10",value:33994,description:"A texture unit."},e.TEXTURE11={name:"TEXTURE11",value:33995,description:"A texture unit."},e.TEXTURE12={name:"TEXTURE12",value:33996,description:"A texture unit."},e.TEXTURE13={name:"TEXTURE13",value:33997,description:"A texture unit."},e.TEXTURE14={name:"TEXTURE14",value:33998,description:"A texture unit."},e.TEXTURE15={name:"TEXTURE15",value:33999,description:"A texture unit."},e.TEXTURE16={name:"TEXTURE16",value:34e3,description:"A texture unit."},e.TEXTURE17={name:"TEXTURE17",value:34001,description:"A texture unit."},e.TEXTURE18={name:"TEXTURE18",value:34002,description:"A texture unit."},e.TEXTURE19={name:"TEXTURE19",value:34003,description:"A texture unit."},e.TEXTURE20={name:"TEXTURE20",value:34004,description:"A texture unit."},e.TEXTURE21={name:"TEXTURE21",value:34005,description:"A texture unit."},e.TEXTURE22={name:"TEXTURE22",value:34006,description:"A texture unit."},e.TEXTURE23={name:"TEXTURE23",value:34007,description:"A texture unit."},e.TEXTURE24={name:"TEXTURE24",value:34008,description:"A texture unit."},e.TEXTURE25={name:"TEXTURE25",value:34009,description:"A texture unit."},e.TEXTURE26={name:"TEXTURE26",value:34010,description:"A texture unit."},e.TEXTURE27={name:"TEXTURE27",value:34011,description:"A texture unit."},e.TEXTURE28={name:"TEXTURE28",value:34012,description:"A texture unit."},e.TEXTURE29={name:"TEXTURE29",value:34013,description:"A texture unit."},e.TEXTURE30={name:"TEXTURE30",value:34014,description:"A texture unit."},e.TEXTURE31={name:"TEXTURE31",value:34015,description:"A texture unit."},e.ACTIVE_TEXTURE={name:"ACTIVE_TEXTURE",value:34016,description:"The current active texture unit."},e.REPEAT={name:"REPEAT",value:10497,description:" "},e.CLAMP_TO_EDGE={name:"CLAMP_TO_EDGE",value:33071,description:" "},e.MIRRORED_REPEAT={name:"MIRRORED_REPEAT",value:33648,description:" "},e.FLOAT_VEC2={name:"FLOAT_VEC2",value:35664,description:" "},e.FLOAT_VEC3={name:"FLOAT_VEC3",value:35665,description:" "},e.FLOAT_VEC4={name:"FLOAT_VEC4",value:35666,description:" "},e.INT_VEC2={name:"INT_VEC2",value:35667,description:" "},e.INT_VEC3={name:"INT_VEC3",value:35668,description:" "},e.INT_VEC4={name:"INT_VEC4",value:35669,description:" "},e.BOOL={name:"BOOL",value:35670,description:" "},e.BOOL_VEC2={name:"BOOL_VEC2",value:35671,description:" "},e.BOOL_VEC3={name:"BOOL_VEC3",value:35672,description:" "},e.BOOL_VEC4={name:"BOOL_VEC4",value:35673,description:" "},e.FLOAT_MAT2={name:"FLOAT_MAT2",value:35674,description:" "},e.FLOAT_MAT3={name:"FLOAT_MAT3",value:35675,description:" "},e.FLOAT_MAT4={name:"FLOAT_MAT4",value:35676,description:" "},e.SAMPLER_2D={name:"SAMPLER_2D",value:35678,description:" "},e.SAMPLER_CUBE={name:"SAMPLER_CUBE",value:35680,description:" "},e.LOW_FLOAT={name:"LOW_FLOAT",value:36336,description:" "},e.MEDIUM_FLOAT={name:"MEDIUM_FLOAT",value:36337,description:" "},e.HIGH_FLOAT={name:"HIGH_FLOAT",value:36338,description:" "},e.LOW_INT={name:"LOW_INT",value:36339,description:" "},e.MEDIUM_INT={name:"MEDIUM_INT",value:36340,description:" "},e.HIGH_INT={name:"HIGH_INT",value:36341,description:" "},e.FRAMEBUFFER={name:"FRAMEBUFFER",value:36160,description:" "},e.RENDERBUFFER={name:"RENDERBUFFER",value:36161,description:" "},e.RGBA4={name:"RGBA4",value:32854,description:" "},e.RGB5_A1={name:"RGB5_A1",value:32855,description:" "},e.RGB565={name:"RGB565",value:36194,description:" "},e.DEPTH_COMPONENT16={name:"DEPTH_COMPONENT16",value:33189,description:" "},e.STENCIL_INDEX={name:"STENCIL_INDEX",value:6401,description:" "},e.STENCIL_INDEX8={name:"STENCIL_INDEX8",value:36168,description:" "},e.DEPTH_STENCIL={name:"DEPTH_STENCIL",value:34041,description:" "},e.RENDERBUFFER_WIDTH={name:"RENDERBUFFER_WIDTH",value:36162,description:" "},e.RENDERBUFFER_HEIGHT={name:"RENDERBUFFER_HEIGHT",value:36163,description:" "},e.RENDERBUFFER_INTERNAL_FORMAT={name:"RENDERBUFFER_INTERNAL_FORMAT",value:36164,description:" "},e.RENDERBUFFER_RED_SIZE={name:"RENDERBUFFER_RED_SIZE",value:36176,description:" "},e.RENDERBUFFER_GREEN_SIZE={name:"RENDERBUFFER_GREEN_SIZE",value:36177,description:" "},e.RENDERBUFFER_BLUE_SIZE={name:"RENDERBUFFER_BLUE_SIZE",value:36178,description:" "},e.RENDERBUFFER_ALPHA_SIZE={name:"RENDERBUFFER_ALPHA_SIZE",value:36179,description:" "},e.RENDERBUFFER_DEPTH_SIZE={name:"RENDERBUFFER_DEPTH_SIZE",value:36180,description:" "},e.RENDERBUFFER_STENCIL_SIZE={name:"RENDERBUFFER_STENCIL_SIZE",value:36181,description:" "},e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE={name:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",value:36048,description:" "},e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME={name:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",value:36049,description:" "},e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL={name:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",value:36050,description:" "},e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE={name:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",value:36051,description:" "},e.COLOR_ATTACHMENT0={name:"COLOR_ATTACHMENT0",value:36064,description:" "},e.DEPTH_ATTACHMENT={name:"DEPTH_ATTACHMENT",value:36096,description:" "},e.STENCIL_ATTACHMENT={name:"STENCIL_ATTACHMENT",value:36128,description:" "},e.DEPTH_STENCIL_ATTACHMENT={name:"DEPTH_STENCIL_ATTACHMENT",value:33306,description:" "},e.NONE={name:"NONE",value:0,description:" "},e.FRAMEBUFFER_COMPLETE={name:"FRAMEBUFFER_COMPLETE",value:36053,description:" "},e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT={name:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",value:36054,description:" "},e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT={name:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",value:36055,description:" "},e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS={name:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",value:36057,description:" "},e.FRAMEBUFFER_UNSUPPORTED={name:"FRAMEBUFFER_UNSUPPORTED",value:36061,description:" "},e.FRAMEBUFFER_BINDING={name:"FRAMEBUFFER_BINDING",value:36006,description:" "},e.RENDERBUFFER_BINDING={name:"RENDERBUFFER_BINDING",value:36007,description:" "},e.MAX_RENDERBUFFER_SIZE={name:"MAX_RENDERBUFFER_SIZE",value:34024,description:" "},e.INVALID_FRAMEBUFFER_OPERATION={name:"INVALID_FRAMEBUFFER_OPERATION",value:1286,description:" "},e.UNPACK_FLIP_Y_WEBGL={name:"UNPACK_FLIP_Y_WEBGL",value:37440,description:" "},e.UNPACK_PREMULTIPLY_ALPHA_WEBGL={name:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",value:37441,description:" "},e.UNPACK_COLORSPACE_CONVERSION_WEBGL={name:"UNPACK_COLORSPACE_CONVERSION_WEBGL",value:37443,description:" "},e.READ_BUFFER={name:"READ_BUFFER",value:3074,description:" "},e.UNPACK_ROW_LENGTH={name:"UNPACK_ROW_LENGTH",value:3314,description:" "},e.UNPACK_SKIP_ROWS={name:"UNPACK_SKIP_ROWS",value:3315,description:" "},e.UNPACK_SKIP_PIXELS={name:"UNPACK_SKIP_PIXELS",value:3316,description:" "},e.PACK_ROW_LENGTH={name:"PACK_ROW_LENGTH",value:3330,description:" "},e.PACK_SKIP_ROWS={name:"PACK_SKIP_ROWS",value:3331,description:" "},e.PACK_SKIP_PIXELS={name:"PACK_SKIP_PIXELS",value:3332,description:" "},e.TEXTURE_BINDING_3D={name:"TEXTURE_BINDING_3D",value:32874,description:" "},e.UNPACK_SKIP_IMAGES={name:"UNPACK_SKIP_IMAGES",value:32877,description:" "},e.UNPACK_IMAGE_HEIGHT={name:"UNPACK_IMAGE_HEIGHT",value:32878,description:" "},e.MAX_3D_TEXTURE_SIZE={name:"MAX_3D_TEXTURE_SIZE",value:32883,description:" "},e.MAX_ELEMENTS_VERTICES={name:"MAX_ELEMENTS_VERTICES",value:33e3,description:" "},e.MAX_ELEMENTS_INDICES={name:"MAX_ELEMENTS_INDICES",value:33001,description:" "},e.MAX_TEXTURE_LOD_BIAS={name:"MAX_TEXTURE_LOD_BIAS",value:34045,description:" "},e.MAX_FRAGMENT_UNIFORM_COMPONENTS={name:"MAX_FRAGMENT_UNIFORM_COMPONENTS",value:35657,description:" "},e.MAX_VERTEX_UNIFORM_COMPONENTS={name:"MAX_VERTEX_UNIFORM_COMPONENTS",value:35658,description:" "},e.MAX_ARRAY_TEXTURE_LAYERS={name:"MAX_ARRAY_TEXTURE_LAYERS",value:35071,description:" "},e.MIN_PROGRAM_TEXEL_OFFSET={name:"MIN_PROGRAM_TEXEL_OFFSET",value:35076,description:" "},e.MAX_PROGRAM_TEXEL_OFFSET={name:"MAX_PROGRAM_TEXEL_OFFSET",value:35077,description:" "},e.MAX_VARYING_COMPONENTS={name:"MAX_VARYING_COMPONENTS",value:35659,description:" "},e.FRAGMENT_SHADER_DERIVATIVE_HINT={name:"FRAGMENT_SHADER_DERIVATIVE_HINT",value:35723,description:" "},e.RASTERIZER_DISCARD={name:"RASTERIZER_DISCARD",value:35977,description:" "},e.VERTEX_ARRAY_BINDING={name:"VERTEX_ARRAY_BINDING",value:34229,description:" "},e.MAX_VERTEX_OUTPUT_COMPONENTS={name:"MAX_VERTEX_OUTPUT_COMPONENTS",value:37154,description:" "},e.MAX_FRAGMENT_INPUT_COMPONENTS={name:"MAX_FRAGMENT_INPUT_COMPONENTS",value:37157,description:" "},e.MAX_SERVER_WAIT_TIMEOUT={name:"MAX_SERVER_WAIT_TIMEOUT",value:37137,description:" "},e.MAX_ELEMENT_INDEX={name:"MAX_ELEMENT_INDEX",value:36203,description:" "},e.RED={name:"RED",value:6403,description:" "},e.RGB8={name:"RGB8",value:32849,description:" "},e.RGBA8={name:"RGBA8",value:32856,description:" "},e.RGB10_A2={name:"RGB10_A2",value:32857,description:" "},e.TEXTURE_3D={name:"TEXTURE_3D",value:32879,description:" "},e.TEXTURE_WRAP_R={name:"TEXTURE_WRAP_R",value:32882,description:" "},e.TEXTURE_MIN_LOD={name:"TEXTURE_MIN_LOD",value:33082,description:" "},e.TEXTURE_MAX_LOD={name:"TEXTURE_MAX_LOD",value:33083,description:" "},e.TEXTURE_BASE_LEVEL={name:"TEXTURE_BASE_LEVEL",value:33084,description:" "},e.TEXTURE_MAX_LEVEL={name:"TEXTURE_MAX_LEVEL",value:33085,description:" "},e.TEXTURE_COMPARE_MODE={name:"TEXTURE_COMPARE_MODE",value:34892,description:" "},e.TEXTURE_COMPARE_FUNC={name:"TEXTURE_COMPARE_FUNC",value:34893,description:" "},e.SRGB={name:"SRGB",value:35904,description:" "},e.SRGB8={name:"SRGB8",value:35905,description:" "},e.SRGB8_ALPHA8={name:"SRGB8_ALPHA8",value:35907,description:" "},e.COMPARE_REF_TO_TEXTURE={name:"COMPARE_REF_TO_TEXTURE",value:34894,description:" "},e.RGBA32F={name:"RGBA32F",value:34836,description:" "},e.RGB32F={name:"RGB32F",value:34837,description:" "},e.RGBA16F={name:"RGBA16F",value:34842,description:" "},e.RGB16F={name:"RGB16F",value:34843,description:" "},e.TEXTURE_2D_ARRAY={name:"TEXTURE_2D_ARRAY",value:35866,description:" "},e.TEXTURE_BINDING_2D_ARRAY={name:"TEXTURE_BINDING_2D_ARRAY",value:35869,description:" "},e.R11F_G11F_B10F={name:"R11F_G11F_B10F",value:35898,description:" "},e.RGB9_E5={name:"RGB9_E5",value:35901,description:" "},e.RGBA32UI={name:"RGBA32UI",value:36208,description:" "},e.RGB32UI={name:"RGB32UI",value:36209,description:" "},e.RGBA16UI={name:"RGBA16UI",value:36214,description:" "},e.RGB16UI={name:"RGB16UI",value:36215,description:" "},e.RGBA8UI={name:"RGBA8UI",value:36220,description:" "},e.RGB8UI={name:"RGB8UI",value:36221,description:" "},e.RGBA32I={name:"RGBA32I",value:36226,description:" "},e.RGB32I={name:"RGB32I",value:36227,description:" "},e.RGBA16I={name:"RGBA16I",value:36232,description:" "},e.RGB16I={name:"RGB16I",value:36233,description:" "},e.RGBA8I={name:"RGBA8I",value:36238,description:" "},e.RGB8I={name:"RGB8I",value:36239,description:" "},e.RED_INTEGER={name:"RED_INTEGER",value:36244,description:" "},e.RGB_INTEGER={name:"RGB_INTEGER",value:36248,description:" "},e.RGBA_INTEGER={name:"RGBA_INTEGER",value:36249,description:" "},e.R8={name:"R8",value:33321,description:" "},e.RG8={name:"RG8",value:33323,description:" "},e.R16F={name:"R16F",value:33325,description:" "},e.R32F={name:"R32F",value:33326,description:" "},e.RG16F={name:"RG16F",value:33327,description:" "},e.RG32F={name:"RG32F",value:33328,description:" "},e.R8I={name:"R8I",value:33329,description:" "},e.R8UI={name:"R8UI",value:33330,description:" "},e.R16I={name:"R16I",value:33331,description:" "},e.R16UI={name:"R16UI",value:33332,description:" "},e.R32I={name:"R32I",value:33333,description:" "},e.R32UI={name:"R32UI",value:33334,description:" "},e.RG8I={name:"RG8I",value:33335,description:" "},e.RG8UI={name:"RG8UI",value:33336,description:" "},e.RG16I={name:"RG16I",value:33337,description:" "},e.RG16UI={name:"RG16UI",value:33338,description:" "},e.RG32I={name:"RG32I",value:33339,description:" "},e.RG32UI={name:"RG32UI",value:33340,description:" "},e.R8_SNORM={name:"R8_SNORM",value:36756,description:" "},e.RG8_SNORM={name:"RG8_SNORM",value:36757,description:" "},e.RGB8_SNORM={name:"RGB8_SNORM",value:36758,description:" "},e.RGBA8_SNORM={name:"RGBA8_SNORM",value:36759,description:" "},e.RGB10_A2UI={name:"RGB10_A2UI",value:36975,description:" "},e.TEXTURE_IMMUTABLE_FORMAT={name:"TEXTURE_IMMUTABLE_FORMAT",value:37167,description:" "},e.TEXTURE_IMMUTABLE_LEVELS={name:"TEXTURE_IMMUTABLE_LEVELS",value:33503,description:" "},e.UNSIGNED_INT_2_10_10_10_REV={name:"UNSIGNED_INT_2_10_10_10_REV",value:33640,description:" "},e.UNSIGNED_INT_10F_11F_11F_REV={name:"UNSIGNED_INT_10F_11F_11F_REV",value:35899,description:" "},e.UNSIGNED_INT_5_9_9_9_REV={name:"UNSIGNED_INT_5_9_9_9_REV",value:35902,description:" "},e.FLOAT_32_UNSIGNED_INT_24_8_REV={name:"FLOAT_32_UNSIGNED_INT_24_8_REV",value:36269,description:" "},e.UNSIGNED_INT_24_8={name:"UNSIGNED_INT_24_8",value:34042,description:" "},e.HALF_FLOAT={name:"HALF_FLOAT",value:5131,description:" "},e.RG={name:"RG",value:33319,description:" "},e.RG_INTEGER={name:"RG_INTEGER",value:33320,description:" "},e.INT_2_10_10_10_REV={name:"INT_2_10_10_10_REV",value:36255,description:" "},e.CURRENT_QUERY={name:"CURRENT_QUERY",value:34917,description:" "},e.QUERY_RESULT={name:"QUERY_RESULT",value:34918,description:" "},e.QUERY_RESULT_AVAILABLE={name:"QUERY_RESULT_AVAILABLE",value:34919,description:" "},e.ANY_SAMPLES_PASSED={name:"ANY_SAMPLES_PASSED",value:35887,description:" "},e.ANY_SAMPLES_PASSED_CONSERVATIVE={name:"ANY_SAMPLES_PASSED_CONSERVATIVE",value:36202,description:" "},e.MAX_DRAW_BUFFERS={name:"MAX_DRAW_BUFFERS",value:34852,description:" "},e.DRAW_BUFFER0={name:"DRAW_BUFFER0",value:34853,description:" "},e.DRAW_BUFFER1={name:"DRAW_BUFFER1",value:34854,description:" "},e.DRAW_BUFFER2={name:"DRAW_BUFFER2",value:34855,description:" "},e.DRAW_BUFFER3={name:"DRAW_BUFFER3",value:34856,description:" "},e.DRAW_BUFFER4={name:"DRAW_BUFFER4",value:34857,description:" "},e.DRAW_BUFFER5={name:"DRAW_BUFFER5",value:34858,description:" "},e.DRAW_BUFFER6={name:"DRAW_BUFFER6",value:34859,description:" "},e.DRAW_BUFFER7={name:"DRAW_BUFFER7",value:34860,description:" "},e.DRAW_BUFFER8={name:"DRAW_BUFFER8",value:34861,description:" "},e.DRAW_BUFFER9={name:"DRAW_BUFFER9",value:34862,description:" "},e.DRAW_BUFFER10={name:"DRAW_BUFFER10",value:34863,description:" "},e.DRAW_BUFFER11={name:"DRAW_BUFFER11",value:34864,description:" "},e.DRAW_BUFFER12={name:"DRAW_BUFFER12",value:34865,description:" "},e.DRAW_BUFFER13={name:"DRAW_BUFFER13",value:34866,description:" "},e.DRAW_BUFFER14={name:"DRAW_BUFFER14",value:34867,description:" "},e.DRAW_BUFFER15={name:"DRAW_BUFFER15",value:34868,description:" "},e.MAX_COLOR_ATTACHMENTS={name:"MAX_COLOR_ATTACHMENTS",value:36063,description:" "},e.COLOR_ATTACHMENT1={name:"COLOR_ATTACHMENT1",value:36065,description:" "},e.COLOR_ATTACHMENT2={name:"COLOR_ATTACHMENT2",value:36066,description:" "},e.COLOR_ATTACHMENT3={name:"COLOR_ATTACHMENT3",value:36067,description:" "},e.COLOR_ATTACHMENT4={name:"COLOR_ATTACHMENT4",value:36068,description:" "},e.COLOR_ATTACHMENT5={name:"COLOR_ATTACHMENT5",value:36069,description:" "},e.COLOR_ATTACHMENT6={name:"COLOR_ATTACHMENT6",value:36070,description:" "},e.COLOR_ATTACHMENT7={name:"COLOR_ATTACHMENT7",value:36071,description:" "},e.COLOR_ATTACHMENT8={name:"COLOR_ATTACHMENT8",value:36072,description:" "},e.COLOR_ATTACHMENT9={name:"COLOR_ATTACHMENT9",value:36073,description:" "},e.COLOR_ATTACHMENT10={name:"COLOR_ATTACHMENT10",value:36074,description:" "},e.COLOR_ATTACHMENT11={name:"COLOR_ATTACHMENT11",value:36075,description:" "},e.COLOR_ATTACHMENT12={name:"COLOR_ATTACHMENT12",value:36076,description:" "},e.COLOR_ATTACHMENT13={name:"COLOR_ATTACHMENT13",value:36077,description:" "},e.COLOR_ATTACHMENT14={name:"COLOR_ATTACHMENT14",value:36078,description:" "},e.COLOR_ATTACHMENT15={name:"COLOR_ATTACHMENT15",value:36079,description:" "},e.SAMPLER_3D={name:"SAMPLER_3D",value:35679,description:" "},e.SAMPLER_2D_SHADOW={name:"SAMPLER_2D_SHADOW",value:35682,description:" "},e.SAMPLER_2D_ARRAY={name:"SAMPLER_2D_ARRAY",value:36289,description:" "},e.SAMPLER_2D_ARRAY_SHADOW={name:"SAMPLER_2D_ARRAY_SHADOW",value:36292,description:" "},e.SAMPLER_CUBE_SHADOW={name:"SAMPLER_CUBE_SHADOW",value:36293,description:" "},e.INT_SAMPLER_2D={name:"INT_SAMPLER_2D",value:36298,description:" "},e.INT_SAMPLER_3D={name:"INT_SAMPLER_3D",value:36299,description:" "},e.INT_SAMPLER_CUBE={name:"INT_SAMPLER_CUBE",value:36300,description:" "},e.INT_SAMPLER_2D_ARRAY={name:"INT_SAMPLER_2D_ARRAY",value:36303,description:" "},e.UNSIGNED_INT_SAMPLER_2D={name:"UNSIGNED_INT_SAMPLER_2D",value:36306,description:" "},e.UNSIGNED_INT_SAMPLER_3D={name:"UNSIGNED_INT_SAMPLER_3D",value:36307,description:" "},e.UNSIGNED_INT_SAMPLER_CUBE={name:"UNSIGNED_INT_SAMPLER_CUBE",value:36308,description:" "},e.UNSIGNED_INT_SAMPLER_2D_ARRAY={name:"UNSIGNED_INT_SAMPLER_2D_ARRAY",value:36311,description:" "},e.MAX_SAMPLES={name:"MAX_SAMPLES",value:36183,description:" "},e.SAMPLER_BINDING={name:"SAMPLER_BINDING",value:35097,description:" "},e.PIXEL_PACK_BUFFER={name:"PIXEL_PACK_BUFFER",value:35051,description:" "},e.PIXEL_UNPACK_BUFFER={name:"PIXEL_UNPACK_BUFFER",value:35052,description:" "},e.PIXEL_PACK_BUFFER_BINDING={name:"PIXEL_PACK_BUFFER_BINDING",value:35053,description:" "},e.PIXEL_UNPACK_BUFFER_BINDING={name:"PIXEL_UNPACK_BUFFER_BINDING",value:35055,description:" "},e.COPY_READ_BUFFER={name:"COPY_READ_BUFFER",value:36662,description:" "},e.COPY_WRITE_BUFFER={name:"COPY_WRITE_BUFFER",value:36663,description:" "},e.COPY_READ_BUFFER_BINDING={name:"COPY_READ_BUFFER_BINDING",value:36662,description:" "},e.COPY_WRITE_BUFFER_BINDING={name:"COPY_WRITE_BUFFER_BINDING",value:36663,description:" "},e.FLOAT_MAT2x3={name:"FLOAT_MAT2x3",value:35685,description:" "},e.FLOAT_MAT2x4={name:"FLOAT_MAT2x4",value:35686,description:" "},e.FLOAT_MAT3x2={name:"FLOAT_MAT3x2",value:35687,description:" "},e.FLOAT_MAT3x4={name:"FLOAT_MAT3x4",value:35688,description:" "},e.FLOAT_MAT4x2={name:"FLOAT_MAT4x2",value:35689,description:" "},e.FLOAT_MAT4x3={name:"FLOAT_MAT4x3",value:35690,description:" "},e.UNSIGNED_INT_VEC2={name:"UNSIGNED_INT_VEC2",value:36294,description:" "},e.UNSIGNED_INT_VEC3={name:"UNSIGNED_INT_VEC3",value:36295,description:" "},e.UNSIGNED_INT_VEC4={name:"UNSIGNED_INT_VEC4",value:36296,description:" "},e.UNSIGNED_NORMALIZED={name:"UNSIGNED_NORMALIZED",value:35863,description:" "},e.SIGNED_NORMALIZED={name:"SIGNED_NORMALIZED",value:36764,description:" "},e.VERTEX_ATTRIB_ARRAY_INTEGER={name:"VERTEX_ATTRIB_ARRAY_INTEGER",value:35069,description:" "},e.VERTEX_ATTRIB_ARRAY_DIVISOR={name:"VERTEX_ATTRIB_ARRAY_DIVISOR",value:35070,description:" "},e.TRANSFORM_FEEDBACK_BUFFER_MODE={name:"TRANSFORM_FEEDBACK_BUFFER_MODE",value:35967,description:" "},e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS={name:"MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",value:35968,description:" "},e.TRANSFORM_FEEDBACK_VARYINGS={name:"TRANSFORM_FEEDBACK_VARYINGS",value:35971,description:" "},e.TRANSFORM_FEEDBACK_BUFFER_START={name:"TRANSFORM_FEEDBACK_BUFFER_START",value:35972,description:" "},e.TRANSFORM_FEEDBACK_BUFFER_SIZE={name:"TRANSFORM_FEEDBACK_BUFFER_SIZE",value:35973,description:" "},e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN={name:"TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",value:35976,description:" "},e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS={name:"MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",value:35978,description:" "},e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS={name:"MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",value:35979,description:" "},e.INTERLEAVED_ATTRIBS={name:"INTERLEAVED_ATTRIBS",value:35980,description:" "},e.SEPARATE_ATTRIBS={name:"SEPARATE_ATTRIBS",value:35981,description:" "},e.TRANSFORM_FEEDBACK_BUFFER={name:"TRANSFORM_FEEDBACK_BUFFER",value:35982,description:" "},e.TRANSFORM_FEEDBACK_BUFFER_BINDING={name:"TRANSFORM_FEEDBACK_BUFFER_BINDING",value:35983,description:" "},e.TRANSFORM_FEEDBACK={name:"TRANSFORM_FEEDBACK",value:36386,description:" "},e.TRANSFORM_FEEDBACK_PAUSED={name:"TRANSFORM_FEEDBACK_PAUSED",value:36387,description:" "},e.TRANSFORM_FEEDBACK_ACTIVE={name:"TRANSFORM_FEEDBACK_ACTIVE",value:36388,description:" "},e.TRANSFORM_FEEDBACK_BINDING={name:"TRANSFORM_FEEDBACK_BINDING",value:36389,description:" "},e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING={name:"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",value:33296,description:" "},e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE={name:"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",value:33297,description:" "},e.FRAMEBUFFER_ATTACHMENT_RED_SIZE={name:"FRAMEBUFFER_ATTACHMENT_RED_SIZE",value:33298,description:" "},e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE={name:"FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",value:33299,description:" "},e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE={name:"FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",value:33300,description:" "},e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE={name:"FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",value:33301,description:" "},e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE={name:"FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",value:33302,description:" "},e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE={name:"FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",value:33303,description:" "},e.FRAMEBUFFER_DEFAULT={name:"FRAMEBUFFER_DEFAULT",value:33304,description:" "},e.DEPTH24_STENCIL8={name:"DEPTH24_STENCIL8",value:35056,description:" "},e.DRAW_FRAMEBUFFER_BINDING={name:"DRAW_FRAMEBUFFER_BINDING",value:36006,description:" "},e.READ_FRAMEBUFFER={name:"READ_FRAMEBUFFER",value:36008,description:" "},e.DRAW_FRAMEBUFFER={name:"DRAW_FRAMEBUFFER",value:36009,description:" "},e.READ_FRAMEBUFFER_BINDING={name:"READ_FRAMEBUFFER_BINDING",value:36010,description:" "},e.RENDERBUFFER_SAMPLES={name:"RENDERBUFFER_SAMPLES",value:36011,description:" "},e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER={name:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",value:36052,description:" "},e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE={name:"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",value:36182,description:" "},e.UNIFORM_BUFFER={name:"UNIFORM_BUFFER",value:35345,description:" "},e.UNIFORM_BUFFER_BINDING={name:"UNIFORM_BUFFER_BINDING",value:35368,description:" "},e.UNIFORM_BUFFER_START={name:"UNIFORM_BUFFER_START",value:35369,description:" "},e.UNIFORM_BUFFER_SIZE={name:"UNIFORM_BUFFER_SIZE",value:35370,description:" "},e.MAX_VERTEX_UNIFORM_BLOCKS={name:"MAX_VERTEX_UNIFORM_BLOCKS",value:35371,description:" "},e.MAX_FRAGMENT_UNIFORM_BLOCKS={name:"MAX_FRAGMENT_UNIFORM_BLOCKS",value:35373,description:" "},e.MAX_COMBINED_UNIFORM_BLOCKS={name:"MAX_COMBINED_UNIFORM_BLOCKS",value:35374,description:" "},e.MAX_UNIFORM_BUFFER_BINDINGS={name:"MAX_UNIFORM_BUFFER_BINDINGS",value:35375,description:" "},e.MAX_UNIFORM_BLOCK_SIZE={name:"MAX_UNIFORM_BLOCK_SIZE",value:35376,description:" "},e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS={name:"MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",value:35377,description:" "},e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS={name:"MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",value:35379,description:" "},e.UNIFORM_BUFFER_OFFSET_ALIGNMENT={name:"UNIFORM_BUFFER_OFFSET_ALIGNMENT",value:35380,description:" "},e.ACTIVE_UNIFORM_BLOCKS={name:"ACTIVE_UNIFORM_BLOCKS",value:35382,description:" "},e.UNIFORM_TYPE={name:"UNIFORM_TYPE",value:35383,description:" "},e.UNIFORM_SIZE={name:"UNIFORM_SIZE",value:35384,description:" "},e.UNIFORM_BLOCK_INDEX={name:"UNIFORM_BLOCK_INDEX",value:35386,description:" "},e.UNIFORM_OFFSET={name:"UNIFORM_OFFSET",value:35387,description:" "},e.UNIFORM_ARRAY_STRIDE={name:"UNIFORM_ARRAY_STRIDE",value:35388,description:" "},e.UNIFORM_MATRIX_STRIDE={name:"UNIFORM_MATRIX_STRIDE",value:35389,description:" "},e.UNIFORM_IS_ROW_MAJOR={name:"UNIFORM_IS_ROW_MAJOR",value:35390,description:" "},e.UNIFORM_BLOCK_BINDING={name:"UNIFORM_BLOCK_BINDING",value:35391,description:" "},e.UNIFORM_BLOCK_DATA_SIZE={name:"UNIFORM_BLOCK_DATA_SIZE",value:35392,description:" "},e.UNIFORM_BLOCK_ACTIVE_UNIFORMS={name:"UNIFORM_BLOCK_ACTIVE_UNIFORMS",value:35394,description:" "},e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES={name:"UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",value:35395,description:" "},e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER={name:"UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",value:35396,description:" "},e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER={name:"UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",value:35398,description:" "},e.OBJECT_TYPE={name:"OBJECT_TYPE",value:37138,description:" "},e.SYNC_CONDITION={name:"SYNC_CONDITION",value:37139,description:" "},e.SYNC_STATUS={name:"SYNC_STATUS",value:37140,description:" "},e.SYNC_FLAGS={name:"SYNC_FLAGS",value:37141,description:" "},e.SYNC_FENCE={name:"SYNC_FENCE",value:37142,description:" "},e.SYNC_GPU_COMMANDS_COMPLETE={name:"SYNC_GPU_COMMANDS_COMPLETE",value:37143,description:" "},e.UNSIGNALED={name:"UNSIGNALED",value:37144,description:" "},e.SIGNALED={name:"SIGNALED",value:37145,description:" "},e.ALREADY_SIGNALED={name:"ALREADY_SIGNALED",value:37146,description:" "},e.TIMEOUT_EXPIRED={name:"TIMEOUT_EXPIRED",value:37147,description:" "},e.CONDITION_SATISFIED={name:"CONDITION_SATISFIED",value:37148,description:" "},e.WAIT_FAILED={name:"WAIT_FAILED",value:37149,description:" "},e.SYNC_FLUSH_COMMANDS_BIT={name:"SYNC_FLUSH_COMMANDS_BIT",value:1,description:" "},e.COLOR={name:"COLOR",value:6144,description:" "},e.DEPTH={name:"DEPTH",value:6145,description:" "},e.STENCIL={name:"STENCIL",value:6146,description:" "},e.MIN={name:"MIN",value:32775,description:" "},e.MAX={name:"MAX",value:32776,description:" "},e.DEPTH_COMPONENT24={name:"DEPTH_COMPONENT24",value:33190,description:" "},e.STREAM_READ={name:"STREAM_READ",value:35041,description:" "},e.STREAM_COPY={name:"STREAM_COPY",value:35042,description:" "},e.STATIC_READ={name:"STATIC_READ",value:35045,description:" "},e.STATIC_COPY={name:"STATIC_COPY",value:35046,description:" "},e.DYNAMIC_READ={name:"DYNAMIC_READ",value:35049,description:" "},e.DYNAMIC_COPY={name:"DYNAMIC_COPY",value:35050,description:" "},e.DEPTH_COMPONENT32F={name:"DEPTH_COMPONENT32F",value:36012,description:" "},e.DEPTH32F_STENCIL8={name:"DEPTH32F_STENCIL8",value:36013,description:" "},e.INVALID_INDEX={name:"INVALID_INDEX",value:4294967295,description:" "},e.TIMEOUT_IGNORED={name:"TIMEOUT_IGNORED",value:-1,description:" "},e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL={name:"MAX_CLIENT_WAIT_TIMEOUT_WEBGL",value:37447,description:" "},e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE={name:"VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",value:35070,description:"Describes the frequency divisor used for instanced rendering.",extensionName:"ANGLE_instanced_arrays"},e.UNMASKED_VENDOR_WEBGL={name:"UNMASKED_VENDOR_WEBGL",value:37445,description:"Passed to getParameter to get the vendor string of the graphics driver.",extensionName:"ANGLE_instanced_arrays"},e.UNMASKED_RENDERER_WEBGL={name:"UNMASKED_RENDERER_WEBGL",value:37446,description:"Passed to getParameter to get the renderer string of the graphics driver.",extensionName:"WEBGL_debug_renderer_info"},e.MAX_TEXTURE_MAX_ANISOTROPY_EXT={name:"MAX_TEXTURE_MAX_ANISOTROPY_EXT",value:34047,description:"Returns the maximum available anisotropy.",extensionName:"EXT_texture_filter_anisotropic"},e.TEXTURE_MAX_ANISOTROPY_EXT={name:"TEXTURE_MAX_ANISOTROPY_EXT",value:34046,description:"Passed to texParameter to set the desired maximum anisotropy for a texture.",extensionName:"EXT_texture_filter_anisotropic"},e.COMPRESSED_RGB_S3TC_DXT1_EXT={name:"COMPRESSED_RGB_S3TC_DXT1_EXT",value:33776,description:"A DXT1-compressed image in an RGB image format.",extensionName:"WEBGL_compressed_texture_s3tc"},e.COMPRESSED_RGBA_S3TC_DXT1_EXT={name:"COMPRESSED_RGBA_S3TC_DXT1_EXT",value:33777,description:"A DXT1-compressed image in an RGB image format with a simple on/off alpha value.",extensionName:"WEBGL_compressed_texture_s3tc"},e.COMPRESSED_RGBA_S3TC_DXT3_EXT={name:"COMPRESSED_RGBA_S3TC_DXT3_EXT",value:33778,description:"A DXT3-compressed image in an RGBA image format. Compared to a 32-bit RGBA texture, it offers 4:1 compression.",extensionName:"WEBGL_compressed_texture_s3tc"},e.COMPRESSED_RGBA_S3TC_DXT5_EXT={name:"COMPRESSED_RGBA_S3TC_DXT5_EXT",value:33779,description:"A DXT5-compressed image in an RGBA image format. It also provides a 4:1 compression, but differs to the DXT3 compression in how the alpha compression is done.",extensionName:"WEBGL_compressed_texture_s3tc"},e.COMPRESSED_R11_EAC={name:"COMPRESSED_R11_EAC",value:37488,description:"One-channel (red) unsigned format compression.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_SIGNED_R11_EAC={name:"COMPRESSED_SIGNED_R11_EAC",value:37489,description:"One-channel (red) signed format compression.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_RG11_EAC={name:"COMPRESSED_RG11_EAC",value:37490,description:"Two-channel (red and green) unsigned format compression.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_SIGNED_RG11_EAC={name:"COMPRESSED_SIGNED_RG11_EAC",value:37491,description:"Two-channel (red and green) signed format compression.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_RGB8_ETC2={name:"COMPRESSED_RGB8_ETC2",value:37492,description:"Compresses RBG8 data with no alpha channel.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_RGBA8_ETC2_EAC={name:"COMPRESSED_RGBA8_ETC2_EAC",value:37493,description:"Compresses RGBA8 data. The RGB part is encoded the same as RGB_ETC2, but the alpha part is encoded separately.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_SRGB8_ETC2={name:"COMPRESSED_SRGB8_ETC2",value:37494,description:"Compresses sRBG8 data with no alpha channel.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC={name:"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",value:37495,description:"Compresses sRGBA8 data. The sRGB part is encoded the same as SRGB_ETC2, but the alpha part is encoded separately.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2={name:"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",value:37496,description:"Similar to RGB8_ETC, but with ability to punch through the alpha channel, which means to make it completely opaque or transparent.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2={name:"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",value:37497,description:"Similar to SRGB8_ETC, but with ability to punch through the alpha channel, which means to make it completely opaque or transparent.",extensionName:"WEBGL_compressed_texture_etc"},e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG={name:"COMPRESSED_RGB_PVRTC_4BPPV1_IMG",value:35840,description:"RGB compression in 4-bit mode. One block for each 4×4 pixels.",extensionName:"WEBGL_compressed_texture_pvrtc"},e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG={name:"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",value:35842,description:"RGBA compression in 4-bit mode. One block for each 4×4 pixels.",extensionName:"WEBGL_compressed_texture_pvrtc"},e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG={name:"COMPRESSED_RGB_PVRTC_2BPPV1_IMG",value:35841,description:"RGB compression in 2-bit mode. One block for each 8×4 pixels.",extensionName:"WEBGL_compressed_texture_pvrtc"},e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG={name:"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",value:35843,description:"RGBA compression in 2-bit mode. One block for each 8×4 pixe",extensionName:"WEBGL_compressed_texture_pvrtc"},e.COMPRESSED_RGB_ETC1_WEBGL={name:"COMPRESSED_RGB_ETC1_WEBGL",value:36196,description:"Compresses 24-bit RGB data with no alpha channel.",extensionName:"WEBGL_compressed_texture_etc1"},e.COMPRESSED_RGB_ATC_WEBGL={name:"COMPRESSED_RGB_ATC_WEBGL",value:35986,description:"Compresses RGB textures with no alpha channel.",extensionName:"WEBGL_compressed_texture_atc"},e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL={name:"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",value:35986,description:"Compresses RGBA textures using explicit alpha encoding (useful when alpha transitions are sharp).",extensionName:"WEBGL_compressed_texture_atc"},e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL={name:"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",value:34798,description:"Compresses RGBA textures using interpolated alpha encoding (useful when alpha transitions are gradient).",extensionName:"WEBGL_compressed_texture_atc"},e.UNSIGNED_INT_24_8_WEBGL={name:"UNSIGNED_INT_24_8_WEBGL",value:34042,description:"Unsigned integer type for 24-bit depth texture data.",extensionName:"WEBGL_depth_texture"},e.HALF_FLOAT_OES={name:"HALF_FLOAT_OES",value:36193,description:"Half floating-point type (16-bit).",extensionName:"OES_texture_half_float"},e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT={name:"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",value:33297,description:" ",extensionName:"WEBGL_color_buffer_float"},e.UNSIGNED_NORMALIZED_EXT={name:"UNSIGNED_NORMALIZED_EXT",value:35863,description:" ",extensionName:"WEBGL_color_buffer_float"},e.MIN_EXT={name:"MIN_EXT",value:32775,description:"Produces the minimum color components of the source and destination colors.",extensionName:"EXT_blend_minmax"},e.MAX_EXT={name:"MAX_EXT",value:32776,description:"Produces the maximum color components of the source and destination colors.",extensionName:"EXT_blend_minmax"},e.SRGB_EXT={name:"SRGB_EXT",value:35904,description:"Unsized sRGB format that leaves the precision up to the driver.",extensionName:"EXT_sRGB"},e.SRGB_ALPHA_EXT={name:"SRGB_ALPHA_EXT",value:35906,description:"Unsized sRGB format with unsized alpha component.",extensionName:"EXT_sRGB"},e.SRGB8_ALPHA8_EXT={name:"SRGB8_ALPHA8_EXT",value:35907,description:"Sized (8-bit) sRGB and alpha formats.",extensionName:"EXT_sRGB"},e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT={name:"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",value:33296,description:"Returns the framebuffer color encoding.",extensionName:"EXT_sRGB"},e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES={name:"FRAGMENT_SHADER_DERIVATIVE_HINT_OES",value:35723,description:"Indicates the accuracy of the derivative calculation for the GLSL built-in functions: dFdx, dFdy, and fwidth.",extensionName:"OES_standard_derivatives"},e.COLOR_ATTACHMENT0_WEBGL={name:"COLOR_ATTACHMENT0_WEBGL",value:36064,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT1_WEBGL={name:"COLOR_ATTACHMENT1_WEBGL",value:36065,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT2_WEBGL={name:"COLOR_ATTACHMENT2_WEBGL",value:36066,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT3_WEBGL={name:"COLOR_ATTACHMENT3_WEBGL",value:36067,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT4_WEBGL={name:"COLOR_ATTACHMENT4_WEBGL",value:36068,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT5_WEBGL={name:"COLOR_ATTACHMENT5_WEBGL",value:36069,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT6_WEBGL={name:"COLOR_ATTACHMENT6_WEBGL",value:36070,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT7_WEBGL={name:"COLOR_ATTACHMENT7_WEBGL",value:36071,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT8_WEBGL={name:"COLOR_ATTACHMENT8_WEBGL",value:36072,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT9_WEBGL={name:"COLOR_ATTACHMENT9_WEBGL",value:36073,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT10_WEBGL={name:"COLOR_ATTACHMENT10_WEBGL",value:36074,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT11_WEBGL={name:"COLOR_ATTACHMENT11_WEBGL",value:36075,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT12_WEBGL={name:"COLOR_ATTACHMENT12_WEBGL",value:36076,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT13_WEBGL={name:"COLOR_ATTACHMENT13_WEBGL",value:36077,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT14_WEBGL={name:"COLOR_ATTACHMENT14_WEBGL",value:36078,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.COLOR_ATTACHMENT15_WEBGL={name:"COLOR_ATTACHMENT15_WEBGL",value:36079,description:"Framebuffer color attachment point",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER0_WEBGL={name:"DRAW_BUFFER0_WEBGL",value:34853,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER1_WEBGL={name:"DRAW_BUFFER1_WEBGL",value:34854,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER2_WEBGL={name:"DRAW_BUFFER2_WEBGL",value:34855,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER3_WEBGL={name:"DRAW_BUFFER3_WEBGL",value:34856,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER4_WEBGL={name:"DRAW_BUFFER4_WEBGL",value:34857,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER5_WEBGL={name:"DRAW_BUFFER5_WEBGL",value:34858,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER6_WEBGL={name:"DRAW_BUFFER6_WEBGL",value:34859,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER7_WEBGL={name:"DRAW_BUFFER7_WEBGL",value:34860,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER8_WEBGL={name:"DRAW_BUFFER8_WEBGL",value:34861,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER9_WEBGL={name:"DRAW_BUFFER9_WEBGL",value:34862,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER10_WEBGL={name:"DRAW_BUFFER10_WEBGL",value:34863,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER11_WEBGL={name:"DRAW_BUFFER11_WEBGL",value:34864,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER12_WEBGL={name:"DRAW_BUFFER12_WEBGL",value:34865,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER13_WEBGL={name:"DRAW_BUFFER13_WEBGL",value:34866,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER14_WEBGL={name:"DRAW_BUFFER14_WEBGL",value:34867,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.DRAW_BUFFER15_WEBGL={name:"DRAW_BUFFER15_WEBGL",value:34868,description:"Draw buffer",extensionName:"WEBGL_draw_buffers"},e.MAX_COLOR_ATTACHMENTS_WEBGL={name:"MAX_COLOR_ATTACHMENTS_WEBGL",value:36063,description:"Maximum number of framebuffer color attachment points",extensionName:"WEBGL_draw_buffers"},e.MAX_DRAW_BUFFERS_WEBGL={name:"MAX_DRAW_BUFFERS_WEBGL",value:34852,description:"Maximum number of draw buffers",extensionName:"WEBGL_draw_buffers"},e.VERTEX_ARRAY_BINDING_OES={name:"VERTEX_ARRAY_BINDING_OES",value:34229,description:"The bound vertex array object (VAO).",extensionName:"VERTEX_ARRAY_BINDING_OES"},e.QUERY_COUNTER_BITS_EXT={name:"QUERY_COUNTER_BITS_EXT",value:34916,description:"The number of bits used to hold the query result for the given target.",extensionName:"EXT_disjoint_timer_query"},e.CURRENT_QUERY_EXT={name:"CURRENT_QUERY_EXT",value:34917,description:"The currently active query.",extensionName:"EXT_disjoint_timer_query"},e.QUERY_RESULT_EXT={name:"QUERY_RESULT_EXT",value:34918,description:"The query result.",extensionName:"EXT_disjoint_timer_query"},e.QUERY_RESULT_AVAILABLE_EXT={name:"QUERY_RESULT_AVAILABLE_EXT",value:34919,description:"A Boolean indicating whether or not a query result is available.",extensionName:"EXT_disjoint_timer_query"},e.TIME_ELAPSED_EXT={name:"TIME_ELAPSED_EXT",value:35007,description:"Elapsed time (in nanoseconds).",extensionName:"EXT_disjoint_timer_query"},e.TIMESTAMP_EXT={name:"TIMESTAMP_EXT",value:36392,description:"The current time.",extensionName:"EXT_disjoint_timer_query"},e.GPU_DISJOINT_EXT={name:"GPU_DISJOINT_EXT",value:36795,description:"A Boolean indicating whether or not the GPU performed any disjoint operation.",extensionName:"EXT_disjoint_timer_query"},e.zeroMeaningByCommand={getError:"NO_ERROR",blendFunc:"ZERO",blendFuncSeparate:"ZERO",readBuffer:"NONE",getFramebufferAttachmentParameter:"NONE",texParameterf:"NONE",texParameteri:"NONE",drawArrays:"POINTS",drawElements:"POINTS",drawArraysInstanced:"POINTS",drawArraysInstancedAngle:"POINTS",drawBuffers:"POINTS",drawElementsInstanced:"POINTS",drawRangeElements:"POINTS"},e.oneMeaningByCommand={blendFunc:"ONE",blendFuncSeparate:"ONE",drawArrays:"LINES",drawElements:"LINES",drawArraysInstanced:"LINES",drawArraysInstancedAngle:"LINES",drawBuffers:"LINES",drawElementsInstanced:"LINES",drawRangeElements:"LINES"},e}(),te={},ne={};!function(){for(var x in ee)if(ee.hasOwnProperty(x)){var S=ee[x];te[S.name]=S,ne[S.value]=S}}();var ie,re,oe,ae,se,le,ce,ue,he,de,pe,me,fe,ge,ve,_e,ye,be,xe,Ee,Se,we=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Te=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return we(t,x),Object.defineProperty(t.prototype,"analyserName",{get:function(){return t.analyserName},enumerable:!0,configurable:!0}),t.prototype.appendToAnalysis=function(x,S){if(x.commands){for(var w={total:0,totalTriangles:0,totalTriangleStrip:0,totalTriangleFan:0,totalLines:0,totalLineStrip:0,totalLineLoop:0,totalPoints:0},U=0,G=x.commands;U<G.length;U++){var H=G[U];"drawArrays"===H.name&&H.commandArguments.length>=3||"drawArraysInstanced"===H.name&&H.commandArguments.length>=3||"drawArraysInstancedANGLE"===H.name&&H.commandArguments.length>=3?this.appendToPrimitives(w,H.commandArguments[0],H.commandArguments[2]):"drawElements"===H.name&&H.commandArguments.length>=2||"drawElementsInstanced"===H.name&&H.commandArguments.length>=2||"drawElementsInstancedANGLE"===H.name&&H.commandArguments.length>=2?this.appendToPrimitives(w,H.commandArguments[0],H.commandArguments[1]):"drawRangeElements"===H.name&&H.commandArguments.length>=4&&this.appendToPrimitives(w,H.commandArguments[0],H.commandArguments[3])}S.total=w.total,S.triangles=w.totalTriangles,S.triangleStrip=w.totalTriangleStrip,S.triangleFan=w.totalTriangleFan,S.lines=w.totalLines,S.lineStrip=w.totalLineStrip,S.lineLoop=w.totalLineLoop,S.points=w.totalPoints}},t.prototype.appendToPrimitives=function(x,S,w){S===ee.POINTS.value?x.totalPoints+=w:S===ee.LINES.value?x.totalLines+=w:S===ee.LINE_STRIP.value?x.totalLineStrip+=w:S===ee.LINE_LOOP.value?x.totalLineLoop+=w:S===ee.TRIANGLES.value?x.totalTriangles+=w:S===ee.TRIANGLE_STRIP.value?x.totalTriangleStrip+=w:S===ee.TRIANGLE_FAN.value&&(x.totalTriangleFan+=w),x.total+=w},t.analyserName="Primitives",t}(K),Ce=function(){function e(x){this.contextInformation=x,this.analysers=[],this.initAnalysers()}return e.prototype.appendAnalyses=function(x){for(var S in this.analysers)this.analysers.hasOwnProperty(S)&&this.analysers[S].appendAnalysis(x)},e.prototype.initAnalysers=function(){this.analysers.push(new Y(this.contextInformation),new Q(this.contextInformation),new Te(this.contextInformation))},e}(),Ae=function(){function e(){}return e.storeOriginFunction=function(x,S){if(x&&x[S]){var w=this.getOriginFunctionName(S);x[w]||(x[w]=x[S])}},e.storePrototypeOriginFunction=function(x,S){if(x&&x.prototype[S]){var w=this.getOriginFunctionName(S);x.prototype[w]||(x.prototype[w]=x.prototype[S])}},e.executePrototypeOriginFunction=function(x,S,w,U){if(x){var G=this.getOriginFunctionName(w);if(S.prototype[G])return x[G]||(x[G]=S.prototype[G]),this.executeFunction(x,G,U)}},e.executeOriginFunction=function(x,S,w){if(x){var U=this.getOriginFunctionName(S);if(x[U])return this.executeFunction(x,U,w)}},e.executeFunction=function(x,S,w){var U=w;if(void 0===U||0===U.length)return x[S]();switch(U.length){case 1:return x[S](U[0]);case 2:return x[S](U[0],U[1]);case 3:return x[S](U[0],U[1],U[2]);case 4:return x[S](U[0],U[1],U[2],U[3]);case 5:return x[S](U[0],U[1],U[2],U[3],U[4]);case 6:return x[S](U[0],U[1],U[2],U[3],U[4],U[5]);case 7:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6]);case 8:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7]);case 9:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8]);case 10:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9]);case 11:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10]);case 12:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11]);case 13:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12]);case 14:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13]);case 15:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14]);case 16:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15]);case 17:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15],U[16]);case 18:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15],U[16],U[17]);case 19:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15],U[16],U[17],U[18]);case 20:return x[S](U[0],U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8],U[9],U[10],U[11],U[12],U[13],U[14],U[15],U[16],U[17],U[18],U[19]);default:return x[S].apply(x,U)}},e.getOriginFunctionName=function(x){return this.originFunctionPrefix+x},e.originFunctionPrefix="__SPECTOR_Origin_",e}(),Me=function(){function e(){}return e.getStackTrace=function(x,S){void 0===x&&(x=0),void 0===S&&(S=0);var w=[];try{throw new Error("Errorator.")}catch(x){if(x.stack)for(var U=0,G=(H=x.stack.split("\n")).length;U<G;U++)H[U].match(/^\s*[A-Za-z0-9\-_\$]+\(/)?w.push(H[U]):0===H[U].indexOf("    at ")?(H[U]=H[U].replace("    at ",""),w.push(H[U])):-1!==H[U].indexOf("/<@http")?(H[U]=H[U].substring(H[U].indexOf("/<@http")+3),w.push(H[U])):-1!==H[U].indexOf("@http")&&(H[U]=H[U].replace("@http"," (http"),H[U]=H[U]+")",w.push(H[U]));else if(x.message){var H;for(U=0,G=(H=x.message.split("\n")).length;U<G;U++)if(H[U].match(/^\s*[A-Za-z0-9\-_\$]+\(/)){var z=H[U];H[U+1]&&(z+=" at "+H[U+1],U++),w.push(z)}}}if(!w)for(var j=arguments.callee.caller;j;){var X=j.toString(),K=X.substring(X.indexOf("function")+8,X.indexOf(""))||"anonymous";w.push(K),j=j.caller}if(w){for(w.shift(),U=0;U<x&&w.length>0;U++)w.shift();for(U=0;U<S&&w.length>0;U++)w.pop()}return w},e}(),Re=function(){function e(){}return e.getWebGlObjectTag=function(x){return x[e.SPECTOROBJECTTAGKEY]},e.attachWebGlObjectTag=function(x,S){S.displayText=e.stringifyWebGlObjectTag(S),x[e.SPECTOROBJECTTAGKEY]=S},e.stringifyWebGlObjectTag=function(x){return x?x.typeName+" - ID: "+x.id:"No tag available."},e.SPECTOROBJECTTAGKEY="__SPECTOR_Object_TAG",e}(),Le=function(){function e(){this.id=0}return Object.defineProperty(e.prototype,"type",{get:function(){return window[this.typeName]||null},enumerable:!0,configurable:!0}),e.prototype.tagWebGlObject=function(x){if(this.type){var S;if(!x)return S;if(S=Re.getWebGlObjectTag(x))return S;if(x instanceof this.type){var w=this.getNextId();return S={typeName:this.typeName,id:w},Re.attachWebGlObjectTag(x,S),S}return S}},e.prototype.getNextId=function(){return this.id++},e}(),Ie=function(){function e(x){this.options=x}return e.prototype.createCapture=function(x,S,w){var U=Me.getStackTrace(4,1),G=0===x.name.indexOf("uniform")?this.stringifyUniform(x.arguments):this.stringify(x.arguments,x.result),H={id:S,startTime:x.startTime,commandEndTime:x.endTime,endTime:0,name:x.name,commandArguments:x.arguments,result:x.result,stackTrace:U,status:0,marker:w,text:G};this.transformCapture(H);for(var z=0;z<H.commandArguments.length;z++){var j=H.commandArguments[z];j&&j.length&&j.length>50&&(H.commandArguments[z]="Array Length: "+j.length)}if(H.commandArguments){var X=[];for(z=0;z<H.commandArguments.length;z++){var K=H.commandArguments[z];void 0===K?X.push(void 0):null===K?X.push(null):X.push(JSON.parse(this.stringifyJSON(K)))}H.commandArguments=X}return H.result&&(H.result=JSON.parse(this.stringifyJSON(H.result))),H},e.prototype.stringifyJSON=function(x){try{return JSON.stringify(x)}catch(x){return null}},e.prototype.transformCapture=function(x){},e.prototype.stringify=function(x,S){var w=this.spiedCommandName;return x&&x.length>0&&(w+=": "+this.stringifyArgs(x).join(", ")),S&&(w+=" -> "+this.stringifyResult(S)),w},e.prototype.stringifyUniform=function(x){var S=this.spiedCommandName;if(x&&x.length>0){var w=[];w.push(this.stringifyValue(x[0]));for(var U=1;U<x.length;U++)if("number"==typeof x[U]){var G=x[U]+"";w.push(G)}else G=this.stringifyValue(x[U]),w.push(G);S+=": "+w.join(", ")}return S},e.prototype.stringifyArgs=function(x){for(var S=[],w=0;w<x.length;w++){var U=x[w],G=this.stringifyValue(U);S.push(G)}return S},e.prototype.stringifyResult=function(x){if(x)return this.stringifyValue(x)},e.prototype.stringifyValue=function(x){if(null===x)return"null";if(void 0===x)return"undefined";var S=Re.getWebGlObjectTag(x);return S?S.displayText:"number"==typeof x&&ee.isWebGlConstant(x)?ee.stringifyWebGlConstant(x,this.spiedCommandName):"string"==typeof x?x:x instanceof HTMLImageElement?x.src:x instanceof ArrayBuffer?"[--("+x.byteLength+")--]":x.length?"[..("+x.length+")..]":x},e}(),Pe=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Fe=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Pe(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[],w=this.options.context.getParameter(ee.READ_FRAMEBUFFER_BINDING.value),U=this.options.tagWebGlObject(w);S.push("READ FROM: "+this.stringifyValue(U));var G=this.options.context.getParameter(ee.DRAW_FRAMEBUFFER_BINDING.value),H=this.options.tagWebGlObject(G);S.push("WRITE TO: "+this.stringifyValue(H));for(var z=0;z<8;z++)S.push(x[z]);return(x[8]&ee.DEPTH_BUFFER_BIT.value)===ee.DEPTH_BUFFER_BIT.value&&S.push(ee.DEPTH_BUFFER_BIT.name),(x[8]&ee.STENCIL_BUFFER_BIT.value)===ee.STENCIL_BUFFER_BIT.value&&S.push(ee.STENCIL_BUFFER_BIT.name),(x[8]&ee.COLOR_BUFFER_BIT.value)===ee.COLOR_BUFFER_BIT.value&&S.push(ee.COLOR_BUFFER_BIT.name),S.push(ee.stringifyWebGlConstant(x[9],"blitFrameBuffer")),S},t.commandName="blitFrameBuffer",t}(Ie),Oe=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ne=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Oe(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return(x[0]&ee.DEPTH_BUFFER_BIT.value)===ee.DEPTH_BUFFER_BIT.value&&S.push(ee.DEPTH_BUFFER_BIT.name),(x[0]&ee.STENCIL_BUFFER_BIT.value)===ee.STENCIL_BUFFER_BIT.value&&S.push(ee.STENCIL_BUFFER_BIT.name),(x[0]&ee.COLOR_BUFFER_BIT.value)===ee.COLOR_BUFFER_BIT.value&&S.push(ee.COLOR_BUFFER_BIT.name),S},t.commandName="clear",t}(Ie),Be=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),De=["lineWidth"],ke=function(x){function t(S,w){var U=x.call(this,S)||this;return U.internalSpiedCommandName=w,U.isDeprecated=De.indexOf(U.spiedCommandName)>-1,U}return Be(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return this.internalSpiedCommandName},enumerable:!0,configurable:!0}),t.prototype.transformCapture=function(x){this.isDeprecated&&(x.status=50)},t}(Ie),Ue=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ge=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ue(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(x[0]),S},t.commandName="disableVertexAttribArray",t}(Ie),Ve=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),He=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ve(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawArrays")),S.push(x[1]),S.push(x[2]),S},t.commandName="drawArrays",t}(Ie),We=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),$e=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return We(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawArraysInstanced")),S.push(x[1]),S.push(x[2]),S.push(x[3]),S},t.commandName="drawArraysInstanced",t}(Ie),ze=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),je=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ze(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawArraysInstancedANGLE")),S.push(x[1]),S.push(x[2]),S.push(x[3]),S},t.commandName="drawArraysInstancedANGLE",t}(Ie),Xe=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ke=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Xe(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawElements")),S.push(x[1]),S.push(ee.stringifyWebGlConstant(x[2],"drawElements")),S.push(x[3]),S},t.commandName="drawElements",t}(Ie),qe=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ye=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return qe(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawElementsInstancedANGLE")),S.push(x[1]),S.push(ee.stringifyWebGlConstant(x[2],"drawElementsInstancedANGLE")),S.push(x[3]),S.push(x[4]),S},t.commandName="drawElementsInstancedANGLE",t}(Ie),Ze=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Je=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ze(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawElementsInstanced")),S.push(x[1]),S.push(ee.stringifyWebGlConstant(x[2],"drawElementsInstanced")),S.push(x[3]),S.push(x[4]),S},t.commandName="drawElementsInstanced",t}(Ie),Qe=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),et=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Qe(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(ee.stringifyWebGlConstant(x[0],"drawRangeElements")),S.push(x[1]),S.push(x[2]),S.push(x[3]),S.push(ee.stringifyWebGlConstant(x[4],"drawRangeElements")),S.push(x[5]),S},t.commandName="drawRangeElements",t}(Ie),tt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),nt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return tt(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){if(x)return"name: "+x.name+", size: "+x.size+", type: "+x.type},t.commandName="getActiveAttrib",t}(Ie),it=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),rt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return it(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){if(x)return"name: "+x.name+", size: "+x.size+", type: "+x.type},t.commandName="getActiveUniform",t}(Ie),ot=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),at=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ot(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){return x?"true":"false"},t.commandName="getExtension",t}(Ie),st=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),lt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return st(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){if(!x)return"null";var S=Re.getWebGlObjectTag(x);return S?S.displayText:x},t.commandName="getParameter",t}(Ie),ct=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),ut=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ct(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){if(x)return"min: "+x.rangeMin+", max: "+x.rangeMax+", precision: "+x.precision},t.commandName="getShaderPrecisionFormat",t}(Ie),ht=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),pt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ht(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyResult=function(x){if(x)return"name: "+x.name+", size: "+x.size+", type: "+x.type},t.commandName="getTransformFeedbackVarying",t}(Ie),mt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),ft=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return mt(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){for(var S=[],w=0;w<4;w++)S.push(x[w].toFixed(0));return S},t.commandName="scissor",t}(Ie),gt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),vt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return gt(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(x[0]),S.push(x[1]),S.push(ee.stringifyWebGlConstant(x[2],"vertexAttribPointer")),S.push(x[3]),S.push(x[4]),S.push(x[5]),S},t.commandName="vertexAttribPointer",t}(Ie),_t=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),yt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return _t(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){for(var S=[],w=0;w<4;w++)S.push(x[w].toFixed(0));return S},t.commandName="viewport",t}(Ie),bt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),xt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return bt(t,x),Object.defineProperty(t.prototype,"spiedCommandName",{get:function(){return t.commandName},enumerable:!0,configurable:!0}),t.prototype.stringifyArgs=function(x){var S=[];return S.push(x[0]),S},t.commandName="enableVertexAttribArray",t}(Ie),Et=function(){function e(x){this.spiedCommandName=x.spiedCommandName,this.spiedCommandRunningContext=x.spiedCommandRunningContext,this.spiedCommand=this.spiedCommandRunningContext[this.spiedCommandName],Ae.storeOriginFunction(this.spiedCommandRunningContext,this.spiedCommandName),this.callback=x.callback,this.commandOptions={context:x.context,contextVersion:x.contextVersion,extensions:x.extensions,toggleCapture:x.toggleCapture},this.initCustomCommands(),this.initCommand()}return e.prototype.spy=function(){this.spiedCommandRunningContext[this.spiedCommandName]=this.overloadedCommand},e.prototype.unSpy=function(){this.spiedCommandRunningContext[this.spiedCommandName]=this.spiedCommand},e.prototype.createCapture=function(x,S,w){return this.command.createCapture(x,S,w)},e.prototype.initCommand=function(){e.customCommandsConstructors[this.spiedCommandName]?this.command=e.customCommandsConstructors[this.spiedCommandName](this.commandOptions):this.command=new ke(this.commandOptions,this.spiedCommandName),this.overloadedCommand=this.getSpy()},e.prototype.getSpy=function(){var x=this;return function(){var S=X.now,w=Ae.executeOriginFunction(x.spiedCommandRunningContext,x.spiedCommandName,arguments),U=X.now,G={name:x.spiedCommandName,arguments,result:w,startTime:S,endTime:U};return x.callback(x,G),w}},e.prototype.initCustomCommands=function(){var x;e.customCommandsConstructors||(e.customCommandsConstructors=((x={})[Fe.commandName]=function(x){return new Fe(x)},x[Ne.commandName]=function(x){return new Ne(x)},x[Ge.commandName]=function(x){return new Ge(x)},x[He.commandName]=function(x){return new He(x)},x[$e.commandName]=function(x){return new $e(x)},x[je.commandName]=function(x){return new je(x)},x[Ke.commandName]=function(x){return new Ke(x)},x[Je.commandName]=function(x){return new Je(x)},x[Ye.commandName]=function(x){return new Ye(x)},x[et.commandName]=function(x){return new et(x)},x[nt.commandName]=function(x){return new nt(x)},x[rt.commandName]=function(x){return new rt(x)},x[at.commandName]=function(x){return new at(x)},x[lt.commandName]=function(x){return new lt(x)},x[ut.commandName]=function(x){return new ut(x)},x[pt.commandName]=function(x){return new pt(x)},x[ft.commandName]=function(x){return new ft(x)},x[vt.commandName]=function(x){return new vt(x)},x[yt.commandName]=function(x){return new yt(x)},x[xt.commandName]=function(x){return new xt(x)},x))},e}(),St=function(){function e(x){this.options=x,this.context=x.context,this.contextVersion=x.contextVersion,this.extensions=x.extensions,this.toggleCapture=x.toggleCapture,this.consumeCommands=this.getConsumeCommands(),this.changeCommandsByState=this.getChangeCommandsByState(),this.commandNameToStates=this.getCommandNameToStates()}return Object.defineProperty(e.prototype,"requireStartAndStopStates",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.startCapture=function(x,S,w){return this.quickCapture=S,this.fullCapture=w,this.capturedCommandsByState={},x&&this.requireStartAndStopStates&&(this.currentState={},this.readFromContextNoSideEffects()),this.copyCurrentStateToPrevious(),this.currentState={},this.previousState},e.prototype.stopCapture=function(){return this.requireStartAndStopStates&&this.readFromContextNoSideEffects(),this.analyse(void 0),this.currentState},e.prototype.registerCallbacks=function(x){for(var S in this.changeCommandsByState)if(this.changeCommandsByState.hasOwnProperty(S))for(var w=0,U=this.changeCommandsByState[S];w<U.length;w++){var G=U[w];x[G]=x[G]||[],x[G].push(this.onChangeCommand.bind(this))}for(var H=0,z=this.consumeCommands;H<z.length;H++){var j=z[H];x[j]=x[j]||[],x[j].push(this.onConsumeCommand.bind(this))}},e.prototype.getStateData=function(){return this.currentState},e.prototype.getConsumeCommands=function(){return[]},e.prototype.getChangeCommandsByState=function(){return{}},e.prototype.copyCurrentStateToPrevious=function(){this.currentState&&(this.previousState=this.currentState)},e.prototype.onChangeCommand=function(x){for(var S=0,w=this.commandNameToStates[x.name];S<w.length;S++){var U=w[S];if(!this.isValidChangeCommand(x,U))return;this.capturedCommandsByState[U]=this.capturedCommandsByState[U]||[],this.capturedCommandsByState[U].push(x)}},e.prototype.isValidChangeCommand=function(x,S){return!0},e.prototype.onConsumeCommand=function(x){this.isValidConsumeCommand(x)&&(this.readFromContextNoSideEffects(),this.analyse(x),this.storeCommandIds(),x[this.stateName]=this.currentState,this.startCapture(!1,this.quickCapture,this.fullCapture))},e.prototype.isValidConsumeCommand=function(x){return this.lastCommandName=null==x?void 0:x.name,!0},e.prototype.analyse=function(x){for(var S in this.capturedCommandsByState)if(this.capturedCommandsByState.hasOwnProperty(S)){var w=this.capturedCommandsByState[S],U=w.length-1;if(U>=0)if(x){for(var G=0;G<U;G++){var H=w[G];H.consumeCommandId=x.id,this.changeCommandCaptureStatus(H,30)}var z=this.isStateEnableNoSideEffects(S,x.commandArguments);(j=w[U]).consumeCommandId=x.id,this.areStatesEquals(this.currentState[S],this.previousState[S])?this.changeCommandCaptureStatus(j,30):z?this.changeCommandCaptureStatus(j,40):this.changeCommandCaptureStatus(j,20)}else for(G=0;G<w.length;G++){var j=w[G];this.changeCommandCaptureStatus(j,10)}}},e.prototype.storeCommandIds=function(){for(var x=["unusedCommandIds","disabledCommandIds","redundantCommandIds","validCommandIds"],S=0,w=x;S<w.length;S++){var U=w[S];this.currentState[U]=[]}for(var G in this.capturedCommandsByState)if(this.capturedCommandsByState.hasOwnProperty(G))for(var H=0,z=this.capturedCommandsByState[G];H<z.length;H++){var j=z[H];switch(j.status){case 10:this.currentState.unusedCommandIds.push(j.id);break;case 20:this.currentState.disabledCommandIds.push(j.id);break;case 30:this.currentState.redundantCommandIds.push(j.id);break;case 40:this.currentState.validCommandIds.push(j.id)}}for(var X=0,K=x;X<K.length;X++)U=K[X],this.currentState[U].length||delete this.currentState[U]},e.prototype.changeCommandCaptureStatus=function(x,S){return x.status<S&&(x.status=S,!0)},e.prototype.areStatesEquals=function(x,S){if(typeof x!=typeof S)return!1;if(x&&!S)return!1;if(S&&!x)return!1;if(null==x)return!0;if(x.length&&S.length&&"string"!=typeof x){if(x.length!==S.length)return!1;for(var w=0;w<x.length;w++)if(x[w]!==S[w])return!1;return!0}return x===S},e.prototype.isStateEnable=function(x,S){return!0},e.prototype.getSpectorData=function(x){if(x)return{__SPECTOR_Object_TAG:Re.getWebGlObjectTag(x)||this.options.tagWebGlObject(x),__SPECTOR_Object_CustomData:x.__SPECTOR_Object_CustomData,__SPECTOR_Metadata:x.__SPECTOR_Metadata}},e.prototype.readFromContextNoSideEffects=function(){this.toggleCapture(!1),this.readFromContext(),this.toggleCapture(!0)},e.prototype.isStateEnableNoSideEffects=function(x,S){this.toggleCapture(!1);var w=this.isStateEnable(x,S);return this.toggleCapture(!0),w},e.prototype.getCommandNameToStates=function(){var x={};for(var S in this.changeCommandsByState)if(this.changeCommandsByState.hasOwnProperty(S))for(var w=0,U=this.changeCommandsByState[S];w<U.length;w++){var G=U[w];x[G]=x[G]||[],x[G].push(S)}return x},e}(),wt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Tt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return wt(t,x),t.prototype.getWebgl1Parameters=function(){return[]},t.prototype.getWebgl2Parameters=function(){return[]},t.prototype.getChangeCommandsByState=function(){this.parameters=[],this.parameters.push(this.getWebgl1Parameters()),this.contextVersion>1&&this.parameters.push(this.getWebgl2Parameters());for(var x={},S=1;S<=this.contextVersion&&!(S>this.parameters.length);S++)if(this.parameters[S-1])for(var w=0,U=this.parameters[S-1];w<U.length;w++){var G=U[w];if(G.changeCommands)for(var H=0,z=G.changeCommands;H<z.length;H++){var j=z[H];x[G.constant.name]=x[G.constant.name]||[],x[G.constant.name].push(j)}}return x},t.prototype.readFromContext=function(){for(var x=1;x<=this.contextVersion&&!(x>this.parameters.length);x++)for(var S=0,w=this.parameters[x-1];S<w.length;S++){var U=w[S],G=this.readParameterFromContext(U),H=Re.getWebGlObjectTag(G);if(H)this.currentState[U.constant.name]=H;else{var z=this.stringifyParameterValue(G,U);this.currentState[U.constant.name]=z}}},t.prototype.readParameterFromContext=function(x){return x.constant.extensionName&&!this.extensions[x.constant.extensionName]?"Extension "+x.constant.extensionName+" is unavailble.":this.context.getParameter(x.constant.value)},t.prototype.stringifyParameterValue=function(x,S){if(null===x)return"null";if(void 0===x)return"undefined";if(30===S.returnType)return x=x.toString(2),"00000000000000000000000000000000".substr(x.length)+x;if("number"==typeof x&&ee.isWebGlConstant(x)){if(20===S.returnType){var w=S.changeCommands&&S.changeCommands[0]||"";return ee.stringifyWebGlConstant(x,w)}return x}if(x.length&&"string"!=typeof x){for(var U=[],G=0;G<x.length;G++)U.push(x[G]);return U}return x},t}(St),Ct=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),At=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ct(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.PACK_ALIGNMENT,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_ALIGNMENT,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_COLORSPACE_CONVERSION_WEBGL,returnType:20,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_FLIP_Y_WEBGL,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_PREMULTIPLY_ALPHA_WEBGL,changeCommands:["pixelStorei"]}]},t.prototype.getWebgl2Parameters=function(){return[{constant:ee.PACK_ROW_LENGTH,changeCommands:["pixelStorei"]},{constant:ee.PACK_SKIP_PIXELS,changeCommands:["pixelStorei"]},{constant:ee.PACK_SKIP_ROWS,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_IMAGE_HEIGHT,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_SKIP_PIXELS,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_SKIP_ROWS,changeCommands:["pixelStorei"]},{constant:ee.UNPACK_SKIP_IMAGES,changeCommands:["pixelStorei"]}]},t.prototype.getConsumeCommands=function(){return["readPixels","texImage2D","texSubImage2D"]},t.prototype.isValidChangeCommand=function(x,S){return te[S].value===x.commandArguments[0]},t.stateName="AlignmentState",t}(Tt),Mt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Rt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Mt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.BLEND,changeCommands:["enable","disable"]},{constant:ee.BLEND_COLOR,changeCommands:["blendColor"]},{constant:ee.BLEND_DST_ALPHA,returnType:20,changeCommands:["blendFunc","blendFuncSeparate"]},{constant:ee.BLEND_DST_RGB,returnType:20,changeCommands:["blendFunc","blendFuncSeparate"]},{constant:ee.BLEND_EQUATION_ALPHA,returnType:20,changeCommands:["blendEquation","blendEquationSeparate"]},{constant:ee.BLEND_EQUATION_RGB,returnType:20,changeCommands:["blendEquation","blendEquationSeparate"]},{constant:ee.BLEND_SRC_ALPHA,returnType:20,changeCommands:["blendFunc","blendFuncSeparate"]},{constant:ee.BLEND_SRC_RGB,returnType:20,changeCommands:["blendFunc","blendFuncSeparate"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||x.commandArguments[0]===ee.BLEND.value},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.BLEND.value)},t.stateName="BlendState",t}(Tt),Lt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),It=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Lt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.COLOR_CLEAR_VALUE,changeCommands:["clearColor"]},{constant:ee.DEPTH_CLEAR_VALUE,changeCommands:["clearDepth"]},{constant:ee.STENCIL_CLEAR_VALUE,changeCommands:["clearStencil"]}]},t.prototype.getConsumeCommands=function(){return["clear"]},t.prototype.isStateEnable=function(x,S){switch(x){case ee.COLOR_CLEAR_VALUE.name:return ee.COLOR_BUFFER_BIT.value===(S[0]&ee.COLOR_BUFFER_BIT.value);case ee.DEPTH_CLEAR_VALUE.name:return ee.DEPTH_BUFFER_BIT.value===(S[0]&ee.DEPTH_BUFFER_BIT.value);case ee.STENCIL_CLEAR_VALUE.name:return ee.STENCIL_BUFFER_BIT.value===(S[0]&ee.STENCIL_BUFFER_BIT.value)}return!1},t.stateName="ClearState",t}(Tt),Pt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ft=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Pt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.COLOR_WRITEMASK,changeCommands:["colorMask"]}]},t.prototype.getConsumeCommands=function(){return Z},t.stateName="ColorState",t}(Tt),Nt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Bt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Nt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.SAMPLE_COVERAGE_VALUE,changeCommands:["sampleCoverage"]},{constant:ee.SAMPLE_COVERAGE_INVERT,changeCommands:["sampleCoverage"]}]},t.prototype.getWebgl2Parameters=function(){return[{constant:ee.SAMPLE_COVERAGE,changeCommands:["enable","disable"]},{constant:ee.SAMPLE_ALPHA_TO_COVERAGE,changeCommands:["enable","disable"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||(x.commandArguments[0]===ee.SAMPLE_COVERAGE.value?S===ee.SAMPLE_COVERAGE.name:x.commandArguments[0]===ee.SAMPLE_ALPHA_TO_COVERAGE.value&&S===ee.SAMPLE_ALPHA_TO_COVERAGE.name)},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){return 2===this.contextVersion&&this.context.isEnabled(ee.SAMPLE_COVERAGE.value)},t.stateName="CoverageState",t}(Tt),Dt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),kt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Dt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.CULL_FACE,changeCommands:["enable","disable"]},{constant:ee.CULL_FACE_MODE,returnType:20,changeCommands:["cullFace"]}]},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||x.commandArguments[0]===ee.CULL_FACE.value},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.CULL_FACE.value)},t.stateName="CullState",t}(Tt),Ut=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Gt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ut(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.DEPTH_TEST,changeCommands:["enable","disable"]},{constant:ee.DEPTH_FUNC,returnType:20,changeCommands:["depthFunc"]},{constant:ee.DEPTH_RANGE,changeCommands:["depthRange"]},{constant:ee.DEPTH_WRITEMASK,changeCommands:["depthMask"]}]},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||x.commandArguments[0]===ee.DEPTH_TEST.value},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.DEPTH_TEST.value)},t.stateName="DepthState",t}(Tt),Vt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ht=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Vt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.DITHER,changeCommands:["enable","disable"]},{constant:ee.VIEWPORT,changeCommands:["viewPort"]},{constant:ee.FRONT_FACE,returnType:20,changeCommands:["frontFace"]},{constant:ee.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,changeCommands:["hint"]}]},t.prototype.getWebgl2Parameters=function(){return[{constant:ee.RASTERIZER_DISCARD,changeCommands:["enable","disable"]},{constant:ee.FRAGMENT_SHADER_DERIVATIVE_HINT,changeCommands:["hint"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"===x.name||"disable"===x.name?x.commandArguments[0]===ee.DITHER.value?S===ee.DITHER.name:x.commandArguments[0]===ee.RASTERIZER_DISCARD.value&&S===ee.RASTERIZER_DISCARD.name:"hint"!==x.name||(x.commandArguments[0]===ee.FRAGMENT_SHADER_DERIVATIVE_HINT_OES.value?S===ee.FRAGMENT_SHADER_DERIVATIVE_HINT_OES.name:x.commandArguments[0]===ee.FRAGMENT_SHADER_DERIVATIVE_HINT.value&&S===ee.FRAGMENT_SHADER_DERIVATIVE_HINT.name)},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){switch(x){case ee.DITHER.name:return this.context.isEnabled(ee.DITHER.value);case ee.RASTERIZER_DISCARD.name:return this.context.isEnabled(ee.RASTERIZER_DISCARD.value)}return!0},t.stateName="DrawState",t}(Tt),Wt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),$t=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Wt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.GENERATE_MIPMAP_HINT,changeCommands:["hint"]}]},t.prototype.getConsumeCommands=function(){return["generateMipmap"]},t.stateName="MipmapHintState",t}(Tt),zt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),jt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return zt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.POLYGON_OFFSET_FILL,changeCommands:["enable","disable"]},{constant:ee.POLYGON_OFFSET_FACTOR,changeCommands:["polygonOffset"]},{constant:ee.POLYGON_OFFSET_UNITS,changeCommands:["polygonOffset"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||x.commandArguments[0]===ee.POLYGON_OFFSET_FILL.value},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.POLYGON_OFFSET_FILL.value)},t.stateName="PolygonOffsetState",t}(Tt),Xt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Kt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Xt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.SCISSOR_TEST,changeCommands:["enable","disable"]},{constant:ee.SCISSOR_BOX,changeCommands:["scissor"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"!==x.name&&"disable"!==x.name||x.commandArguments[0]===ee.SCISSOR_TEST.value},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.SCISSOR_TEST.value)},t.stateName="ScissorState",t}(Tt),qt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Yt=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return qt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.STENCIL_TEST,changeCommands:["enable","disable"]},{constant:ee.STENCIL_BACK_FAIL,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_BACK_FUNC,returnType:20,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_BACK_PASS_DEPTH_FAIL,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_BACK_PASS_DEPTH_PASS,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_BACK_REF,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_BACK_VALUE_MASK,returnType:30,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_BACK_WRITEMASK,returnType:30,changeCommands:["stencilMask","stencilMaskSeparate"]},{constant:ee.STENCIL_FAIL,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_FUNC,returnType:20,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_PASS_DEPTH_FAIL,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_PASS_DEPTH_PASS,returnType:20,changeCommands:["stencilOp","stencilOpSeparate"]},{constant:ee.STENCIL_REF,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_VALUE_MASK,returnType:30,changeCommands:["stencilFunc","stencilFuncSeparate"]},{constant:ee.STENCIL_WRITEMASK,returnType:30,changeCommands:["stencilMask","stencilMaskSeparate"]}]},t.prototype.isValidChangeCommand=function(x,S){return"enable"===x.name||"disable"===x.name?x.commandArguments[0]===ee.STENCIL_TEST.value:"stencilOp"===x.name||"stencilOpSeparate"===x.name?t.stencilOpStates.indexOf(x.commandArguments[0])>0:"stencilFunc"===x.name||"stencilFuncSeparate"===x.name?t.stencilFuncStates.indexOf(x.commandArguments[0])>0:"stencilMask"!==x.name&&"stencilMaskSeparate"!==x.name||t.stencilMaskStates.indexOf(x.commandArguments[0])>0},t.prototype.getConsumeCommands=function(){return Z},t.prototype.isStateEnable=function(x,S){return this.context.isEnabled(ee.STENCIL_TEST.value)},t.stateName="StencilState",t.stencilOpStates=[ee.STENCIL_BACK_FAIL.value,ee.STENCIL_BACK_PASS_DEPTH_FAIL.value,ee.STENCIL_BACK_PASS_DEPTH_PASS.value,ee.STENCIL_FAIL.value,ee.STENCIL_PASS_DEPTH_FAIL.value,ee.STENCIL_PASS_DEPTH_PASS.value],t.stencilFuncStates=[ee.STENCIL_BACK_FUNC.value,ee.STENCIL_BACK_REF.value,ee.STENCIL_BACK_VALUE_MASK.value,ee.STENCIL_FUNC.value,ee.STENCIL_REF.value,ee.STENCIL_VALUE_MASK.value],t.stencilMaskStates=[ee.STENCIL_BACK_WRITEMASK.value,ee.STENCIL_WRITEMASK.value],t}(Tt),Zt=function(){function e(){}return e.isSupportedCombination=function(x,S,w){return x=x||ee.UNSIGNED_BYTE.value,((S=S||ee.RGBA.value)===ee.RGB.value||S===ee.RGBA.value)&&(w===ee.RGB.value||w===ee.RGBA.value||w===ee.RGBA8.value||w===ee.RGBA16F.value||w===ee.RGBA32F.value||w===ee.RGB16F.value||w===ee.RGB32F.value||w===ee.R11F_G11F_B10F.value||w===ee.SRGB8.value||w===ee.SRGB8_ALPHA8.value)&&this.isSupportedComponentType(x)},e.readPixels=function(x,S,w,U,G,H){x.getError();var z,j=U*G*4;if(H===ee.UNSIGNED_BYTE.value?z=new Uint8Array(j):(H=ee.FLOAT.value,z=new Float32Array(j)),x.readPixels(S,w,U,G,x.RGBA,H,z),!x.getError()){if(H===ee.UNSIGNED_BYTE.value)return z;for(var X=new Uint8Array(U*G*4),K=0;K<G;K++)for(var q=0;q<U;q++)X[K*U*4+4*q+0]=255*Math.min(Math.max(z[K*U*4+4*q+0],0),1),X[K*U*4+4*q+1]=255*Math.min(Math.max(z[K*U*4+4*q+1],0),1),X[K*U*4+4*q+2]=255*Math.min(Math.max(z[K*U*4+4*q+2],0),1),X[K*U*4+4*q+3]=255*Math.min(Math.max(z[K*U*4+4*q+3],0),1);return X}},e.isSupportedComponentType=function(x){return x===ee.UNSIGNED_BYTE.value||x===ee.UNSIGNED_SHORT_4_4_4_4.value||x===ee.UNSIGNED_SHORT_5_5_5_1.value||x===ee.UNSIGNED_SHORT_5_6_5.value||x===ee.HALF_FLOAT.value||x===ee.HALF_FLOAT_OES.value||x===ee.FLOAT.value},e}(),Jt=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),dt=function(){for(var x=0,S=0,w=arguments.length;S<w;S++)x+=arguments[S].length;var U=Array(x),G=0;for(S=0;S<w;S++)for(var H=arguments[S],z=0,j=H.length;z<j;z++,G++)U[G]=H[z];return U},Qt=function(x){function t(S){var w=x.call(this,S)||this;return w.captureFrameBuffer=S.context.createFramebuffer(),w.workingCanvas=document.createElement("canvas"),w.workingContext2D=w.workingCanvas.getContext("2d"),w.captureCanvas=document.createElement("canvas"),w.captureContext2D=w.captureCanvas.getContext("2d"),w.captureContext2D.imageSmoothingEnabled=!0,w.captureContext2D.mozImageSmoothingEnabled=!0,w.captureContext2D.oImageSmoothingEnabled=!0,w.captureContext2D.webkitImageSmoothingEnabled=!0,w.captureContext2D.msImageSmoothingEnabled=!0,w}return Jt(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),t.prototype.getConsumeCommands=function(){return dt(["clear","clearBufferfv","clearBufferiv","clearBufferuiv","clearBufferfi"],Z)},t.prototype.readFromContext=function(){var x=this.context;this.currentState.Attachments=[];var S=this.context.getParameter(ee.FRAMEBUFFER_BINDING.value);if(!S)return this.currentState.FrameBuffer=null,void this.getCapture(x,"Canvas COLOR_ATTACHMENT",0,0,x.drawingBufferWidth,x.drawingBufferHeight,0,0,ee.UNSIGNED_BYTE.value);var w=x.getParameter(x.VIEWPORT),U=w[0],G=w[1],H=w[2],z=w[3];this.currentState.FrameBuffer=this.getSpectorData(S);var j=this.context.checkFramebufferStatus(ee.FRAMEBUFFER.value);if(this.currentState.FrameBufferStatus=ne[j].name,j===ee.FRAMEBUFFER_COMPLETE.value)if(this.extensions[ee.MAX_DRAW_BUFFERS_WEBGL.extensionName])for(var X=this.context.getParameter(ee.MAX_DRAW_BUFFERS_WEBGL.value),K=0;K<X;K++)this.readFrameBufferAttachmentFromContext(this.context,S,te["COLOR_ATTACHMENT"+K+"_WEBGL"],U,G,H,z);else if(this.contextVersion>1)for(X=this.context.getParameter(ee.MAX_DRAW_BUFFERS.value),K=0;K<X;K++)this.readFrameBufferAttachmentFromContext(this.context,S,te["COLOR_ATTACHMENT"+K],U,G,H,z);else this.readFrameBufferAttachmentFromContext(this.context,S,te.COLOR_ATTACHMENT0,U,G,H,z)},t.prototype.readFrameBufferAttachmentFromContext=function(x,S,w,U,G,H,z){var j=ee.FRAMEBUFFER.value,X=this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE.value);if(X!==ee.NONE.value){var K=this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME.value);if(K){var q=this.contextVersion>1?this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE.value):ee.UNSIGNED_BYTE.value;X===ee.RENDERBUFFER.value?this.readFrameBufferAttachmentFromRenderBuffer(x,S,w,U,G,H,z,j,q,K):X===ee.TEXTURE.value&&this.readFrameBufferAttachmentFromTexture(x,S,w,U,G,H,z,j,q,K)}}},t.prototype.readFrameBufferAttachmentFromRenderBuffer=function(x,S,w,U,G,H,z,j,X,K){var q=0,Y=0;if(K.__SPECTOR_Object_CustomData){var Z=K.__SPECTOR_Object_CustomData;if(H=Z.width,z=Z.height,q=Z.samples,Y=Z.internalFormat,!q&&!Zt.isSupportedCombination(X,ee.RGBA.value,Y))return}else H+=U,z+=G;if(U=G=0,q){var J=x,Q=x.createRenderbuffer(),te=x.getParameter(x.RENDERBUFFER_BINDING);x.bindRenderbuffer(x.RENDERBUFFER,Q),x.renderbufferStorage(x.RENDERBUFFER,Y,H,z),x.bindRenderbuffer(x.RENDERBUFFER,te),x.bindFramebuffer(ee.FRAMEBUFFER.value,this.captureFrameBuffer),x.framebufferRenderbuffer(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,ee.RENDERBUFFER.value,Q);var ne=J.getParameter(J.READ_FRAMEBUFFER_BINDING),ie=J.getParameter(J.DRAW_FRAMEBUFFER_BINDING);J.bindFramebuffer(J.READ_FRAMEBUFFER,S),J.bindFramebuffer(J.DRAW_FRAMEBUFFER,this.captureFrameBuffer),J.blitFramebuffer(0,0,H,z,0,0,H,z,x.COLOR_BUFFER_BIT,x.NEAREST),J.bindFramebuffer(ee.FRAMEBUFFER.value,this.captureFrameBuffer),J.bindFramebuffer(J.READ_FRAMEBUFFER,ne),J.bindFramebuffer(J.DRAW_FRAMEBUFFER,ie),this.context.checkFramebufferStatus(ee.FRAMEBUFFER.value)===ee.FRAMEBUFFER_COMPLETE.value&&this.getCapture(x,w.name,U,G,H,z,0,0,ee.UNSIGNED_BYTE.value),x.bindFramebuffer(ee.FRAMEBUFFER.value,S),x.deleteRenderbuffer(Q)}else x.bindFramebuffer(ee.FRAMEBUFFER.value,this.captureFrameBuffer),x.framebufferRenderbuffer(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,ee.RENDERBUFFER.value,K),this.context.checkFramebufferStatus(ee.FRAMEBUFFER.value)===ee.FRAMEBUFFER_COMPLETE.value&&this.getCapture(x,w.name,U,G,H,z,0,0,X),x.bindFramebuffer(ee.FRAMEBUFFER.value,S)},t.prototype.readFrameBufferAttachmentFromTexture=function(x,S,w,U,G,H,z,j,X,K){var q=0;this.contextVersion>1&&(q=this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER.value));var Y=this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL.value),Z=this.context.getFramebufferAttachmentParameter(j,w.value,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE.value),J=(Z>0?ne[Z].name:ee.TEXTURE_2D.name,!1),Q=X;if(K.__SPECTOR_Object_CustomData){var te=K.__SPECTOR_Object_CustomData;if(H=te.width,z=te.height,Q=te.type,J=te.target===ee.TEXTURE_2D_ARRAY.name,!Zt.isSupportedCombination(te.type,te.format,te.internalFormat))return}else H+=U,z+=G;U=G=0,x.bindFramebuffer(ee.FRAMEBUFFER.value,this.captureFrameBuffer),q>0||J?x.framebufferTextureLayer(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,K,Y,q):x.framebufferTexture2D(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,Z||ee.TEXTURE_2D.value,K,Y),this.context.checkFramebufferStatus(ee.FRAMEBUFFER.value)===ee.FRAMEBUFFER_COMPLETE.value&&this.getCapture(x,w.name,U,G,H,z,Z,q,Q),x.bindFramebuffer(ee.FRAMEBUFFER.value,S)},t.prototype.getCapture=function(x,S,w,U,G,H,j,X,K){var q={attachmentName:S,src:null,textureCubeMapFace:j?ne[j].name:null,textureLayer:X};if(!this.quickCapture)try{var Y=Zt.readPixels(x,w,U,G,H,K);if(Y){this.workingCanvas.width=G,this.workingCanvas.height=H;var Z=this.workingContext2D.createImageData(Math.ceil(G),Math.ceil(H));if(Z.data.set(Y),this.workingContext2D.putImageData(Z,0,0),this.fullCapture)this.captureCanvas.width=this.workingCanvas.width,this.captureCanvas.height=this.workingCanvas.height;else{var J=G/H;J<1?(this.captureCanvas.width=t.captureBaseSize*J,this.captureCanvas.height=t.captureBaseSize):J>1?(this.captureCanvas.width=t.captureBaseSize,this.captureCanvas.height=t.captureBaseSize/J):(this.captureCanvas.width=t.captureBaseSize,this.captureCanvas.height=t.captureBaseSize)}this.captureCanvas.width=Math.max(this.captureCanvas.width,1),this.captureCanvas.height=Math.max(this.captureCanvas.height,1),this.captureContext2D.globalCompositeOperation="copy",this.captureContext2D.scale(1,-1),this.captureContext2D.translate(0,-this.captureCanvas.height),this.captureContext2D.drawImage(this.workingCanvas,0,0,G,H,0,0,this.captureCanvas.width,this.captureCanvas.height),this.captureContext2D.setTransform(1,0,0,1,0,0),this.captureContext2D.globalCompositeOperation="source-over",q.src=this.captureCanvas.toDataURL()}}catch(x){z.warn("Spector can not capture the visual state: "+x)}this.currentState.Attachments.push(q)},t.prototype.analyse=function(x){},t.stateName="VisualState",t.captureBaseSize=256,t}(St),en=function(){function e(x){this.context=x.context,this.captureFrameBuffer=x.context.createFramebuffer(),this.workingCanvas=document.createElement("canvas"),this.workingContext2D=this.workingCanvas.getContext("2d"),this.captureCanvas=document.createElement("canvas"),this.captureContext2D=this.captureCanvas.getContext("2d"),this.captureContext2D.imageSmoothingEnabled=!0,this.captureContext2D.mozImageSmoothingEnabled=!0,this.captureContext2D.oImageSmoothingEnabled=!0,this.captureContext2D.webkitImageSmoothingEnabled=!0,this.captureContext2D.msImageSmoothingEnabled=!0}return e.prototype.appendTextureState=function(x,S,w,U){if(void 0===w&&(w=null),S){var G=S.__SPECTOR_Object_CustomData;G&&(this.fullCapture=U,G.type&&(x.textureType=this.getWebGlConstant(G.type)),G.format&&(x.format=this.getWebGlConstant(G.format)),G.internalFormat&&(x.internalFormat=this.getWebGlConstant(G.internalFormat)),x.width=G.width,x.height=G.height,G.depth&&(x.depth=G.depth),w&&(x.visual=this.getTextureVisualState(w,S,G)))}},e.prototype.getTextureVisualState=function(x,S,w){try{var U=this.context,G={};if(!Zt.isSupportedCombination(w.type,w.format,w.internalFormat))return G;var H=this.context.getParameter(ee.FRAMEBUFFER_BINDING.value);U.bindFramebuffer(ee.FRAMEBUFFER.value,this.captureFrameBuffer);try{var z=w.width,j=w.height;if(x===ee.TEXTURE_3D&&w.depth)for(var X=U,K=0;K<w.depth;K++)K>2&&K<w.depth-3||(X.framebufferTextureLayer(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,S,0,K),G["3D Layer "+K]=this.getCapture(U,0,0,z,j,w.type));else if(x===ee.TEXTURE_2D_ARRAY&&w.depth)for(X=U,K=0;K<w.depth;K++)K>2&&K<w.depth-3||(X.framebufferTextureLayer(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,S,0,K),G["Layer "+K]=this.getCapture(U,0,0,z,j,w.type));else if(x===ee.TEXTURE_CUBE_MAP)for(var q=0,Y=e.cubeMapFaces;q<Y.length;q++){var Z=Y[q];U.framebufferTexture2D(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,Z.value,S,0),G[Z.name]=this.getCapture(U,0,0,z,j,w.type)}else U.framebufferTexture2D(ee.FRAMEBUFFER.value,ee.COLOR_ATTACHMENT0.value,ee.TEXTURE_2D.value,S,0),G[ee.TEXTURE_2D.name]=this.getCapture(U,0,0,z,j,w.type)}catch(x){}return U.bindFramebuffer(ee.FRAMEBUFFER.value,H),G}catch(x){}},e.prototype.getCapture=function(x,S,w,U,G,H){try{if(this.context.checkFramebufferStatus(ee.FRAMEBUFFER.value)!==ee.FRAMEBUFFER_COMPLETE.value)return;H=H||ee.UNSIGNED_BYTE.value;var z=Zt.readPixels(x,S,w,U,G,H);if(!z)return;this.workingCanvas.width=U,this.workingCanvas.height=G;var j=this.workingContext2D.createImageData(U,G);if(j.data.set(z),this.workingContext2D.putImageData(j,0,0),this.fullCapture)this.captureCanvas.width=this.workingCanvas.width,this.captureCanvas.height=this.workingCanvas.height;else{var X=U/G;X<1?(this.captureCanvas.width=Qt.captureBaseSize*X,this.captureCanvas.height=Qt.captureBaseSize):X>1?(this.captureCanvas.width=Qt.captureBaseSize,this.captureCanvas.height=Qt.captureBaseSize/X):(this.captureCanvas.width=Qt.captureBaseSize,this.captureCanvas.height=Qt.captureBaseSize)}return this.captureCanvas.width=Math.max(this.captureCanvas.width,1),this.captureCanvas.height=Math.max(this.captureCanvas.height,1),this.captureContext2D.globalCompositeOperation="copy",this.captureContext2D.scale(1,-1),this.captureContext2D.translate(0,-this.captureCanvas.height),this.captureContext2D.drawImage(this.workingCanvas,0,0,U,G,0,0,this.captureCanvas.width,this.captureCanvas.height),this.captureContext2D.setTransform(1,0,0,1,0,0),this.captureContext2D.globalCompositeOperation="source-over",this.captureCanvas.toDataURL()}catch(x){}},e.prototype.getWebGlConstant=function(x){var S=ne[x];return S?S.name:x+""},e.captureBaseSize=64,e.cubeMapFaces=[ee.TEXTURE_CUBE_MAP_POSITIVE_X,ee.TEXTURE_CUBE_MAP_POSITIVE_Y,ee.TEXTURE_CUBE_MAP_POSITIVE_Z,ee.TEXTURE_CUBE_MAP_NEGATIVE_X,ee.TEXTURE_CUBE_MAP_NEGATIVE_Y,ee.TEXTURE_CUBE_MAP_NEGATIVE_Z],e}(),tn=function(){function e(x){this.context=x.context}return e.prototype.getUboValue=function(x,S,w,U){var G=e.uboTypes[U];if(G){var H=new G.arrayBufferView(w*G.lengthMultiplier),z=this.context,j=z.getIndexedParameter(ee.UNIFORM_BUFFER_BINDING.value,x);if(j){var X=z.getIndexedParameter(ee.UNIFORM_BUFFER_START.value,x),K=z.getParameter(ee.UNIFORM_BUFFER_BINDING.value);try{z.bindBuffer(ee.UNIFORM_BUFFER.value,j),z.getBufferSubData(ee.UNIFORM_BUFFER.value,X+S,H)}catch(x){return}K&&z.bindBuffer(ee.UNIFORM_BUFFER.value,K)}return Array.prototype.slice.call(H)}},e.uboTypes=((ie={})[ee.BOOL.value]={arrayBufferView:Uint8Array,lengthMultiplier:1},ie[ee.BOOL_VEC2.value]={arrayBufferView:Uint8Array,lengthMultiplier:2},ie[ee.BOOL_VEC3.value]={arrayBufferView:Uint8Array,lengthMultiplier:3},ie[ee.BOOL_VEC4.value]={arrayBufferView:Uint8Array,lengthMultiplier:4},ie[ee.INT.value]={arrayBufferView:Int32Array,lengthMultiplier:1},ie[ee.INT_VEC2.value]={arrayBufferView:Int32Array,lengthMultiplier:2},ie[ee.INT_VEC3.value]={arrayBufferView:Int32Array,lengthMultiplier:3},ie[ee.INT_VEC4.value]={arrayBufferView:Int32Array,lengthMultiplier:4},ie[ee.UNSIGNED_INT.value]={arrayBufferView:Uint32Array,lengthMultiplier:1},ie[ee.UNSIGNED_INT_VEC2.value]={arrayBufferView:Uint32Array,lengthMultiplier:2},ie[ee.UNSIGNED_INT_VEC3.value]={arrayBufferView:Uint32Array,lengthMultiplier:3},ie[ee.UNSIGNED_INT_VEC4.value]={arrayBufferView:Uint32Array,lengthMultiplier:4},ie[ee.FLOAT.value]={arrayBufferView:Float32Array,lengthMultiplier:1},ie[ee.FLOAT_VEC2.value]={arrayBufferView:Float32Array,lengthMultiplier:2},ie[ee.FLOAT_VEC3.value]={arrayBufferView:Float32Array,lengthMultiplier:3},ie[ee.FLOAT_VEC4.value]={arrayBufferView:Float32Array,lengthMultiplier:4},ie[ee.FLOAT_MAT2.value]={arrayBufferView:Float32Array,lengthMultiplier:4},ie[ee.FLOAT_MAT2x3.value]={arrayBufferView:Float32Array,lengthMultiplier:6},ie[ee.FLOAT_MAT2x4.value]={arrayBufferView:Float32Array,lengthMultiplier:8},ie[ee.FLOAT_MAT3.value]={arrayBufferView:Float32Array,lengthMultiplier:9},ie[ee.FLOAT_MAT3x2.value]={arrayBufferView:Float32Array,lengthMultiplier:6},ie[ee.FLOAT_MAT3x4.value]={arrayBufferView:Float32Array,lengthMultiplier:12},ie[ee.FLOAT_MAT4.value]={arrayBufferView:Float32Array,lengthMultiplier:16},ie[ee.FLOAT_MAT4x2.value]={arrayBufferView:Float32Array,lengthMultiplier:8},ie[ee.FLOAT_MAT4x3.value]={arrayBufferView:Float32Array,lengthMultiplier:12},ie[ee.SAMPLER_2D.value]={arrayBufferView:Uint8Array,lengthMultiplier:1},ie[ee.SAMPLER_CUBE.value]={arrayBufferView:Uint8Array,lengthMultiplier:1},ie),e}(),nn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),rn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLBuffer"},enumerable:!0,configurable:!0}),t}(Le),on=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLFramebuffer"},enumerable:!0,configurable:!0}),t}(Le),an=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLProgram"},enumerable:!0,configurable:!0}),t.saveInGlobalStore=function(x){var S=Re.getWebGlObjectTag(x);S&&(this.store[S.id]=x)},t.getFromGlobalStore=function(x){return this.store[x]},t.updateInGlobalStore=function(x,S){if(S){var w=this.getFromGlobalStore(x);if(w){var U=Re.getWebGlObjectTag(w);U&&(Re.attachWebGlObjectTag(S,U),this.store[U.id]=S)}}},t.store={},t}(Le),sn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLQuery"},enumerable:!0,configurable:!0}),t}(Le),ln=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLRenderbuffer"},enumerable:!0,configurable:!0}),t}(Le),cn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLSampler"},enumerable:!0,configurable:!0}),t}(Le),hn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLShader"},enumerable:!0,configurable:!0}),t}(Le),dn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLSync"},enumerable:!0,configurable:!0}),t}(Le),pn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLTexture"},enumerable:!0,configurable:!0}),t}(Le),mn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLTransformFeedback"},enumerable:!0,configurable:!0}),t}(Le),gn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLUniformLocation"},enumerable:!0,configurable:!0}),t}(Le),vn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nn(t,x),Object.defineProperty(t.prototype,"typeName",{get:function(){return"WebGLVertexArrayObject"},enumerable:!0,configurable:!0}),t}(Le),bn=function(){function e(){}return e.getProgramData=function(x,S){for(var w={LINK_STATUS:x.getProgramParameter(S,ee.LINK_STATUS.value),VALIDATE_STATUS:x.getProgramParameter(S,ee.VALIDATE_STATUS.value)},U=x.getAttachedShaders(S),G=new Array(2),H=0,z=0,j=U;z<j.length;z++){var X=j[z],K=this.readShaderFromContext(x,X);H+=K.source.length,K.fragment?G[1]=K:G[0]=K}return{programStatus:w,shaders:G,length:H}},e.readShaderFromContext=function(x,S){var w=x.getShaderSource(S),U=x.getExtension("WEBGL_debug_shaders"),G=U?U.getTranslatedShaderSource(S):null,H=x.getShaderParameter(S,ee.SHADER_TYPE.value)===ee.FRAGMENT_SHADER.value,z=S&&S.__SPECTOR_Metadata&&S.__SPECTOR_Metadata.name?S.__SPECTOR_Metadata.name:this.readNameFromShaderSource(w);return z||(z=H?"Fragment":"Vertex"),{COMPILE_STATUS:x.getShaderParameter(S,ee.COMPILE_STATUS.value),fragment:H,name:z,source:w,translatedSource:G}},e.readNameFromShaderSource=function(x){try{var S="",w=void 0,U=/#define[\s]+SHADER_NAME[\s]+([\S]+)(\n|$)/gi;if(null!==(w=U.exec(x))&&(w.index===U.lastIndex&&U.lastIndex++,S=w[1]),""===S){var G=/#define[\s]+SHADER_NAME_B64[\s]+([\S]+)(\n|$)/gi;null!==(w=G.exec(x))&&(w.index===G.lastIndex&&G.lastIndex++,S=w[1]),S&&(S=decodeURIComponent(atob(S)))}return S}catch(x){return null}},e}(),xn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ot=function(){return(Ot=Object.assign||function(x){for(var S,w=1,U=arguments.length;w<U;w++)for(var G in S=arguments[w])Object.prototype.hasOwnProperty.call(S,G)&&(x[G]=S[G]);return x}).apply(this,arguments)},En=function(x){function t(S){var w=x.call(this,S)||this;return w.drawCallTextureInputState=new en(S),w.drawCallUboInputState=new tn(S),w}return xn(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return t.stateName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requireStartAndStopStates",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.getConsumeCommands=function(){return Z},t.prototype.getChangeCommandsByState=function(){return{}},t.prototype.readFromContext=function(){var x,S=this.context.getParameter(ee.CURRENT_PROGRAM.value);if(S){this.currentState.frameBuffer=this.readFrameBufferFromContext();var w=S.__SPECTOR_Object_CustomData?S.__SPECTOR_Object_CustomData:bn.getProgramData(this.context,S);if(this.currentState.programStatus=Ot({},w.programStatus),this.currentState.programStatus.program=this.getSpectorData(S),this.currentState.programStatus.RECOMPILABLE=G.isBuildableProgram(S),this.currentState.programStatus.RECOMPILABLE&&an.saveInGlobalStore(S),this.currentState.shaders=w.shaders,(null===(x=this.lastCommandName)||void 0===x?void 0:x.indexOf("Elements"))>=0){var U=this.context.getParameter(this.context.ELEMENT_ARRAY_BUFFER_BINDING);U&&(this.currentState.elementArray={},this.currentState.elementArray.arrayBuffer=this.getSpectorData(U))}var H=this.context.getProgramParameter(S,ee.ACTIVE_ATTRIBUTES.value);this.currentState.attributes=[];for(var z=0;z<H;z++){var j=this.readAttributeFromContext(S,z);this.currentState.attributes.push(j)}var X=this.context.getProgramParameter(S,ee.ACTIVE_UNIFORMS.value);this.currentState.uniforms=[];var K=[];for(z=0;z<X;z++){K.push(z);var q=this.readUniformFromContext(S,z);this.currentState.uniforms.push(q)}if(this.contextVersion>1){var Y=this.context.getProgramParameter(S,ee.ACTIVE_UNIFORM_BLOCKS.value);for(this.currentState.uniformBlocks=[],z=0;z<Y;z++){var Z=this.readUniformBlockFromContext(S,z);this.currentState.uniformBlocks.push(Z)}if(this.readUniformsFromContextIntoState(S,K,this.currentState.uniforms,this.currentState.uniformBlocks),this.context.getParameter(ee.TRANSFORM_FEEDBACK_ACTIVE.value)){var J=this.context.getProgramParameter(S,ee.TRANSFORM_FEEDBACK_BUFFER_MODE.value);this.currentState.transformFeedbackMode=this.getWebGlConstant(J),this.currentState.transformFeedbacks=[];var Q=this.context.getProgramParameter(S,ee.TRANSFORM_FEEDBACK_VARYINGS.value);for(z=0;z<Q;z++){var te=this.readTransformFeedbackFromContext(S,z);this.currentState.transformFeedbacks.push(te)}}}for(z=0;z<K.length;z++){if(null!==(q=this.currentState.uniforms[z]).value&&void 0!==q.value){var ne=t.samplerTypes[q.typeValue];if(ne)if(q.value.length){q.textures=[];for(var ie=0;ie<q.value.length;ie++)q.textures.push(this.readTextureFromContext(q.value[ie],ne))}else q.texture=this.readTextureFromContext(q.value,ne)}delete q.typeValue}}},t.prototype.readFrameBufferFromContext=function(){var x=this.context.getParameter(ee.FRAMEBUFFER_BINDING.value);if(!x)return null;var S={};if(S.frameBuffer=this.getSpectorData(x),this.readFrameBufferAttachmentFromContext(ee.DEPTH_ATTACHMENT.value)&&(S.depthAttachment=this.readFrameBufferAttachmentFromContext(ee.DEPTH_ATTACHMENT.value)),this.readFrameBufferAttachmentFromContext(ee.STENCIL_ATTACHMENT.value)&&(S.stencilAttachment=this.readFrameBufferAttachmentFromContext(ee.STENCIL_ATTACHMENT.value)),this.extensions[ee.MAX_DRAW_BUFFERS_WEBGL.extensionName]){S.colorAttachments=[];for(var w=this.context.getParameter(ee.MAX_DRAW_BUFFERS_WEBGL.value),U=0;U<w;U++)(H=this.readFrameBufferAttachmentFromContext(te["COLOR_ATTACHMENT"+U+"_WEBGL"].value))&&S.colorAttachments.push(H)}else if(this.contextVersion>1){var G=this.context;for(S.colorAttachments=[],w=G.getParameter(ee.MAX_DRAW_BUFFERS.value),U=0;U<w;U++)(H=this.readFrameBufferAttachmentFromContext(te["COLOR_ATTACHMENT"+U].value))&&S.colorAttachments.push(H)}else{var H;(H=this.readFrameBufferAttachmentFromContext(te.COLOR_ATTACHMENT0.value))&&(S.colorAttachments=[H])}return S},t.prototype.readFrameBufferAttachmentFromContext=function(x){var S=ee.FRAMEBUFFER.value,w=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE.value);if(w!==ee.NONE.value){var U={},G=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME.value);if(w===ee.RENDERBUFFER.value){if(U.type="RENDERBUFFER",U.buffer=this.getSpectorData(G),G){var H=G.__SPECTOR_Object_CustomData;H&&(H.internalFormat&&(U.internalFormat=this.getWebGlConstant(H.internalFormat)),U.width=H.width,U.height=H.height,U.msaaSamples=H.samples)}}else if(w===ee.TEXTURE.value){U.type="TEXTURE",U.texture=this.getSpectorData(G),U.textureLevel=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL.value);var z=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE.value);U.textureCubeMapFace=this.getWebGlConstant(z),this.drawCallTextureInputState.appendTextureState(U,G,null,this.fullCapture)}return this.extensions.EXT_sRGB&&(U.encoding=this.getWebGlConstant(this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT.value))),this.contextVersion>1&&(U.alphaSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE.value),U.blueSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE.value),U.encoding=this.getWebGlConstant(this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING.value)),U.componentType=this.getWebGlConstant(this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE.value)),U.depthSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE.value),U.greenSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE.value),U.redSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_RED_SIZE.value),U.stencilSize=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE.value),w===ee.TEXTURE.value&&(U.textureLayer=this.context.getFramebufferAttachmentParameter(S,x,ee.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER.value))),U}},t.prototype.readAttributeFromContext=function(x,S){var w=this.context.getActiveAttrib(x,S),U=this.context.getAttribLocation(x,w.name);if(-1===U)return{name:w.name,size:w.size,type:this.getWebGlConstant(w.type),location:-1};var G=this.context.getVertexAttrib(U,ee.CURRENT_VERTEX_ATTRIB.value),H=this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING.value),z={name:w.name,size:w.size,type:this.getWebGlConstant(w.type),location:U,offsetPointer:this.context.getVertexAttribOffset(U,ee.VERTEX_ATTRIB_ARRAY_POINTER.value),bufferBinding:this.getSpectorData(H),enabled:this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_ENABLED.value),arraySize:this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_SIZE.value),stride:this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_STRIDE.value),arrayType:this.getWebGlConstant(this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_TYPE.value)),normalized:this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_NORMALIZED.value),vertexAttrib:Array.prototype.slice.call(G)};return this.extensions[ee.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE.extensionName]?z.divisor=this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE.value):this.contextVersion>1&&(z.integer=this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_INTEGER.value),z.divisor=this.context.getVertexAttrib(U,ee.VERTEX_ATTRIB_ARRAY_DIVISOR.value)),this.appendBufferCustomData(z,H),z},t.prototype.readUniformFromContext=function(x,S){var w=this.context.getActiveUniform(x,S),U=this.context.getUniformLocation(x,w.name);if(U){if(w.size>1&&w.name&&w.name.indexOf("[0]")===w.name.length-3){for(var G=[],H=0;H<w.size;H++){var z=this.context.getUniformLocation(x,w.name.replace("[0]","["+H+"]"));z&&((j=this.context.getUniform(x,z)).length&&(j=Array.prototype.slice.call(j)),G.push({value:j}))}return{name:w.name.replace("[0]",""),size:w.size,type:this.getWebGlConstant(w.type),typeValue:w.type,location:this.getSpectorData(U),values:G}}var j;return(j=this.context.getUniform(x,U)).length&&(j=Array.prototype.slice.call(j)),{name:w.name,size:w.size,type:this.getWebGlConstant(w.type),typeValue:w.type,location:this.getSpectorData(U),value:j}}return{name:w.name,size:w.size,type:this.getWebGlConstant(w.type),typeValue:w.type}},t.prototype.readTextureFromContext=function(x,S){var w=this.context.getParameter(ee.ACTIVE_TEXTURE.value);this.context.activeTexture(ee.TEXTURE0.value+x);var U={magFilter:this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_MAG_FILTER.value)),minFilter:this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_MIN_FILTER.value)),wrapS:this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_WRAP_S.value)),wrapT:this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_WRAP_T.value))};if(this.extensions[ee.TEXTURE_MAX_ANISOTROPY_EXT.extensionName]&&(U.anisotropy=this.context.getTexParameter(S.value,ee.TEXTURE_MAX_ANISOTROPY_EXT.value)),this.contextVersion>1){U.baseLevel=this.context.getTexParameter(S.value,ee.TEXTURE_BASE_LEVEL.value),U.immutable=this.context.getTexParameter(S.value,ee.TEXTURE_IMMUTABLE_FORMAT.value),U.immutableLevels=this.context.getTexParameter(S.value,ee.TEXTURE_IMMUTABLE_LEVELS.value),U.maxLevel=this.context.getTexParameter(S.value,ee.TEXTURE_MAX_LEVEL.value);var G=this.context.getParameter(ee.SAMPLER_BINDING.value);if(G){U.sampler=this.getSpectorData(G);var H=this.context;U.samplerMaxLod=H.getSamplerParameter(G,ee.TEXTURE_MAX_LOD.value),U.samplerMinLod=H.getSamplerParameter(G,ee.TEXTURE_MIN_LOD.value),U.samplerCompareFunc=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_COMPARE_FUNC.value)),U.samplerCompareMode=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_COMPARE_MODE.value)),U.samplerWrapS=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_WRAP_S.value)),U.samplerWrapT=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_WRAP_T.value)),U.samplerWrapR=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_WRAP_R.value)),U.samplerMagFilter=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_MAG_FILTER.value)),U.samplerMinFilter=this.getWebGlConstant(H.getSamplerParameter(G,ee.TEXTURE_MIN_FILTER.value))}else U.maxLod=this.context.getTexParameter(S.value,ee.TEXTURE_MAX_LOD.value),U.minLod=this.context.getTexParameter(S.value,ee.TEXTURE_MIN_LOD.value),U.compareFunc=this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_COMPARE_FUNC.value)),U.compareMode=this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_COMPARE_MODE.value)),U.wrapR=this.getWebGlConstant(this.context.getTexParameter(S.value,ee.TEXTURE_WRAP_R.value))}var z=this.getTextureStorage(S);if(z){var j=this.quickCapture?null:S;this.drawCallTextureInputState.appendTextureState(U,z,j,this.fullCapture)}return this.context.activeTexture(w),U},t.prototype.getTextureStorage=function(x){return x===ee.TEXTURE_2D?this.context.getParameter(ee.TEXTURE_BINDING_2D.value):x===ee.TEXTURE_CUBE_MAP?this.context.getParameter(ee.TEXTURE_BINDING_CUBE_MAP.value):x===ee.TEXTURE_3D?this.context.getParameter(ee.TEXTURE_BINDING_3D.value):x===ee.TEXTURE_2D_ARRAY?this.context.getParameter(ee.TEXTURE_BINDING_2D_ARRAY.value):void 0},t.prototype.readUniformsFromContextIntoState=function(x,S,w,U){for(var G=this.context,H=G.getActiveUniforms(x,S,ee.UNIFORM_TYPE.value),z=G.getActiveUniforms(x,S,ee.UNIFORM_SIZE.value),j=G.getActiveUniforms(x,S,ee.UNIFORM_BLOCK_INDEX.value),X=G.getActiveUniforms(x,S,ee.UNIFORM_OFFSET.value),K=G.getActiveUniforms(x,S,ee.UNIFORM_ARRAY_STRIDE.value),q=G.getActiveUniforms(x,S,ee.UNIFORM_MATRIX_STRIDE.value),Y=G.getActiveUniforms(x,S,ee.UNIFORM_IS_ROW_MAJOR.value),Z=0;Z<S.length;Z++){var J=w[Z];if(J.type=this.getWebGlConstant(H[Z]),J.size=z[Z],J.blockIndice=j[Z],J.blockIndice>-1&&(J.blockName=G.getActiveUniformBlockName(x,J.blockIndice)),J.offset=X[Z],J.arrayStride=K[Z],J.matrixStride=q[Z],J.rowMajor=Y[Z],J.blockIndice>-1){var Q=U[j[Z]].bindingPoint;J.value=this.drawCallUboInputState.getUboValue(Q,J.offset,J.size,H[Z])}}},t.prototype.readTransformFeedbackFromContext=function(x,S){var w=this.context,U=w.getTransformFeedbackVarying(x,S),G=w.getIndexedParameter(ee.TRANSFORM_FEEDBACK_BUFFER_BINDING.value,S),H={name:U.name,size:U.size,type:this.getWebGlConstant(U.type),buffer:this.getSpectorData(G),bufferSize:w.getIndexedParameter(ee.TRANSFORM_FEEDBACK_BUFFER_SIZE.value,S),bufferStart:w.getIndexedParameter(ee.TRANSFORM_FEEDBACK_BUFFER_START.value,S)};return this.appendBufferCustomData(H,G),H},t.prototype.readUniformBlockFromContext=function(x,S){var w=this.context,U=w.getActiveUniformBlockParameter(x,S,ee.UNIFORM_BLOCK_BINDING.value),G=w.getIndexedParameter(ee.UNIFORM_BUFFER_BINDING.value,U),H={name:w.getActiveUniformBlockName(x,S),bindingPoint:U,size:w.getActiveUniformBlockParameter(x,S,ee.UNIFORM_BLOCK_DATA_SIZE.value),activeUniformCount:w.getActiveUniformBlockParameter(x,S,ee.UNIFORM_BLOCK_ACTIVE_UNIFORMS.value),vertex:w.getActiveUniformBlockParameter(x,S,ee.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER.value),fragment:w.getActiveUniformBlockParameter(x,S,ee.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER.value),buffer:this.getSpectorData(G)};return this.appendBufferCustomData(H,G),H},t.prototype.appendBufferCustomData=function(x,S){if(S){var w=S.__SPECTOR_Object_CustomData;w&&(w.usage&&(x.bufferUsage=this.getWebGlConstant(w.usage)),x.bufferLength=w.length,w.offset&&(x.bufferOffset=w.offset),w.sourceLength&&(x.bufferSourceLength=w.sourceLength))}},t.prototype.getWebGlConstant=function(x){var S=ne[x];return S?S.name:x},t.stateName="DrawCall",t.samplerTypes=((re={})[ee.SAMPLER_2D.value]=ee.TEXTURE_2D,re[ee.SAMPLER_CUBE.value]=ee.TEXTURE_CUBE_MAP,re[ee.SAMPLER_3D.value]=ee.TEXTURE_3D,re[ee.SAMPLER_2D_SHADOW.value]=ee.TEXTURE_2D,re[ee.SAMPLER_2D_ARRAY.value]=ee.TEXTURE_2D_ARRAY,re[ee.SAMPLER_2D_ARRAY_SHADOW.value]=ee.TEXTURE_2D_ARRAY,re[ee.SAMPLER_CUBE_SHADOW.value]=ee.TEXTURE_CUBE_MAP,re[ee.INT_SAMPLER_2D.value]=ee.TEXTURE_2D,re[ee.INT_SAMPLER_3D.value]=ee.TEXTURE_3D,re[ee.INT_SAMPLER_CUBE.value]=ee.TEXTURE_CUBE_MAP,re[ee.INT_SAMPLER_2D_ARRAY.value]=ee.TEXTURE_2D_ARRAY,re[ee.UNSIGNED_INT_SAMPLER_2D.value]=ee.TEXTURE_2D,re[ee.UNSIGNED_INT_SAMPLER_3D.value]=ee.TEXTURE_3D,re[ee.UNSIGNED_INT_SAMPLER_CUBE.value]=ee.TEXTURE_CUBE_MAP,re[ee.UNSIGNED_INT_SAMPLER_2D_ARRAY.value]=ee.TEXTURE_2D_ARRAY,re),t}(St),Sn=function(){function e(x){this.contextInformation=x,this.stateTrackers=[],this.onCommandCapturedCallbacks={},this.initStateTrackers()}return e.prototype.startCapture=function(x,S,w){for(var U=0,G=this.stateTrackers;U<G.length;U++){var H=G[U],z=H.startCapture(!0,S,w);H.requireStartAndStopStates&&(x.initState[H.stateName]=z)}},e.prototype.stopCapture=function(x){for(var S=0,w=this.stateTrackers;S<w.length;S++){var U=w[S],G=U.stopCapture();U.requireStartAndStopStates&&(x.endState[U.stateName]=G)}},e.prototype.captureState=function(x){var S=this.onCommandCapturedCallbacks[x.name];if(S)for(var w=0,U=S;w<U.length;w++)(0,U[w])(x)},e.prototype.initStateTrackers=function(){this.stateTrackers.push(new At(this.contextInformation),new Rt(this.contextInformation),new It(this.contextInformation),new Ft(this.contextInformation),new Bt(this.contextInformation),new kt(this.contextInformation),new Gt(this.contextInformation),new Ht(this.contextInformation),new $t(this.contextInformation),new jt(this.contextInformation),new Kt(this.contextInformation),new Yt(this.contextInformation),new Qt(this.contextInformation),new En(this.contextInformation));for(var x=0,S=this.stateTrackers;x<S.length;x++)S[x].registerCallbacks(this.onCommandCapturedCallbacks)},e}(),wn=function(){function e(x){this.options=x,this.createCommandNames=this.getCreateCommandNames(),this.updateCommandNames=this.getUpdateCommandNames(),this.deleteCommandNames=this.getDeleteCommandNames(),this.startTime=X.now,this.memoryPerSecond={},this.totalMemory=0,this.frameMemory=0,this.capturing=!1,e.initializeByteSizeFormat()}return e.initializeByteSizeFormat=function(){var x;this.byteSizePerInternalFormat||(this.byteSizePerInternalFormat=((x={})[ee.R8.value]=1,x[ee.R16F.value]=2,x[ee.R32F.value]=4,x[ee.R8UI.value]=1,x[ee.RG8.value]=2,x[ee.RG16F.value]=4,x[ee.RG32F.value]=8,x[ee.ALPHA.value]=1,x[ee.RGB.value]=3,x[ee.RGBA.value]=4,x[ee.LUMINANCE.value]=1,x[ee.LUMINANCE_ALPHA.value]=2,x[ee.DEPTH_COMPONENT.value]=1,x[ee.DEPTH_STENCIL.value]=2,x[ee.SRGB_EXT.value]=3,x[ee.SRGB_ALPHA_EXT.value]=4,x[ee.RGB8.value]=3,x[ee.SRGB8.value]=3,x[ee.RGB565.value]=2,x[ee.R11F_G11F_B10F.value]=4,x[ee.RGB9_E5.value]=2,x[ee.RGB16F.value]=6,x[ee.RGB32F.value]=12,x[ee.RGB8UI.value]=3,x[ee.RGBA8.value]=4,x[ee.RGB5_A1.value]=2,x[ee.RGBA16F.value]=8,x[ee.RGBA32F.value]=16,x[ee.RGBA8UI.value]=4,x[ee.COMPRESSED_R11_EAC.value]=4,x[ee.COMPRESSED_SIGNED_R11_EAC.value]=4,x[ee.COMPRESSED_RG11_EAC.value]=4,x[ee.COMPRESSED_SIGNED_RG11_EAC.value]=4,x[ee.COMPRESSED_RGB8_ETC2.value]=4,x[ee.COMPRESSED_RGBA8_ETC2_EAC.value]=4,x[ee.COMPRESSED_SRGB8_ETC2.value]=4,x[ee.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC.value]=4,x[ee.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2.value]=4,x[ee.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2.value]=4,x[ee.COMPRESSED_RGB_S3TC_DXT1_EXT.value]=.5,x[ee.COMPRESSED_RGBA_S3TC_DXT3_EXT.value]=1,x[ee.COMPRESSED_RGBA_S3TC_DXT5_EXT.value]=1,x[ee.COMPRESSED_RGB_PVRTC_4BPPV1_IMG.value]=.5,x[ee.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG.value]=.5,x[ee.COMPRESSED_RGB_PVRTC_2BPPV1_IMG.value]=.25,x[ee.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG.value]=.25,x[ee.COMPRESSED_RGB_ETC1_WEBGL.value]=.5,x[ee.COMPRESSED_RGB_ATC_WEBGL.value]=.5,x[ee.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL.value]=1,x[ee.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL.value]=1,x))},e.prototype.registerCallbacks=function(x){for(var S=0,w=this.createCommandNames;S<w.length;S++)x[j=w[S]]=x[j]||[],x[j].push(this.createWithoutSideEffects.bind(this));for(var U=0,G=this.updateCommandNames;U<G.length;U++)x[j=G[U]]=x[j]||[],x[j].push(this.updateWithoutSideEffects.bind(this));for(var H=0,z=this.deleteCommandNames;H<z.length;H++){var j;x[j=z[H]]=x[j]||[],x[j].push(this.deleteWithoutSideEffects.bind(this))}},e.prototype.startCapture=function(){this.frameMemory=0,this.capturing=!0},e.prototype.stopCapture=function(){this.frameMemory=0,this.capturing=!1},e.prototype.appendRecordedInformation=function(x){x.frameMemory[this.objectName]=this.frameMemory,x.memory[this.objectName]=this.memoryPerSecond},e.prototype.create=function(x){},e.prototype.createWithoutSideEffects=function(x){this.options.toggleCapture(!1),this.create(x),this.options.toggleCapture(!0)},e.prototype.updateWithoutSideEffects=function(x){if(x&&0!==x.arguments.length){this.options.toggleCapture(!1);var S=x.arguments[0],w=this.getBoundInstance(S);if(w)if(Re.getWebGlObjectTag(w)){var U=this.getWebGlConstant(S),G=this.update(x,U,w);this.changeMemorySize(G),this.options.toggleCapture(!0)}else this.options.toggleCapture(!0);else this.options.toggleCapture(!0)}},e.prototype.deleteWithoutSideEffects=function(x){if(x&&x.arguments&&!(x.arguments.length<1)){var S=x.arguments[0];if(S){this.options.toggleCapture(!1);var w=this.delete(S);this.changeMemorySize(-w),this.options.toggleCapture(!0)}}},e.prototype.changeMemorySize=function(x){this.totalMemory+=x,this.capturing&&(this.frameMemory+=x);var S=X.now-this.startTime,w=Math.round(S/1e3);this.memoryPerSecond[w]=this.totalMemory},e.prototype.getWebGlConstant=function(x){var S=ne[x];return S?S.name:x+""},e.prototype.getByteSizeForInternalFormat=function(x){return e.byteSizePerInternalFormat[x]||4},e}(),Tn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Cn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Tn(t,x),Object.defineProperty(t.prototype,"objectName",{get:function(){return"Buffer"},enumerable:!0,configurable:!0}),t.prototype.getCreateCommandNames=function(){return["createBuffer"]},t.prototype.getUpdateCommandNames=function(){return["bufferData"]},t.prototype.getDeleteCommandNames=function(){return["deleteBuffer"]},t.prototype.getBoundInstance=function(x){var S=this.options.context;return x===ee.ARRAY_BUFFER.value?S.getParameter(ee.ARRAY_BUFFER_BINDING.value):x===ee.ELEMENT_ARRAY_BUFFER.value?S.getParameter(ee.ELEMENT_ARRAY_BUFFER_BINDING.value):x===ee.COPY_READ_BUFFER.value?S.getParameter(ee.COPY_READ_BUFFER_BINDING.value):x===ee.COPY_WRITE_BUFFER.value?S.getParameter(ee.COPY_WRITE_BUFFER_BINDING.value):x===ee.TRANSFORM_FEEDBACK_BUFFER.value?S.getParameter(ee.TRANSFORM_FEEDBACK_BUFFER_BINDING.value):x===ee.UNIFORM_BUFFER.value?S.getParameter(ee.UNIFORM_BUFFER_BINDING.value):x===ee.PIXEL_PACK_BUFFER.value?S.getParameter(ee.PIXEL_PACK_BUFFER_BINDING.value):x===ee.PIXEL_UNPACK_BUFFER.value?S.getParameter(ee.PIXEL_UNPACK_BUFFER_BINDING.value):void 0},t.prototype.delete=function(x){var S=x.__SPECTOR_Object_CustomData;return S?S.length:0},t.prototype.update=function(x,S,w){var U=this.getCustomData(S,x);if(!U)return 0;var G=w.__SPECTOR_Object_CustomData?w.__SPECTOR_Object_CustomData.length:0;return w.__SPECTOR_Object_CustomData=U,U.length-G},t.prototype.getCustomData=function(x,S){var w=this.getLength(S);return S.arguments.length>=4?{target:x,length:w,usage:S.arguments[2],offset:S.arguments[3],sourceLength:S.arguments[1]?S.arguments[1].length:-1}:3===S.arguments.length?{target:x,length:w,usage:S.arguments[2]}:void 0},t.prototype.getLength=function(x){var S=-1,w=0;return 5===x.arguments.length&&(S=x.arguments[4],w=x.arguments[3]),S<=0&&(S="number"==typeof x.arguments[1]?x.arguments[1]:x.arguments[1]&&(x.arguments[1].byteLength||x.arguments[1].length)||0),S-w},t}(wn),An=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Mn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return An(t,x),Object.defineProperty(t.prototype,"objectName",{get:function(){return"Renderbuffer"},enumerable:!0,configurable:!0}),t.prototype.getCreateCommandNames=function(){return["createRenderbuffer"]},t.prototype.getUpdateCommandNames=function(){return["renderbufferStorage","renderbufferStorageMultisample"]},t.prototype.getDeleteCommandNames=function(){return["deleteRenderbuffer"]},t.prototype.getBoundInstance=function(x){var S=this.options.context;if(x===ee.RENDERBUFFER.value)return S.getParameter(ee.RENDERBUFFER_BINDING.value)},t.prototype.delete=function(x){var S=x.__SPECTOR_Object_CustomData;return S?S.length:0},t.prototype.update=function(x,S,w){var U=this.getCustomData(x,S);if(!U)return 0;var G=w.__SPECTOR_Object_CustomData?w.__SPECTOR_Object_CustomData.length:0;return U.length=U.width*U.height*this.getByteSizeForInternalFormat(U.internalFormat),w.__SPECTOR_Object_CustomData=U,U.length-G},t.prototype.getCustomData=function(x,S){return 4===x.arguments.length?{target:S,internalFormat:x.arguments[1],width:x.arguments[2],height:x.arguments[3],length:0,samples:0}:{target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],length:0,samples:x.arguments[1]}},t}(wn),Rn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),In=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Rn(t,x),Object.defineProperty(t.prototype,"objectName",{get:function(){return"Texture2d"},enumerable:!0,configurable:!0}),t.prototype.getCreateCommandNames=function(){return["createTexture"]},t.prototype.getUpdateCommandNames=function(){return["texImage2D","compressedTexImage2D","texStorage2D"]},t.prototype.getDeleteCommandNames=function(){return["deleteTexture"]},t.prototype.getBoundInstance=function(x){var S=this.options.context;return x===ee.TEXTURE_2D.value?S.getParameter(ee.TEXTURE_BINDING_2D.value):x===ee.TEXTURE_CUBE_MAP_POSITIVE_X.value||x===ee.TEXTURE_CUBE_MAP_POSITIVE_Y.value||x===ee.TEXTURE_CUBE_MAP_POSITIVE_Z.value||x===ee.TEXTURE_CUBE_MAP_NEGATIVE_X.value||x===ee.TEXTURE_CUBE_MAP_NEGATIVE_Y.value||x===ee.TEXTURE_CUBE_MAP_NEGATIVE_Z.value?S.getParameter(ee.TEXTURE_BINDING_CUBE_MAP.value):void 0},t.prototype.delete=function(x){var S=x.__SPECTOR_Object_CustomData;return S?S.target===ee.TEXTURE_2D_ARRAY.name||S.target===ee.TEXTURE_3D.name?0:S.length:0},t.prototype.update=function(x,S,w){if(x.arguments.length>=2&&0!==x.arguments[1])return 0;var U=this.getCustomData(x,S,w);if(!U)return 0;var G=w.__SPECTOR_Object_CustomData?w.__SPECTOR_Object_CustomData.length:0;if(U.isCompressed){if(x.arguments.length>=7){var H=x.arguments[6];U.length="number"==typeof H?H:null==H?void 0:H.byteLength}}else{var z="TEXTURE_2D"===S?1:6,j=U.internalFormat;j===ee.RGBA.value&&(U.type===ee.FLOAT.value&&(j=ee.RGBA32F.value),U.type===ee.HALF_FLOAT_OES.value&&(j=ee.RGBA16F.value)),U.length=U.width*U.height*z*this.getByteSizeForInternalFormat(j)}return U.length=0|U.length,w.__SPECTOR_Object_CustomData=U,U.length-G},t.prototype.getCustomData=function(x,S,w){return"texImage2D"===x.name?this.getTexImage2DCustomData(x,S,w):"compressedTexImage2D"===x.name?this.getCompressedTexImage2DCustomData(x,S,w):"texStorage2D"===x.name?this.getTexStorage2DCustomData(x,S,w):void 0},t.prototype.getTexStorage2DCustomData=function(x,S,w){var U;return 5===x.arguments.length&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],length:0,isCompressed:!1}),U},t.prototype.getCompressedTexImage2DCustomData=function(x,S,w){var U;if(0===x.arguments[1])return x.arguments.length>=7&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],length:0,isCompressed:!0}),U},t.prototype.getTexImage2DCustomData=function(x,S,w){var U;if(0===x.arguments[1])return x.arguments.length>=8?U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],format:x.arguments[6],type:x.arguments[7],length:0,isCompressed:!1}:6===x.arguments.length&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[5].width,height:x.arguments[5].height,format:x.arguments[3],type:x.arguments[4],length:0,isCompressed:!1}),U},t}(wn),Fn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),On=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Fn(t,x),Object.defineProperty(t.prototype,"objectName",{get:function(){return"Texture3d"},enumerable:!0,configurable:!0}),t.prototype.getCreateCommandNames=function(){return["createTexture"]},t.prototype.getUpdateCommandNames=function(){return["texImage3D","compressedTexImage3D","texStorage3D"]},t.prototype.getDeleteCommandNames=function(){return["deleteTexture"]},t.prototype.getBoundInstance=function(x){var S=this.options.context;return x===ee.TEXTURE_2D_ARRAY.value?S.getParameter(ee.TEXTURE_BINDING_2D_ARRAY.value):x===ee.TEXTURE_3D.value?S.getParameter(ee.TEXTURE_BINDING_3D.value):void 0},t.prototype.delete=function(x){var S=x.__SPECTOR_Object_CustomData;return S?S.target!==ee.TEXTURE_2D_ARRAY.name&&S.target!==ee.TEXTURE_3D.name?0:S.length:0},t.prototype.update=function(x,S,w){if(x.arguments.length>=2&&0!==x.arguments[1])return 0;var U=this.getCustomData(x,S,w);if(!U)return 0;var G=w.__SPECTOR_Object_CustomData?w.__SPECTOR_Object_CustomData.length:0;if(U.isCompressed){if(x.arguments.length>=7){var H=x.arguments[6];U.length="number"==typeof H?H:null==H?void 0:H.byteLength}}else U.length=U.width*U.height*U.depth*this.getByteSizeForInternalFormat(U.internalFormat);return U.length=0|U.length,w.__SPECTOR_Object_CustomData=U,U.length-G},t.prototype.getCustomData=function(x,S,w){return"texImage3D"===x.name?this.getTexImage3DCustomData(x,S,w):"compressedTexImage3D"===x.name?this.getCompressedTexImage3DCustomData(x,S,w):"texStorage3D"===x.name?this.getTexStorage3DCustomData(x,S,w):void 0},t.prototype.getTexStorage3DCustomData=function(x,S,w){var U;return 6===x.arguments.length&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],depth:x.arguments[5],length:0,isCompressed:!1}),U},t.prototype.getCompressedTexImage3DCustomData=function(x,S,w){var U;if(0===x.arguments[1])return x.arguments.length>=8&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],depth:x.arguments[5],length:0,isCompressed:!0}),U},t.prototype.getTexImage3DCustomData=function(x,S,w){var U;if(0===x.arguments[1])return x.arguments.length>=9&&(U={target:S,internalFormat:x.arguments[2],width:x.arguments[3],height:x.arguments[4],depth:x.arguments[5],format:x.arguments[7],type:x.arguments[8],length:0,isCompressed:!1}),U},t}(wn),Nn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Bn=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Nn(t,x),Object.defineProperty(t.prototype,"objectName",{get:function(){return"Program"},enumerable:!0,configurable:!0}),t.prototype.getCreateCommandNames=function(){return["createProgram"]},t.prototype.getUpdateCommandNames=function(){return["linkProgram"]},t.prototype.getDeleteCommandNames=function(){return["deleteProgram"]},t.prototype.getBoundInstance=function(x){return x},t.prototype.delete=function(x){var S=x.__SPECTOR_Object_CustomData;return S?S.length:0},t.prototype.update=function(x,S,w){if(x.arguments.length>=1&&!x.arguments[0])return 0;var U=this.getCustomData(w);if(!U)return 0;var G=w.__SPECTOR_Object_CustomData?w.__SPECTOR_Object_CustomData.length:0;return w.__SPECTOR_Object_CustomData=U,U.length-G},t.prototype.getCustomData=function(x){var S=this.options.context;return bn.getProgramData(S,x)},t}(wn),Dn=function(){function e(x){this.contextInformation=x,this.onCommandCallbacks={},this.recorders=[],this.initRecorders()}return e.prototype.recordCommand=function(x){var S=this.onCommandCallbacks[x.name];if(S)for(var w=0,U=S;w<U.length;w++)(0,U[w])(x)},e.prototype.startCapture=function(){for(var x=0,S=this.recorders;x<S.length;x++)S[x].startCapture()},e.prototype.stopCapture=function(){for(var x=0,S=this.recorders;x<S.length;x++)S[x].stopCapture()},e.prototype.appendRecordedInformation=function(x){for(var S=0,w=this.recorders;S<w.length;S++)w[S].appendRecordedInformation(x)},e.prototype.initRecorders=function(){this.recorders.push(new Cn(this.contextInformation),new Mn(this.contextInformation),new In(this.contextInformation),new On(this.contextInformation),new Bn(this.contextInformation));for(var x=0,S=this.recorders;x<S.length;x++)S[x].registerCallbacks(this.onCommandCallbacks)},e}(),kn=function(){function e(x){this.contextInformation=x,this.webGlObjects=[],this.initWebglObjects()}return e.prototype.tagWebGlObjects=function(x){for(var S=0,w=this.webGlObjects;S<w.length;S++){for(var U=w[S],G=0;G<x.arguments.length;G++){var H=x.arguments[G];if(U.tagWebGlObject(H))break}if(U.tagWebGlObject(x.result))break}},e.prototype.tagWebGlObject=function(x){for(var S=0,w=this.webGlObjects;S<w.length;S++){var U=w[S].tagWebGlObject(x);if(U)return U}},e.prototype.initWebglObjects=function(){this.webGlObjects.push(new rn,new on,new an,new sn,new ln,new cn,new dn,new pn,new mn,new gn,new vn,new hn)},e}(),Gn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Hn=function(x){function t(S){var w=x.call(this,S)||this;return w.extensionDefinition=[[{name:"ANGLE_instanced_arrays",description:""},{name:"EXT_blend_minmax",description:""},{name:"EXT_color_buffer_float",description:""},{name:"EXT_color_buffer_half_float",description:""},{name:"EXT_disjoint_timer_query",description:""},{name:"EXT_frag_depth",description:""},{name:"EXT_sRGB",description:""},{name:"EXT_shader_texture_lod",description:""},{name:"EXT_texture_filter_anisotropic",description:""},{name:"OES_element_index_uint",description:""},{name:"OES_standard_derivatives",description:""},{name:"OES_texture_float",description:""},{name:"OES_texture_float_linear",description:""},{name:"OES_texture_half_float",description:""},{name:"OES_texture_half_float_linear",description:""},{name:"OES_vertex_array_object",description:""},{name:"WEBGL_color_buffer_float",description:""},{name:"WEBGL_compressed_texture_astc",description:""},{name:"WEBGL_compressed_texture_atc",description:""},{name:"WEBGL_compressed_texture_etc",description:""},{name:"WEBGL_compressed_texture_etc1",description:""},{name:"WEBGL_compressed_texture_pvrtc",description:""},{name:"WEBGL_compressed_texture_s3tc",description:""},{name:"WEBGL_depth_texture",description:""},{name:"WEBGL_draw_buffers",description:""}],[{name:"EXT_color_buffer_float",description:""},{name:"EXT_disjoint_timer_query",description:""},{name:"EXT_disjoint_timer_query_webgl2",description:""},{name:"EXT_texture_filter_anisotropic",description:""},{name:"OES_texture_float_linear",description:""},{name:"WEBGL_compressed_texture_astc",description:""},{name:"WEBGL_compressed_texture_atc",description:""},{name:"WEBGL_compressed_texture_etc",description:""},{name:"WEBGL_compressed_texture_etc1",description:""},{name:"WEBGL_compressed_texture_pvrtc",description:""},{name:"WEBGL_compressed_texture_s3tc",description:""}]],w.currentState=w.startCapture(!0,w.quickCapture,w.fullCapture),w}return Gn(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return"Extensions"},enumerable:!0,configurable:!0}),t.prototype.getExtensions=function(){return this.extensions},t.prototype.readFromContext=function(){for(var x=0,S=1===this.contextVersion?this.extensionDefinition[0]:this.extensionDefinition[1];x<S.length;x++){var w=S[x],U=this.context.getExtension(w.name);U?(this.currentState[w.name]=!0,this.extensions[w.name]=U):this.currentState[w.name]=!1}},t}(St),Wn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),$n=function(x){function t(S){var w=x.call(this,S)||this;return w.currentState=w.startCapture(!0,w.quickCapture,w.fullCapture),w}return Wn(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return"CompressedTextures"},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.COMPRESSED_TEXTURE_FORMATS}]},t.prototype.stringifyParameterValue=function(x,S){for(var w=[],U=0,G=x;U<G.length;U++){var H=G[U];w.push(ee.stringifyWebGlConstant(H,"getParameter"))}return w},t}(Tt),zn=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Xn=function(x){function t(S){var w=x.call(this,S)||this;return w.currentState=w.startCapture(!0,w.quickCapture,w.fullCapture),w}return zn(t,x),Object.defineProperty(t.prototype,"stateName",{get:function(){return"Capabilities"},enumerable:!0,configurable:!0}),t.prototype.getWebgl1Parameters=function(){return[{constant:ee.RENDERER},{constant:ee.VENDOR},{constant:ee.VERSION},{constant:ee.SHADING_LANGUAGE_VERSION},{constant:ee.SAMPLES},{constant:ee.SAMPLE_BUFFERS},{constant:ee.RED_BITS},{constant:ee.GREEN_BITS},{constant:ee.BLUE_BITS},{constant:ee.ALPHA_BITS},{constant:ee.DEPTH_BITS},{constant:ee.STENCIL_BITS},{constant:ee.SUBPIXEL_BITS},{constant:ee.LINE_WIDTH},{constant:ee.ALIASED_LINE_WIDTH_RANGE},{constant:ee.ALIASED_POINT_SIZE_RANGE},{constant:ee.IMPLEMENTATION_COLOR_READ_FORMAT,returnType:20},{constant:ee.IMPLEMENTATION_COLOR_READ_TYPE,returnType:20},{constant:ee.MAX_COMBINED_TEXTURE_IMAGE_UNITS},{constant:ee.MAX_CUBE_MAP_TEXTURE_SIZE},{constant:ee.MAX_FRAGMENT_UNIFORM_VECTORS},{constant:ee.MAX_RENDERBUFFER_SIZE},{constant:ee.MAX_TEXTURE_IMAGE_UNITS},{constant:ee.MAX_TEXTURE_SIZE},{constant:ee.MAX_VARYING_VECTORS},{constant:ee.MAX_VERTEX_ATTRIBS},{constant:ee.MAX_VERTEX_TEXTURE_IMAGE_UNITS},{constant:ee.MAX_VERTEX_UNIFORM_VECTORS},{constant:ee.MAX_VIEWPORT_DIMS},{constant:ee.MAX_TEXTURE_MAX_ANISOTROPY_EXT},{constant:ee.MAX_COLOR_ATTACHMENTS_WEBGL},{constant:ee.MAX_DRAW_BUFFERS_WEBGL}]},t.prototype.getWebgl2Parameters=function(){return[{constant:ee.MAX_3D_TEXTURE_SIZE},{constant:ee.MAX_ARRAY_TEXTURE_LAYERS},{constant:ee.MAX_CLIENT_WAIT_TIMEOUT_WEBGL},{constant:ee.MAX_COLOR_ATTACHMENTS},{constant:ee.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS},{constant:ee.MAX_COMBINED_UNIFORM_BLOCKS},{constant:ee.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS},{constant:ee.MAX_DRAW_BUFFERS},{constant:ee.MAX_ELEMENT_INDEX},{constant:ee.MAX_ELEMENTS_INDICES},{constant:ee.MAX_ELEMENTS_VERTICES},{constant:ee.MAX_FRAGMENT_INPUT_COMPONENTS},{constant:ee.MAX_FRAGMENT_UNIFORM_BLOCKS},{constant:ee.MAX_FRAGMENT_UNIFORM_COMPONENTS},{constant:ee.MAX_PROGRAM_TEXEL_OFFSET},{constant:ee.MAX_SAMPLES},{constant:ee.MAX_SERVER_WAIT_TIMEOUT},{constant:ee.MAX_TEXTURE_LOD_BIAS},{constant:ee.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS},{constant:ee.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS},{constant:ee.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS},{constant:ee.MAX_UNIFORM_BLOCK_SIZE},{constant:ee.MAX_UNIFORM_BUFFER_BINDINGS},{constant:ee.MAX_VARYING_COMPONENTS},{constant:ee.MAX_VERTEX_OUTPUT_COMPONENTS},{constant:ee.MAX_VERTEX_UNIFORM_BLOCKS},{constant:ee.MAX_VERTEX_UNIFORM_COMPONENTS},{constant:ee.MIN_PROGRAM_TEXEL_OFFSET}]},t}(Tt),Kn=function(){function e(x){this.options=x,this.commandId=0,this.context=x.context,this.version=x.version,this.onMaxCommand=new j,this.capturing=!1,this.globalCapturing=!0,this.contextInformation={context:this.context,contextVersion:this.version,toggleCapture:this.toggleGlobalCapturing.bind(this),tagWebGlObject:this.tagWebGlObject.bind(this),extensions:{}},this.commandSpies={},this.stateSpy=new Sn(this.contextInformation),this.recorderSpy=new Dn(this.contextInformation),this.webGlObjectSpy=new kn(this.contextInformation),this.analyser=new Ce(this.contextInformation),this.initStaticCapture(),x.recordAlways&&this.spy()}return e.prototype.spy=function(){this.spyContext(this.context);var x=this.contextInformation.extensions;for(var S in x)x.hasOwnProperty(S)&&this.spyContext(x[S])},e.prototype.unSpy=function(){for(var x in this.commandSpies)this.commandSpies.hasOwnProperty(x)&&this.commandSpies[x].unSpy()},e.prototype.startCapture=function(x,S,w){void 0===x&&(x=0),void 0===S&&(S=!1),void 0===w&&(w=!1);var U=X.now;this.maxCommands=x,this.options.recordAlways||this.spy(),this.capturing=!0,this.commandId=0,this.currentCapture={canvas:this.canvasCapture,context:this.contextCapture,commands:[],initState:{},endState:{},startTime:U,listenCommandsStartTime:0,listenCommandsEndTime:0,endTime:0,analyses:[],frameMemory:{},memory:{}},this.currentCapture.canvas.width=this.context.canvas.width,this.currentCapture.canvas.height=this.context.canvas.height,this.currentCapture.canvas.clientWidth=this.context.canvas.clientWidth||this.context.canvas.width,this.currentCapture.canvas.clientHeight=this.context.canvas.clientHeight||this.context.canvas.height,this.stateSpy.startCapture(this.currentCapture,S,w),this.recorderSpy.startCapture(),this.currentCapture.listenCommandsStartTime=X.now},e.prototype.stopCapture=function(){var x=X.now;return this.options.recordAlways||this.unSpy(),this.capturing=!1,this.stateSpy.stopCapture(this.currentCapture),this.recorderSpy.stopCapture(),this.currentCapture.listenCommandsEndTime=x,this.currentCapture.endTime=X.now,this.recorderSpy.appendRecordedInformation(this.currentCapture),this.analyser.appendAnalyses(this.currentCapture),this.currentCapture},e.prototype.isCapturing=function(){return this.globalCapturing&&this.capturing},e.prototype.setMarker=function(x){this.marker=x},e.prototype.clearMarker=function(){this.marker=null},e.prototype.getNextCommandCaptureId=function(){return this.commandId++},e.prototype.onCommand=function(x,S){if(this.globalCapturing&&(this.webGlObjectSpy.tagWebGlObjects(S),this.recorderSpy.recordCommand(S),this.isCapturing())){var w=x.createCapture(S,this.getNextCommandCaptureId(),this.marker);this.stateSpy.captureState(w),this.currentCapture.commands.push(w),w.endTime=X.now,this.maxCommands>0&&this.currentCapture.commands.length===this.maxCommands&&this.onMaxCommand.trigger(this)}},e.prototype.spyContext=function(x){var S=[];for(var w in x)w&&S.push(w);for(var U=0;U<S.length;U++)if(w=S[U],!~e.unSpyableMembers.indexOf(w))try{"number"!=typeof x[w]&&this.spyFunction(w,x)}catch(x){z.error("Cant Spy member: "+w),z.error(x)}},e.prototype.initStaticCapture=function(){var x=new Hn(this.contextInformation),S=x.getExtensions();for(var w in S)S.hasOwnProperty(w)&&(this.contextInformation.extensions[w]=S[w]);var U=new Xn(this.contextInformation),G=new $n(this.contextInformation);this.contextCapture={version:this.version,contextAttributes:this.context.getContextAttributes(),capabilities:U.getStateData(),extensions:x.getStateData(),compressedTextures:G.getStateData()},this.canvasCapture={width:this.context.canvas.width,height:this.context.canvas.height,clientWidth:this.context.canvas.clientWidth||this.context.canvas.width,clientHeight:this.context.canvas.clientHeight||this.context.canvas.height,browserAgent:navigator?navigator.userAgent:""}},e.prototype.spyFunction=function(x,S){if(0!==x.indexOf("__SPECTOR_Origin_")){if(!this.commandSpies[x]){var w=function(x,S){var w={};for(var U in x)x.hasOwnProperty(U)&&(w[U]=x[U]);for(var U in S)w.hasOwnProperty(U)||(w[U]=S[U]);return w}(this.contextInformation,{spiedCommandName:x,spiedCommandRunningContext:S,callback:this.onCommand.bind(this)});this.commandSpies[x]=new Et(w)}this.commandSpies[x].spy()}},e.prototype.toggleGlobalCapturing=function(x){this.globalCapturing=x},e.prototype.tagWebGlObject=function(x){return this.webGlObjectSpy.tagWebGlObject(x)},e.unSpyableMembers=["canvas","drawingBufferWidth","drawingBufferHeight","glp"],e}(),qn=function(){function e(x){this.spiedWindow=x||window,this.lastFrame=0,this.speedRatio=1,this.willPlayNextFrame=!1,this.onFrameStart=new j,this.onFrameEnd=new j,this.onError=new j,this.lastSixtyFramesDuration=[],this.lastSixtyFramesCurrentIndex=0,this.lastSixtyFramesPreviousStart=0;for(var S=0;S<e.fpsWindowSize;S++)this.lastSixtyFramesDuration[S]=0;this.init()}return e.prototype.playNextFrame=function(){this.willPlayNextFrame=!0},e.prototype.changeSpeedRatio=function(x){this.speedRatio=x},e.prototype.getFps=function(){for(var x=0,S=0;S<e.fpsWindowSize;S++)x+=this.lastSixtyFramesDuration[S];return 0===x?0:6e4/x},e.prototype.init=function(){for(var x=this,S=0,w=e.requestAnimationFrameFunctions;S<w.length;S++){var U=w[S];this.spyRequestAnimationFrame(U,this.spiedWindow)}for(var G=0,H=e.setTimerFunctions;G<H.length;G++)U=H[G],this.spySetTimer(U);this.spiedWindow.VRDisplay&&this.spiedWindow.addEventListener("vrdisplaypresentchange",(function(S){x.spyRequestAnimationFrame("requestAnimationFrame",S.display)}))},e.prototype.spyRequestAnimationFrame=function(x,S){var w=this;Ae.storeOriginFunction(S,x),S[x]=function(){var U=arguments[0],G=w.getCallback(w,U,(function(){w.spiedWindow[x](U)}));return Ae.executeOriginFunction(S,x,[G])}},e.prototype.spySetTimer=function(x){var S=this,w=this.spiedWindow,U="setTimeout"===x;Ae.storeOriginFunction(w,x),w[x]=function(){var G=arguments[0],H=arguments[1],z=Array.prototype.slice.call(arguments);return e.setTimerCommonValues.indexOf(H)>-1&&(z[0]=S.getCallback(S,G,U?function(){w[x](G)}:null)),Ae.executeOriginFunction(w,x,z)}},e.prototype.getCallback=function(x,S,w){return void 0===w&&(w=null),function(){var U=X.now;if(x.lastFrame=++x.lastFrame%x.speedRatio,x.willPlayNextFrame||x.speedRatio&&!x.lastFrame){x.onFrameStart.trigger(x);try{S.apply(x.spiedWindow,arguments)}catch(S){x.onError.trigger(S)}x.lastSixtyFramesCurrentIndex=(x.lastSixtyFramesCurrentIndex+1)%e.fpsWindowSize,x.lastSixtyFramesDuration[x.lastSixtyFramesCurrentIndex]=U-x.lastSixtyFramesPreviousStart,x.onFrameEnd.trigger(x),x.willPlayNextFrame=!1}else w&&w();x.lastSixtyFramesPreviousStart=U}},e.requestAnimationFrameFunctions=["requestAnimationFrame","msRequestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame"],e.setTimerFunctions=["setTimeout","setInterval"],e.setTimerCommonValues=[0,15,16,33,32,40],e.fpsWindowSize=60,e}(),Zn=function(){function e(x){this.canvas=x,this.onContextRequested=new j,this.init()}return e.prototype.init=function(){var x=this,t=function(){var S=this instanceof HTMLCanvasElement?HTMLCanvasElement:OffscreenCanvas,w=x.canvas?Ae.executeOriginFunction(this,"getContext",arguments):Ae.executePrototypeOriginFunction(this,S,"getContext",arguments);if(arguments.length>0&&"2d"===arguments[0])return w;if(w){var U=Array.prototype.slice.call(arguments),G="webgl2"===U[0]||"experimental-webgl2"===U[0]?2:1;x.onContextRequested.trigger({context:w,contextVersion:G})}return w};this.canvas?(Ae.storeOriginFunction(this.canvas,"getContext"),this.canvas.getContext=t):(Ae.storePrototypeOriginFunction(HTMLCanvasElement,"getContext"),HTMLCanvasElement.prototype.getContext=t,"undefined"!=typeof OffscreenCanvas&&(Ae.storePrototypeOriginFunction(OffscreenCanvas,"getContext"),OffscreenCanvas.prototype.getContext=t))},e}(),Jn=(w(11),function(){function e(x,S){this.placeHolder=x,this.stateStore=S}return e.prototype.compose=function(x){var S=this.stateStore.getStatesToProcess(),w=!1;for(var U in S)if(S.hasOwnProperty(U)){var G=S[U],H=this.stateStore.getLastOperation(G),z=this.stateStore.getComponentInstance(G),j=this.stateStore.getData(G);z.render(j,G,H),w=!0}if(w){var X=this.stateStore.getLastOperation(x);this.composeInContainer(this.placeHolder,Number.MAX_VALUE,x,X)}},e.prototype.composeChildren=function(x,S){if(S)for(var w=this.stateStore.getChildrenIds(x),U=0,G=0;G<w.length;G++){var H=w[G],z=this.stateStore.getLastOperation(H);this.composeInContainer(S,U,H,z),50!==z&&U++}},e.prototype.composeInContainer=function(x,S,w,U){var G=this.stateStore.getComponentInstance(w).composeInContainer(x,S,U);this.composeChildren(w,G)},e}()),ei=function(){function e(){this.store={},this.idGenerator=0,this.pendingOperation={}}return e.prototype.getLastOperation=function(x){return this.store[x].lastOperation},e.prototype.getData=function(x){return this.store[x].data},e.prototype.getComponentInstance=function(x){return this.store[x].componentInstance},e.prototype.getParentId=function(x){return this.store[x].parent?this.store[x].parent.id:-1},e.prototype.getChildrenIds=function(x){for(var S=[],w=0,U=this.store[x].children;w<U.length;w++){var G=U[w];S.push(G.id)}return S},e.prototype.hasChildren=function(x){return this.store[x].children.length>0},e.prototype.add=function(x,S){var w=this.getNewId();return this.pendingOperation[w]=w,this.store[w]={data:x,id:w,parent:null,children:[],componentInstance:S,lastOperation:20},w},e.prototype.update=function(x,S){this.store[x],this.pendingOperation[x]=x,this.store[x].data=S,this.store[x].lastOperation=40},e.prototype.addChild=function(x,S,w){var U=this.store[x],G=this.add(S,w);this.pendingOperation[G]=G;var H=this.store[G];return H.parent=U,U.children.push(H),G},e.prototype.insertChildAt=function(x,S,w,U){var G=this.store[x],H=this.add(w,U);this.pendingOperation[H]=H;var z=this.store[H];return z.parent=G,S>=G.children.length?G.children.push(z):S>=0?G.children.splice(S,0,z):G.children.unshift(z),H},e.prototype.removeChildById=function(x,S){for(var w=this.store[x],U=w.children.length-1;U>=0;U--)if(w.children[U].id===S){this.removeChildAt(x,U);break}},e.prototype.removeChildAt=function(x,S){var w,U=this.store[x];S>U.children.length-1?(w=U.children[U.children.length-1],U.children[U.children.length-1].parent=null,U.children.splice(U.children.length-1,1)):S>=0?(w=U.children[S],U.children[S].parent=null,U.children.splice(S,1)):(w=U.children[0],U.children[0].parent=null,U.children.splice(0,1)),w.parent=null,this.remove(w.id)},e.prototype.remove=function(x){var S=this.store[x];S.parent?(this.store[S.parent.id],this.removeChildById(S.parent.id,x)):(this.removeChildren(x),this.store[x].lastOperation=50,this.pendingOperation[x]=x)},e.prototype.removeChildren=function(x){for(var S=this.store[x];S.children.length;)this.remove(S.children[0].id)},e.prototype.getStatesToProcess=function(){return this.pendingOperation},e.prototype.flushPendingOperations=function(){for(var x in this.pendingOperation)this.pendingOperation[x]&&(50===this.store[x].lastOperation?delete this.store[x]:this.store[x].lastOperation=0);this.pendingOperation={}},e.prototype.getNewId=function(){return++this.idGenerator},e}(),ni=function(){function e(x){this.component=x}return e.prototype.render=function(x,S,w){0!==w&&(50!==w?this.domNode=this.component.render(x,S):this.removeNode())},e.prototype.composeInContainer=function(x,S,w){if(50===w)return this.removeNode(),null;var U=this.cachedCurrentChildrenContainer;if(0===w)return U;var G=this.domNode,H=G.getAttribute("childrencontainer")?G:G.querySelector("[childrenContainer]");if(H&&U)for(var z=U.children;z.length>0;)H.appendChild(z[0]);if(this.cachedCurrentChildrenContainer=H,S>=x.children.length)x.appendChild(G),this.cachedCurrentDomNode&&40===w&&(this.cachedCurrentDomNode.remove?this.cachedCurrentDomNode.remove():this.cachedCurrentDomNode.parentNode&&this.cachedCurrentDomNode.parentNode.removeChild(this.cachedCurrentDomNode));else{var j=x.children[S];x.insertBefore(G,j),40===w&&x.removeChild(j)}return this.cachedCurrentDomNode=this.domNode,H},e.prototype.removeNode=function(){this.domNode&&this.domNode.parentElement&&(this.domNode.remove?this.domNode.remove():this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode)),this.cachedCurrentDomNode&&this.cachedCurrentDomNode.parentElement&&(this.cachedCurrentDomNode.remove?this.cachedCurrentDomNode.remove():this.cachedCurrentDomNode.parentNode&&this.cachedCurrentDomNode.parentNode.removeChild(this.cachedCurrentDomNode))},e.idGenerator=0,e}(),ii=function(){function e(x){this.stateStore=new ei,this.compositor=new Jn(x,this.stateStore),this.willRender=!1,this.rootStateId=-1}return e.prototype.addRootState=function(x,S,w){void 0===w&&(w=!1);var U=new ni(S),G=this.stateStore.add(x,U);return this.rootStateId=G,this.setForRender(w),G},e.prototype.addChildState=function(x,S,w,U){void 0===U&&(U=!1);var G=this.insertChildState(x,S,Number.MAX_VALUE,w);return this.setForRender(U),G},e.prototype.insertChildState=function(x,S,w,U,G){void 0===G&&(G=!1);var H=new ni(U),z=this.stateStore.insertChildAt(x,w,S,H);return this.setForRender(G),z},e.prototype.updateState=function(x,S,w){void 0===w&&(w=!1),this.stateStore.update(x,S),this.setForRender(w)},e.prototype.removeState=function(x,S){void 0===S&&(S=!1),this.stateStore.remove(x),this.setForRender(S)},e.prototype.removeChildrenStates=function(x,S){void 0===S&&(S=!1),this.stateStore.removeChildren(x),this.setForRender(S)},e.prototype.getState=function(x){return this.stateStore.getData(x)},e.prototype.getGenericState=function(x){return this.getState(x)},e.prototype.getChildrenState=function(x){var S=this;return this.stateStore.getChildrenIds(x).map((function(w){return S.stateStore.getData(x)}))},e.prototype.getChildrenGenericState=function(x){return this.getChildrenState(x)},e.prototype.hasChildren=function(x){return this.stateStore.hasChildren(x)},e.prototype.updateAllChildrenState=function(x,S){for(var w=0,U=this.stateStore.getChildrenIds(x);w<U.length;w++){var G=U[w],H=this.getGenericState(G);S(H),this.updateState(G,H)}},e.prototype.updateAllChildrenGenericState=function(x,S){this.updateAllChildrenState(x,S)},e.prototype.setForRender=function(x){this.willRender||(this.willRender=!0,x?this.compose():setTimeout(this.compose.bind(this),e.REFRESHRATEINMILLISECONDS))},e.prototype.compose=function(){this.willRender=!1,this.compositor.compose(this.rootStateId),this.stateStore.flushPendingOperations()},e.REFRESHRATEINMILLISECONDS=100,e}(),ri=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),oi=function(x){function t(){var S=x.call(this)||this;return S.events={},S}return ri(t,x),t.prototype.addEventListener=function(x,S,w){return void 0===w&&(w=null),this.events[x]?this.events[x].add(S,w):-1},t.prototype.removeEventListener=function(x,S){this.events[x]&&this.events[x].remove(S)},t.prototype.renderElementFromTemplate=function(x,S,w){var U=this.createFromHtml(x);return this.bindCommands(U,S,w),U},t.prototype.bindCommands=function(x,S,w){x.getAttribute("commandname")&&this.bindCommand(x,S,w);for(var U=x.querySelectorAll("[commandName]"),G=0;G<U.length;G++){var H=U[G];this.bindCommand(H,S,w)}},t.prototype.bindCommand=function(x,S,w){var U=x.getAttribute("commandname"),G=x.getAttribute("commandeventbinding")||"";0===G.length&&(G="click");var H="true"===x.getAttribute("usecapture"),z="true"===x.getAttribute("stoppropagation");this.createEvent(U),this.mapEventListener(x,G,U,S,w,H,z)},t.prototype.mapEventListener=function(x,S,w,U,G,H,z){void 0===H&&(H=!1),void 0===z&&(z=!1);var j=this;z?x.addEventListener(S,(function(x){return x.stopPropagation(),x.preventDefault(),j.triggerEvent(w,this,U,G),!1}),H):x.addEventListener(S,(function(){j.triggerEvent(w,this,U,G)}),H)},t.prototype.createEvent=function(x){if(!this.events[x]){var S=new j;this.events[x]=S}return this.events[x]},t.prototype.triggerEvent=function(x,S,w,U){this.events[x].trigger({sender:S,stateId:U,state:w})},t}(function(){function e(){this.dummyTextGeneratorElement=document.createElement("div")}return e.prototype.createFromHtml=function(x){var S=document.createElement("div");return S.innerHTML=x,S.firstElementChild},e.prototype.htmlTemplate=function(x){for(var S=this,w=[],U=1;U<arguments.length;U++)w[U-1]=arguments[U];var G=x.raw,H="";return w.forEach((function(x,w){var U=G[w];Array.isArray(x)&&(x=x.join("")),U&&U.length>0&&"$"===U[U.length-1]?U=U.slice(0,-1):x=S.htmlEscape(x),H+=U,H+=x})),H+=G[G.length-1]},e.prototype.htmlEscape=function(x){return null==x||0===x.length?x:(this.dummyTextGeneratorElement.innerText=x,this.dummyTextGeneratorElement.innerHTML)},e}()),ai=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),un=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},li=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ai(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(oe||(oe=un(['<div>\n            <div childrenContainer="true" class="captureMenuComponent ','">\n            </div>\n            <div class="captureMenuLogComponent ','">\n                <span class="','">',"<span>\n            </div>\n        </div>"],['<div>\n            <div childrenContainer="true" class="captureMenuComponent ','">\n            </div>\n            <div class="captureMenuLogComponent ','">\n                <span class="','">',"<span>\n            </div>\n        </div>"])),x?"active":"",x.logVisible?"active":"",x.logLevel===U.error?"error":"",x.logText);return this.renderElementFromTemplate(w,x,S)},t}(oi),ci=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),ui=function(x){function t(){var S=x.call(this)||this;return S.onCanvasSelected=S.createEvent("onCanvasSelected"),S}return ci(t,x),t.prototype.render=function(x,S){var w=document.createElement("li"),U=document.createElement("span");return U.innerText="Id: "+x.id+" - Size: "+x.width+"*"+x.height,w.appendChild(U),this.mapEventListener(w,"click","onCanvasSelected",x,S),w},t}(oi),di=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),fn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},pi=function(x){function t(){var S=x.call(this)||this;return S.onCaptureRequested=S.createEvent("onCaptureRequested"),S.onPlayRequested=S.createEvent("onPlayRequested"),S.onPauseRequested=S.createEvent("onPauseRequested"),S.onPlayNextFrameRequested=S.createEvent("onPlayNextFrameRequested"),S}return di(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(ae||(ae=fn(['\n        <div class="captureMenuActionsComponent">\n            <div commandName="onCaptureRequested">\n            </div>\n            $',"\n        </div>"],['\n        <div class="captureMenuActionsComponent">\n            <div commandName="onCaptureRequested">\n            </div>\n            $',"\n        </div>"])),x?'<div commandName="onPauseRequested">\n                </div>':'<div commandName="onPlayRequested">\n                </div>\n                <div commandName="onPlayNextFrameRequested">\n                </div>');return this.renderElementFromTemplate(w,x,S)},t}(oi),fi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),_n=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},gi=function(x){function t(){var S=x.call(this)||this;return S.onCanvasSelection=S.createEvent("onCanvasSelection"),S}return fi(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(se||(se=_n(['\n        <div class="canvasListComponent">\n            <span commandName="onCanvasSelection">\n                ','\n            </span>\n            <ul childrenContainer="true" style="','"></ul>\n        </div>'],['\n        <div class="canvasListComponent">\n            <span commandName="onCanvasSelection">\n                ','\n            </span>\n            <ul childrenContainer="true" style="','"></ul>\n        </div>'])),x.currentCanvasInformation?x.currentCanvasInformation.id+" ("+x.currentCanvasInformation.width+"*"+x.currentCanvasInformation.height+")":"Choose Canvas...",x.showList?"display:block;visibility:visible":"display:none;visibility:hidden");return this.renderElementFromTemplate(w,x,S)},t}(oi),_i=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),yi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return _i(t,x),t.prototype.render=function(x,S){var w=document.createElement("span");return w.className="fpsCounterComponent",w.innerText=x.toFixed(2)+" Fps",w},t}(oi),bi=function(){function e(x){var S=this;void 0===x&&(x={}),this.options=x,this.rootPlaceHolder=x.rootPlaceHolder||document.body,this.mvx=new ii(this.rootPlaceHolder),this.isTrackingCanvas=!1,this.onCanvasSelected=new j,this.onCaptureRequested=new j,this.onPauseRequested=new j,this.onPlayRequested=new j,this.onPlayNextFrameRequested=new j,this.captureMenuComponent=new li,this.canvasListComponent=new gi,this.canvasListItemComponent=new ui,this.actionsComponent=new pi,this.fpsCounterComponent=new yi,this.rootStateId=this.mvx.addRootState({visible:!0,logLevel:U.info,logText:e.SelectCanvasHelpText,logVisible:!this.options.hideLog},this.captureMenuComponent),this.canvasListStateId=this.mvx.addChildState(this.rootStateId,{currentCanvasInformation:null,showList:!1},this.canvasListComponent),this.actionsStateId=this.mvx.addChildState(this.rootStateId,!0,this.actionsComponent),this.fpsStateId=this.mvx.addChildState(this.rootStateId,0,this.fpsCounterComponent),this.actionsComponent.onCaptureRequested.add((function(){var x=S.getSelectedCanvasInformation();x&&S.updateMenuStateLog(U.info,e.PleaseWaitHelpText,!0),setTimeout((function(){S.onCaptureRequested.trigger(x)}),200)})),this.actionsComponent.onPauseRequested.add((function(){S.onPauseRequested.trigger(S.getSelectedCanvasInformation()),S.mvx.updateState(S.actionsStateId,!1)})),this.actionsComponent.onPlayRequested.add((function(){S.onPlayRequested.trigger(S.getSelectedCanvasInformation()),S.mvx.updateState(S.actionsStateId,!0)})),this.actionsComponent.onPlayNextFrameRequested.add((function(){S.onPlayNextFrameRequested.trigger(S.getSelectedCanvasInformation())})),this.canvasListComponent.onCanvasSelection.add((function(x){S.mvx.updateState(S.canvasListStateId,{currentCanvasInformation:null,showList:!x.state.showList}),S.updateMenuStateLog(U.info,e.SelectCanvasHelpText),S.onCanvasSelected.trigger(null),S.isTrackingCanvas&&S.trackPageCanvases(),x.state.showList?S.showMenuStateLog():S.hideMenuStateLog()})),this.canvasListItemComponent.onCanvasSelected.add((function(x){S.mvx.updateState(S.canvasListStateId,{currentCanvasInformation:x.state,showList:!1}),S.onCanvasSelected.trigger(x.state),S.updateMenuStateLog(U.info,e.ActionsHelpText),S.showMenuStateLog()}))}return e.prototype.getSelectedCanvasInformation=function(){return this.mvx.getGenericState(this.canvasListStateId).currentCanvasInformation},e.prototype.trackPageCanvases=function(){if(this.isTrackingCanvas=!0,document.body){var x=document.body.querySelectorAll("canvas");this.updateCanvasesList(x)}},e.prototype.updateCanvasesList=function(x){this.updateCanvasesListInformationInternal(x,(function(x){return{id:x.id,width:x.width,height:x.height,ref:x}}))},e.prototype.updateCanvasesListInformation=function(x){this.updateCanvasesListInformationInternal(x,(function(x){return{id:x.id,width:x.width,height:x.height,ref:x.ref}}))},e.prototype.display=function(){this.updateMenuStateVisibility(!0)},e.prototype.hide=function(){this.updateMenuStateVisibility(!1)},e.prototype.captureComplete=function(x){x?this.updateMenuStateLog(U.error,x):this.updateMenuStateLog(U.info,e.ActionsHelpText)},e.prototype.setFPS=function(x){this.mvx.updateState(this.fpsStateId,x)},e.prototype.updateCanvasesListInformationInternal=function(x,S){this.mvx.removeChildrenStates(this.canvasListStateId);for(var w=[],G=0;G<x.length;G++){var H=S(x[G]);w.push(H),this.mvx.addChildState(this.canvasListStateId,H,this.canvasListItemComponent)}var z=w.length,j=this.mvx.getGenericState(this.canvasListStateId).showList;if(!j)if(1===z){var X=w[0];this.mvx.updateState(this.canvasListStateId,{currentCanvasInformation:X,showList:j}),this.updateMenuStateLog(U.info,e.ActionsHelpText),this.onCanvasSelected.trigger(X)}else this.updateMenuStateLog(U.info,e.SelectCanvasHelpText),this.onCanvasSelected.trigger(null)},e.prototype.hideMenuStateLog=function(){var x=this.mvx.getGenericState(this.rootStateId);this.mvx.updateState(this.rootStateId,{visible:x.visible,logLevel:x.logLevel,logText:x.logText,logVisible:!1})},e.prototype.showMenuStateLog=function(){var x=this.mvx.getGenericState(this.rootStateId);this.mvx.updateState(this.rootStateId,{visible:x.visible,logLevel:x.logLevel,logText:x.logText,logVisible:!this.options.hideLog})},e.prototype.updateMenuStateLog=function(x,S,w){void 0===w&&(w=!1);var U=this.mvx.getGenericState(this.rootStateId);this.mvx.updateState(this.rootStateId,{visible:U.visible,logLevel:x,logText:S,logVisible:!this.options.hideLog},w)},e.prototype.updateMenuStateVisibility=function(x){var S=this.mvx.getGenericState(this.rootStateId);this.mvx.updateState(this.rootStateId,{visible:x,logLevel:S.logLevel,logText:S.logText,logVisible:S.logVisible})},e.SelectCanvasHelpText="Please, select a canvas in the list above.",e.ActionsHelpText="Record with the red button, you can also pause or continue playing the current scene.",e.PleaseWaitHelpText="Capturing, be patient (this can take up to 3 minutes)...",e}(),xi=(w(13),function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}()),yn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Ei=function(x){function t(){var S=x.call(this)||this;return S.onCaptureLoaded=new j,S}return xi(t,x),t.prototype.render=function(x,S){var w=this,U=this.htmlTemplate(le||(le=yn(['\n        <div class="captureListComponent ','">\n            <div class="openCaptureFile">\n                <Span>Drag files here to open a previously saved capture.</span>\n            </div>\n            <ul childrenContainer="true"></ul>\n        </div>'],['\n        <div class="captureListComponent ','">\n            <div class="openCaptureFile">\n                <Span>Drag files here to open a previously saved capture.</span>\n            </div>\n            <ul childrenContainer="true"></ul>\n        </div>'])),x?"active":""),G=this.renderElementFromTemplate(U,x,S),H=G.querySelector(".openCaptureFile");return H.addEventListener("dragenter",(function(x){return w.drag(x),!1}),!1),H.addEventListener("dragover",(function(x){return w.drag(x),!1}),!1),H.addEventListener("drop",(function(x){w.drop(x)}),!1),G},t.prototype.drag=function(x){x.stopPropagation(),x.preventDefault()},t.prototype.drop=function(x){x.stopPropagation(),x.preventDefault(),this.loadFiles(x)},t.prototype.loadFiles=function(x){var S=this,w=null;if(x&&x.dataTransfer&&x.dataTransfer.files&&(w=x.dataTransfer.files),x&&x.target&&x.target.files&&(w=x.target.files),w&&w.length>0)for(var i=function(x){var U=w[x].name.toLowerCase().split(".").pop();if(w[x].type,"json"===U){var G=w[x],H=new FileReader;H.onerror=function(x){z.error("Error while reading file: "+G.name+x)},H.onload=function(x){try{var w=JSON.parse(x.target.result);S.onCaptureLoaded.trigger(w)}catch(x){z.error("Error while reading file: "+G.name+x)}},H.readAsText(G)}},U=0;U<w.length;U++)i(U)},t}(oi),Si=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),wi=function(x){function t(){var S=x.call(this)||this;return S.onCaptureSelected=S.createEvent("onCaptureSelected"),S.onSaveRequested=S.createEvent("onSaveRequested"),S}return Si(t,x),t.prototype.render=function(x,S){var w=document.createElement("li");if(x.active&&(w.className="active"),x.capture.endState.VisualState.Attachments)for(var U=0,G=x.capture.endState.VisualState.Attachments;U<G.length;U++){var H=G[U],z=document.createElement("img");z.src=encodeURI(H.src),w.appendChild(z)}else{var j=document.createElement("span");j.innerText=x.capture.endState.VisualState.FrameBufferStatus,w.appendChild(j)}var X=document.createElement("span");X.innerText=new Date(x.capture.startTime).toTimeString().split(" ")[0],w.appendChild(X);var K=document.createElement("a");return K.href="#",K.className="captureListItemSave",this.mapEventListener(K,"click","onSaveRequested",x,S,!1,!0),X.appendChild(K),this.mapEventListener(w,"click","onCaptureSelected",x,S),w},t}(oi),Ti=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ln=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Ci=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ti(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(ce||(ce=Ln(['\n        <div class="visualStateListComponent">\n            <ul childrenContainer="true"></ul>\n        </div>'],['\n        <div class="visualStateListComponent">\n            <ul childrenContainer="true"></ul>\n        </div>'])));return this.renderElementFromTemplate(w,x,S)},t}(oi),Ai=function(){function e(){}return e.scrollIntoView=function(x){for(var S=x.getBoundingClientRect(),w=x.parentElement;w&&w.clientHeight===w.offsetHeight;)w=w.parentElement;if(w){var U=w.getBoundingClientRect();S.top<U.top?x.scrollIntoView(!0):S.bottom>U.bottom&&x.scrollIntoView(!1)}},e}(),Mi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Ri=function(x){function t(){var S=x.call(this)||this;return S.onVisualStateSelected=S.createEvent("onVisualStateSelected"),S}return Mi(t,x),t.prototype.render=function(x,S){var w=document.createElement("li");if(x.active&&(w.className="active",setTimeout((function(){Ai.scrollIntoView(w)}),1)),x.VisualState.Attachments)for(var U=0,G=x.VisualState.Attachments;U<G.length;U++){var H=G[U];if(H.src){var z=document.createElement("img");if(z.src=encodeURI(H.src),w.appendChild(z),x.VisualState.Attachments.length>1){var j=document.createElement("span");j.innerText=H.attachmentName,w.appendChild(j)}if(H.textureLayer){var X=document.createElement("span");X.innerText="Layer: "+H.textureLayer,w.appendChild(X)}if(H.textureCubeMapFace){var K=document.createElement("span");K.innerText=H.textureCubeMapFace,w.appendChild(K)}}}else{var q=document.createElement("span");q.innerText=x.VisualState.FrameBufferStatus,w.appendChild(q)}var Y=document.createElement("span");return Y.innerText=x.VisualState.FrameBuffer?"Frame buffer: "+x.VisualState.FrameBuffer.__SPECTOR_Object_TAG.id:"Canvas frame buffer",w.appendChild(Y),this.mapEventListener(w,"click","onVisualStateSelected",x,S),w},t}(oi),Li=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Pn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Ii=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Li(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(ue||(ue=Pn(['\n        <div class="commandListComponent">\n            <ul childrenContainer="true"></ul>\n        </div>'],['\n        <div class="commandListComponent">\n            <ul childrenContainer="true"></ul>\n        </div>'])));return this.renderElementFromTemplate(w,x,S)},t}(oi),Pi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Fi=function(x){function t(){var S=x.call(this)||this;return S.onCommandSelected=S.createEvent("onCommandSelected"),S.onVertexSelected=S.createEvent("onVertexSelected"),S.onFragmentSelected=S.createEvent("onFragmentSelected"),S}return Pi(t,x),t.prototype.render=function(x,S){var w=document.createElement("li"),U="unknown";switch(x.capture.status){case 50:U="deprecated";break;case 10:U="unused";break;case 20:U="disabled";break;case 30:U="redundant";break;case 40:U="valid"}if(x.capture.VisualState&&(w.className=" drawCall"),x.active&&(w.className=" active",setTimeout((function(){Ai.scrollIntoView(w)}),1)),x.capture.marker){var G=document.createElement("span");G.className=U+" marker important",G.innerText=x.capture.marker+" ",G.style.fontWeight="1000",w.appendChild(G)}var H=document.createElement("span"),z=x.capture.text;if(z=z.replace(x.capture.name,'<span class=" '+U+' important">'+x.capture.name+"</span>"),H.innerHTML=z,w.appendChild(H),x.capture.VisualState&&"clear"!==x.capture.name)try{var j=x.capture.DrawCall.shaders[0],X=x.capture.DrawCall.shaders[1],K=document.createElement("a");K.innerText=j.name,K.href="#",w.appendChild(K),this.mapEventListener(K,"click","onVertexSelected",x,S);var q=document.createElement("a");q.innerText=X.name,q.href="#",w.appendChild(q),this.mapEventListener(q,"click","onFragmentSelected",x,S)}catch(x){}return this.mapEventListener(w,"click","onCommandSelected",x,S),w},t}(oi),Oi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Un=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Ni=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Oi(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(he||(he=Un(['\n        <div class="commandDetailComponent" childrenContainer="true">\n        </div>'],['\n        <div class="commandDetailComponent" childrenContainer="true">\n        </div>'])));return this.renderElementFromTemplate(w,x,S)},t}(oi),Bi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Vn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Di=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Bi(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(de||(de=Vn(['\n        <div class="jsonContentComponent" childrenContainer="true">\n        </div>'],['\n        <div class="jsonContentComponent" childrenContainer="true">\n        </div>'])));return this.renderElementFromTemplate(w,x,S)},t}(oi),ki=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),jn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Ui=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ki(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(pe||(pe=jn(['\n        <div class="jsonGroupComponent">\n            <div class="jsonGroupComponentTitle">','</div>\n            <ul childrenContainer="true"></ul>\n        </div>'],['\n        <div class="jsonGroupComponent">\n            <div class="jsonGroupComponentTitle">','</div>\n            <ul childrenContainer="true"></ul>\n        </div>'])),x?x.replace(/([A-Z])/g," $1").trim():"");return this.renderElementFromTemplate(w,x,S)},t}(oi),Gi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Yn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Vi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Gi(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(me||(me=Yn(['\n            <li><span class="jsonItemComponentKey">',': </span><span class="jsonItemComponentValue">',"</span><li>"],['\n            <li><span class="jsonItemComponentKey">',': </span><span class="jsonItemComponentValue">',"</span><li>"])),x.key,x.value);return this.renderElementFromTemplate(w,x,S)},t}(oi),Hi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Qn=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Wi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Hi(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(fe||(fe=Qn(['\n        <li class="jsonItemImageHolder"><div class="jsonItemImage"><img src="','"/><span>',"</span></div></li>"],['\n        <li class="jsonItemImageHolder"><div class="jsonItemImage"><img src="','"/><span>',"</span></div></li>"])),x.value,x.key);return this.renderElementFromTemplate(w,x,S)},t}(oi),$i=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),ti=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},zi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return $i(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(ge||(ge=ti(['\n            <li><span class="jsonItemComponentKey">',': </span>\n                <span class="jsonItemComponentValue">',' (<a href="','" target="_blank" class="jsonSourceItemComponentOpen">Open help page</a>)\n                </span>\n            <li>'],['\n            <li><span class="jsonItemComponentKey">',': </span>\n                <span class="jsonItemComponentValue">',' (<a href="','" target="_blank" class="jsonSourceItemComponentOpen">Open help page</a>)\n                </span>\n            <li>'])),x.key,x.value,x.help);return this.renderElementFromTemplate(w,x,S)},t}(oi),ji=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Xi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return ji(t,x),t.prototype.render=function(x,S){var w=document.createElement("div");if(w.className="jsonVisualStateItemComponent",x.Attachments)for(var U=0,G=x.Attachments;U<G.length;U++){var H=G[U];if(H.src){var z=document.createElement("img");if(z.src=encodeURI(H.src),w.appendChild(z),x.Attachments.length>1){var j=document.createElement("span");j.innerText=H.attachmentName,w.appendChild(j)}}}else{var X=document.createElement("span");X.innerText=x.FrameBufferStatus,w.appendChild(X)}var K=document.createElement("span");return K.innerText=x.FrameBuffer?x.FrameBuffer.__SPECTOR_Object_TAG.displayText:"Canvas frame buffer",w.appendChild(K),w},t}(oi),Ki=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),si=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},qi=function(x){function t(){var S=x.call(this)||this;return S.onCapturesClicked=S.createEvent("onCapturesClicked"),S.onCommandsClicked=S.createEvent("onCommandsClicked"),S.onInformationClicked=S.createEvent("onInformationClicked"),S.onInitStateClicked=S.createEvent("onInitStateClicked"),S.onEndStateClicked=S.createEvent("onEndStateClicked"),S.onCloseClicked=S.createEvent("onCloseClicked"),S.onSearchTextChanged=S.createEvent("onSearchTextChanged"),S.onSearchTextCleared=S.createEvent("onSearchTextCleared"),S}return Ki(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(ve||(ve=si(['<ul class="resultViewMenuComponent">\n                <li class="resultViewMenuOpen resultViewMenuSmall"><a href="#" role="button">Menu</a></li>\n\n                <li class="searchContainer">\n                    <input type="text" placeHolder="Search..." value="','" commandName="onSearchTextChanged" commandEventBinding="change">\n                    <a class="clearSearch" stoppropagation="true" CommandName="onSearchTextCleared">X</a>\n                </li>\n                <li><a class="',' href="#" role="button" commandName="onCapturesClicked">Captures</a></li>\n                <li><a class="',' href="#" role="button" commandName="onInformationClicked">Information</a></li>\n                <li><a class="',' href="#" role="button" commandName="onInitStateClicked">Init State</a></li>\n                <li>\n                    <a class="',' href="#" role="button" commandName="onCommandsClicked">\n                        Commands','\n                    </a>\n                </li>\n                <li><a class="',' href="#" role="button" commandName="onEndStateClicked">End State</a></li>\n                <li><a role="button" commandName="onCloseClicked" stoppropagation="true">Close</a></li>\n            </ul>'],['<ul class="resultViewMenuComponent">\n                <li class="resultViewMenuOpen resultViewMenuSmall"><a href="#" role="button">Menu</a></li>\n\n                <li class="searchContainer">\n                    <input type="text" placeHolder="Search..." value="','" commandName="onSearchTextChanged" commandEventBinding="change">\n                    <a class="clearSearch" stoppropagation="true" CommandName="onSearchTextCleared">X</a>\n                </li>\n                <li><a class="',' href="#" role="button" commandName="onCapturesClicked">Captures</a></li>\n                <li><a class="',' href="#" role="button" commandName="onInformationClicked">Information</a></li>\n                <li><a class="',' href="#" role="button" commandName="onInitStateClicked">Init State</a></li>\n                <li>\n                    <a class="',' href="#" role="button" commandName="onCommandsClicked">\n                        Commands','\n                    </a>\n                </li>\n                <li><a class="',' href="#" role="button" commandName="onEndStateClicked">End State</a></li>\n                <li><a role="button" commandName="onCloseClicked" stoppropagation="true">Close</a></li>\n            </ul>'])),x.searchText,0===x.status?"active":"",10===x.status?"active":"",20===x.status?"active":"",40===x.status?"active":"",x.commandCount>0?" ("+x.commandCount+")":"",30===x.status?"active":""),U=this.renderElementFromTemplate(w,x,S),G=U.querySelector(".resultViewMenuOpen"),H=U.querySelectorAll("li:not(.resultViewMenuSmall)");return G.addEventListener("click",(function(x){if("true"===G.getAttribute("open")){G.setAttribute("open","false");for(var S=0;S<H.length;S++)H[S].style.display="none",H[S].style.visibility="hidden"}else for(G.setAttribute("open","true"),S=0;S<H.length;S++)H[S].style.display="block",H[S].style.visibility="visible"})),U},t}(oi),Yi=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),Zi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Yi(t,x),t.prototype.render=function(x,S){return this.renderElementFromTemplate('<div childrenContainer="true" class="resultViewContentComponent"></div>',x,S)},t}(oi),Ji=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),hi=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},Qi=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return Ji(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(_e||(_e=hi(['\n            <div childrenContainer="true" class="resultViewComponent ','">\n            </div>'],['\n            <div childrenContainer="true" class="resultViewComponent ','">\n            </div>'])),x?"active":"");return this.renderElementFromTemplate(w,x,S)},t}(oi),er=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),mi=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},tr=function(x){function t(){var S=x.call(this)||this;return S.onTranslatedVertexSourceClicked=S.createEvent("onTranslatedVertexSourceClicked"),S.onTranslatedFragmentSourceClicked=S.createEvent("onTranslatedFragmentSourceClicked"),S.onVertexSourceClicked=S.createEvent("onVertexSourceClicked"),S.onFragmentSourceClicked=S.createEvent("onFragmentSourceClicked"),S.onSourceCodeCloseClicked=S.createEvent("onSourceCodeCloseClicked"),S.onSourceCodeChanged=S.createEvent("onSourceCodeChanged"),S}return er(t,x),t.prototype.showError=function(x){if(this.editor){var S=[];if(x=x||"")for(var w=/^.*ERROR:\W([0-9]+):([0-9]+):(.*)$/gm,U=w.exec(x);null!=U;)S.push({row:+U[2]-1,column:U[1],text:U[3]||"Error",type:"error"}),U=w.exec(x);this.editor.getSession().setAnnotations(S)}},t.prototype.render=function(x,S){var w,U=this,G=x.fragment?x.sourceFragment:x.sourceVertex;w=x.translated?x.fragment?x.translatedSourceFragment:x.translatedSourceVertex:G?this._indentIfdef(this._beautify(G)):"";var H=this.htmlTemplate(Ee||(Ee=mi(['\n        <div class="sourceCodeComponentContainer">\n            <div class="sourceCodeMenuComponentContainer">\n                <ul class="sourceCodeMenuComponent">\n                    $',"\n                    $",'\n                    <li><a class="','" href="#" role="button" commandName="onVertexSourceClicked">Vertex</a></li>\n                    <li><a class="','" href="#" role="button" commandName="onFragmentSourceClicked">Fragment</a></li>\n                    <li><a href="#" role="button" commandName="onSourceCodeCloseClicked">Close</a></li>\n                </ul>\n            </div>\n            $',"\n        </div>"],['\n        <div class="sourceCodeComponentContainer">\n            <div class="sourceCodeMenuComponentContainer">\n                <ul class="sourceCodeMenuComponent">\n                    $',"\n                    $",'\n                    <li><a class="','" href="#" role="button" commandName="onVertexSourceClicked">Vertex</a></li>\n                    <li><a class="','" href="#" role="button" commandName="onFragmentSourceClicked">Fragment</a></li>\n                    <li><a href="#" role="button" commandName="onSourceCodeCloseClicked">Close</a></li>\n                </ul>\n            </div>\n            $',"\n        </div>"])),x.translatedSourceVertex?this.htmlTemplate(ye||(ye=mi(['<li><a class="','" href="#" role="button" commandName="onTranslatedVertexSourceClicked">Translated Vertex</a></li>'],['<li><a class="','" href="#" role="button" commandName="onTranslatedVertexSourceClicked">Translated Vertex</a></li>'])),!x.fragment&&x.translated?"active":""):"",x.translatedSourceFragment?this.htmlTemplate(be||(be=mi(['<li><a class="','" href="#" role="button" commandName="onTranslatedFragmentSourceClicked">Translated Fragment</a></li>'],['<li><a class="','" href="#" role="button" commandName="onTranslatedFragmentSourceClicked">Translated Fragment</a></li>'])),x.fragment&&x.translated?"active":""):"",x.fragment||x.translated?"":"active",x.fragment&&!x.translated?"active":"",this.htmlTemplate(xe||(xe=mi(['<div class="sourceCodeComponent">',"</div>"],['<div class="sourceCodeComponent">',"</div>"])),w)),z=this.renderElementFromTemplate(H.replace(/<br>/g,"\n"),x,S);this.editor=ace.edit(z.querySelector(".sourceCodeComponent")),this.editor.setTheme("ace/theme/monokai"),this.editor.getSession().setMode("ace/mode/glsl"),this.editor.setShowPrintMargin(!1);var j=-1;return this.editor.setReadOnly(!x.editable&&!x.translated),this.editor.getSession().on("change",(function(w){-1!==j&&clearTimeout(j),j=setTimeout((function(){U._triggerCompilation(U.editor,x,z,S)}),1500)})),z},t.prototype._triggerCompilation=function(x,S,w,U){S.fragment?S.sourceFragment=x.getValue():S.sourceVertex=x.getValue(),this.triggerEvent("onSourceCodeChanged",w,S,U)},t.prototype._beautify=function(x,S){void 0===S&&(S=0),x=x.trim(),x=this._adaptComments(x);for(var w,U=this._getBracket(x),G=U.firstIteration,H=U.lastIteration,z="",j=0;j<S;j++)z+="    ";if(-1===G)w=x=(x=(x=(x=(x=(x=(x=(x=z+x).replace(/;(?![^\(]*\))\s*(\/\/.*)?/g,(function(x){return x.trim()+"\n"}))).replace(/\s*([*+-/=><\s]*=)\s*/g,(function(x){return" "+x.trim()+" "}))).replace(/\s*(,)\s*/g,(function(x){return x.trim()+" "}))).replace(/\n[ \t]+/g,"\n")).replace(/\n/g,"\n"+z)).replace(/\s+$/g,"")).replace(/\n+$/g,"");else{var X=x.substr(0,G),K=x.substr(H+1,x.length),q=x.substr(G+1,H-G-1).trim(),Y=this._beautify(q,S+1);w=(w=(w=this._beautify(X,S)+" {\n"+Y+"\n"+z+"}\n"+this._beautify(K,S)).replace(/\s*\n+\s*;/g,";")).replace(/#endif[\t \f\v]*{/g,"\n {")}return(w=(w=w.replace(t.semicolonReplacementKeyRegex,";")).replace(t.openCurlyReplacementKeyRegex,"{")).replace(t.closeCurlyReplacementKeyRegex,"}")},t.prototype._adaptComments=function(x){for(var S=!1,w=!1,U=0;U<x.length;U++){var G=x[U];"/"===G?"*"===x[U-1]?w=!1:"*"===x[U+1]?S||(w=!0,U++):"/"===x[U+1]&&(w||(S=!0,U++)):"\n"===G?S=!1:";"===G?(S||w)&&(x=x.substr(0,U)+t.semicolonReplacementKey+x.substr(U+1)):"{"===G?(S||w)&&(x=x.substr(0,U)+t.openCurlyReplacementKey+x.substr(U+1)):"}"===G&&(S||w)&&(x=x.substr(0,U)+t.closeCurlyReplacementKey+x.substr(U+1))}return x},t.prototype._getBracket=function(x,S){void 0===S&&(S=-1);for(var w=x.indexOf("{",S),U=1,G=w,H=0,z=0,j=x.substr(w+1).split("");z<j.length;z++){var X=j[z];if(G++,"{"===X&&U++,"}"===X&&U--,0===U){H=G;break}}return w>-1&&0===H?this._getBracket(x,w+1):{firstIteration:w,lastIteration:H}},t.prototype._indentIfdef=function(x){for(var S=0,w=x.split("\n"),U=0;U<w.length;U++){var G=w[U];-1!==G.indexOf("#endif")&&S--,-1!==G.indexOf("#else")&&S--;for(var H="",z=0;z<S;z++)H+="    ";w[U]=H+G,-1===G.indexOf("#if")&&-1===G.indexOf("#else")||S++}return w.join("\n")},t.semicolonReplacementKey="[[[semicolonReplacementKey]]]",t.semicolonReplacementKeyRegex=new RegExp("\\[\\[\\[semicolonReplacementKey\\]\\]\\]","g"),t.openCurlyReplacementKey="[[[openCurlyReplacementKey]]]",t.openCurlyReplacementKeyRegex=new RegExp("\\[\\[\\[openCurlyReplacementKey\\]\\]\\]","g"),t.closeCurlyReplacementKey="[[[closeCurlyReplacementKey]]]",t.closeCurlyReplacementKeyRegex=new RegExp("\\[\\[\\[closeCurlyReplacementKey\\]\\]\\]","g"),t}(oi),nr=function(){var e=function(x,S){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,S){x.__proto__=S}||function(x,S){for(var w in S)S.hasOwnProperty(w)&&(x[w]=S[w])})(x,S)};return function(x,S){function i(){this.constructor=x}e(x,S),x.prototype=null===S?Object.create(S):(i.prototype=S.prototype,new i)}}(),vi=function(x,S){return Object.defineProperty?Object.defineProperty(x,"raw",{value:S}):x.raw=S,x},ir=function(x){function t(){return null!==x&&x.apply(this,arguments)||this}return nr(t,x),t.prototype.render=function(x,S){var w=this.htmlTemplate(Se||(Se=vi(['\n                <div childrenContainer="true" class="','"></div>'],['\n                <div childrenContainer="true" class="','"></div>'])),x?"informationColumnLeftComponent":"informationColumnRightComponent");return this.renderElementFromTemplate(w,x,S)},t}(oi),rr=function(){function e(){}return e.getMDNLink=function(x){var S=e.WebGL2Functions[x];if(S)return e.WebGL2RootUrl+S;var w=e.WebGLFunctions[x];return w?e.WebGLRootUrl+w:e.WebGLRootUrl+x},e.WebGL2RootUrl="https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/",e.WebGLRootUrl="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/",e.WebGL2Functions={beginQuery:"beginQuery",beginTransformFeedback:"beginTransformFeedback",bindBufferBase:"bindBufferBase",bindBufferRange:"bindBufferRange",bindSampler:"bindSampler",bindTransformFeedback:"bindTransformFeedback",bindVertexArray:"bindVertexArray",blitFramebuffer:"blitFramebuffer",clearBufferfv:"clearBuffer",clearBufferiv:"clearBuffer",clearBufferuiv:"clearBuffer",clearBufferfi:"clearBuffer",clientWaitSync:"clientWaitSync",compressedTexImage3D:"compressedTexImage3D",compressedTexSubImage3D:"compressedTexSubImage3D",copyBufferSubData:"copyBufferSubData",copyTexSubImage3D:"copyTexSubImage3D",createQuery:"createQuery",createSampler:"createSampler",createTransformFeedback:"createTransformFeedback",createVertexArray:"createVertexArray",deleteQuery:"deleteQuery",deleteSampler:"deleteSampler",deleteSync:"deleteSync",deleteTransformFeedback:"deleteTransformFeedback",deleteVertexArray:"deleteVertexArray",drawArraysInstanced:"drawArraysInstanced",drawBuffers:"drawBuffers",drawElementsInstanced:"drawElementsInstanced",drawRangeElements:"drawRangeElements",endQuery:"endQuery",endTransformFeedback:"endTransformFeedback",fenceSync:"fenceSync",framebufferTextureLayer:"framebufferTextureLayer",getActiveUniformBlockName:"getActiveUniformBlockName",getActiveUniformBlockParameter:"getActiveUniformBlockParameter",getActiveUniforms:"getActiveUniforms",getBufferSubData:"getBufferSubData",getFragDataLocation:"getFragDataLocation",getIndexedParameter:"getIndexedParameter",getInternalformatParameter:"getInternalformatParameter",getQuery:"getQuery",getQueryParameter:"getQueryParameter",getSamplerParameter:"getSamplerParameter",getSyncParameter:"getSyncParameter",getTransformFeedbackVarying:"getTransformFeedbackVarying",getUniformBlockIndex:"getUniformBlockIndex",getUniformIndices:"getUniformIndices",invalidateFramebuffer:"invalidateFramebuffer",invalidateSubFramebuffer:"invalidateSubFramebuffer",isQuery:"isQuery",isSampler:"isSampler",isSync:"isSync",isTransformFeedback:"isTransformFeedback",isVertexArray:"isVertexArray",pauseTransformFeedback:"pauseTransformFeedback",readBuffer:"readBuffer",renderbufferStorageMultisample:"renderbufferStorageMultisample",resumeTransformFeedback:"resumeTransformFeedback",samplerParameteri:"samplerParameter",samplerParameterf:"samplerParameter",texImage3D:"texImage3D",texStorage2D:"texStorage2D",texStorage3D:"texStorage3D",texSubImage3D:"texSubImage3D",transformFeedbackVaryings:"transformFeedbackVaryings",uniform1ui:"uniform",uniform2ui:"uniform",uniform3ui:"uniform",uniform4ui:"uniform",uniform1fv:"uniform",uniform2fv:"uniform",uniform3fv:"uniform",uniform4fv:"uniform",uniform1iv:"uniform",uniform2iv:"uniform",uniform3iv:"uniform",uniform4iv:"uniform",uniform1uiv:"uniform",uniform2uiv:"uniform",uniform3uiv:"uniform",uniform4uiv:"uniform",uniformBlockBinding:"uniformBlockBinding",uniformMatrix2fv:"uniformMatrix",uniformMatrix3x2fv:"uniformMatrix",uniformMatrix4x2fv:"uniformMatrix",uniformMatrix2x3fv:"uniformMatrix",uniformMatrix3fv:"uniformMatrix",uniformMatrix4x3fv:"uniformMatrix",uniformMatrix2x4fv:"uniformMatrix",uniformMatrix3x4fv:"uniformMatrix",uniformMatrix4fv:"uniformMatrix",vertexAttribDivisor:"vertexAttribDivisor",vertexAttribI4i:"vertexAttribI",vertexAttribI4ui:"vertexAttribI",vertexAttribI4iv:"vertexAttribI",vertexAttribI4uiv:"vertexAttribI",vertexAttribIPointer:"vertexAttribIPointer",waitSync:"waitSync"},e.WebGLFunctions={uniform1f:"uniform",uniform1fv:"uniform",uniform1i:"uniform",uniform1iv:"uniform",uniform2f:"uniform",uniform2fv:"uniform",uniform2i:"uniform",uniform2iv:"uniform",uniform3f:"uniform",uniform3i:"uniform",uniform3iv:"uniform",uniform4f:"uniform",uniform4fv:"uniform",uniform4i:"uniform",uniform4iv:"uniform",uniformMatrix2fv:"uniformMatrix",uniformMatrix3fv:"uniformMatrix",uniformMatrix4fv:"uniformMatrix",vertexAttrib1f:"vertexAttrib",vertexAttrib2f:"vertexAttrib",vertexAttrib3f:"vertexAttrib",vertexAttrib4f:"vertexAttrib",vertexAttrib1fv:"vertexAttrib",vertexAttrib2fv:"vertexAttrib",vertexAttrib3fv:"vertexAttrib",vertexAttrib4fv:"vertexAttrib"},e}(),or=function(){function e(x){var S=this;void 0===x&&(x=null),this.rootPlaceHolder=x,this.onSourceCodeChanged=new j,this.rootPlaceHolder=this.rootPlaceHolder||document.body,this.mvx=new ii(this.rootPlaceHolder),this.searchText="",this.currentCommandId=-1,this.visible=!1,this.commandCount=0,this.commandListStateId=-1,this.commandDetailStateId=-1,this.currentCaptureStateId=-1,this.currentCommandStateId=-1,this.currentVisualStateId=-1,this.visualStateListStateId=-1,this.initVisualStateId=-1,this.sourceCodeComponentStateId=-1,this.captureListComponent=new Ei,this.captureListItemComponent=new wi,this.visualStateListComponent=new Ci,this.visualStateListItemComponent=new Ri,this.commandListComponent=new Ii,this.commandListItemComponent=new Fi,this.commandDetailComponent=new Ni,this.jsonContentComponent=new Di,this.jsonGroupComponent=new Ui,this.jsonItemComponent=new Vi,this.jsonImageItemComponent=new Wi,this.jsonHelpItemComponent=new zi,this.jsonVisualStateItemComponent=new Xi,this.resultViewMenuComponent=new qi,this.resultViewContentComponent=new Zi,this.resultViewComponent=new Qi,this.sourceCodeComponent=new tr,this.informationColumnComponent=new ir,this.rootStateId=this.mvx.addRootState(null,this.resultViewComponent),this.menuStateId=this.mvx.addChildState(this.rootStateId,null,this.resultViewMenuComponent),this.contentStateId=this.mvx.addChildState(this.rootStateId,null,this.resultViewContentComponent),this.captureListStateId=this.mvx.addChildState(this.rootStateId,!1,this.captureListComponent),this.initKeyboardEvents(),this.initMenuComponent(),this.captureListComponent.onCaptureLoaded.add((function(x){S.addCapture(x)})),this.captureListItemComponent.onCaptureSelected.add((function(x){S.selectCapture(x.stateId)})),this.captureListItemComponent.onSaveRequested.add((function(x){S.saveCapture(x.state.capture)})),this.visualStateListItemComponent.onVisualStateSelected.add((function(x){S.selectVisualState(x.stateId)})),this.commandListItemComponent.onCommandSelected.add((function(x){S.selectCommand(x.stateId)})),this.commandListItemComponent.onVertexSelected.add((function(x){S.selectCommand(x.stateId),S.openShader(!1)})),this.commandListItemComponent.onFragmentSelected.add((function(x){S.selectCommand(x.stateId),S.openShader(!0)})),this.sourceCodeComponent.onSourceCodeCloseClicked.add((function(){S.displayCurrentCapture()})),this.sourceCodeComponent.onTranslatedVertexSourceClicked.add((function(x){var w=S.mvx.getGenericState(S.sourceCodeComponentStateId);w.fragment=!1,w.translated=!0,S.mvx.updateState(S.sourceCodeComponentStateId,w)})),this.sourceCodeComponent.onTranslatedFragmentSourceClicked.add((function(x){var w=S.mvx.getGenericState(S.sourceCodeComponentStateId);w.fragment=!0,w.translated=!0,S.mvx.updateState(S.sourceCodeComponentStateId,w)})),this.sourceCodeComponent.onVertexSourceClicked.add((function(x){var w=S.mvx.getGenericState(S.sourceCodeComponentStateId);w.fragment=!1,w.translated=!1,S.mvx.updateState(S.sourceCodeComponentStateId,w)})),this.sourceCodeComponent.onFragmentSourceClicked.add((function(x){var w=S.mvx.getGenericState(S.sourceCodeComponentStateId);w.fragment=!0,w.translated=!1,S.mvx.updateState(S.sourceCodeComponentStateId,w)})),this.sourceCodeComponent.onSourceCodeChanged.add((function(x){S.onSourceCodeChanged.trigger({programId:x.state.programId,sourceFragment:x.state.sourceFragment,sourceVertex:x.state.sourceVertex,translatedSourceFragment:x.state.translatedSourceFragment,translatedSourceVertex:x.state.translatedSourceVertex})})),this.updateViewState()}return e.prototype.saveCapture=function(x){var S=JSON.stringify(x,null,4),w=new Blob([S],{type:"octet/stream"}),U="capture "+new Date(x.startTime).toTimeString().split(" ")[0]+".json";if(navigator.msSaveBlob)navigator.msSaveBlob(w,U);else{var G=document.createElement("a"),H=window.URL.createObjectURL(w);G.setAttribute("href",H),G.setAttribute("download",U),G.click()}},e.prototype.selectCapture=function(x){this.currentCommandId=-1,this.currentCaptureStateId=x,this.displayCurrentCapture()},e.prototype.selectCommand=function(x){this.currentCommandStateId=x,this.currentVisualStateId=this.displayCurrentCommand(),this.displayCurrentVisualState()},e.prototype.selectVisualState=function(x){this.currentVisualStateId=x,this.currentCommandStateId=this.displayCurrentVisualState(),this.displayCurrentCommand()},e.prototype.display=function(){this.visible=!0,this.updateViewState()},e.prototype.hide=function(){this.visible=!1,this.updateViewState()},e.prototype.addCapture=function(x){var S=this.mvx.insertChildState(this.captureListStateId,{capture:x,active:!1},0,this.captureListItemComponent);return this.selectCapture(S),S},e.prototype.showSourceCodeError=function(x){this.sourceCodeComponent.showError(x)},e.prototype.initKeyboardEvents=function(){var x=this;this.rootPlaceHolder.addEventListener("keydown",(function(S){40===x.mvx.getGenericState(x.menuStateId).status&&(38===S.keyCode?(S.preventDefault(),S.stopPropagation(),x.selectPreviousCommand()):40===S.keyCode?(S.preventDefault(),S.stopPropagation(),x.selectNextCommand()):33===S.keyCode?(S.preventDefault(),S.stopPropagation(),x.selectPreviousVisualState()):34===S.keyCode&&(S.preventDefault(),S.stopPropagation(),x.selectNextVisualState()))}))},e.prototype.openShader=function(x){this.mvx.removeChildrenStates(this.contentStateId);var S=this.mvx.getGenericState(this.currentCommandStateId);this.sourceCodeComponentStateId=this.mvx.addChildState(this.contentStateId,{programId:S.capture.DrawCall.programStatus.program.__SPECTOR_Object_TAG.id,nameVertex:S.capture.DrawCall.shaders[0].name,nameFragment:S.capture.DrawCall.shaders[1].name,sourceVertex:S.capture.DrawCall.shaders[0].source,sourceFragment:S.capture.DrawCall.shaders[1].source,translatedSourceVertex:S.capture.DrawCall.shaders[0].translatedSource,translatedSourceFragment:S.capture.DrawCall.shaders[1].translatedSource,fragment:x,translated:!1,editable:S.capture.DrawCall.programStatus.RECOMPILABLE},this.sourceCodeComponent),this.commandDetailStateId=this.mvx.addChildState(this.contentStateId,null,this.commandDetailComponent),this.displayCurrentCommandDetail(S)},e.prototype.selectPreviousCommand=function(){var x=this.mvx.getGenericState(this.currentCommandStateId);x.previousCommandStateId<0||this.selectCommand(x.previousCommandStateId)},e.prototype.selectNextCommand=function(){var x=this.mvx.getGenericState(this.currentCommandStateId);x.nextCommandStateId<0||this.selectCommand(x.nextCommandStateId)},e.prototype.selectPreviousVisualState=function(){var x=this.mvx.getGenericState(this.currentVisualStateId);x.previousVisualStateId<0||this.selectVisualState(x.previousVisualStateId)},e.prototype.selectNextVisualState=function(){var x=this.mvx.getGenericState(this.currentVisualStateId);x.nextVisualStateId<0||this.selectVisualState(x.nextVisualStateId)},e.prototype.initMenuComponent=function(){var x=this;this.mvx.updateState(this.menuStateId,{status:0,searchText:this.searchText,commandCount:0}),this.resultViewMenuComponent.onCloseClicked.add((function(S){x.hide()})),this.resultViewMenuComponent.onCapturesClicked.add((function(S){x.displayCaptures()})),this.resultViewMenuComponent.onCommandsClicked.add((function(S){x.displayCurrentCapture()})),this.resultViewMenuComponent.onInformationClicked.add((function(S){x.displayInformation()})),this.resultViewMenuComponent.onInitStateClicked.add((function(S){x.displayInitState()})),this.resultViewMenuComponent.onEndStateClicked.add((function(S){x.displayEndState()})),this.resultViewMenuComponent.onSearchTextChanged.add((function(S){x.search(S.sender.value)})),this.resultViewMenuComponent.onSearchTextCleared.add((function(S){x.mvx.updateState(x.menuStateId,{status:S.state.status,searchText:"",commandCount:S.state.commandCount}),x.search("")}))},e.prototype.onCaptureRelatedAction=function(x){var S=this.mvx.getGenericState(this.currentCaptureStateId);return this.commandCount=S.capture.commands.length,this.mvx.removeChildrenStates(this.contentStateId),this.mvx.updateState(this.menuStateId,{status:x,searchText:this.searchText,commandCount:this.commandCount}),this.mvx.getGenericState(this.captureListStateId)&&this.mvx.updateState(this.captureListStateId,!1),S.capture},e.prototype.displayCaptures=function(){this.mvx.updateState(this.menuStateId,{status:0,searchText:this.searchText,commandCount:this.commandCount}),this.mvx.updateState(this.captureListStateId,!0)},e.prototype.displayInformation=function(){var x=this.onCaptureRelatedAction(10),S=this.mvx.addChildState(this.contentStateId,!0,this.informationColumnComponent),w=this.mvx.addChildState(this.contentStateId,!1,this.informationColumnComponent),U=this.mvx.addChildState(S,null,this.jsonContentComponent);this.displayJSONGroup(U,"Canvas",x.canvas),this.displayJSONGroup(U,"Context",x.context);for(var G=this.mvx.addChildState(w,null,this.jsonContentComponent),H=0,z=x.analyses;H<z.length;H++){var j=z[H];this.displayJSONGroup(G,j.analyserName,j)}this.displayJSONGroup(G,"Frame Memory Changes",x.frameMemory),this.displayJSONGroup(G,"Total Memory (seconds since application start: bytes)",x.memory)},e.prototype.displayJSON=function(x,S){for(var w in S.VisualState&&this.mvx.addChildState(x,S.VisualState,this.jsonVisualStateItemComponent),S)if("VisualState"!==w&&"analyserName"!==w&&"source"!==w&&"translatedSource"!==w){var U=S[w];if("visual"===w)for(var G in U)U.hasOwnProperty(G)&&U[G]&&this.mvx.addChildState(x,{key:G,value:U[G]},this.jsonImageItemComponent);else{var H=this.getJSONAsString(x,w,U);if(null==H)continue;if(this.toFilter(w)&&this.toFilter(U))continue;this.mvx.addChildState(x,{key:w,value:H},this.jsonItemComponent)}U&&U.__SPECTOR_Metadata&&this.displayJSONGroup(x,"Metadata",U.__SPECTOR_Metadata)}},e.prototype.getJSONAsString=function(x,S,w){if(null===w)return"null";if(void 0===w)return"undefined";if("number"==typeof w)return Math.floor(w)===w?w.toFixed(0):w.toFixed(4);if("string"==typeof w)return w;if("boolean"==typeof w)return w?"true":"false";if(0===w.length)return"Empty Array";if(w.length){for(var U=[],G=0;G<w.length;G++){var H=this.getJSONAsString(x,S+"("+G.toFixed(0)+")",w[G]);null!==H&&U.push(H)}return 0===U.length?null:U.join(", ")}return w.help?(this.mvx.addChildState(x,{key:S,value:w.name,help:w.help},this.jsonHelpItemComponent),null):w.__SPECTOR_Object_TAG?w.__SPECTOR_Object_TAG.displayText:w.displayText?w.displayText:("object"==typeof w&&this.displayJSONGroup(x,S,w),null)},e.prototype.displayJSONGroup=function(x,S,w){if(w){var U=this.mvx.addChildState(x,S,this.jsonGroupComponent);this.displayJSON(U,w),this.mvx.hasChildren(U)||this.mvx.removeState(U)}},e.prototype.displayInitState=function(){var x=this.onCaptureRelatedAction(20),S=this.mvx.addChildState(this.contentStateId,null,this.jsonContentComponent);this.displayJSON(S,x.initState)},e.prototype.displayEndState=function(){var x=this.onCaptureRelatedAction(30),S=this.mvx.addChildState(this.contentStateId,null,this.jsonContentComponent);this.displayJSON(S,x.endState)},e.prototype.displayCurrentCapture=function(){var x=this.onCaptureRelatedAction(40);this.mvx.updateAllChildrenGenericState(this.captureListStateId,(function(x){return x.active=!1,x})),this.mvx.updateState(this.currentCaptureStateId,{capture:x,active:!0}),this.createVisualStates(x),this.commandListStateId=this.mvx.addChildState(this.contentStateId,null,this.commandListComponent),this.commandDetailStateId=this.mvx.addChildState(this.contentStateId,null,this.commandDetailComponent),this.createCommands(x)},e.prototype.displayCurrentCommand=function(){if(40!==this.mvx.getGenericState(this.menuStateId).status)return-1;var x=this.mvx.getGenericState(this.currentCommandStateId),S=x.capture;return this.currentCommandId=S.id,this.mvx.updateAllChildrenGenericState(this.commandListStateId,(function(x){return x.active=!1,x})),this.mvx.updateState(this.currentCommandStateId,{capture:S,visualStateId:x.visualStateId,previousCommandStateId:x.previousCommandStateId,nextCommandStateId:x.nextCommandStateId,active:!0}),this.displayCurrentCommandDetail(x)},e.prototype.displayCurrentCommandDetail=function(x){var S=x.capture;this.mvx.removeChildrenStates(this.commandDetailStateId);var w=this.mvx.getGenericState(x.visualStateId);this.mvx.addChildState(this.commandDetailStateId,w.VisualState,this.jsonVisualStateItemComponent);var U="Unknown";switch(S.status){case 50:U="Deprecated";break;case 10:U="Unused";break;case 20:U="Disabled";break;case 30:U="Redundant";break;case 40:U="Valid"}var G=rr.getMDNLink(S.name);for(var H in S.result?this.displayJSONGroup(this.commandDetailStateId,"Global",{name:{help:G,name:S.name},duration:S.commandEndTime-S.startTime,result:S.result,status:U}):this.displayJSONGroup(this.commandDetailStateId,"Global",{name:{help:G,name:S.name},duration:S.commandEndTime-S.startTime,status:U}),S)"VisualState"!==H&&"result"!==H&&"object"==typeof S[H]&&this.displayJSONGroup(this.commandDetailStateId,H,S[H]);return x.visualStateId},e.prototype.displayCurrentVisualState=function(){if(40!==this.mvx.getGenericState(this.menuStateId).status)return null;var x=this.mvx.getGenericState(this.currentVisualStateId);return x.commandStateId===Number.MIN_VALUE?this.displayInitState():x.commandStateId===Number.MAX_VALUE&&this.displayEndState(),this.mvx.updateAllChildrenGenericState(this.visualStateListStateId,(function(x){return x.active=!1,x})),x.active=!0,this.mvx.updateState(this.currentVisualStateId,x),x.commandStateId},e.prototype.createVisualStates=function(x){this.visualStateListStateId=this.mvx.addChildState(this.contentStateId,null,this.visualStateListComponent),this.mvx.removeChildrenStates(this.visualStateListStateId),this.initVisualStateId=this.mvx.addChildState(this.visualStateListStateId,{VisualState:x.initState.VisualState,time:x.startTime,commandStateId:Number.MIN_VALUE,active:!1},this.visualStateListItemComponent)},e.prototype.createCommands=function(x){this.mvx.removeChildrenStates(this.commandListStateId);for(var S=this.initVisualStateId,w=!1,U=null,G=-1,H=null,z=-1,j=0;j<x.commands.length;j++){var X=x.commands[j];if(!this.toFilter(X.marker)||!this.toFilter(X.name)||X.id===this.currentCommandId){var K={capture:X,previousCommandStateId:G,nextCommandStateId:-1,visualStateId:void 0,active:!1},q=this.mvx.addChildState(this.commandListStateId,K,this.commandListItemComponent);if(U&&((U=this.mvx.getGenericState(G)).nextCommandStateId=q,this.mvx.updateState(G,U)),G=q,U=K,X.VisualState){var Y={VisualState:X.VisualState,time:X.endTime,commandStateId:q,active:!1,previousVisualStateId:z,nextVisualStateId:-1};S=this.mvx.addChildState(this.visualStateListStateId,Y,this.visualStateListItemComponent),H&&((H=this.mvx.getGenericState(z)).nextVisualStateId=S,this.mvx.updateState(z,H)),H=Y,z=S,w=!0}else if(!w){var Z=this.mvx.getGenericState(this.initVisualStateId);Z.commandStateId=q,Z.previousVisualStateId=-1,Z.nextVisualStateId=-1,this.mvx.updateState(this.initVisualStateId,Z),H=Z,z=S,w=!0}K.visualStateId=S,this.mvx.updateState(q,K),(-1===this.currentCommandId&&0===j||this.currentCommandId===X.id)&&(this.currentCommandStateId=q,this.displayCurrentCommand(),this.currentVisualStateId=S,this.displayCurrentVisualState())}}},e.prototype.updateViewState=function(){this.mvx.updateState(this.rootStateId,this.visible)},e.prototype.toFilter=function(x){return x=(x+="").toLowerCase(),!!(this.searchText&&this.searchText.length>2&&-1===x.indexOf(this.searchText.toLowerCase()))},e.prototype.search=function(x){switch(this.searchText=x,this.mvx.getGenericState(this.menuStateId).status){case 0:case 40:this.displayCurrentCapture();break;case 30:this.displayEndState();break;case 10:this.displayInformation();break;case 20:this.displayInitState()}this.searchText=""},e}(),ar={CaptureMenu:bi,ResultView:or},sr=function(){function e(){this.noFrameTimeout=-1,this.captureNextFrames=0,this.captureNextCommands=0,this.quickCapture=!1,this.fullCapture=!1,this.retry=0,this.contexts=[],this.timeSpy=new qn,this.onCaptureStarted=new j,this.onCapture=new j,this.onError=new j,this.timeSpy.onFrameStart.add(this.onFrameStart,this),this.timeSpy.onFrameEnd.add(this.onFrameEnd,this),this.timeSpy.onError.add(this.onErrorInternal,this)}return e.getFirstAvailable3dContext=function(x){return this.tryGetContextFromHelperField(x)||this.tryGetContextFromCanvas(x,"webgl")||this.tryGetContextFromCanvas(x,"experimental-webgl")||this.tryGetContextFromCanvas(x,"webgl2")||this.tryGetContextFromCanvas(x,"experimental-webgl2")},e.tryGetContextFromHelperField=function(x){var S=x instanceof HTMLCanvasElement?x.getAttribute("__spector_context_type"):x.__spector_context_type;if(S)return this.tryGetContextFromCanvas(x,S)},e.tryGetContextFromCanvas=function(x,S){var w;try{w=x.getContext(S)}catch(x){}return w},e.prototype.displayUI=function(x){var S=this;void 0===x&&(x=!1),this.captureMenu||(this.getCaptureUI(),this.captureMenu.onPauseRequested.add(this.pause,this),this.captureMenu.onPlayRequested.add(this.play,this),this.captureMenu.onPlayNextFrameRequested.add(this.playNextFrame,this),this.captureMenu.onCaptureRequested.add((function(x){x&&S.captureCanvas(x.ref)}),this),setInterval((function(){S.captureMenu.setFPS(S.getFps())}),1e3),x||this.captureMenu.trackPageCanvases(),this.captureMenu.display()),this.resultView||(this.getResultUI(),this.onCapture.add((function(x){S.resultView.display(),S.resultView.addCapture(x)})))},e.prototype.getResultUI=function(){var x=this;return this.resultView||(this.resultView=new or,this.resultView.onSourceCodeChanged.add((function(S){x.rebuildProgramFromProgramId(S.programId,S.sourceVertex,S.sourceFragment,(function(w){x.referenceNewProgram(S.programId,w),x.resultView.showSourceCodeError(null)}),(function(S){x.resultView.showSourceCodeError(S)}))}))),this.resultView},e.prototype.getCaptureUI=function(){return this.captureMenu||(this.captureMenu=new bi),this.captureMenu},e.prototype.rebuildProgramFromProgramId=function(x,S,w,U,G){var H=an.getFromGlobalStore(x);this.rebuildProgram(H,S,w,U,G)},e.prototype.rebuildProgram=function(x,S,w,U,H){G.rebuildProgram(x,S,w,U,H)},e.prototype.referenceNewProgram=function(x,S){an.updateInGlobalStore(x,S)},e.prototype.pause=function(){this.timeSpy.changeSpeedRatio(0)},e.prototype.play=function(){this.timeSpy.changeSpeedRatio(1)},e.prototype.playNextFrame=function(){this.timeSpy.playNextFrame()},e.prototype.drawOnlyEveryXFrame=function(x){this.timeSpy.changeSpeedRatio(x)},e.prototype.getFps=function(){return this.timeSpy.getFps()},e.prototype.spyCanvases=function(){this.canvasSpy?this.onErrorInternal("Already spying canvas."):(this.canvasSpy=new Zn,this.canvasSpy.onContextRequested.add(this.spyContext,this))},e.prototype.spyCanvas=function(x){this.canvasSpy?this.onErrorInternal("Already spying canvas."):(this.canvasSpy=new Zn(x),this.canvasSpy.onContextRequested.add(this.spyContext,this))},e.prototype.getAvailableContexts=function(){return this.getAvailableContexts()},e.prototype.captureCanvas=function(x,S,w,U){void 0===S&&(S=0),void 0===w&&(w=!1),void 0===U&&(U=!1);var G=this.getAvailableContextSpyByCanvas(x);if(G)this.captureContextSpy(G,S,w,U);else{var H=e.getFirstAvailable3dContext(x);H?this.captureContext(H,S,w,U):z.error("No webgl context available on the chosen canvas.")}},e.prototype.captureContext=function(x,S,w,U){void 0===S&&(S=0),void 0===w&&(w=!1),void 0===U&&(U=!1);var G=this.getAvailableContextSpyByCanvas(x.canvas);G||((G=x.getIndexedParameter?new Kn({context:x,version:2,recordAlways:!1}):new Kn({context:x,version:1,recordAlways:!1})).onMaxCommand.add(this.stopCapture,this),this.contexts.push({canvas:G.context.canvas,contextSpy:G})),G&&this.captureContextSpy(G,S,w,U)},e.prototype.captureContextSpy=function(x,S,w,U){var G=this;void 0===S&&(S=0),void 0===w&&(w=!1),void 0===U&&(U=!1),this.quickCapture=w,this.fullCapture=U,this.capturingContext?this.onErrorInternal("Already capturing a context."):(this.retry=0,this.capturingContext=x,this.capturingContext.setMarker(this.marker),(S=Math.min(S,5e3))>0?this.captureCommands(S):this.captureFrames(1),this.noFrameTimeout=setTimeout((function(){S>0?G.stopCapture():G.capturingContext&&G.retry>1?G.onErrorInternal("No frames with gl commands detected. Try moving the camera."):G.onErrorInternal("No frames detected. Try moving the camera or implementing requestAnimationFrame.")}),1e4))},e.prototype.captureNextFrame=function(x,S,w){void 0===S&&(S=!1),void 0===w&&(w=!1),x instanceof HTMLCanvasElement||self.OffscreenCanvas&&x instanceof OffscreenCanvas?this.captureCanvas(x,0,S,w):this.captureContext(x,0,S,w)},e.prototype.startCapture=function(x,S,w,U){void 0===w&&(w=!1),void 0===U&&(U=!1),x instanceof HTMLCanvasElement||self.OffscreenCanvas&&x instanceof OffscreenCanvas?this.captureCanvas(x,S,w,U):this.captureContext(x,S,w,U)},e.prototype.stopCapture=function(){if(this.capturingContext){var x=this.capturingContext.stopCapture();if(x.commands.length>0)return this.noFrameTimeout>-1&&clearTimeout(this.noFrameTimeout),this.triggerCapture(x),this.capturingContext=void 0,this.captureNextFrames=0,this.captureNextCommands=0,x;0===this.captureNextCommands&&(this.retry++,this.captureFrames(1))}},e.prototype.setMarker=function(x){this.marker=x,this.capturingContext&&this.capturingContext.setMarker(x)},e.prototype.clearMarker=function(){this.marker=null,this.capturingContext&&this.capturingContext.clearMarker()},e.prototype.captureFrames=function(x){this.captureNextFrames=x,this.captureNextCommands=0,this.playNextFrame()},e.prototype.captureCommands=function(x){this.captureNextFrames=0,this.captureNextCommands=x,this.play(),this.capturingContext?(this.onCaptureStarted.trigger(void 0),this.capturingContext.startCapture(x,this.quickCapture,this.fullCapture)):(this.onErrorInternal("No context to capture from."),this.captureNextCommands=0)},e.prototype.spyContext=function(x){var S=this.getAvailableContextSpyByCanvas(x.context.canvas);S||((S=new Kn({context:x.context,version:x.contextVersion,recordAlways:!0})).onMaxCommand.add(this.stopCapture,this),this.contexts.push({canvas:S.context.canvas,contextSpy:S})),S.spy()},e.prototype.getAvailableContextSpyByCanvas=function(x){for(var S=0,w=this.contexts;S<w.length;S++){var U=w[S];if(U.canvas===x)return U.contextSpy}},e.prototype.onFrameStart=function(){this.captureNextCommands>0||(this.captureNextFrames>0?(this.capturingContext&&(this.onCaptureStarted.trigger(void 0),this.capturingContext.startCapture(0,this.quickCapture,this.fullCapture)),this.captureNextFrames--):this.capturingContext=void 0)},e.prototype.onFrameEnd=function(){this.captureNextCommands>0||0===this.captureNextFrames&&this.stopCapture()},e.prototype.triggerCapture=function(x){this.captureMenu&&this.captureMenu.captureComplete(null),this.onCapture.trigger(x)},e.prototype.onErrorInternal=function(x){if(z.error(x),this.noFrameTimeout>-1&&clearTimeout(this.noFrameTimeout),!this.capturingContext)throw x;this.capturingContext=void 0,this.captureNextFrames=0,this.captureNextCommands=0,this.retry=0,this.captureMenu&&this.captureMenu.captureComplete(x),this.onError.trigger(x)},e}()}])},792:function(x){x.exports=function(){"use strict";var c=function(){var x=0,S=document.createElement("div");function e(x){return S.appendChild(x.dom),x}function t(w){for(var U=0;U<S.children.length;U++)S.children[U].style.display=U===w?"block":"none";x=w}S.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",S.addEventListener("click",(function(w){w.preventDefault(),t(++x%S.children.length)}),!1);var w=(performance||Date).now(),U=w,G=0,H=e(new c.Panel("FPS","#0ff","#002")),z=e(new c.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var j=e(new c.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:S,addPanel:e,showPanel:t,begin:function(){w=(performance||Date).now()},end:function(){G++;var x=(performance||Date).now();if(z.update(x-w,200),U+1e3<=x&&(H.update(1e3*G/(x-U),100),U=x,G=0,j)){var S=performance.memory;j.update(S.usedJSHeapSize/1048576,S.jsHeapSizeLimit/1048576)}return x},update:function(){w=this.end()},domElement:S,setMode:t}};return c.Panel=function(x,S,w){var U=1/0,G=0,H=Math.round,z=H(window.devicePixelRatio||1),j=80*z,X=48*z,K=3*z,q=2*z,Y=3*z,Z=15*z,J=74*z,Q=30*z,ee=document.createElement("canvas");ee.width=j,ee.height=X,ee.style.cssText="width:80px;height:48px";var te=ee.getContext("2d");return te.font="bold "+9*z+"px Helvetica,Arial,sans-serif",te.textBaseline="top",te.fillStyle=w,te.fillRect(0,0,j,X),te.fillStyle=S,te.fillText(x,K,q),te.fillRect(Y,Z,J,Q),te.fillStyle=w,te.globalAlpha=.9,te.fillRect(Y,Z,J,Q),{dom:ee,update:function(X,ne){U=Math.min(U,X),G=Math.max(G,X),te.fillStyle=w,te.globalAlpha=1,te.fillRect(0,0,j,Z),te.fillStyle=S,te.fillText(H(X)+" "+x+" ("+H(U)+"-"+H(G)+")",K,q),te.drawImage(ee,Y+z,Z,J-z,Q,Y,Z,J-z,Q),te.fillRect(Y+J-z,Z,z,Q),te.fillStyle=w,te.globalAlpha=.9,te.fillRect(Y+J-z,Z,z,H((1-X/ne)*Q))}}},c}()},581:(x,S,w)=>{var U=w(212);U.OrbitControls=function(x,S){var w,G,H,z,j;void 0===S&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),S===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=x,this.domElement=S,this.enabled=!0,this.target=new U.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:U.MOUSE.ROTATE,MIDDLE:U.MOUSE.DOLLY,RIGHT:U.MOUSE.PAN},this.touches={ONE:U.TOUCH.ROTATE,TWO:U.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return ee.phi},this.getAzimuthalAngle=function(){return ee.theta},this.saveState=function(){X.target0.copy(X.target),X.position0.copy(X.object.position),X.zoom0=X.object.zoom},this.reset=function(){X.target.copy(X.target0),X.object.position.copy(X.position0),X.object.zoom=X.zoom0,X.object.updateProjectionMatrix(),X.dispatchEvent(K),X.update(),J=Z.NONE},this.update=(w=new U.Vector3,G=(new U.Quaternion).setFromUnitVectors(x.up,new U.Vector3(0,1,0)),H=G.clone().inverse(),z=new U.Vector3,j=new U.Quaternion,function update(){var x=X.object.position;return w.copy(x).sub(X.target),w.applyQuaternion(G),ee.setFromVector3(w),X.autoRotate&&J===Z.NONE&&rotateLeft(function getAutoRotationAngle(){return 2*Math.PI/60/60*X.autoRotateSpeed}()),X.enableDamping?(ee.theta+=te.theta*X.dampingFactor,ee.phi+=te.phi*X.dampingFactor):(ee.theta+=te.theta,ee.phi+=te.phi),ee.theta=Math.max(X.minAzimuthAngle,Math.min(X.maxAzimuthAngle,ee.theta)),ee.phi=Math.max(X.minPolarAngle,Math.min(X.maxPolarAngle,ee.phi)),ee.makeSafe(),ee.radius*=ne,ee.radius=Math.max(X.minDistance,Math.min(X.maxDistance,ee.radius)),!0===X.enableDamping?X.target.addScaledVector(ie,X.dampingFactor):X.target.add(ie),w.setFromSpherical(ee),w.applyQuaternion(H),x.copy(X.target).add(w),X.object.lookAt(X.target),!0===X.enableDamping?(te.theta*=1-X.dampingFactor,te.phi*=1-X.dampingFactor,ie.multiplyScalar(1-X.dampingFactor)):(te.set(0,0,0),ie.set(0,0,0)),ne=1,!!(re||z.distanceToSquared(X.object.position)>Q||8*(1-j.dot(X.object.quaternion))>Q)&&(X.dispatchEvent(K),z.copy(X.object.position),j.copy(X.object.quaternion),re=!1,!0)}),this.dispose=function(){X.domElement.removeEventListener("contextmenu",onContextMenu,!1),X.domElement.removeEventListener("mousedown",onMouseDown,!1),X.domElement.removeEventListener("wheel",onMouseWheel,!1),X.domElement.removeEventListener("touchstart",onTouchStart,!1),X.domElement.removeEventListener("touchend",onTouchEnd,!1),X.domElement.removeEventListener("touchmove",onTouchMove,!1),document.removeEventListener("mousemove",onMouseMove,!1),document.removeEventListener("mouseup",onMouseUp,!1),X.domElement.removeEventListener("keydown",onKeyDown,!1)};var X=this,K={type:"change"},q={type:"start"},Y={type:"end"},Z={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},J=Z.NONE,Q=1e-6,ee=new U.Spherical,te=new U.Spherical,ne=1,ie=new U.Vector3,re=!1,oe=new U.Vector2,ae=new U.Vector2,se=new U.Vector2,le=new U.Vector2,ce=new U.Vector2,ue=new U.Vector2,he=new U.Vector2,de=new U.Vector2,pe=new U.Vector2;function getZoomScale(){return Math.pow(.95,X.zoomSpeed)}function rotateLeft(x){te.theta-=x}function rotateUp(x){te.phi-=x}var me,fe=(me=new U.Vector3,function panLeft(x,S){me.setFromMatrixColumn(S,0),me.multiplyScalar(-x),ie.add(me)}),ge=function(){var x=new U.Vector3;return function panUp(S,w){!0===X.screenSpacePanning?x.setFromMatrixColumn(w,1):(x.setFromMatrixColumn(w,0),x.crossVectors(X.object.up,x)),x.multiplyScalar(S),ie.add(x)}}(),ve=function(){var x=new U.Vector3;return function pan(S,w){var U=X.domElement;if(X.object.isPerspectiveCamera){var G=X.object.position;x.copy(G).sub(X.target);var H=x.length();H*=Math.tan(X.object.fov/2*Math.PI/180),fe(2*S*H/U.clientHeight,X.object.matrix),ge(2*w*H/U.clientHeight,X.object.matrix)}else X.object.isOrthographicCamera?(fe(S*(X.object.right-X.object.left)/X.object.zoom/U.clientWidth,X.object.matrix),ge(w*(X.object.top-X.object.bottom)/X.object.zoom/U.clientHeight,X.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),X.enablePan=!1)}}();function dollyIn(x){X.object.isPerspectiveCamera?ne/=x:X.object.isOrthographicCamera?(X.object.zoom=Math.max(X.minZoom,Math.min(X.maxZoom,X.object.zoom*x)),X.object.updateProjectionMatrix(),re=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),X.enableZoom=!1)}function dollyOut(x){X.object.isPerspectiveCamera?ne*=x:X.object.isOrthographicCamera?(X.object.zoom=Math.max(X.minZoom,Math.min(X.maxZoom,X.object.zoom/x)),X.object.updateProjectionMatrix(),re=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),X.enableZoom=!1)}function handleMouseDownRotate(x){oe.set(x.clientX,x.clientY)}function handleMouseDownPan(x){le.set(x.clientX,x.clientY)}function handleTouchStartRotate(x){if(1==x.touches.length)oe.set(x.touches[0].pageX,x.touches[0].pageY);else{var S=.5*(x.touches[0].pageX+x.touches[1].pageX),w=.5*(x.touches[0].pageY+x.touches[1].pageY);oe.set(S,w)}}function handleTouchStartPan(x){if(1==x.touches.length)le.set(x.touches[0].pageX,x.touches[0].pageY);else{var S=.5*(x.touches[0].pageX+x.touches[1].pageX),w=.5*(x.touches[0].pageY+x.touches[1].pageY);le.set(S,w)}}function handleTouchStartDolly(x){var S=x.touches[0].pageX-x.touches[1].pageX,w=x.touches[0].pageY-x.touches[1].pageY,U=Math.sqrt(S*S+w*w);he.set(0,U)}function handleTouchMoveRotate(x){if(1==x.touches.length)ae.set(x.touches[0].pageX,x.touches[0].pageY);else{var S=.5*(x.touches[0].pageX+x.touches[1].pageX),w=.5*(x.touches[0].pageY+x.touches[1].pageY);ae.set(S,w)}se.subVectors(ae,oe).multiplyScalar(X.rotateSpeed);var U=X.domElement;rotateLeft(2*Math.PI*se.x/U.clientHeight),rotateUp(2*Math.PI*se.y/U.clientHeight),oe.copy(ae)}function handleTouchMovePan(x){if(1==x.touches.length)ce.set(x.touches[0].pageX,x.touches[0].pageY);else{var S=.5*(x.touches[0].pageX+x.touches[1].pageX),w=.5*(x.touches[0].pageY+x.touches[1].pageY);ce.set(S,w)}ue.subVectors(ce,le).multiplyScalar(X.panSpeed),ve(ue.x,ue.y),le.copy(ce)}function handleTouchMoveDolly(x){var S=x.touches[0].pageX-x.touches[1].pageX,w=x.touches[0].pageY-x.touches[1].pageY,U=Math.sqrt(S*S+w*w);de.set(0,U),pe.set(0,Math.pow(de.y/he.y,X.zoomSpeed)),dollyIn(pe.y),he.copy(de)}function onMouseDown(x){if(!1!==X.enabled){switch(x.preventDefault(),X.domElement.focus?X.domElement.focus():window.focus(),x.button){case 0:switch(X.mouseButtons.LEFT){case U.MOUSE.ROTATE:if(x.ctrlKey||x.metaKey||x.shiftKey){if(!1===X.enablePan)return;handleMouseDownPan(x),J=Z.PAN}else{if(!1===X.enableRotate)return;handleMouseDownRotate(x),J=Z.ROTATE}break;case U.MOUSE.PAN:if(x.ctrlKey||x.metaKey||x.shiftKey){if(!1===X.enableRotate)return;handleMouseDownRotate(x),J=Z.ROTATE}else{if(!1===X.enablePan)return;handleMouseDownPan(x),J=Z.PAN}break;default:J=Z.NONE}break;case 1:if(X.mouseButtons.MIDDLE===U.MOUSE.DOLLY){if(!1===X.enableZoom)return;!function handleMouseDownDolly(x){he.set(x.clientX,x.clientY)}(x),J=Z.DOLLY}else J=Z.NONE;break;case 2:switch(X.mouseButtons.RIGHT){case U.MOUSE.ROTATE:if(!1===X.enableRotate)return;handleMouseDownRotate(x),J=Z.ROTATE;break;case U.MOUSE.PAN:if(!1===X.enablePan)return;handleMouseDownPan(x),J=Z.PAN;break;default:J=Z.NONE}}J!==Z.NONE&&(document.addEventListener("mousemove",onMouseMove,!1),document.addEventListener("mouseup",onMouseUp,!1),X.dispatchEvent(q))}}function onMouseMove(x){if(!1!==X.enabled)switch(x.preventDefault(),J){case Z.ROTATE:if(!1===X.enableRotate)return;!function handleMouseMoveRotate(x){ae.set(x.clientX,x.clientY),se.subVectors(ae,oe).multiplyScalar(X.rotateSpeed);var S=X.domElement;rotateLeft(2*Math.PI*se.x/S.clientHeight),rotateUp(2*Math.PI*se.y/S.clientHeight),oe.copy(ae),X.update()}(x);break;case Z.DOLLY:if(!1===X.enableZoom)return;!function handleMouseMoveDolly(x){de.set(x.clientX,x.clientY),pe.subVectors(de,he),pe.y>0?dollyIn(getZoomScale()):pe.y<0&&dollyOut(getZoomScale()),he.copy(de),X.update()}(x);break;case Z.PAN:if(!1===X.enablePan)return;!function handleMouseMovePan(x){ce.set(x.clientX,x.clientY),ue.subVectors(ce,le).multiplyScalar(X.panSpeed),ve(ue.x,ue.y),le.copy(ce),X.update()}(x)}}function onMouseUp(x){!1!==X.enabled&&(document.removeEventListener("mousemove",onMouseMove,!1),document.removeEventListener("mouseup",onMouseUp,!1),X.dispatchEvent(Y),J=Z.NONE)}function onMouseWheel(x){!1===X.enabled||!1===X.enableZoom||J!==Z.NONE&&J!==Z.ROTATE||(x.preventDefault(),x.stopPropagation(),X.dispatchEvent(q),function handleMouseWheel(x){x.deltaY<0?dollyOut(getZoomScale()):x.deltaY>0&&dollyIn(getZoomScale()),X.update()}(x),X.dispatchEvent(Y))}function onKeyDown(x){!1!==X.enabled&&!1!==X.enableKeys&&!1!==X.enablePan&&function handleKeyDown(x){var S=!1;switch(x.keyCode){case X.keys.UP:ve(0,X.keyPanSpeed),S=!0;break;case X.keys.BOTTOM:ve(0,-X.keyPanSpeed),S=!0;break;case X.keys.LEFT:ve(X.keyPanSpeed,0),S=!0;break;case X.keys.RIGHT:ve(-X.keyPanSpeed,0),S=!0}S&&(x.preventDefault(),X.update())}(x)}function onTouchStart(x){if(!1!==X.enabled){switch(x.preventDefault(),x.touches.length){case 1:switch(X.touches.ONE){case U.TOUCH.ROTATE:if(!1===X.enableRotate)return;handleTouchStartRotate(x),J=Z.TOUCH_ROTATE;break;case U.TOUCH.PAN:if(!1===X.enablePan)return;handleTouchStartPan(x),J=Z.TOUCH_PAN;break;default:J=Z.NONE}break;case 2:switch(X.touches.TWO){case U.TOUCH.DOLLY_PAN:if(!1===X.enableZoom&&!1===X.enablePan)return;!function handleTouchStartDollyPan(x){X.enableZoom&&handleTouchStartDolly(x),X.enablePan&&handleTouchStartPan(x)}(x),J=Z.TOUCH_DOLLY_PAN;break;case U.TOUCH.DOLLY_ROTATE:if(!1===X.enableZoom&&!1===X.enableRotate)return;!function handleTouchStartDollyRotate(x){X.enableZoom&&handleTouchStartDolly(x),X.enableRotate&&handleTouchStartRotate(x)}(x),J=Z.TOUCH_DOLLY_ROTATE;break;default:J=Z.NONE}break;default:J=Z.NONE}J!==Z.NONE&&X.dispatchEvent(q)}}function onTouchMove(x){if(!1!==X.enabled)switch(x.preventDefault(),x.stopPropagation(),J){case Z.TOUCH_ROTATE:if(!1===X.enableRotate)return;handleTouchMoveRotate(x),X.update();break;case Z.TOUCH_PAN:if(!1===X.enablePan)return;handleTouchMovePan(x),X.update();break;case Z.TOUCH_DOLLY_PAN:if(!1===X.enableZoom&&!1===X.enablePan)return;!function handleTouchMoveDollyPan(x){X.enableZoom&&handleTouchMoveDolly(x),X.enablePan&&handleTouchMovePan(x)}(x),X.update();break;case Z.TOUCH_DOLLY_ROTATE:if(!1===X.enableZoom&&!1===X.enableRotate)return;!function handleTouchMoveDollyRotate(x){X.enableZoom&&handleTouchMoveDolly(x),X.enableRotate&&handleTouchMoveRotate(x)}(x),X.update();break;default:J=Z.NONE}}function onTouchEnd(x){!1!==X.enabled&&(X.dispatchEvent(Y),J=Z.NONE)}function onContextMenu(x){!1!==X.enabled&&x.preventDefault()}X.domElement.addEventListener("contextmenu",onContextMenu,!1),X.domElement.addEventListener("mousedown",onMouseDown,!1),X.domElement.addEventListener("wheel",onMouseWheel,!1),X.domElement.addEventListener("touchstart",onTouchStart,!1),X.domElement.addEventListener("touchend",onTouchEnd,!1),X.domElement.addEventListener("touchmove",onTouchMove,!1),X.domElement.addEventListener("keydown",onKeyDown,!1),-1===X.domElement.tabIndex&&(X.domElement.tabIndex=0),this.update()},U.OrbitControls.prototype=Object.create(U.EventDispatcher.prototype),U.OrbitControls.prototype.constructor=U.OrbitControls,U.MapControls=function(x,S){U.OrbitControls.call(this,x,S),this.mouseButtons.LEFT=U.MOUSE.PAN,this.mouseButtons.RIGHT=U.MOUSE.ROTATE,this.touches.ONE=U.TOUCH.PAN,this.touches.TWO=U.TOUCH.DOLLY_ROTATE},U.MapControls.prototype=Object.create(U.EventDispatcher.prototype),U.MapControls.prototype.constructor=U.MapControls,x.exports=S.default=U.OrbitControls},212:(x,S,w)=>{"use strict";w.r(S),w.d(S,{ACESFilmicToneMapping:()=>Ve,AddEquation:()=>ue,AddOperation:()=>Be,AdditiveAnimationBlendMode:()=>Hn,AdditiveBlending:()=>ae,AlphaFormat:()=>Et,AlwaysDepth:()=>Ae,AlwaysStencilFunc:()=>Ai,AmbientLight:()=>AmbientLight,AmbientLightProbe:()=>AmbientLightProbe,AnimationClip:()=>AnimationClip,AnimationLoader:()=>AnimationLoader,AnimationMixer:()=>AnimationMixer,AnimationObjectGroup:()=>AnimationObjectGroup,AnimationUtils:()=>hs,ArcCurve:()=>ArcCurve,ArrayCamera:()=>ArrayCamera,ArrowHelper:()=>ArrowHelper,Audio:()=>Audio,AudioAnalyser:()=>AudioAnalyser,AudioContext:()=>Ts,AudioListener:()=>AudioListener,AudioLoader:()=>AudioLoader,AxesHelper:()=>AxesHelper,AxisHelper:()=>AxisHelper,BackSide:()=>ee,BasicDepthPacking:()=>ri,BasicShadowMap:()=>q,BinaryTextureLoader:()=>BinaryTextureLoader,Bone:()=>Bone,BooleanKeyframeTrack:()=>BooleanKeyframeTrack,BoundingBoxHelper:()=>BoundingBoxHelper,Box2:()=>Box2,Box3:()=>Box3,Box3Helper:()=>Box3Helper,BoxBufferGeometry:()=>BoxGeometry,BoxGeometry:()=>BoxGeometry,BoxHelper:()=>BoxHelper,BufferAttribute:()=>BufferAttribute,BufferGeometry:()=>BufferGeometry,BufferGeometryLoader:()=>BufferGeometryLoader,ByteType:()=>ut,Cache:()=>ds,Camera:()=>Camera,CameraHelper:()=>CameraHelper,CanvasRenderer:()=>CanvasRenderer,CanvasTexture:()=>CanvasTexture,CatmullRomCurve3:()=>CatmullRomCurve3,CineonToneMapping:()=>Ge,CircleBufferGeometry:()=>CircleGeometry,CircleGeometry:()=>CircleGeometry,ClampToEdgeWrapping:()=>Ze,Clock:()=>Clock,Color:()=>Color,ColorKeyframeTrack:()=>ColorKeyframeTrack,CompressedTexture:()=>CompressedTexture,CompressedTextureLoader:()=>CompressedTextureLoader,ConeBufferGeometry:()=>ConeGeometry,ConeGeometry:()=>ConeGeometry,CubeCamera:()=>CubeCamera,CubeReflectionMapping:()=>$e,CubeRefractionMapping:()=>ze,CubeTexture:()=>CubeTexture,CubeTextureLoader:()=>CubeTextureLoader,CubeUVReflectionMapping:()=>Ke,CubeUVRefractionMapping:()=>qe,CubicBezierCurve:()=>CubicBezierCurve,CubicBezierCurve3:()=>CubicBezierCurve3,CubicInterpolant:()=>CubicInterpolant,CullFaceBack:()=>j,CullFaceFront:()=>X,CullFaceFrontBack:()=>K,CullFaceNone:()=>z,Curve:()=>Curve,CurvePath:()=>CurvePath,CustomBlending:()=>ce,CustomToneMapping:()=>He,CylinderBufferGeometry:()=>CylinderGeometry,CylinderGeometry:()=>CylinderGeometry,Cylindrical:()=>Cylindrical,DataTexture:()=>DataTexture,DataTexture2DArray:()=>DataTexture2DArray,DataTexture3D:()=>DataTexture3D,DataTextureLoader:()=>DataTextureLoader,DataUtils:()=>DataUtils,DecrementStencilOp:()=>fi,DecrementWrapStencilOp:()=>_i,DefaultLoadingManager:()=>ps,DepthFormat:()=>Mt,DepthStencilFormat:()=>Rt,DepthTexture:()=>DepthTexture,DirectionalLight:()=>DirectionalLight,DirectionalLightHelper:()=>DirectionalLightHelper,DiscreteInterpolant:()=>DiscreteInterpolant,DodecahedronBufferGeometry:()=>DodecahedronGeometry,DodecahedronGeometry:()=>DodecahedronGeometry,DoubleSide:()=>te,DstAlphaFactor:()=>xe,DstColorFactor:()=>Se,DynamicBufferAttribute:()=>DynamicBufferAttribute,DynamicCopyUsage:()=>Ni,DynamicDrawUsage:()=>Ri,DynamicReadUsage:()=>Pi,EdgesGeometry:()=>EdgesGeometry,EdgesHelper:()=>EdgesHelper,EllipseCurve:()=>EllipseCurve,EqualDepth:()=>Le,EqualStencilFunc:()=>Ei,EquirectangularReflectionMapping:()=>je,EquirectangularRefractionMapping:()=>Xe,Euler:()=>Euler,EventDispatcher:()=>EventDispatcher,ExtrudeBufferGeometry:()=>ExtrudeGeometry,ExtrudeGeometry:()=>ExtrudeGeometry,FaceColors:()=>gl,FileLoader:()=>FileLoader,FlatShading:()=>ne,Float16BufferAttribute:()=>Float16BufferAttribute,Float32Attribute:()=>Float32Attribute,Float32BufferAttribute:()=>Float32BufferAttribute,Float64Attribute:()=>Float64Attribute,Float64BufferAttribute:()=>Float64BufferAttribute,FloatType:()=>gt,Fog:()=>Fog,FogExp2:()=>FogExp2,Font:()=>Font,FontLoader:()=>FontLoader,FrontSide:()=>Q,Frustum:()=>Frustum,GLBufferAttribute:()=>GLBufferAttribute,GLSL1:()=>Di,GLSL3:()=>ki,GammaEncoding:()=>qn,GreaterDepth:()=>Pe,GreaterEqualDepth:()=>Ie,GreaterEqualStencilFunc:()=>Ci,GreaterStencilFunc:()=>wi,GridHelper:()=>GridHelper,Group:()=>Group,HalfFloatType:()=>vt,HemisphereLight:()=>HemisphereLight,HemisphereLightHelper:()=>HemisphereLightHelper,HemisphereLightProbe:()=>HemisphereLightProbe,IcosahedronBufferGeometry:()=>IcosahedronGeometry,IcosahedronGeometry:()=>IcosahedronGeometry,ImageBitmapLoader:()=>ImageBitmapLoader,ImageLoader:()=>ImageLoader,ImageUtils:()=>ImageUtils,ImmediateRenderObject:()=>ImmediateRenderObject,IncrementStencilOp:()=>pi,IncrementWrapStencilOp:()=>gi,InstancedBufferAttribute:()=>InstancedBufferAttribute,InstancedBufferGeometry:()=>InstancedBufferGeometry,InstancedInterleavedBuffer:()=>InstancedInterleavedBuffer,InstancedMesh:()=>InstancedMesh,Int16Attribute:()=>Int16Attribute,Int16BufferAttribute:()=>Int16BufferAttribute,Int32Attribute:()=>Int32Attribute,Int32BufferAttribute:()=>Int32BufferAttribute,Int8Attribute:()=>Int8Attribute,Int8BufferAttribute:()=>Int8BufferAttribute,IntType:()=>mt,InterleavedBuffer:()=>InterleavedBuffer,InterleavedBufferAttribute:()=>InterleavedBufferAttribute,Interpolant:()=>Interpolant,InterpolateDiscrete:()=>Fn,InterpolateLinear:()=>On,InterpolateSmooth:()=>Nn,InvertStencilOp:()=>yi,JSONLoader:()=>JSONLoader,KeepStencilOp:()=>ui,KeyframeTrack:()=>KeyframeTrack,LOD:()=>LOD,LatheBufferGeometry:()=>LatheGeometry,LatheGeometry:()=>LatheGeometry,Layers:()=>Layers,LensFlare:()=>LensFlare,LessDepth:()=>Me,LessEqualDepth:()=>Re,LessEqualStencilFunc:()=>Si,LessStencilFunc:()=>xi,Light:()=>Light,LightProbe:()=>LightProbe,Line:()=>Line,Line3:()=>Line3,LineBasicMaterial:()=>LineBasicMaterial,LineCurve:()=>LineCurve,LineCurve3:()=>LineCurve3,LineDashedMaterial:()=>LineDashedMaterial,LineLoop:()=>LineLoop,LinePieces:()=>ml,LineSegments:()=>LineSegments,LineStrip:()=>pl,LinearEncoding:()=>Xn,LinearFilter:()=>rt,LinearInterpolant:()=>LinearInterpolant,LinearMipMapLinearFilter:()=>lt,LinearMipMapNearestFilter:()=>at,LinearMipmapLinearFilter:()=>st,LinearMipmapNearestFilter:()=>ot,LinearToneMapping:()=>ke,Loader:()=>Loader,LoaderUtils:()=>LoaderUtils,LoadingManager:()=>LoadingManager,LogLuvEncoding:()=>Jn,LoopOnce:()=>Mn,LoopPingPong:()=>In,LoopRepeat:()=>Rn,LuminanceAlphaFormat:()=>Ct,LuminanceFormat:()=>Tt,MOUSE:()=>G,Material:()=>Material,MaterialLoader:()=>MaterialLoader,Math:()=>$i,MathUtils:()=>$i,Matrix3:()=>Matrix3,Matrix4:()=>Matrix4,MaxEquation:()=>me,Mesh:()=>Mesh,MeshBasicMaterial:()=>MeshBasicMaterial,MeshDepthMaterial:()=>MeshDepthMaterial,MeshDistanceMaterial:()=>MeshDistanceMaterial,MeshFaceMaterial:()=>MeshFaceMaterial,MeshLambertMaterial:()=>MeshLambertMaterial,MeshMatcapMaterial:()=>MeshMatcapMaterial,MeshNormalMaterial:()=>MeshNormalMaterial,MeshPhongMaterial:()=>MeshPhongMaterial,MeshPhysicalMaterial:()=>MeshPhysicalMaterial,MeshStandardMaterial:()=>MeshStandardMaterial,MeshToonMaterial:()=>MeshToonMaterial,MinEquation:()=>pe,MirroredRepeatWrapping:()=>Je,MixOperation:()=>Ne,MultiMaterial:()=>MultiMaterial,MultiplyBlending:()=>le,MultiplyOperation:()=>Oe,NearestFilter:()=>Qe,NearestMipMapLinearFilter:()=>it,NearestMipMapNearestFilter:()=>tt,NearestMipmapLinearFilter:()=>nt,NearestMipmapNearestFilter:()=>et,NeverDepth:()=>Ce,NeverStencilFunc:()=>bi,NoBlending:()=>re,NoColors:()=>fl,NoToneMapping:()=>De,NormalAnimationBlendMode:()=>Gn,NormalBlending:()=>oe,NotEqualDepth:()=>Fe,NotEqualStencilFunc:()=>Ti,NumberKeyframeTrack:()=>NumberKeyframeTrack,Object3D:()=>Object3D,ObjectLoader:()=>ObjectLoader,ObjectSpaceNormalMap:()=>li,OctahedronBufferGeometry:()=>OctahedronGeometry,OctahedronGeometry:()=>OctahedronGeometry,OneFactor:()=>ge,OneMinusDstAlphaFactor:()=>Ee,OneMinusDstColorFactor:()=>we,OneMinusSrcAlphaFactor:()=>be,OneMinusSrcColorFactor:()=>_e,OrthographicCamera:()=>OrthographicCamera,PCFShadowMap:()=>Y,PCFSoftShadowMap:()=>Z,PMREMGenerator:()=>PMREMGenerator,ParametricGeometry:()=>ParametricGeometry,Particle:()=>Particle,ParticleBasicMaterial:()=>ParticleBasicMaterial,ParticleSystem:()=>ParticleSystem,ParticleSystemMaterial:()=>ParticleSystemMaterial,Path:()=>Path,PerspectiveCamera:()=>PerspectiveCamera,Plane:()=>Plane,PlaneBufferGeometry:()=>PlaneGeometry,PlaneGeometry:()=>PlaneGeometry,PlaneHelper:()=>PlaneHelper,PointCloud:()=>PointCloud,PointCloudMaterial:()=>PointCloudMaterial,PointLight:()=>PointLight,PointLightHelper:()=>PointLightHelper,Points:()=>Points,PointsMaterial:()=>PointsMaterial,PolarGridHelper:()=>PolarGridHelper,PolyhedronBufferGeometry:()=>PolyhedronGeometry,PolyhedronGeometry:()=>PolyhedronGeometry,PositionalAudio:()=>PositionalAudio,PropertyBinding:()=>PropertyBinding,PropertyMixer:()=>PropertyMixer,QuadraticBezierCurve:()=>QuadraticBezierCurve,QuadraticBezierCurve3:()=>QuadraticBezierCurve3,Quaternion:()=>Quaternion,QuaternionKeyframeTrack:()=>QuaternionKeyframeTrack,QuaternionLinearInterpolant:()=>QuaternionLinearInterpolant,REVISION:()=>U,RGBADepthPacking:()=>oi,RGBAFormat:()=>wt,RGBAIntegerFormat:()=>Bt,RGBA_ASTC_10x10_Format:()=>an,RGBA_ASTC_10x5_Format:()=>nn,RGBA_ASTC_10x6_Format:()=>rn,RGBA_ASTC_10x8_Format:()=>on,RGBA_ASTC_12x10_Format:()=>sn,RGBA_ASTC_12x12_Format:()=>ln,RGBA_ASTC_4x4_Format:()=>Kt,RGBA_ASTC_5x4_Format:()=>qt,RGBA_ASTC_5x5_Format:()=>Yt,RGBA_ASTC_6x5_Format:()=>Zt,RGBA_ASTC_6x6_Format:()=>Jt,RGBA_ASTC_8x5_Format:()=>Qt,RGBA_ASTC_8x6_Format:()=>en,RGBA_ASTC_8x8_Format:()=>tn,RGBA_BPTC_Format:()=>cn,RGBA_ETC2_EAC_Format:()=>Xt,RGBA_PVRTC_2BPPV1_Format:()=>$t,RGBA_PVRTC_4BPPV1_Format:()=>Wt,RGBA_S3TC_DXT1_Format:()=>kt,RGBA_S3TC_DXT3_Format:()=>Ut,RGBA_S3TC_DXT5_Format:()=>Gt,RGBDEncoding:()=>ii,RGBEEncoding:()=>Zn,RGBEFormat:()=>At,RGBFormat:()=>St,RGBIntegerFormat:()=>Nt,RGBM16Encoding:()=>ni,RGBM7Encoding:()=>ei,RGB_ETC1_Format:()=>zt,RGB_ETC2_Format:()=>jt,RGB_PVRTC_2BPPV1_Format:()=>Ht,RGB_PVRTC_4BPPV1_Format:()=>Vt,RGB_S3TC_DXT1_Format:()=>Dt,RGFormat:()=>Pt,RGIntegerFormat:()=>Ft,RawShaderMaterial:()=>RawShaderMaterial,Ray:()=>Ray,Raycaster:()=>Raycaster,RectAreaLight:()=>RectAreaLight,RedFormat:()=>Lt,RedIntegerFormat:()=>It,ReinhardToneMapping:()=>Ue,RepeatWrapping:()=>Ye,ReplaceStencilOp:()=>di,ReverseSubtractEquation:()=>de,RingBufferGeometry:()=>RingGeometry,RingGeometry:()=>RingGeometry,SRGB8_ALPHA8_ASTC_10x10_Format:()=>Tn,SRGB8_ALPHA8_ASTC_10x5_Format:()=>En,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Sn,SRGB8_ALPHA8_ASTC_10x8_Format:()=>wn,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Cn,SRGB8_ALPHA8_ASTC_12x12_Format:()=>An,SRGB8_ALPHA8_ASTC_4x4_Format:()=>hn,SRGB8_ALPHA8_ASTC_5x4_Format:()=>dn,SRGB8_ALPHA8_ASTC_5x5_Format:()=>pn,SRGB8_ALPHA8_ASTC_6x5_Format:()=>mn,SRGB8_ALPHA8_ASTC_6x6_Format:()=>gn,SRGB8_ALPHA8_ASTC_8x5_Format:()=>vn,SRGB8_ALPHA8_ASTC_8x6_Format:()=>bn,SRGB8_ALPHA8_ASTC_8x8_Format:()=>xn,Scene:()=>Scene,SceneUtils:()=>_l,ShaderChunk:()=>Bo,ShaderLib:()=>ko,ShaderMaterial:()=>ShaderMaterial,ShadowMaterial:()=>ShadowMaterial,Shape:()=>Shape,ShapeBufferGeometry:()=>ShapeGeometry,ShapeGeometry:()=>ShapeGeometry,ShapePath:()=>ShapePath,ShapeUtils:()=>ShapeUtils,ShortType:()=>ht,Skeleton:()=>Skeleton,SkeletonHelper:()=>SkeletonHelper,SkinnedMesh:()=>SkinnedMesh,SmoothShading:()=>ie,Sphere:()=>Sphere,SphereBufferGeometry:()=>SphereGeometry,SphereGeometry:()=>SphereGeometry,Spherical:()=>Spherical,SphericalHarmonics3:()=>SphericalHarmonics3,SplineCurve:()=>SplineCurve,SpotLight:()=>SpotLight,SpotLightHelper:()=>SpotLightHelper,Sprite:()=>Sprite,SpriteMaterial:()=>SpriteMaterial,SrcAlphaFactor:()=>ye,SrcAlphaSaturateFactor:()=>Te,SrcColorFactor:()=>ve,StaticCopyUsage:()=>Oi,StaticDrawUsage:()=>Mi,StaticReadUsage:()=>Ii,StereoCamera:()=>StereoCamera,StreamCopyUsage:()=>Bi,StreamDrawUsage:()=>Li,StreamReadUsage:()=>Fi,StringKeyframeTrack:()=>StringKeyframeTrack,SubtractEquation:()=>he,SubtractiveBlending:()=>se,TOUCH:()=>H,TangentSpaceNormalMap:()=>ai,TetrahedronBufferGeometry:()=>TetrahedronGeometry,TetrahedronGeometry:()=>TetrahedronGeometry,TextGeometry:()=>TextGeometry,Texture:()=>Texture,TextureLoader:()=>TextureLoader,TorusBufferGeometry:()=>TorusGeometry,TorusGeometry:()=>TorusGeometry,TorusKnotBufferGeometry:()=>TorusKnotGeometry,TorusKnotGeometry:()=>TorusKnotGeometry,Triangle:()=>Triangle,TriangleFanDrawMode:()=>zn,TriangleStripDrawMode:()=>$n,TrianglesDrawMode:()=>Wn,TubeBufferGeometry:()=>TubeGeometry,TubeGeometry:()=>TubeGeometry,UVMapping:()=>We,Uint16Attribute:()=>Uint16Attribute,Uint16BufferAttribute:()=>Uint16BufferAttribute,Uint32Attribute:()=>Uint32Attribute,Uint32BufferAttribute:()=>Uint32BufferAttribute,Uint8Attribute:()=>Uint8Attribute,Uint8BufferAttribute:()=>Uint8BufferAttribute,Uint8ClampedAttribute:()=>Uint8ClampedAttribute,Uint8ClampedBufferAttribute:()=>Uint8ClampedBufferAttribute,Uniform:()=>Uniform,UniformsLib:()=>Do,UniformsUtils:()=>Ro,UnsignedByteType:()=>ct,UnsignedInt248Type:()=>xt,UnsignedIntType:()=>ft,UnsignedShort4444Type:()=>_t,UnsignedShort5551Type:()=>yt,UnsignedShort565Type:()=>bt,UnsignedShortType:()=>pt,VSMShadowMap:()=>J,Vector2:()=>Vector2,Vector3:()=>Vector3,Vector4:()=>Vector4,VectorKeyframeTrack:()=>VectorKeyframeTrack,Vertex:()=>Vertex,VertexColors:()=>vl,VideoTexture:()=>VideoTexture,WebGL1Renderer:()=>WebGL1Renderer,WebGLCubeRenderTarget:()=>WebGLCubeRenderTarget,WebGLMultipleRenderTargets:()=>WebGLMultipleRenderTargets,WebGLMultisampleRenderTarget:()=>WebGLMultisampleRenderTarget,WebGLRenderTarget:()=>WebGLRenderTarget,WebGLRenderTargetCube:()=>WebGLRenderTargetCube,WebGLRenderer:()=>WebGLRenderer,WebGLUtils:()=>WebGLUtils,WireframeGeometry:()=>WireframeGeometry,WireframeHelper:()=>WireframeHelper,WrapAroundEnding:()=>kn,XHRLoader:()=>XHRLoader,ZeroCurvatureEnding:()=>Bn,ZeroFactor:()=>fe,ZeroSlopeEnding:()=>Dn,ZeroStencilOp:()=>ci,sRGBEncoding:()=>Kn});const U="133",G={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},H={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},z=0,j=1,X=2,K=3,q=0,Y=1,Z=2,J=3,Q=0,ee=1,te=2,ne=1,ie=2,re=0,oe=1,ae=2,se=3,le=4,ce=5,ue=100,he=101,de=102,pe=103,me=104,fe=200,ge=201,ve=202,_e=203,ye=204,be=205,xe=206,Ee=207,Se=208,we=209,Te=210,Ce=0,Ae=1,Me=2,Re=3,Le=4,Ie=5,Pe=6,Fe=7,Oe=0,Ne=1,Be=2,De=0,ke=1,Ue=2,Ge=3,Ve=4,He=5,We=300,$e=301,ze=302,je=303,Xe=304,Ke=306,qe=307,Ye=1e3,Ze=1001,Je=1002,Qe=1003,et=1004,tt=1004,nt=1005,it=1005,rt=1006,ot=1007,at=1007,st=1008,lt=1008,ct=1009,ut=1010,ht=1011,pt=1012,mt=1013,ft=1014,gt=1015,vt=1016,_t=1017,yt=1018,bt=1019,xt=1020,Et=1021,St=1022,wt=1023,Tt=1024,Ct=1025,At=wt,Mt=1026,Rt=1027,Lt=1028,It=1029,Pt=1030,Ft=1031,Nt=1032,Bt=1033,Dt=33776,kt=33777,Ut=33778,Gt=33779,Vt=35840,Ht=35841,Wt=35842,$t=35843,zt=36196,jt=37492,Xt=37496,Kt=37808,qt=37809,Yt=37810,Zt=37811,Jt=37812,Qt=37813,en=37814,tn=37815,nn=37816,rn=37817,on=37818,an=37819,sn=37820,ln=37821,cn=36492,hn=37840,dn=37841,pn=37842,mn=37843,gn=37844,vn=37845,bn=37846,xn=37847,En=37848,Sn=37849,wn=37850,Tn=37851,Cn=37852,An=37853,Mn=2200,Rn=2201,In=2202,Fn=2300,On=2301,Nn=2302,Bn=2400,Dn=2401,kn=2402,Gn=2500,Hn=2501,Wn=0,$n=1,zn=2,Xn=3e3,Kn=3001,qn=3007,Zn=3002,Jn=3003,ei=3004,ni=3005,ii=3006,ri=3200,oi=3201,ai=0,li=1,ci=0,ui=7680,di=7681,pi=7682,fi=7683,gi=34055,_i=34056,yi=5386,bi=512,xi=513,Ei=514,Si=515,wi=516,Ti=517,Ci=518,Ai=519,Mi=35044,Ri=35048,Li=35040,Ii=35045,Pi=35049,Fi=35041,Oi=35046,Ni=35050,Bi=35042,Di="100",ki="300 es";class EventDispatcher{addEventListener(x,S){void 0===this._listeners&&(this._listeners={});const w=this._listeners;void 0===w[x]&&(w[x]=[]),-1===w[x].indexOf(S)&&w[x].push(S)}hasEventListener(x,S){if(void 0===this._listeners)return!1;const w=this._listeners;return void 0!==w[x]&&-1!==w[x].indexOf(S)}removeEventListener(x,S){if(void 0===this._listeners)return;const w=this._listeners[x];if(void 0!==w){const x=w.indexOf(S);-1!==x&&w.splice(x,1)}}dispatchEvent(x){if(void 0===this._listeners)return;const S=this._listeners[x.type];if(void 0!==S){x.target=this;const w=S.slice(0);for(let S=0,U=w.length;S<U;S++)w[S].call(this,x);x.target=null}}}let Ui=1234567;const Gi=Math.PI/180,Vi=180/Math.PI,Hi=[];for(let x=0;x<256;x++)Hi[x]=(x<16?"0":"")+x.toString(16);const Wi="undefined"!=typeof crypto&&"randomUUID"in crypto;function generateUUID(){if(Wi)return crypto.randomUUID().toUpperCase();const x=4294967295*Math.random()|0,S=4294967295*Math.random()|0,w=4294967295*Math.random()|0,U=4294967295*Math.random()|0;return(Hi[255&x]+Hi[x>>8&255]+Hi[x>>16&255]+Hi[x>>24&255]+"-"+Hi[255&S]+Hi[S>>8&255]+"-"+Hi[S>>16&15|64]+Hi[S>>24&255]+"-"+Hi[63&w|128]+Hi[w>>8&255]+"-"+Hi[w>>16&255]+Hi[w>>24&255]+Hi[255&U]+Hi[U>>8&255]+Hi[U>>16&255]+Hi[U>>24&255]).toUpperCase()}function clamp(x,S,w){return Math.max(S,Math.min(w,x))}function euclideanModulo(x,S){return(x%S+S)%S}function lerp(x,S,w){return(1-w)*x+w*S}function isPowerOfTwo(x){return 0==(x&x-1)&&0!==x}function ceilPowerOfTwo(x){return Math.pow(2,Math.ceil(Math.log(x)/Math.LN2))}function floorPowerOfTwo(x){return Math.pow(2,Math.floor(Math.log(x)/Math.LN2))}var $i=Object.freeze({__proto__:null,DEG2RAD:Gi,RAD2DEG:Vi,generateUUID,clamp,euclideanModulo,mapLinear:function mapLinear(x,S,w,U,G){return U+(x-S)*(G-U)/(w-S)},inverseLerp:function inverseLerp(x,S,w){return x!==S?(w-x)/(S-x):0},lerp,damp:function damp(x,S,w,U){return lerp(x,S,1-Math.exp(-w*U))},pingpong:function pingpong(x,S=1){return S-Math.abs(euclideanModulo(x,2*S)-S)},smoothstep:function smoothstep(x,S,w){return x<=S?0:x>=w?1:(x=(x-S)/(w-S))*x*(3-2*x)},smootherstep:function smootherstep(x,S,w){return x<=S?0:x>=w?1:(x=(x-S)/(w-S))*x*x*(x*(6*x-15)+10)},randInt:function randInt(x,S){return x+Math.floor(Math.random()*(S-x+1))},randFloat:function randFloat(x,S){return x+Math.random()*(S-x)},randFloatSpread:function randFloatSpread(x){return x*(.5-Math.random())},seededRandom:function seededRandom(x){return void 0!==x&&(Ui=x%2147483647),Ui=16807*Ui%2147483647,(Ui-1)/2147483646},degToRad:function degToRad(x){return x*Gi},radToDeg:function radToDeg(x){return x*Vi},isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler:function setQuaternionFromProperEuler(x,S,w,U,G){const H=Math.cos,z=Math.sin,j=H(w/2),X=z(w/2),K=H((S+U)/2),q=z((S+U)/2),Y=H((S-U)/2),Z=z((S-U)/2),J=H((U-S)/2),Q=z((U-S)/2);switch(G){case"XYX":x.set(j*q,X*Y,X*Z,j*K);break;case"YZY":x.set(X*Z,j*q,X*Y,j*K);break;case"ZXZ":x.set(X*Y,X*Z,j*q,j*K);break;case"XZX":x.set(j*q,X*Q,X*J,j*K);break;case"YXY":x.set(X*J,j*q,X*Q,j*K);break;case"ZYZ":x.set(X*Q,X*J,j*q,j*K);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+G)}}});class Vector2{constructor(x=0,S=0){this.x=x,this.y=S}get width(){return this.x}set width(x){this.x=x}get height(){return this.y}set height(x){this.y=x}set(x,S){return this.x=x,this.y=S,this}setScalar(x){return this.x=x,this.y=x,this}setX(x){return this.x=x,this}setY(x){return this.y=x,this}setComponent(x,S){switch(x){case 0:this.x=S;break;case 1:this.y=S;break;default:throw new Error("index is out of range: "+x)}return this}getComponent(x){switch(x){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+x)}}clone(){return new this.constructor(this.x,this.y)}copy(x){return this.x=x.x,this.y=x.y,this}add(x,S){return void 0!==S?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(x,S)):(this.x+=x.x,this.y+=x.y,this)}addScalar(x){return this.x+=x,this.y+=x,this}addVectors(x,S){return this.x=x.x+S.x,this.y=x.y+S.y,this}addScaledVector(x,S){return this.x+=x.x*S,this.y+=x.y*S,this}sub(x,S){return void 0!==S?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(x,S)):(this.x-=x.x,this.y-=x.y,this)}subScalar(x){return this.x-=x,this.y-=x,this}subVectors(x,S){return this.x=x.x-S.x,this.y=x.y-S.y,this}multiply(x){return this.x*=x.x,this.y*=x.y,this}multiplyScalar(x){return this.x*=x,this.y*=x,this}divide(x){return this.x/=x.x,this.y/=x.y,this}divideScalar(x){return this.multiplyScalar(1/x)}applyMatrix3(x){const S=this.x,w=this.y,U=x.elements;return this.x=U[0]*S+U[3]*w+U[6],this.y=U[1]*S+U[4]*w+U[7],this}min(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this}max(x){return this.x=Math.max(this.x,x.x),this.y=Math.max(this.y,x.y),this}clamp(x,S){return this.x=Math.max(x.x,Math.min(S.x,this.x)),this.y=Math.max(x.y,Math.min(S.y,this.y)),this}clampScalar(x,S){return this.x=Math.max(x,Math.min(S,this.x)),this.y=Math.max(x,Math.min(S,this.y)),this}clampLength(x,S){const w=this.length();return this.divideScalar(w||1).multiplyScalar(Math.max(x,Math.min(S,w)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(x){return this.x*x.x+this.y*x.y}cross(x){return this.x*x.y-this.y*x.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(x){return Math.sqrt(this.distanceToSquared(x))}distanceToSquared(x){const S=this.x-x.x,w=this.y-x.y;return S*S+w*w}manhattanDistanceTo(x){return Math.abs(this.x-x.x)+Math.abs(this.y-x.y)}setLength(x){return this.normalize().multiplyScalar(x)}lerp(x,S){return this.x+=(x.x-this.x)*S,this.y+=(x.y-this.y)*S,this}lerpVectors(x,S,w){return this.x=x.x+(S.x-x.x)*w,this.y=x.y+(S.y-x.y)*w,this}equals(x){return x.x===this.x&&x.y===this.y}fromArray(x,S=0){return this.x=x[S],this.y=x[S+1],this}toArray(x=[],S=0){return x[S]=this.x,x[S+1]=this.y,x}fromBufferAttribute(x,S,w){return void 0!==w&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=x.getX(S),this.y=x.getY(S),this}rotateAround(x,S){const w=Math.cos(S),U=Math.sin(S),G=this.x-x.x,H=this.y-x.y;return this.x=G*w-H*U+x.x,this.y=G*U+H*w+x.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Vector2.prototype.isVector2=!0;class Matrix3{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(x,S,w,U,G,H,z,j,X){const K=this.elements;return K[0]=x,K[1]=U,K[2]=z,K[3]=S,K[4]=G,K[5]=j,K[6]=w,K[7]=H,K[8]=X,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(x){const S=this.elements,w=x.elements;return S[0]=w[0],S[1]=w[1],S[2]=w[2],S[3]=w[3],S[4]=w[4],S[5]=w[5],S[6]=w[6],S[7]=w[7],S[8]=w[8],this}extractBasis(x,S,w){return x.setFromMatrix3Column(this,0),S.setFromMatrix3Column(this,1),w.setFromMatrix3Column(this,2),this}setFromMatrix4(x){const S=x.elements;return this.set(S[0],S[4],S[8],S[1],S[5],S[9],S[2],S[6],S[10]),this}multiply(x){return this.multiplyMatrices(this,x)}premultiply(x){return this.multiplyMatrices(x,this)}multiplyMatrices(x,S){const w=x.elements,U=S.elements,G=this.elements,H=w[0],z=w[3],j=w[6],X=w[1],K=w[4],q=w[7],Y=w[2],Z=w[5],J=w[8],Q=U[0],ee=U[3],te=U[6],ne=U[1],ie=U[4],re=U[7],oe=U[2],ae=U[5],se=U[8];return G[0]=H*Q+z*ne+j*oe,G[3]=H*ee+z*ie+j*ae,G[6]=H*te+z*re+j*se,G[1]=X*Q+K*ne+q*oe,G[4]=X*ee+K*ie+q*ae,G[7]=X*te+K*re+q*se,G[2]=Y*Q+Z*ne+J*oe,G[5]=Y*ee+Z*ie+J*ae,G[8]=Y*te+Z*re+J*se,this}multiplyScalar(x){const S=this.elements;return S[0]*=x,S[3]*=x,S[6]*=x,S[1]*=x,S[4]*=x,S[7]*=x,S[2]*=x,S[5]*=x,S[8]*=x,this}determinant(){const x=this.elements,S=x[0],w=x[1],U=x[2],G=x[3],H=x[4],z=x[5],j=x[6],X=x[7],K=x[8];return S*H*K-S*z*X-w*G*K+w*z*j+U*G*X-U*H*j}invert(){const x=this.elements,S=x[0],w=x[1],U=x[2],G=x[3],H=x[4],z=x[5],j=x[6],X=x[7],K=x[8],q=K*H-z*X,Y=z*j-K*G,Z=X*G-H*j,J=S*q+w*Y+U*Z;if(0===J)return this.set(0,0,0,0,0,0,0,0,0);const Q=1/J;return x[0]=q*Q,x[1]=(U*X-K*w)*Q,x[2]=(z*w-U*H)*Q,x[3]=Y*Q,x[4]=(K*S-U*j)*Q,x[5]=(U*G-z*S)*Q,x[6]=Z*Q,x[7]=(w*j-X*S)*Q,x[8]=(H*S-w*G)*Q,this}transpose(){let x;const S=this.elements;return x=S[1],S[1]=S[3],S[3]=x,x=S[2],S[2]=S[6],S[6]=x,x=S[5],S[5]=S[7],S[7]=x,this}getNormalMatrix(x){return this.setFromMatrix4(x).invert().transpose()}transposeIntoArray(x){const S=this.elements;return x[0]=S[0],x[1]=S[3],x[2]=S[6],x[3]=S[1],x[4]=S[4],x[5]=S[7],x[6]=S[2],x[7]=S[5],x[8]=S[8],this}setUvTransform(x,S,w,U,G,H,z){const j=Math.cos(G),X=Math.sin(G);return this.set(w*j,w*X,-w*(j*H+X*z)+H+x,-U*X,U*j,-U*(-X*H+j*z)+z+S,0,0,1),this}scale(x,S){const w=this.elements;return w[0]*=x,w[3]*=x,w[6]*=x,w[1]*=S,w[4]*=S,w[7]*=S,this}rotate(x){const S=Math.cos(x),w=Math.sin(x),U=this.elements,G=U[0],H=U[3],z=U[6],j=U[1],X=U[4],K=U[7];return U[0]=S*G+w*j,U[3]=S*H+w*X,U[6]=S*z+w*K,U[1]=-w*G+S*j,U[4]=-w*H+S*X,U[7]=-w*z+S*K,this}translate(x,S){const w=this.elements;return w[0]+=x*w[2],w[3]+=x*w[5],w[6]+=x*w[8],w[1]+=S*w[2],w[4]+=S*w[5],w[7]+=S*w[8],this}equals(x){const S=this.elements,w=x.elements;for(let x=0;x<9;x++)if(S[x]!==w[x])return!1;return!0}fromArray(x,S=0){for(let w=0;w<9;w++)this.elements[w]=x[w+S];return this}toArray(x=[],S=0){const w=this.elements;return x[S]=w[0],x[S+1]=w[1],x[S+2]=w[2],x[S+3]=w[3],x[S+4]=w[4],x[S+5]=w[5],x[S+6]=w[6],x[S+7]=w[7],x[S+8]=w[8],x}clone(){return(new this.constructor).fromArray(this.elements)}}function arrayMax(x){if(0===x.length)return-1/0;let S=x[0];for(let w=1,U=x.length;w<U;++w)x[w]>S&&(S=x[w]);return S}Matrix3.prototype.isMatrix3=!0;const zi={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(x,S){return new zi[x](S)}function createElementNS(x){return document.createElementNS("http://www.w3.org/1999/xhtml",x)}let ji;class ImageUtils{static getDataURL(x){if(/^data:/i.test(x.src))return x.src;if("undefined"==typeof HTMLCanvasElement)return x.src;let S;if(x instanceof HTMLCanvasElement)S=x;else{void 0===ji&&(ji=createElementNS("canvas")),ji.width=x.width,ji.height=x.height;const w=ji.getContext("2d");x instanceof ImageData?w.putImageData(x,0,0):w.drawImage(x,0,0,x.width,x.height),S=ji}return S.width>2048||S.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",x),S.toDataURL("image/jpeg",.6)):S.toDataURL("image/png")}}let Xi=0;class Texture extends EventDispatcher{constructor(x=Texture.DEFAULT_IMAGE,S=Texture.DEFAULT_MAPPING,w=Ze,U=Ze,G=rt,H=st,z=wt,j=ct,X=1,K=Xn){super(),Object.defineProperty(this,"id",{value:Xi++}),this.uuid=generateUUID(),this.name="",this.image=x,this.mipmaps=[],this.mapping=S,this.wrapS=w,this.wrapT=U,this.magFilter=G,this.minFilter=H,this.anisotropy=X,this.format=z,this.internalFormat=null,this.type=j,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=K,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(x){return this.name=x.name,this.image=x.image,this.mipmaps=x.mipmaps.slice(0),this.mapping=x.mapping,this.wrapS=x.wrapS,this.wrapT=x.wrapT,this.magFilter=x.magFilter,this.minFilter=x.minFilter,this.anisotropy=x.anisotropy,this.format=x.format,this.internalFormat=x.internalFormat,this.type=x.type,this.offset.copy(x.offset),this.repeat.copy(x.repeat),this.center.copy(x.center),this.rotation=x.rotation,this.matrixAutoUpdate=x.matrixAutoUpdate,this.matrix.copy(x.matrix),this.generateMipmaps=x.generateMipmaps,this.premultiplyAlpha=x.premultiplyAlpha,this.flipY=x.flipY,this.unpackAlignment=x.unpackAlignment,this.encoding=x.encoding,this}toJSON(x){const S=void 0===x||"string"==typeof x;if(!S&&void 0!==x.textures[this.uuid])return x.textures[this.uuid];const w={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const U=this.image;if(void 0===U.uuid&&(U.uuid=generateUUID()),!S&&void 0===x.images[U.uuid]){let S;if(Array.isArray(U)){S=[];for(let x=0,w=U.length;x<w;x++)U[x].isDataTexture?S.push(serializeImage(U[x].image)):S.push(serializeImage(U[x]))}else S=serializeImage(U);x.images[U.uuid]={uuid:U.uuid,url:S}}w.image=U.uuid}return S||(x.textures[this.uuid]=w),w}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(x){if(this.mapping!==We)return x;if(x.applyMatrix3(this.matrix),x.x<0||x.x>1)switch(this.wrapS){case Ye:x.x=x.x-Math.floor(x.x);break;case Ze:x.x=x.x<0?0:1;break;case Je:1===Math.abs(Math.floor(x.x)%2)?x.x=Math.ceil(x.x)-x.x:x.x=x.x-Math.floor(x.x)}if(x.y<0||x.y>1)switch(this.wrapT){case Ye:x.y=x.y-Math.floor(x.y);break;case Ze:x.y=x.y<0?0:1;break;case Je:1===Math.abs(Math.floor(x.y)%2)?x.y=Math.ceil(x.y)-x.y:x.y=x.y-Math.floor(x.y)}return this.flipY&&(x.y=1-x.y),x}set needsUpdate(x){!0===x&&this.version++}}function serializeImage(x){return"undefined"!=typeof HTMLImageElement&&x instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&x instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&x instanceof ImageBitmap?ImageUtils.getDataURL(x):x.data?{data:Array.prototype.slice.call(x.data),width:x.width,height:x.height,type:x.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Texture.DEFAULT_IMAGE=void 0,Texture.DEFAULT_MAPPING=We,Texture.prototype.isTexture=!0;class Vector4{constructor(x=0,S=0,w=0,U=1){this.x=x,this.y=S,this.z=w,this.w=U}get width(){return this.z}set width(x){this.z=x}get height(){return this.w}set height(x){this.w=x}set(x,S,w,U){return this.x=x,this.y=S,this.z=w,this.w=U,this}setScalar(x){return this.x=x,this.y=x,this.z=x,this.w=x,this}setX(x){return this.x=x,this}setY(x){return this.y=x,this}setZ(x){return this.z=x,this}setW(x){return this.w=x,this}setComponent(x,S){switch(x){case 0:this.x=S;break;case 1:this.y=S;break;case 2:this.z=S;break;case 3:this.w=S;break;default:throw new Error("index is out of range: "+x)}return this}getComponent(x){switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+x)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(x){return this.x=x.x,this.y=x.y,this.z=x.z,this.w=void 0!==x.w?x.w:1,this}add(x,S){return void 0!==S?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(x,S)):(this.x+=x.x,this.y+=x.y,this.z+=x.z,this.w+=x.w,this)}addScalar(x){return this.x+=x,this.y+=x,this.z+=x,this.w+=x,this}addVectors(x,S){return this.x=x.x+S.x,this.y=x.y+S.y,this.z=x.z+S.z,this.w=x.w+S.w,this}addScaledVector(x,S){return this.x+=x.x*S,this.y+=x.y*S,this.z+=x.z*S,this.w+=x.w*S,this}sub(x,S){return void 0!==S?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(x,S)):(this.x-=x.x,this.y-=x.y,this.z-=x.z,this.w-=x.w,this)}subScalar(x){return this.x-=x,this.y-=x,this.z-=x,this.w-=x,this}subVectors(x,S){return this.x=x.x-S.x,this.y=x.y-S.y,this.z=x.z-S.z,this.w=x.w-S.w,this}multiply(x){return this.x*=x.x,this.y*=x.y,this.z*=x.z,this.w*=x.w,this}multiplyScalar(x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this}applyMatrix4(x){const S=this.x,w=this.y,U=this.z,G=this.w,H=x.elements;return this.x=H[0]*S+H[4]*w+H[8]*U+H[12]*G,this.y=H[1]*S+H[5]*w+H[9]*U+H[13]*G,this.z=H[2]*S+H[6]*w+H[10]*U+H[14]*G,this.w=H[3]*S+H[7]*w+H[11]*U+H[15]*G,this}divideScalar(x){return this.multiplyScalar(1/x)}setAxisAngleFromQuaternion(x){this.w=2*Math.acos(x.w);const S=Math.sqrt(1-x.w*x.w);return S<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=x.x/S,this.y=x.y/S,this.z=x.z/S),this}setAxisAngleFromRotationMatrix(x){let S,w,U,G;const H=.01,z=.1,j=x.elements,X=j[0],K=j[4],q=j[8],Y=j[1],Z=j[5],J=j[9],Q=j[2],ee=j[6],te=j[10];if(Math.abs(K-Y)<H&&Math.abs(q-Q)<H&&Math.abs(J-ee)<H){if(Math.abs(K+Y)<z&&Math.abs(q+Q)<z&&Math.abs(J+ee)<z&&Math.abs(X+Z+te-3)<z)return this.set(1,0,0,0),this;S=Math.PI;const x=(X+1)/2,j=(Z+1)/2,ne=(te+1)/2,ie=(K+Y)/4,re=(q+Q)/4,oe=(J+ee)/4;return x>j&&x>ne?x<H?(w=0,U=.707106781,G=.707106781):(w=Math.sqrt(x),U=ie/w,G=re/w):j>ne?j<H?(w=.707106781,U=0,G=.707106781):(U=Math.sqrt(j),w=ie/U,G=oe/U):ne<H?(w=.707106781,U=.707106781,G=0):(G=Math.sqrt(ne),w=re/G,U=oe/G),this.set(w,U,G,S),this}let ne=Math.sqrt((ee-J)*(ee-J)+(q-Q)*(q-Q)+(Y-K)*(Y-K));return Math.abs(ne)<.001&&(ne=1),this.x=(ee-J)/ne,this.y=(q-Q)/ne,this.z=(Y-K)/ne,this.w=Math.acos((X+Z+te-1)/2),this}min(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this.z=Math.min(this.z,x.z),this.w=Math.min(this.w,x.w),this}max(x){return this.x=Math.max(this.x,x.x),this.y=Math.max(this.y,x.y),this.z=Math.max(this.z,x.z),this.w=Math.max(this.w,x.w),this}clamp(x,S){return this.x=Math.max(x.x,Math.min(S.x,this.x)),this.y=Math.max(x.y,Math.min(S.y,this.y)),this.z=Math.max(x.z,Math.min(S.z,this.z)),this.w=Math.max(x.w,Math.min(S.w,this.w)),this}clampScalar(x,S){return this.x=Math.max(x,Math.min(S,this.x)),this.y=Math.max(x,Math.min(S,this.y)),this.z=Math.max(x,Math.min(S,this.z)),this.w=Math.max(x,Math.min(S,this.w)),this}clampLength(x,S){const w=this.length();return this.divideScalar(w||1).multiplyScalar(Math.max(x,Math.min(S,w)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(x){return this.x*x.x+this.y*x.y+this.z*x.z+this.w*x.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(x){return this.normalize().multiplyScalar(x)}lerp(x,S){return this.x+=(x.x-this.x)*S,this.y+=(x.y-this.y)*S,this.z+=(x.z-this.z)*S,this.w+=(x.w-this.w)*S,this}lerpVectors(x,S,w){return this.x=x.x+(S.x-x.x)*w,this.y=x.y+(S.y-x.y)*w,this.z=x.z+(S.z-x.z)*w,this.w=x.w+(S.w-x.w)*w,this}equals(x){return x.x===this.x&&x.y===this.y&&x.z===this.z&&x.w===this.w}fromArray(x,S=0){return this.x=x[S],this.y=x[S+1],this.z=x[S+2],this.w=x[S+3],this}toArray(x=[],S=0){return x[S]=this.x,x[S+1]=this.y,x[S+2]=this.z,x[S+3]=this.w,x}fromBufferAttribute(x,S,w){return void 0!==w&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=x.getX(S),this.y=x.getY(S),this.z=x.getZ(S),this.w=x.getW(S),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Vector4.prototype.isVector4=!0;class WebGLRenderTarget extends EventDispatcher{constructor(x,S,w={}){super(),this.width=x,this.height=S,this.depth=1,this.scissor=new Vector4(0,0,x,S),this.scissorTest=!1,this.viewport=new Vector4(0,0,x,S),this.texture=new Texture(void 0,w.mapping,w.wrapS,w.wrapT,w.magFilter,w.minFilter,w.format,w.type,w.anisotropy,w.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:x,height:S,depth:1},this.texture.generateMipmaps=void 0!==w.generateMipmaps&&w.generateMipmaps,this.texture.internalFormat=void 0!==w.internalFormat?w.internalFormat:null,this.texture.minFilter=void 0!==w.minFilter?w.minFilter:rt,this.depthBuffer=void 0===w.depthBuffer||w.depthBuffer,this.stencilBuffer=void 0!==w.stencilBuffer&&w.stencilBuffer,this.depthTexture=void 0!==w.depthTexture?w.depthTexture:null}setTexture(x){x.image={width:this.width,height:this.height,depth:this.depth},this.texture=x}setSize(x,S,w=1){this.width===x&&this.height===S&&this.depth===w||(this.width=x,this.height=S,this.depth=w,this.texture.image.width=x,this.texture.image.height=S,this.texture.image.depth=w,this.dispose()),this.viewport.set(0,0,x,S),this.scissor.set(0,0,x,S)}clone(){return(new this.constructor).copy(this)}copy(x){return this.width=x.width,this.height=x.height,this.depth=x.depth,this.viewport.copy(x.viewport),this.texture=x.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=x.depthBuffer,this.stencilBuffer=x.stencilBuffer,this.depthTexture=x.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}WebGLRenderTarget.prototype.isWebGLRenderTarget=!0;class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(x,S,w){super(x,S);const U=this.texture;this.texture=[];for(let x=0;x<w;x++)this.texture[x]=U.clone()}setSize(x,S,w=1){if(this.width!==x||this.height!==S||this.depth!==w){this.width=x,this.height=S,this.depth=w;for(let U=0,G=this.texture.length;U<G;U++)this.texture[U].image.width=x,this.texture[U].image.height=S,this.texture[U].image.depth=w;this.dispose()}return this.viewport.set(0,0,x,S),this.scissor.set(0,0,x,S),this}copy(x){this.dispose(),this.width=x.width,this.height=x.height,this.depth=x.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=x.depthBuffer,this.stencilBuffer=x.stencilBuffer,this.depthTexture=x.depthTexture,this.texture.length=0;for(let S=0,w=x.texture.length;S<w;S++)this.texture[S]=x.texture[S].clone();return this}}WebGLMultipleRenderTargets.prototype.isWebGLMultipleRenderTargets=!0;class WebGLMultisampleRenderTarget extends WebGLRenderTarget{constructor(x,S,w){super(x,S,w),this.samples=4}copy(x){return super.copy.call(this,x),this.samples=x.samples,this}}WebGLMultisampleRenderTarget.prototype.isWebGLMultisampleRenderTarget=!0;class Quaternion{constructor(x=0,S=0,w=0,U=1){this._x=x,this._y=S,this._z=w,this._w=U}static slerp(x,S,w,U){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),w.slerpQuaternions(x,S,U)}static slerpFlat(x,S,w,U,G,H,z){let j=w[U+0],X=w[U+1],K=w[U+2],q=w[U+3];const Y=G[H+0],Z=G[H+1],J=G[H+2],Q=G[H+3];if(0===z)return x[S+0]=j,x[S+1]=X,x[S+2]=K,void(x[S+3]=q);if(1===z)return x[S+0]=Y,x[S+1]=Z,x[S+2]=J,void(x[S+3]=Q);if(q!==Q||j!==Y||X!==Z||K!==J){let x=1-z;const S=j*Y+X*Z+K*J+q*Q,w=S>=0?1:-1,U=1-S*S;if(U>Number.EPSILON){const G=Math.sqrt(U),H=Math.atan2(G,S*w);x=Math.sin(x*H)/G,z=Math.sin(z*H)/G}const G=z*w;if(j=j*x+Y*G,X=X*x+Z*G,K=K*x+J*G,q=q*x+Q*G,x===1-z){const x=1/Math.sqrt(j*j+X*X+K*K+q*q);j*=x,X*=x,K*=x,q*=x}}x[S]=j,x[S+1]=X,x[S+2]=K,x[S+3]=q}static multiplyQuaternionsFlat(x,S,w,U,G,H){const z=w[U],j=w[U+1],X=w[U+2],K=w[U+3],q=G[H],Y=G[H+1],Z=G[H+2],J=G[H+3];return x[S]=z*J+K*q+j*Z-X*Y,x[S+1]=j*J+K*Y+X*q-z*Z,x[S+2]=X*J+K*Z+z*Y-j*q,x[S+3]=K*J-z*q-j*Y-X*Z,x}get x(){return this._x}set x(x){this._x=x,this._onChangeCallback()}get y(){return this._y}set y(x){this._y=x,this._onChangeCallback()}get z(){return this._z}set z(x){this._z=x,this._onChangeCallback()}get w(){return this._w}set w(x){this._w=x,this._onChangeCallback()}set(x,S,w,U){return this._x=x,this._y=S,this._z=w,this._w=U,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(x){return this._x=x.x,this._y=x.y,this._z=x.z,this._w=x.w,this._onChangeCallback(),this}setFromEuler(x,S){if(!x||!x.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const w=x._x,U=x._y,G=x._z,H=x._order,z=Math.cos,j=Math.sin,X=z(w/2),K=z(U/2),q=z(G/2),Y=j(w/2),Z=j(U/2),J=j(G/2);switch(H){case"XYZ":this._x=Y*K*q+X*Z*J,this._y=X*Z*q-Y*K*J,this._z=X*K*J+Y*Z*q,this._w=X*K*q-Y*Z*J;break;case"YXZ":this._x=Y*K*q+X*Z*J,this._y=X*Z*q-Y*K*J,this._z=X*K*J-Y*Z*q,this._w=X*K*q+Y*Z*J;break;case"ZXY":this._x=Y*K*q-X*Z*J,this._y=X*Z*q+Y*K*J,this._z=X*K*J+Y*Z*q,this._w=X*K*q-Y*Z*J;break;case"ZYX":this._x=Y*K*q-X*Z*J,this._y=X*Z*q+Y*K*J,this._z=X*K*J-Y*Z*q,this._w=X*K*q+Y*Z*J;break;case"YZX":this._x=Y*K*q+X*Z*J,this._y=X*Z*q+Y*K*J,this._z=X*K*J-Y*Z*q,this._w=X*K*q-Y*Z*J;break;case"XZY":this._x=Y*K*q-X*Z*J,this._y=X*Z*q-Y*K*J,this._z=X*K*J+Y*Z*q,this._w=X*K*q+Y*Z*J;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+H)}return!1!==S&&this._onChangeCallback(),this}setFromAxisAngle(x,S){const w=S/2,U=Math.sin(w);return this._x=x.x*U,this._y=x.y*U,this._z=x.z*U,this._w=Math.cos(w),this._onChangeCallback(),this}setFromRotationMatrix(x){const S=x.elements,w=S[0],U=S[4],G=S[8],H=S[1],z=S[5],j=S[9],X=S[2],K=S[6],q=S[10],Y=w+z+q;if(Y>0){const x=.5/Math.sqrt(Y+1);this._w=.25/x,this._x=(K-j)*x,this._y=(G-X)*x,this._z=(H-U)*x}else if(w>z&&w>q){const x=2*Math.sqrt(1+w-z-q);this._w=(K-j)/x,this._x=.25*x,this._y=(U+H)/x,this._z=(G+X)/x}else if(z>q){const x=2*Math.sqrt(1+z-w-q);this._w=(G-X)/x,this._x=(U+H)/x,this._y=.25*x,this._z=(j+K)/x}else{const x=2*Math.sqrt(1+q-w-z);this._w=(H-U)/x,this._x=(G+X)/x,this._y=(j+K)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(x,S){let w=x.dot(S)+1;return w<Number.EPSILON?(w=0,Math.abs(x.x)>Math.abs(x.z)?(this._x=-x.y,this._y=x.x,this._z=0,this._w=w):(this._x=0,this._y=-x.z,this._z=x.y,this._w=w)):(this._x=x.y*S.z-x.z*S.y,this._y=x.z*S.x-x.x*S.z,this._z=x.x*S.y-x.y*S.x,this._w=w),this.normalize()}angleTo(x){return 2*Math.acos(Math.abs(clamp(this.dot(x),-1,1)))}rotateTowards(x,S){const w=this.angleTo(x);if(0===w)return this;const U=Math.min(1,S/w);return this.slerp(x,U),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(x){return this._x*x._x+this._y*x._y+this._z*x._z+this._w*x._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let x=this.length();return 0===x?(this._x=0,this._y=0,this._z=0,this._w=1):(x=1/x,this._x=this._x*x,this._y=this._y*x,this._z=this._z*x,this._w=this._w*x),this._onChangeCallback(),this}multiply(x,S){return void 0!==S?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(x,S)):this.multiplyQuaternions(this,x)}premultiply(x){return this.multiplyQuaternions(x,this)}multiplyQuaternions(x,S){const w=x._x,U=x._y,G=x._z,H=x._w,z=S._x,j=S._y,X=S._z,K=S._w;return this._x=w*K+H*z+U*X-G*j,this._y=U*K+H*j+G*z-w*X,this._z=G*K+H*X+w*j-U*z,this._w=H*K-w*z-U*j-G*X,this._onChangeCallback(),this}slerp(x,S){if(0===S)return this;if(1===S)return this.copy(x);const w=this._x,U=this._y,G=this._z,H=this._w;let z=H*x._w+w*x._x+U*x._y+G*x._z;if(z<0?(this._w=-x._w,this._x=-x._x,this._y=-x._y,this._z=-x._z,z=-z):this.copy(x),z>=1)return this._w=H,this._x=w,this._y=U,this._z=G,this;const j=1-z*z;if(j<=Number.EPSILON){const x=1-S;return this._w=x*H+S*this._w,this._x=x*w+S*this._x,this._y=x*U+S*this._y,this._z=x*G+S*this._z,this.normalize(),this._onChangeCallback(),this}const X=Math.sqrt(j),K=Math.atan2(X,z),q=Math.sin((1-S)*K)/X,Y=Math.sin(S*K)/X;return this._w=H*q+this._w*Y,this._x=w*q+this._x*Y,this._y=U*q+this._y*Y,this._z=G*q+this._z*Y,this._onChangeCallback(),this}slerpQuaternions(x,S,w){this.copy(x).slerp(S,w)}random(){const x=Math.random(),S=Math.sqrt(1-x),w=Math.sqrt(x),U=2*Math.PI*Math.random(),G=2*Math.PI*Math.random();return this.set(S*Math.cos(U),w*Math.sin(G),w*Math.cos(G),S*Math.sin(U))}equals(x){return x._x===this._x&&x._y===this._y&&x._z===this._z&&x._w===this._w}fromArray(x,S=0){return this._x=x[S],this._y=x[S+1],this._z=x[S+2],this._w=x[S+3],this._onChangeCallback(),this}toArray(x=[],S=0){return x[S]=this._x,x[S+1]=this._y,x[S+2]=this._z,x[S+3]=this._w,x}fromBufferAttribute(x,S){return this._x=x.getX(S),this._y=x.getY(S),this._z=x.getZ(S),this._w=x.getW(S),this}_onChange(x){return this._onChangeCallback=x,this}_onChangeCallback(){}}Quaternion.prototype.isQuaternion=!0;class Vector3{constructor(x=0,S=0,w=0){this.x=x,this.y=S,this.z=w}set(x,S,w){return void 0===w&&(w=this.z),this.x=x,this.y=S,this.z=w,this}setScalar(x){return this.x=x,this.y=x,this.z=x,this}setX(x){return this.x=x,this}setY(x){return this.y=x,this}setZ(x){return this.z=x,this}setComponent(x,S){switch(x){case 0:this.x=S;break;case 1:this.y=S;break;case 2:this.z=S;break;default:throw new Error("index is out of range: "+x)}return this}getComponent(x){switch(x){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+x)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(x){return this.x=x.x,this.y=x.y,this.z=x.z,this}add(x,S){return void 0!==S?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(x,S)):(this.x+=x.x,this.y+=x.y,this.z+=x.z,this)}addScalar(x){return this.x+=x,this.y+=x,this.z+=x,this}addVectors(x,S){return this.x=x.x+S.x,this.y=x.y+S.y,this.z=x.z+S.z,this}addScaledVector(x,S){return this.x+=x.x*S,this.y+=x.y*S,this.z+=x.z*S,this}sub(x,S){return void 0!==S?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(x,S)):(this.x-=x.x,this.y-=x.y,this.z-=x.z,this)}subScalar(x){return this.x-=x,this.y-=x,this.z-=x,this}subVectors(x,S){return this.x=x.x-S.x,this.y=x.y-S.y,this.z=x.z-S.z,this}multiply(x,S){return void 0!==S?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(x,S)):(this.x*=x.x,this.y*=x.y,this.z*=x.z,this)}multiplyScalar(x){return this.x*=x,this.y*=x,this.z*=x,this}multiplyVectors(x,S){return this.x=x.x*S.x,this.y=x.y*S.y,this.z=x.z*S.z,this}applyEuler(x){return x&&x.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(qi.setFromEuler(x))}applyAxisAngle(x,S){return this.applyQuaternion(qi.setFromAxisAngle(x,S))}applyMatrix3(x){const S=this.x,w=this.y,U=this.z,G=x.elements;return this.x=G[0]*S+G[3]*w+G[6]*U,this.y=G[1]*S+G[4]*w+G[7]*U,this.z=G[2]*S+G[5]*w+G[8]*U,this}applyNormalMatrix(x){return this.applyMatrix3(x).normalize()}applyMatrix4(x){const S=this.x,w=this.y,U=this.z,G=x.elements,H=1/(G[3]*S+G[7]*w+G[11]*U+G[15]);return this.x=(G[0]*S+G[4]*w+G[8]*U+G[12])*H,this.y=(G[1]*S+G[5]*w+G[9]*U+G[13])*H,this.z=(G[2]*S+G[6]*w+G[10]*U+G[14])*H,this}applyQuaternion(x){const S=this.x,w=this.y,U=this.z,G=x.x,H=x.y,z=x.z,j=x.w,X=j*S+H*U-z*w,K=j*w+z*S-G*U,q=j*U+G*w-H*S,Y=-G*S-H*w-z*U;return this.x=X*j+Y*-G+K*-z-q*-H,this.y=K*j+Y*-H+q*-G-X*-z,this.z=q*j+Y*-z+X*-H-K*-G,this}project(x){return this.applyMatrix4(x.matrixWorldInverse).applyMatrix4(x.projectionMatrix)}unproject(x){return this.applyMatrix4(x.projectionMatrixInverse).applyMatrix4(x.matrixWorld)}transformDirection(x){const S=this.x,w=this.y,U=this.z,G=x.elements;return this.x=G[0]*S+G[4]*w+G[8]*U,this.y=G[1]*S+G[5]*w+G[9]*U,this.z=G[2]*S+G[6]*w+G[10]*U,this.normalize()}divide(x){return this.x/=x.x,this.y/=x.y,this.z/=x.z,this}divideScalar(x){return this.multiplyScalar(1/x)}min(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this.z=Math.min(this.z,x.z),this}max(x){return this.x=Math.max(this.x,x.x),this.y=Math.max(this.y,x.y),this.z=Math.max(this.z,x.z),this}clamp(x,S){return this.x=Math.max(x.x,Math.min(S.x,this.x)),this.y=Math.max(x.y,Math.min(S.y,this.y)),this.z=Math.max(x.z,Math.min(S.z,this.z)),this}clampScalar(x,S){return this.x=Math.max(x,Math.min(S,this.x)),this.y=Math.max(x,Math.min(S,this.y)),this.z=Math.max(x,Math.min(S,this.z)),this}clampLength(x,S){const w=this.length();return this.divideScalar(w||1).multiplyScalar(Math.max(x,Math.min(S,w)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(x){return this.x*x.x+this.y*x.y+this.z*x.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(x){return this.normalize().multiplyScalar(x)}lerp(x,S){return this.x+=(x.x-this.x)*S,this.y+=(x.y-this.y)*S,this.z+=(x.z-this.z)*S,this}lerpVectors(x,S,w){return this.x=x.x+(S.x-x.x)*w,this.y=x.y+(S.y-x.y)*w,this.z=x.z+(S.z-x.z)*w,this}cross(x,S){return void 0!==S?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(x,S)):this.crossVectors(this,x)}crossVectors(x,S){const w=x.x,U=x.y,G=x.z,H=S.x,z=S.y,j=S.z;return this.x=U*j-G*z,this.y=G*H-w*j,this.z=w*z-U*H,this}projectOnVector(x){const S=x.lengthSq();if(0===S)return this.set(0,0,0);const w=x.dot(this)/S;return this.copy(x).multiplyScalar(w)}projectOnPlane(x){return Ki.copy(this).projectOnVector(x),this.sub(Ki)}reflect(x){return this.sub(Ki.copy(x).multiplyScalar(2*this.dot(x)))}angleTo(x){const S=Math.sqrt(this.lengthSq()*x.lengthSq());if(0===S)return Math.PI/2;const w=this.dot(x)/S;return Math.acos(clamp(w,-1,1))}distanceTo(x){return Math.sqrt(this.distanceToSquared(x))}distanceToSquared(x){const S=this.x-x.x,w=this.y-x.y,U=this.z-x.z;return S*S+w*w+U*U}manhattanDistanceTo(x){return Math.abs(this.x-x.x)+Math.abs(this.y-x.y)+Math.abs(this.z-x.z)}setFromSpherical(x){return this.setFromSphericalCoords(x.radius,x.phi,x.theta)}setFromSphericalCoords(x,S,w){const U=Math.sin(S)*x;return this.x=U*Math.sin(w),this.y=Math.cos(S)*x,this.z=U*Math.cos(w),this}setFromCylindrical(x){return this.setFromCylindricalCoords(x.radius,x.theta,x.y)}setFromCylindricalCoords(x,S,w){return this.x=x*Math.sin(S),this.y=w,this.z=x*Math.cos(S),this}setFromMatrixPosition(x){const S=x.elements;return this.x=S[12],this.y=S[13],this.z=S[14],this}setFromMatrixScale(x){const S=this.setFromMatrixColumn(x,0).length(),w=this.setFromMatrixColumn(x,1).length(),U=this.setFromMatrixColumn(x,2).length();return this.x=S,this.y=w,this.z=U,this}setFromMatrixColumn(x,S){return this.fromArray(x.elements,4*S)}setFromMatrix3Column(x,S){return this.fromArray(x.elements,3*S)}equals(x){return x.x===this.x&&x.y===this.y&&x.z===this.z}fromArray(x,S=0){return this.x=x[S],this.y=x[S+1],this.z=x[S+2],this}toArray(x=[],S=0){return x[S]=this.x,x[S+1]=this.y,x[S+2]=this.z,x}fromBufferAttribute(x,S,w){return void 0!==w&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=x.getX(S),this.y=x.getY(S),this.z=x.getZ(S),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const x=2*(Math.random()-.5),S=Math.random()*Math.PI*2,w=Math.sqrt(1-x**2);return this.x=w*Math.cos(S),this.y=w*Math.sin(S),this.z=x,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Vector3.prototype.isVector3=!0;const Ki=new Vector3,qi=new Quaternion;class Box3{constructor(x=new Vector3(1/0,1/0,1/0),S=new Vector3(-1/0,-1/0,-1/0)){this.min=x,this.max=S}set(x,S){return this.min.copy(x),this.max.copy(S),this}setFromArray(x){let S=1/0,w=1/0,U=1/0,G=-1/0,H=-1/0,z=-1/0;for(let j=0,X=x.length;j<X;j+=3){const X=x[j],K=x[j+1],q=x[j+2];X<S&&(S=X),K<w&&(w=K),q<U&&(U=q),X>G&&(G=X),K>H&&(H=K),q>z&&(z=q)}return this.min.set(S,w,U),this.max.set(G,H,z),this}setFromBufferAttribute(x){let S=1/0,w=1/0,U=1/0,G=-1/0,H=-1/0,z=-1/0;for(let j=0,X=x.count;j<X;j++){const X=x.getX(j),K=x.getY(j),q=x.getZ(j);X<S&&(S=X),K<w&&(w=K),q<U&&(U=q),X>G&&(G=X),K>H&&(H=K),q>z&&(z=q)}return this.min.set(S,w,U),this.max.set(G,H,z),this}setFromPoints(x){this.makeEmpty();for(let S=0,w=x.length;S<w;S++)this.expandByPoint(x[S]);return this}setFromCenterAndSize(x,S){const w=Zi.copy(S).multiplyScalar(.5);return this.min.copy(x).sub(w),this.max.copy(x).add(w),this}setFromObject(x){return this.makeEmpty(),this.expandByObject(x)}clone(){return(new this.constructor).copy(this)}copy(x){return this.min.copy(x.min),this.max.copy(x.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(x){return this.isEmpty()?x.set(0,0,0):x.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(x){return this.isEmpty()?x.set(0,0,0):x.subVectors(this.max,this.min)}expandByPoint(x){return this.min.min(x),this.max.max(x),this}expandByVector(x){return this.min.sub(x),this.max.add(x),this}expandByScalar(x){return this.min.addScalar(-x),this.max.addScalar(x),this}expandByObject(x){x.updateWorldMatrix(!1,!1);const S=x.geometry;void 0!==S&&(null===S.boundingBox&&S.computeBoundingBox(),Ji.copy(S.boundingBox),Ji.applyMatrix4(x.matrixWorld),this.union(Ji));const w=x.children;for(let x=0,S=w.length;x<S;x++)this.expandByObject(w[x]);return this}containsPoint(x){return!(x.x<this.min.x||x.x>this.max.x||x.y<this.min.y||x.y>this.max.y||x.z<this.min.z||x.z>this.max.z)}containsBox(x){return this.min.x<=x.min.x&&x.max.x<=this.max.x&&this.min.y<=x.min.y&&x.max.y<=this.max.y&&this.min.z<=x.min.z&&x.max.z<=this.max.z}getParameter(x,S){return S.set((x.x-this.min.x)/(this.max.x-this.min.x),(x.y-this.min.y)/(this.max.y-this.min.y),(x.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(x){return!(x.max.x<this.min.x||x.min.x>this.max.x||x.max.y<this.min.y||x.min.y>this.max.y||x.max.z<this.min.z||x.min.z>this.max.z)}intersectsSphere(x){return this.clampPoint(x.center,Zi),Zi.distanceToSquared(x.center)<=x.radius*x.radius}intersectsPlane(x){let S,w;return x.normal.x>0?(S=x.normal.x*this.min.x,w=x.normal.x*this.max.x):(S=x.normal.x*this.max.x,w=x.normal.x*this.min.x),x.normal.y>0?(S+=x.normal.y*this.min.y,w+=x.normal.y*this.max.y):(S+=x.normal.y*this.max.y,w+=x.normal.y*this.min.y),x.normal.z>0?(S+=x.normal.z*this.min.z,w+=x.normal.z*this.max.z):(S+=x.normal.z*this.max.z,w+=x.normal.z*this.min.z),S<=-x.constant&&w>=-x.constant}intersectsTriangle(x){if(this.isEmpty())return!1;this.getCenter(or),ar.subVectors(this.max,or),Qi.subVectors(x.a,or),er.subVectors(x.b,or),tr.subVectors(x.c,or),nr.subVectors(er,Qi),ir.subVectors(tr,er),rr.subVectors(Qi,tr);let S=[0,-nr.z,nr.y,0,-ir.z,ir.y,0,-rr.z,rr.y,nr.z,0,-nr.x,ir.z,0,-ir.x,rr.z,0,-rr.x,-nr.y,nr.x,0,-ir.y,ir.x,0,-rr.y,rr.x,0];return!!satForAxes(S,Qi,er,tr,ar)&&(S=[1,0,0,0,1,0,0,0,1],!!satForAxes(S,Qi,er,tr,ar)&&(sr.crossVectors(nr,ir),S=[sr.x,sr.y,sr.z],satForAxes(S,Qi,er,tr,ar)))}clampPoint(x,S){return S.copy(x).clamp(this.min,this.max)}distanceToPoint(x){return Zi.copy(x).clamp(this.min,this.max).sub(x).length()}getBoundingSphere(x){return this.getCenter(x.center),x.radius=.5*this.getSize(Zi).length(),x}intersect(x){return this.min.max(x.min),this.max.min(x.max),this.isEmpty()&&this.makeEmpty(),this}union(x){return this.min.min(x.min),this.max.max(x.max),this}applyMatrix4(x){return this.isEmpty()||(Yi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(x),Yi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(x),Yi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(x),Yi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(x),Yi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(x),Yi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(x),Yi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(x),Yi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(x),this.setFromPoints(Yi)),this}translate(x){return this.min.add(x),this.max.add(x),this}equals(x){return x.min.equals(this.min)&&x.max.equals(this.max)}}Box3.prototype.isBox3=!0;const Yi=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],Zi=new Vector3,Ji=new Box3,Qi=new Vector3,er=new Vector3,tr=new Vector3,nr=new Vector3,ir=new Vector3,rr=new Vector3,or=new Vector3,ar=new Vector3,sr=new Vector3,lr=new Vector3;function satForAxes(x,S,w,U,G){for(let H=0,z=x.length-3;H<=z;H+=3){lr.fromArray(x,H);const z=G.x*Math.abs(lr.x)+G.y*Math.abs(lr.y)+G.z*Math.abs(lr.z),j=S.dot(lr),X=w.dot(lr),K=U.dot(lr);if(Math.max(-Math.max(j,X,K),Math.min(j,X,K))>z)return!1}return!0}const cr=new Box3,ur=new Vector3,hr=new Vector3,dr=new Vector3;class Sphere{constructor(x=new Vector3,S=-1){this.center=x,this.radius=S}set(x,S){return this.center.copy(x),this.radius=S,this}setFromPoints(x,S){const w=this.center;void 0!==S?w.copy(S):cr.setFromPoints(x).getCenter(w);let U=0;for(let S=0,G=x.length;S<G;S++)U=Math.max(U,w.distanceToSquared(x[S]));return this.radius=Math.sqrt(U),this}copy(x){return this.center.copy(x.center),this.radius=x.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(x){return x.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(x){return x.distanceTo(this.center)-this.radius}intersectsSphere(x){const S=this.radius+x.radius;return x.center.distanceToSquared(this.center)<=S*S}intersectsBox(x){return x.intersectsSphere(this)}intersectsPlane(x){return Math.abs(x.distanceToPoint(this.center))<=this.radius}clampPoint(x,S){const w=this.center.distanceToSquared(x);return S.copy(x),w>this.radius*this.radius&&(S.sub(this.center).normalize(),S.multiplyScalar(this.radius).add(this.center)),S}getBoundingBox(x){return this.isEmpty()?(x.makeEmpty(),x):(x.set(this.center,this.center),x.expandByScalar(this.radius),x)}applyMatrix4(x){return this.center.applyMatrix4(x),this.radius=this.radius*x.getMaxScaleOnAxis(),this}translate(x){return this.center.add(x),this}expandByPoint(x){dr.subVectors(x,this.center);const S=dr.lengthSq();if(S>this.radius*this.radius){const x=Math.sqrt(S),w=.5*(x-this.radius);this.center.add(dr.multiplyScalar(w/x)),this.radius+=w}return this}union(x){return hr.subVectors(x.center,this.center).normalize().multiplyScalar(x.radius),this.expandByPoint(ur.copy(x.center).add(hr)),this.expandByPoint(ur.copy(x.center).sub(hr)),this}equals(x){return x.center.equals(this.center)&&x.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const pr=new Vector3,mr=new Vector3,fr=new Vector3,gr=new Vector3,vr=new Vector3,_r=new Vector3,yr=new Vector3;class Ray{constructor(x=new Vector3,S=new Vector3(0,0,-1)){this.origin=x,this.direction=S}set(x,S){return this.origin.copy(x),this.direction.copy(S),this}copy(x){return this.origin.copy(x.origin),this.direction.copy(x.direction),this}at(x,S){return S.copy(this.direction).multiplyScalar(x).add(this.origin)}lookAt(x){return this.direction.copy(x).sub(this.origin).normalize(),this}recast(x){return this.origin.copy(this.at(x,pr)),this}closestPointToPoint(x,S){S.subVectors(x,this.origin);const w=S.dot(this.direction);return w<0?S.copy(this.origin):S.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(x){return Math.sqrt(this.distanceSqToPoint(x))}distanceSqToPoint(x){const S=pr.subVectors(x,this.origin).dot(this.direction);return S<0?this.origin.distanceToSquared(x):(pr.copy(this.direction).multiplyScalar(S).add(this.origin),pr.distanceToSquared(x))}distanceSqToSegment(x,S,w,U){mr.copy(x).add(S).multiplyScalar(.5),fr.copy(S).sub(x).normalize(),gr.copy(this.origin).sub(mr);const G=.5*x.distanceTo(S),H=-this.direction.dot(fr),z=gr.dot(this.direction),j=-gr.dot(fr),X=gr.lengthSq(),K=Math.abs(1-H*H);let q,Y,Z,J;if(K>0)if(q=H*j-z,Y=H*z-j,J=G*K,q>=0)if(Y>=-J)if(Y<=J){const x=1/K;q*=x,Y*=x,Z=q*(q+H*Y+2*z)+Y*(H*q+Y+2*j)+X}else Y=G,q=Math.max(0,-(H*Y+z)),Z=-q*q+Y*(Y+2*j)+X;else Y=-G,q=Math.max(0,-(H*Y+z)),Z=-q*q+Y*(Y+2*j)+X;else Y<=-J?(q=Math.max(0,-(-H*G+z)),Y=q>0?-G:Math.min(Math.max(-G,-j),G),Z=-q*q+Y*(Y+2*j)+X):Y<=J?(q=0,Y=Math.min(Math.max(-G,-j),G),Z=Y*(Y+2*j)+X):(q=Math.max(0,-(H*G+z)),Y=q>0?G:Math.min(Math.max(-G,-j),G),Z=-q*q+Y*(Y+2*j)+X);else Y=H>0?-G:G,q=Math.max(0,-(H*Y+z)),Z=-q*q+Y*(Y+2*j)+X;return w&&w.copy(this.direction).multiplyScalar(q).add(this.origin),U&&U.copy(fr).multiplyScalar(Y).add(mr),Z}intersectSphere(x,S){pr.subVectors(x.center,this.origin);const w=pr.dot(this.direction),U=pr.dot(pr)-w*w,G=x.radius*x.radius;if(U>G)return null;const H=Math.sqrt(G-U),z=w-H,j=w+H;return z<0&&j<0?null:z<0?this.at(j,S):this.at(z,S)}intersectsSphere(x){return this.distanceSqToPoint(x.center)<=x.radius*x.radius}distanceToPlane(x){const S=x.normal.dot(this.direction);if(0===S)return 0===x.distanceToPoint(this.origin)?0:null;const w=-(this.origin.dot(x.normal)+x.constant)/S;return w>=0?w:null}intersectPlane(x,S){const w=this.distanceToPlane(x);return null===w?null:this.at(w,S)}intersectsPlane(x){const S=x.distanceToPoint(this.origin);if(0===S)return!0;return x.normal.dot(this.direction)*S<0}intersectBox(x,S){let w,U,G,H,z,j;const X=1/this.direction.x,K=1/this.direction.y,q=1/this.direction.z,Y=this.origin;return X>=0?(w=(x.min.x-Y.x)*X,U=(x.max.x-Y.x)*X):(w=(x.max.x-Y.x)*X,U=(x.min.x-Y.x)*X),K>=0?(G=(x.min.y-Y.y)*K,H=(x.max.y-Y.y)*K):(G=(x.max.y-Y.y)*K,H=(x.min.y-Y.y)*K),w>H||G>U?null:((G>w||w!=w)&&(w=G),(H<U||U!=U)&&(U=H),q>=0?(z=(x.min.z-Y.z)*q,j=(x.max.z-Y.z)*q):(z=(x.max.z-Y.z)*q,j=(x.min.z-Y.z)*q),w>j||z>U?null:((z>w||w!=w)&&(w=z),(j<U||U!=U)&&(U=j),U<0?null:this.at(w>=0?w:U,S)))}intersectsBox(x){return null!==this.intersectBox(x,pr)}intersectTriangle(x,S,w,U,G){vr.subVectors(S,x),_r.subVectors(w,x),yr.crossVectors(vr,_r);let H,z=this.direction.dot(yr);if(z>0){if(U)return null;H=1}else{if(!(z<0))return null;H=-1,z=-z}gr.subVectors(this.origin,x);const j=H*this.direction.dot(_r.crossVectors(gr,_r));if(j<0)return null;const X=H*this.direction.dot(vr.cross(gr));if(X<0)return null;if(j+X>z)return null;const K=-H*gr.dot(yr);return K<0?null:this.at(K/z,G)}applyMatrix4(x){return this.origin.applyMatrix4(x),this.direction.transformDirection(x),this}equals(x){return x.origin.equals(this.origin)&&x.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Matrix4{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(x,S,w,U,G,H,z,j,X,K,q,Y,Z,J,Q,ee){const te=this.elements;return te[0]=x,te[4]=S,te[8]=w,te[12]=U,te[1]=G,te[5]=H,te[9]=z,te[13]=j,te[2]=X,te[6]=K,te[10]=q,te[14]=Y,te[3]=Z,te[7]=J,te[11]=Q,te[15]=ee,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Matrix4).fromArray(this.elements)}copy(x){const S=this.elements,w=x.elements;return S[0]=w[0],S[1]=w[1],S[2]=w[2],S[3]=w[3],S[4]=w[4],S[5]=w[5],S[6]=w[6],S[7]=w[7],S[8]=w[8],S[9]=w[9],S[10]=w[10],S[11]=w[11],S[12]=w[12],S[13]=w[13],S[14]=w[14],S[15]=w[15],this}copyPosition(x){const S=this.elements,w=x.elements;return S[12]=w[12],S[13]=w[13],S[14]=w[14],this}setFromMatrix3(x){const S=x.elements;return this.set(S[0],S[3],S[6],0,S[1],S[4],S[7],0,S[2],S[5],S[8],0,0,0,0,1),this}extractBasis(x,S,w){return x.setFromMatrixColumn(this,0),S.setFromMatrixColumn(this,1),w.setFromMatrixColumn(this,2),this}makeBasis(x,S,w){return this.set(x.x,S.x,w.x,0,x.y,S.y,w.y,0,x.z,S.z,w.z,0,0,0,0,1),this}extractRotation(x){const S=this.elements,w=x.elements,U=1/br.setFromMatrixColumn(x,0).length(),G=1/br.setFromMatrixColumn(x,1).length(),H=1/br.setFromMatrixColumn(x,2).length();return S[0]=w[0]*U,S[1]=w[1]*U,S[2]=w[2]*U,S[3]=0,S[4]=w[4]*G,S[5]=w[5]*G,S[6]=w[6]*G,S[7]=0,S[8]=w[8]*H,S[9]=w[9]*H,S[10]=w[10]*H,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,this}makeRotationFromEuler(x){x&&x.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const S=this.elements,w=x.x,U=x.y,G=x.z,H=Math.cos(w),z=Math.sin(w),j=Math.cos(U),X=Math.sin(U),K=Math.cos(G),q=Math.sin(G);if("XYZ"===x.order){const x=H*K,w=H*q,U=z*K,G=z*q;S[0]=j*K,S[4]=-j*q,S[8]=X,S[1]=w+U*X,S[5]=x-G*X,S[9]=-z*j,S[2]=G-x*X,S[6]=U+w*X,S[10]=H*j}else if("YXZ"===x.order){const x=j*K,w=j*q,U=X*K,G=X*q;S[0]=x+G*z,S[4]=U*z-w,S[8]=H*X,S[1]=H*q,S[5]=H*K,S[9]=-z,S[2]=w*z-U,S[6]=G+x*z,S[10]=H*j}else if("ZXY"===x.order){const x=j*K,w=j*q,U=X*K,G=X*q;S[0]=x-G*z,S[4]=-H*q,S[8]=U+w*z,S[1]=w+U*z,S[5]=H*K,S[9]=G-x*z,S[2]=-H*X,S[6]=z,S[10]=H*j}else if("ZYX"===x.order){const x=H*K,w=H*q,U=z*K,G=z*q;S[0]=j*K,S[4]=U*X-w,S[8]=x*X+G,S[1]=j*q,S[5]=G*X+x,S[9]=w*X-U,S[2]=-X,S[6]=z*j,S[10]=H*j}else if("YZX"===x.order){const x=H*j,w=H*X,U=z*j,G=z*X;S[0]=j*K,S[4]=G-x*q,S[8]=U*q+w,S[1]=q,S[5]=H*K,S[9]=-z*K,S[2]=-X*K,S[6]=w*q+U,S[10]=x-G*q}else if("XZY"===x.order){const x=H*j,w=H*X,U=z*j,G=z*X;S[0]=j*K,S[4]=-q,S[8]=X*K,S[1]=x*q+G,S[5]=H*K,S[9]=w*q-U,S[2]=U*q-w,S[6]=z*K,S[10]=G*q+x}return S[3]=0,S[7]=0,S[11]=0,S[12]=0,S[13]=0,S[14]=0,S[15]=1,this}makeRotationFromQuaternion(x){return this.compose(Er,x,Sr)}lookAt(x,S,w){const U=this.elements;return Cr.subVectors(x,S),0===Cr.lengthSq()&&(Cr.z=1),Cr.normalize(),wr.crossVectors(w,Cr),0===wr.lengthSq()&&(1===Math.abs(w.z)?Cr.x+=1e-4:Cr.z+=1e-4,Cr.normalize(),wr.crossVectors(w,Cr)),wr.normalize(),Tr.crossVectors(Cr,wr),U[0]=wr.x,U[4]=Tr.x,U[8]=Cr.x,U[1]=wr.y,U[5]=Tr.y,U[9]=Cr.y,U[2]=wr.z,U[6]=Tr.z,U[10]=Cr.z,this}multiply(x,S){return void 0!==S?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(x,S)):this.multiplyMatrices(this,x)}premultiply(x){return this.multiplyMatrices(x,this)}multiplyMatrices(x,S){const w=x.elements,U=S.elements,G=this.elements,H=w[0],z=w[4],j=w[8],X=w[12],K=w[1],q=w[5],Y=w[9],Z=w[13],J=w[2],Q=w[6],ee=w[10],te=w[14],ne=w[3],ie=w[7],re=w[11],oe=w[15],ae=U[0],se=U[4],le=U[8],ce=U[12],ue=U[1],he=U[5],de=U[9],pe=U[13],me=U[2],fe=U[6],ge=U[10],ve=U[14],_e=U[3],ye=U[7],be=U[11],xe=U[15];return G[0]=H*ae+z*ue+j*me+X*_e,G[4]=H*se+z*he+j*fe+X*ye,G[8]=H*le+z*de+j*ge+X*be,G[12]=H*ce+z*pe+j*ve+X*xe,G[1]=K*ae+q*ue+Y*me+Z*_e,G[5]=K*se+q*he+Y*fe+Z*ye,G[9]=K*le+q*de+Y*ge+Z*be,G[13]=K*ce+q*pe+Y*ve+Z*xe,G[2]=J*ae+Q*ue+ee*me+te*_e,G[6]=J*se+Q*he+ee*fe+te*ye,G[10]=J*le+Q*de+ee*ge+te*be,G[14]=J*ce+Q*pe+ee*ve+te*xe,G[3]=ne*ae+ie*ue+re*me+oe*_e,G[7]=ne*se+ie*he+re*fe+oe*ye,G[11]=ne*le+ie*de+re*ge+oe*be,G[15]=ne*ce+ie*pe+re*ve+oe*xe,this}multiplyScalar(x){const S=this.elements;return S[0]*=x,S[4]*=x,S[8]*=x,S[12]*=x,S[1]*=x,S[5]*=x,S[9]*=x,S[13]*=x,S[2]*=x,S[6]*=x,S[10]*=x,S[14]*=x,S[3]*=x,S[7]*=x,S[11]*=x,S[15]*=x,this}determinant(){const x=this.elements,S=x[0],w=x[4],U=x[8],G=x[12],H=x[1],z=x[5],j=x[9],X=x[13],K=x[2],q=x[6],Y=x[10],Z=x[14];return x[3]*(+G*j*q-U*X*q-G*z*Y+w*X*Y+U*z*Z-w*j*Z)+x[7]*(+S*j*Z-S*X*Y+G*H*Y-U*H*Z+U*X*K-G*j*K)+x[11]*(+S*X*q-S*z*Z-G*H*q+w*H*Z+G*z*K-w*X*K)+x[15]*(-U*z*K-S*j*q+S*z*Y+U*H*q-w*H*Y+w*j*K)}transpose(){const x=this.elements;let S;return S=x[1],x[1]=x[4],x[4]=S,S=x[2],x[2]=x[8],x[8]=S,S=x[6],x[6]=x[9],x[9]=S,S=x[3],x[3]=x[12],x[12]=S,S=x[7],x[7]=x[13],x[13]=S,S=x[11],x[11]=x[14],x[14]=S,this}setPosition(x,S,w){const U=this.elements;return x.isVector3?(U[12]=x.x,U[13]=x.y,U[14]=x.z):(U[12]=x,U[13]=S,U[14]=w),this}invert(){const x=this.elements,S=x[0],w=x[1],U=x[2],G=x[3],H=x[4],z=x[5],j=x[6],X=x[7],K=x[8],q=x[9],Y=x[10],Z=x[11],J=x[12],Q=x[13],ee=x[14],te=x[15],ne=q*ee*X-Q*Y*X+Q*j*Z-z*ee*Z-q*j*te+z*Y*te,ie=J*Y*X-K*ee*X-J*j*Z+H*ee*Z+K*j*te-H*Y*te,re=K*Q*X-J*q*X+J*z*Z-H*Q*Z-K*z*te+H*q*te,oe=J*q*j-K*Q*j-J*z*Y+H*Q*Y+K*z*ee-H*q*ee,ae=S*ne+w*ie+U*re+G*oe;if(0===ae)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const se=1/ae;return x[0]=ne*se,x[1]=(Q*Y*G-q*ee*G-Q*U*Z+w*ee*Z+q*U*te-w*Y*te)*se,x[2]=(z*ee*G-Q*j*G+Q*U*X-w*ee*X-z*U*te+w*j*te)*se,x[3]=(q*j*G-z*Y*G-q*U*X+w*Y*X+z*U*Z-w*j*Z)*se,x[4]=ie*se,x[5]=(K*ee*G-J*Y*G+J*U*Z-S*ee*Z-K*U*te+S*Y*te)*se,x[6]=(J*j*G-H*ee*G-J*U*X+S*ee*X+H*U*te-S*j*te)*se,x[7]=(H*Y*G-K*j*G+K*U*X-S*Y*X-H*U*Z+S*j*Z)*se,x[8]=re*se,x[9]=(J*q*G-K*Q*G-J*w*Z+S*Q*Z+K*w*te-S*q*te)*se,x[10]=(H*Q*G-J*z*G+J*w*X-S*Q*X-H*w*te+S*z*te)*se,x[11]=(K*z*G-H*q*G-K*w*X+S*q*X+H*w*Z-S*z*Z)*se,x[12]=oe*se,x[13]=(K*Q*U-J*q*U+J*w*Y-S*Q*Y-K*w*ee+S*q*ee)*se,x[14]=(J*z*U-H*Q*U-J*w*j+S*Q*j+H*w*ee-S*z*ee)*se,x[15]=(H*q*U-K*z*U+K*w*j-S*q*j-H*w*Y+S*z*Y)*se,this}scale(x){const S=this.elements,w=x.x,U=x.y,G=x.z;return S[0]*=w,S[4]*=U,S[8]*=G,S[1]*=w,S[5]*=U,S[9]*=G,S[2]*=w,S[6]*=U,S[10]*=G,S[3]*=w,S[7]*=U,S[11]*=G,this}getMaxScaleOnAxis(){const x=this.elements,S=x[0]*x[0]+x[1]*x[1]+x[2]*x[2],w=x[4]*x[4]+x[5]*x[5]+x[6]*x[6],U=x[8]*x[8]+x[9]*x[9]+x[10]*x[10];return Math.sqrt(Math.max(S,w,U))}makeTranslation(x,S,w){return this.set(1,0,0,x,0,1,0,S,0,0,1,w,0,0,0,1),this}makeRotationX(x){const S=Math.cos(x),w=Math.sin(x);return this.set(1,0,0,0,0,S,-w,0,0,w,S,0,0,0,0,1),this}makeRotationY(x){const S=Math.cos(x),w=Math.sin(x);return this.set(S,0,w,0,0,1,0,0,-w,0,S,0,0,0,0,1),this}makeRotationZ(x){const S=Math.cos(x),w=Math.sin(x);return this.set(S,-w,0,0,w,S,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(x,S){const w=Math.cos(S),U=Math.sin(S),G=1-w,H=x.x,z=x.y,j=x.z,X=G*H,K=G*z;return this.set(X*H+w,X*z-U*j,X*j+U*z,0,X*z+U*j,K*z+w,K*j-U*H,0,X*j-U*z,K*j+U*H,G*j*j+w,0,0,0,0,1),this}makeScale(x,S,w){return this.set(x,0,0,0,0,S,0,0,0,0,w,0,0,0,0,1),this}makeShear(x,S,w,U,G,H){return this.set(1,w,G,0,x,1,H,0,S,U,1,0,0,0,0,1),this}compose(x,S,w){const U=this.elements,G=S._x,H=S._y,z=S._z,j=S._w,X=G+G,K=H+H,q=z+z,Y=G*X,Z=G*K,J=G*q,Q=H*K,ee=H*q,te=z*q,ne=j*X,ie=j*K,re=j*q,oe=w.x,ae=w.y,se=w.z;return U[0]=(1-(Q+te))*oe,U[1]=(Z+re)*oe,U[2]=(J-ie)*oe,U[3]=0,U[4]=(Z-re)*ae,U[5]=(1-(Y+te))*ae,U[6]=(ee+ne)*ae,U[7]=0,U[8]=(J+ie)*se,U[9]=(ee-ne)*se,U[10]=(1-(Y+Q))*se,U[11]=0,U[12]=x.x,U[13]=x.y,U[14]=x.z,U[15]=1,this}decompose(x,S,w){const U=this.elements;let G=br.set(U[0],U[1],U[2]).length();const H=br.set(U[4],U[5],U[6]).length(),z=br.set(U[8],U[9],U[10]).length();this.determinant()<0&&(G=-G),x.x=U[12],x.y=U[13],x.z=U[14],xr.copy(this);const j=1/G,X=1/H,K=1/z;return xr.elements[0]*=j,xr.elements[1]*=j,xr.elements[2]*=j,xr.elements[4]*=X,xr.elements[5]*=X,xr.elements[6]*=X,xr.elements[8]*=K,xr.elements[9]*=K,xr.elements[10]*=K,S.setFromRotationMatrix(xr),w.x=G,w.y=H,w.z=z,this}makePerspective(x,S,w,U,G,H){void 0===H&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const z=this.elements,j=2*G/(S-x),X=2*G/(w-U),K=(S+x)/(S-x),q=(w+U)/(w-U),Y=-(H+G)/(H-G),Z=-2*H*G/(H-G);return z[0]=j,z[4]=0,z[8]=K,z[12]=0,z[1]=0,z[5]=X,z[9]=q,z[13]=0,z[2]=0,z[6]=0,z[10]=Y,z[14]=Z,z[3]=0,z[7]=0,z[11]=-1,z[15]=0,this}makeOrthographic(x,S,w,U,G,H){const z=this.elements,j=1/(S-x),X=1/(w-U),K=1/(H-G),q=(S+x)*j,Y=(w+U)*X,Z=(H+G)*K;return z[0]=2*j,z[4]=0,z[8]=0,z[12]=-q,z[1]=0,z[5]=2*X,z[9]=0,z[13]=-Y,z[2]=0,z[6]=0,z[10]=-2*K,z[14]=-Z,z[3]=0,z[7]=0,z[11]=0,z[15]=1,this}equals(x){const S=this.elements,w=x.elements;for(let x=0;x<16;x++)if(S[x]!==w[x])return!1;return!0}fromArray(x,S=0){for(let w=0;w<16;w++)this.elements[w]=x[w+S];return this}toArray(x=[],S=0){const w=this.elements;return x[S]=w[0],x[S+1]=w[1],x[S+2]=w[2],x[S+3]=w[3],x[S+4]=w[4],x[S+5]=w[5],x[S+6]=w[6],x[S+7]=w[7],x[S+8]=w[8],x[S+9]=w[9],x[S+10]=w[10],x[S+11]=w[11],x[S+12]=w[12],x[S+13]=w[13],x[S+14]=w[14],x[S+15]=w[15],x}}Matrix4.prototype.isMatrix4=!0;const br=new Vector3,xr=new Matrix4,Er=new Vector3(0,0,0),Sr=new Vector3(1,1,1),wr=new Vector3,Tr=new Vector3,Cr=new Vector3,Ar=new Matrix4,Mr=new Quaternion;class Euler{constructor(x=0,S=0,w=0,U=Euler.DefaultOrder){this._x=x,this._y=S,this._z=w,this._order=U}get x(){return this._x}set x(x){this._x=x,this._onChangeCallback()}get y(){return this._y}set y(x){this._y=x,this._onChangeCallback()}get z(){return this._z}set z(x){this._z=x,this._onChangeCallback()}get order(){return this._order}set order(x){this._order=x,this._onChangeCallback()}set(x,S,w,U=this._order){return this._x=x,this._y=S,this._z=w,this._order=U,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(x){return this._x=x._x,this._y=x._y,this._z=x._z,this._order=x._order,this._onChangeCallback(),this}setFromRotationMatrix(x,S=this._order,w=!0){const U=x.elements,G=U[0],H=U[4],z=U[8],j=U[1],X=U[5],K=U[9],q=U[2],Y=U[6],Z=U[10];switch(S){case"XYZ":this._y=Math.asin(clamp(z,-1,1)),Math.abs(z)<.9999999?(this._x=Math.atan2(-K,Z),this._z=Math.atan2(-H,G)):(this._x=Math.atan2(Y,X),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(K,-1,1)),Math.abs(K)<.9999999?(this._y=Math.atan2(z,Z),this._z=Math.atan2(j,X)):(this._y=Math.atan2(-q,G),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(Y,-1,1)),Math.abs(Y)<.9999999?(this._y=Math.atan2(-q,Z),this._z=Math.atan2(-H,X)):(this._y=0,this._z=Math.atan2(j,G));break;case"ZYX":this._y=Math.asin(-clamp(q,-1,1)),Math.abs(q)<.9999999?(this._x=Math.atan2(Y,Z),this._z=Math.atan2(j,G)):(this._x=0,this._z=Math.atan2(-H,X));break;case"YZX":this._z=Math.asin(clamp(j,-1,1)),Math.abs(j)<.9999999?(this._x=Math.atan2(-K,X),this._y=Math.atan2(-q,G)):(this._x=0,this._y=Math.atan2(z,Z));break;case"XZY":this._z=Math.asin(-clamp(H,-1,1)),Math.abs(H)<.9999999?(this._x=Math.atan2(Y,X),this._y=Math.atan2(z,G)):(this._x=Math.atan2(-K,Z),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+S)}return this._order=S,!0===w&&this._onChangeCallback(),this}setFromQuaternion(x,S,w){return Ar.makeRotationFromQuaternion(x),this.setFromRotationMatrix(Ar,S,w)}setFromVector3(x,S=this._order){return this.set(x.x,x.y,x.z,S)}reorder(x){return Mr.setFromEuler(this),this.setFromQuaternion(Mr,x)}equals(x){return x._x===this._x&&x._y===this._y&&x._z===this._z&&x._order===this._order}fromArray(x){return this._x=x[0],this._y=x[1],this._z=x[2],void 0!==x[3]&&(this._order=x[3]),this._onChangeCallback(),this}toArray(x=[],S=0){return x[S]=this._x,x[S+1]=this._y,x[S+2]=this._z,x[S+3]=this._order,x}toVector3(x){return x?x.set(this._x,this._y,this._z):new Vector3(this._x,this._y,this._z)}_onChange(x){return this._onChangeCallback=x,this}_onChangeCallback(){}}Euler.prototype.isEuler=!0,Euler.DefaultOrder="XYZ",Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Layers{constructor(){this.mask=1}set(x){this.mask=1<<x|0}enable(x){this.mask|=1<<x|0}enableAll(){this.mask=-1}toggle(x){this.mask^=1<<x|0}disable(x){this.mask&=~(1<<x|0)}disableAll(){this.mask=0}test(x){return 0!=(this.mask&x.mask)}}let Rr=0;const Lr=new Vector3,Ir=new Quaternion,Pr=new Matrix4,Fr=new Vector3,Or=new Vector3,Nr=new Vector3,Br=new Quaternion,Dr=new Vector3(1,0,0),kr=new Vector3(0,1,0),Ur=new Vector3(0,0,1),Gr={type:"added"},Vr={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:Rr++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();const x=new Vector3,S=new Euler,w=new Quaternion,U=new Vector3(1,1,1);S._onChange((function onRotationChange(){w.setFromEuler(S,!1)})),w._onChange((function onQuaternionChange(){S.setFromQuaternion(w,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:x},rotation:{configurable:!0,enumerable:!0,value:S},quaternion:{configurable:!0,enumerable:!0,value:w},scale:{configurable:!0,enumerable:!0,value:U},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(x){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(x),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(x){return this.quaternion.premultiply(x),this}setRotationFromAxisAngle(x,S){this.quaternion.setFromAxisAngle(x,S)}setRotationFromEuler(x){this.quaternion.setFromEuler(x,!0)}setRotationFromMatrix(x){this.quaternion.setFromRotationMatrix(x)}setRotationFromQuaternion(x){this.quaternion.copy(x)}rotateOnAxis(x,S){return Ir.setFromAxisAngle(x,S),this.quaternion.multiply(Ir),this}rotateOnWorldAxis(x,S){return Ir.setFromAxisAngle(x,S),this.quaternion.premultiply(Ir),this}rotateX(x){return this.rotateOnAxis(Dr,x)}rotateY(x){return this.rotateOnAxis(kr,x)}rotateZ(x){return this.rotateOnAxis(Ur,x)}translateOnAxis(x,S){return Lr.copy(x).applyQuaternion(this.quaternion),this.position.add(Lr.multiplyScalar(S)),this}translateX(x){return this.translateOnAxis(Dr,x)}translateY(x){return this.translateOnAxis(kr,x)}translateZ(x){return this.translateOnAxis(Ur,x)}localToWorld(x){return x.applyMatrix4(this.matrixWorld)}worldToLocal(x){return x.applyMatrix4(Pr.copy(this.matrixWorld).invert())}lookAt(x,S,w){x.isVector3?Fr.copy(x):Fr.set(x,S,w);const U=this.parent;this.updateWorldMatrix(!0,!1),Or.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Pr.lookAt(Or,Fr,this.up):Pr.lookAt(Fr,Or,this.up),this.quaternion.setFromRotationMatrix(Pr),U&&(Pr.extractRotation(U.matrixWorld),Ir.setFromRotationMatrix(Pr),this.quaternion.premultiply(Ir.invert()))}add(x){if(arguments.length>1){for(let x=0;x<arguments.length;x++)this.add(arguments[x]);return this}return x===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",x),this):(x&&x.isObject3D?(null!==x.parent&&x.parent.remove(x),x.parent=this,this.children.push(x),x.dispatchEvent(Gr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",x),this)}remove(x){if(arguments.length>1){for(let x=0;x<arguments.length;x++)this.remove(arguments[x]);return this}const S=this.children.indexOf(x);return-1!==S&&(x.parent=null,this.children.splice(S,1),x.dispatchEvent(Vr)),this}removeFromParent(){const x=this.parent;return null!==x&&x.remove(this),this}clear(){for(let x=0;x<this.children.length;x++){const S=this.children[x];S.parent=null,S.dispatchEvent(Vr)}return this.children.length=0,this}attach(x){return this.updateWorldMatrix(!0,!1),Pr.copy(this.matrixWorld).invert(),null!==x.parent&&(x.parent.updateWorldMatrix(!0,!1),Pr.multiply(x.parent.matrixWorld)),x.applyMatrix4(Pr),this.add(x),x.updateWorldMatrix(!1,!0),this}getObjectById(x){return this.getObjectByProperty("id",x)}getObjectByName(x){return this.getObjectByProperty("name",x)}getObjectByProperty(x,S){if(this[x]===S)return this;for(let w=0,U=this.children.length;w<U;w++){const U=this.children[w].getObjectByProperty(x,S);if(void 0!==U)return U}}getWorldPosition(x){return this.updateWorldMatrix(!0,!1),x.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(x){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Or,x,Nr),x}getWorldScale(x){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Or,Br,x),x}getWorldDirection(x){this.updateWorldMatrix(!0,!1);const S=this.matrixWorld.elements;return x.set(S[8],S[9],S[10]).normalize()}raycast(){}traverse(x){x(this);const S=this.children;for(let w=0,U=S.length;w<U;w++)S[w].traverse(x)}traverseVisible(x){if(!1===this.visible)return;x(this);const S=this.children;for(let w=0,U=S.length;w<U;w++)S[w].traverseVisible(x)}traverseAncestors(x){const S=this.parent;null!==S&&(x(S),S.traverseAncestors(x))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(x){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||x)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,x=!0);const S=this.children;for(let w=0,U=S.length;w<U;w++)S[w].updateMatrixWorld(x)}updateWorldMatrix(x,S){const w=this.parent;if(!0===x&&null!==w&&w.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===S){const x=this.children;for(let S=0,w=x.length;S<w;S++)x[S].updateWorldMatrix(!1,!0)}}toJSON(x){const S=void 0===x||"string"==typeof x,w={};S&&(x={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},w.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const U={};function serialize(S,w){return void 0===S[w.uuid]&&(S[w.uuid]=w.toJSON(x)),w.uuid}if(U.uuid=this.uuid,U.type=this.type,""!==this.name&&(U.name=this.name),!0===this.castShadow&&(U.castShadow=!0),!0===this.receiveShadow&&(U.receiveShadow=!0),!1===this.visible&&(U.visible=!1),!1===this.frustumCulled&&(U.frustumCulled=!1),0!==this.renderOrder&&(U.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(U.userData=this.userData),U.layers=this.layers.mask,U.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(U.matrixAutoUpdate=!1),this.isInstancedMesh&&(U.type="InstancedMesh",U.count=this.count,U.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(U.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?U.background=this.background.toJSON():this.background.isTexture&&(U.background=this.background.toJSON(x).uuid)),this.environment&&this.environment.isTexture&&(U.environment=this.environment.toJSON(x).uuid);else if(this.isMesh||this.isLine||this.isPoints){U.geometry=serialize(x.geometries,this.geometry);const S=this.geometry.parameters;if(void 0!==S&&void 0!==S.shapes){const w=S.shapes;if(Array.isArray(w))for(let S=0,U=w.length;S<U;S++){const U=w[S];serialize(x.shapes,U)}else serialize(x.shapes,w)}}if(this.isSkinnedMesh&&(U.bindMode=this.bindMode,U.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(serialize(x.skeletons,this.skeleton),U.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const S=[];for(let w=0,U=this.material.length;w<U;w++)S.push(serialize(x.materials,this.material[w]));U.material=S}else U.material=serialize(x.materials,this.material);if(this.children.length>0){U.children=[];for(let S=0;S<this.children.length;S++)U.children.push(this.children[S].toJSON(x).object)}if(this.animations.length>0){U.animations=[];for(let S=0;S<this.animations.length;S++){const w=this.animations[S];U.animations.push(serialize(x.animations,w))}}if(S){const S=extractFromCache(x.geometries),U=extractFromCache(x.materials),G=extractFromCache(x.textures),H=extractFromCache(x.images),z=extractFromCache(x.shapes),j=extractFromCache(x.skeletons),X=extractFromCache(x.animations);S.length>0&&(w.geometries=S),U.length>0&&(w.materials=U),G.length>0&&(w.textures=G),H.length>0&&(w.images=H),z.length>0&&(w.shapes=z),j.length>0&&(w.skeletons=j),X.length>0&&(w.animations=X)}return w.object=U,w;function extractFromCache(x){const S=[];for(const w in x){const U=x[w];delete U.metadata,S.push(U)}return S}}clone(x){return(new this.constructor).copy(this,x)}copy(x,S=!0){if(this.name=x.name,this.up.copy(x.up),this.position.copy(x.position),this.rotation.order=x.rotation.order,this.quaternion.copy(x.quaternion),this.scale.copy(x.scale),this.matrix.copy(x.matrix),this.matrixWorld.copy(x.matrixWorld),this.matrixAutoUpdate=x.matrixAutoUpdate,this.matrixWorldNeedsUpdate=x.matrixWorldNeedsUpdate,this.layers.mask=x.layers.mask,this.visible=x.visible,this.castShadow=x.castShadow,this.receiveShadow=x.receiveShadow,this.frustumCulled=x.frustumCulled,this.renderOrder=x.renderOrder,this.userData=JSON.parse(JSON.stringify(x.userData)),!0===S)for(let S=0;S<x.children.length;S++){const w=x.children[S];this.add(w.clone())}return this}}Object3D.DefaultUp=new Vector3(0,1,0),Object3D.DefaultMatrixAutoUpdate=!0,Object3D.prototype.isObject3D=!0;const Hr=new Vector3,Wr=new Vector3,$r=new Vector3,zr=new Vector3,jr=new Vector3,Xr=new Vector3,Kr=new Vector3,qr=new Vector3,Yr=new Vector3,Zr=new Vector3;class Triangle{constructor(x=new Vector3,S=new Vector3,w=new Vector3){this.a=x,this.b=S,this.c=w}static getNormal(x,S,w,U){U.subVectors(w,S),Hr.subVectors(x,S),U.cross(Hr);const G=U.lengthSq();return G>0?U.multiplyScalar(1/Math.sqrt(G)):U.set(0,0,0)}static getBarycoord(x,S,w,U,G){Hr.subVectors(U,S),Wr.subVectors(w,S),$r.subVectors(x,S);const H=Hr.dot(Hr),z=Hr.dot(Wr),j=Hr.dot($r),X=Wr.dot(Wr),K=Wr.dot($r),q=H*X-z*z;if(0===q)return G.set(-2,-1,-1);const Y=1/q,Z=(X*j-z*K)*Y,J=(H*K-z*j)*Y;return G.set(1-Z-J,J,Z)}static containsPoint(x,S,w,U){return this.getBarycoord(x,S,w,U,zr),zr.x>=0&&zr.y>=0&&zr.x+zr.y<=1}static getUV(x,S,w,U,G,H,z,j){return this.getBarycoord(x,S,w,U,zr),j.set(0,0),j.addScaledVector(G,zr.x),j.addScaledVector(H,zr.y),j.addScaledVector(z,zr.z),j}static isFrontFacing(x,S,w,U){return Hr.subVectors(w,S),Wr.subVectors(x,S),Hr.cross(Wr).dot(U)<0}set(x,S,w){return this.a.copy(x),this.b.copy(S),this.c.copy(w),this}setFromPointsAndIndices(x,S,w,U){return this.a.copy(x[S]),this.b.copy(x[w]),this.c.copy(x[U]),this}setFromAttributeAndIndices(x,S,w,U){return this.a.fromBufferAttribute(x,S),this.b.fromBufferAttribute(x,w),this.c.fromBufferAttribute(x,U),this}clone(){return(new this.constructor).copy(this)}copy(x){return this.a.copy(x.a),this.b.copy(x.b),this.c.copy(x.c),this}getArea(){return Hr.subVectors(this.c,this.b),Wr.subVectors(this.a,this.b),.5*Hr.cross(Wr).length()}getMidpoint(x){return x.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(x){return Triangle.getNormal(this.a,this.b,this.c,x)}getPlane(x){return x.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(x,S){return Triangle.getBarycoord(x,this.a,this.b,this.c,S)}getUV(x,S,w,U,G){return Triangle.getUV(x,this.a,this.b,this.c,S,w,U,G)}containsPoint(x){return Triangle.containsPoint(x,this.a,this.b,this.c)}isFrontFacing(x){return Triangle.isFrontFacing(this.a,this.b,this.c,x)}intersectsBox(x){return x.intersectsTriangle(this)}closestPointToPoint(x,S){const w=this.a,U=this.b,G=this.c;let H,z;jr.subVectors(U,w),Xr.subVectors(G,w),qr.subVectors(x,w);const j=jr.dot(qr),X=Xr.dot(qr);if(j<=0&&X<=0)return S.copy(w);Yr.subVectors(x,U);const K=jr.dot(Yr),q=Xr.dot(Yr);if(K>=0&&q<=K)return S.copy(U);const Y=j*q-K*X;if(Y<=0&&j>=0&&K<=0)return H=j/(j-K),S.copy(w).addScaledVector(jr,H);Zr.subVectors(x,G);const Z=jr.dot(Zr),J=Xr.dot(Zr);if(J>=0&&Z<=J)return S.copy(G);const Q=Z*X-j*J;if(Q<=0&&X>=0&&J<=0)return z=X/(X-J),S.copy(w).addScaledVector(Xr,z);const ee=K*J-Z*q;if(ee<=0&&q-K>=0&&Z-J>=0)return Kr.subVectors(G,U),z=(q-K)/(q-K+(Z-J)),S.copy(U).addScaledVector(Kr,z);const te=1/(ee+Q+Y);return H=Q*te,z=Y*te,S.copy(w).addScaledVector(jr,H).addScaledVector(Xr,z)}equals(x){return x.a.equals(this.a)&&x.b.equals(this.b)&&x.c.equals(this.c)}}let Jr=0;class Material extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:Jr++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=oe,this.side=Q,this.vertexColors=!1,this.opacity=1,this.format=wt,this.transparent=!1,this.blendSrc=ye,this.blendDst=be,this.blendEquation=ue,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Re,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ai,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ui,this.stencilZFail=ui,this.stencilZPass=ui,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(x){this._alphaTest>0!=x>0&&this.version++,this._alphaTest=x}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(x){if(void 0!==x)for(const S in x){const w=x[S];if(void 0===w){console.warn("THREE.Material: '"+S+"' parameter is undefined.");continue}if("shading"===S){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=w===ne;continue}const U=this[S];void 0!==U?U&&U.isColor?U.set(w):U&&U.isVector3&&w&&w.isVector3?U.copy(w):this[S]=w:console.warn("THREE."+this.type+": '"+S+"' is not a property of this material.")}}toJSON(x){const S=void 0===x||"string"==typeof x;S&&(x={textures:{},images:{}});const w={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function extractFromCache(x){const S=[];for(const w in x){const U=x[w];delete U.metadata,S.push(U)}return S}if(w.uuid=this.uuid,w.type=this.type,""!==this.name&&(w.name=this.name),this.color&&this.color.isColor&&(w.color=this.color.getHex()),void 0!==this.roughness&&(w.roughness=this.roughness),void 0!==this.metalness&&(w.metalness=this.metalness),void 0!==this.sheen&&(w.sheen=this.sheen),this.sheenTint&&this.sheenTint.isColor&&(w.sheenTint=this.sheenTint.getHex()),void 0!==this.sheenRoughness&&(w.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(w.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(w.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(w.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(w.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(w.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(w.shininess=this.shininess),void 0!==this.clearcoat&&(w.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(w.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(w.clearcoatMap=this.clearcoatMap.toJSON(x).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(w.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(x).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(w.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(x).uuid,w.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(w.map=this.map.toJSON(x).uuid),this.matcap&&this.matcap.isTexture&&(w.matcap=this.matcap.toJSON(x).uuid),this.alphaMap&&this.alphaMap.isTexture&&(w.alphaMap=this.alphaMap.toJSON(x).uuid),this.lightMap&&this.lightMap.isTexture&&(w.lightMap=this.lightMap.toJSON(x).uuid,w.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(w.aoMap=this.aoMap.toJSON(x).uuid,w.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(w.bumpMap=this.bumpMap.toJSON(x).uuid,w.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(w.normalMap=this.normalMap.toJSON(x).uuid,w.normalMapType=this.normalMapType,w.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(w.displacementMap=this.displacementMap.toJSON(x).uuid,w.displacementScale=this.displacementScale,w.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(w.roughnessMap=this.roughnessMap.toJSON(x).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(w.metalnessMap=this.metalnessMap.toJSON(x).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(w.emissiveMap=this.emissiveMap.toJSON(x).uuid),this.specularMap&&this.specularMap.isTexture&&(w.specularMap=this.specularMap.toJSON(x).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(w.specularIntensityMap=this.specularIntensityMap.toJSON(x).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(w.specularTintMap=this.specularTintMap.toJSON(x).uuid),this.envMap&&this.envMap.isTexture&&(w.envMap=this.envMap.toJSON(x).uuid,void 0!==this.combine&&(w.combine=this.combine)),void 0!==this.envMapIntensity&&(w.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(w.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(w.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(w.gradientMap=this.gradientMap.toJSON(x).uuid),void 0!==this.transmission&&(w.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(w.transmissionMap=this.transmissionMap.toJSON(x).uuid),void 0!==this.thickness&&(w.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(w.thicknessMap=this.thicknessMap.toJSON(x).uuid),void 0!==this.attenuationDistance&&(w.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(w.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(w.size=this.size),null!==this.shadowSide&&(w.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(w.sizeAttenuation=this.sizeAttenuation),this.blending!==oe&&(w.blending=this.blending),this.side!==Q&&(w.side=this.side),this.vertexColors&&(w.vertexColors=!0),this.opacity<1&&(w.opacity=this.opacity),this.format!==wt&&(w.format=this.format),!0===this.transparent&&(w.transparent=this.transparent),w.depthFunc=this.depthFunc,w.depthTest=this.depthTest,w.depthWrite=this.depthWrite,w.colorWrite=this.colorWrite,w.stencilWrite=this.stencilWrite,w.stencilWriteMask=this.stencilWriteMask,w.stencilFunc=this.stencilFunc,w.stencilRef=this.stencilRef,w.stencilFuncMask=this.stencilFuncMask,w.stencilFail=this.stencilFail,w.stencilZFail=this.stencilZFail,w.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(w.rotation=this.rotation),!0===this.polygonOffset&&(w.polygonOffset=!0),0!==this.polygonOffsetFactor&&(w.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(w.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(w.linewidth=this.linewidth),void 0!==this.dashSize&&(w.dashSize=this.dashSize),void 0!==this.gapSize&&(w.gapSize=this.gapSize),void 0!==this.scale&&(w.scale=this.scale),!0===this.dithering&&(w.dithering=!0),this.alphaTest>0&&(w.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(w.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(w.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(w.wireframe=this.wireframe),this.wireframeLinewidth>1&&(w.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(w.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(w.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(w.flatShading=this.flatShading),!1===this.visible&&(w.visible=!1),!1===this.toneMapped&&(w.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(w.userData=this.userData),S){const S=extractFromCache(x.textures),U=extractFromCache(x.images);S.length>0&&(w.textures=S),U.length>0&&(w.images=U)}return w}clone(){return(new this.constructor).copy(this)}copy(x){this.name=x.name,this.fog=x.fog,this.blending=x.blending,this.side=x.side,this.vertexColors=x.vertexColors,this.opacity=x.opacity,this.format=x.format,this.transparent=x.transparent,this.blendSrc=x.blendSrc,this.blendDst=x.blendDst,this.blendEquation=x.blendEquation,this.blendSrcAlpha=x.blendSrcAlpha,this.blendDstAlpha=x.blendDstAlpha,this.blendEquationAlpha=x.blendEquationAlpha,this.depthFunc=x.depthFunc,this.depthTest=x.depthTest,this.depthWrite=x.depthWrite,this.stencilWriteMask=x.stencilWriteMask,this.stencilFunc=x.stencilFunc,this.stencilRef=x.stencilRef,this.stencilFuncMask=x.stencilFuncMask,this.stencilFail=x.stencilFail,this.stencilZFail=x.stencilZFail,this.stencilZPass=x.stencilZPass,this.stencilWrite=x.stencilWrite;const S=x.clippingPlanes;let w=null;if(null!==S){const x=S.length;w=new Array(x);for(let U=0;U!==x;++U)w[U]=S[U].clone()}return this.clippingPlanes=w,this.clipIntersection=x.clipIntersection,this.clipShadows=x.clipShadows,this.shadowSide=x.shadowSide,this.colorWrite=x.colorWrite,this.precision=x.precision,this.polygonOffset=x.polygonOffset,this.polygonOffsetFactor=x.polygonOffsetFactor,this.polygonOffsetUnits=x.polygonOffsetUnits,this.dithering=x.dithering,this.alphaTest=x.alphaTest,this.alphaToCoverage=x.alphaToCoverage,this.premultipliedAlpha=x.premultipliedAlpha,this.visible=x.visible,this.toneMapped=x.toneMapped,this.userData=JSON.parse(JSON.stringify(x.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(x){!0===x&&this.version++}}Material.prototype.isMaterial=!0;const Qr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},eo={h:0,s:0,l:0},to={h:0,s:0,l:0};function hue2rgb(x,S,w){return w<0&&(w+=1),w>1&&(w-=1),w<1/6?x+6*(S-x)*w:w<.5?S:w<2/3?x+6*(S-x)*(2/3-w):x}function SRGBToLinear(x){return x<.04045?.0773993808*x:Math.pow(.9478672986*x+.0521327014,2.4)}function LinearToSRGB(x){return x<.0031308?12.92*x:1.055*Math.pow(x,.41666)-.055}class Color{constructor(x,S,w){return void 0===S&&void 0===w?this.set(x):this.setRGB(x,S,w)}set(x){return x&&x.isColor?this.copy(x):"number"==typeof x?this.setHex(x):"string"==typeof x&&this.setStyle(x),this}setScalar(x){return this.r=x,this.g=x,this.b=x,this}setHex(x){return x=Math.floor(x),this.r=(x>>16&255)/255,this.g=(x>>8&255)/255,this.b=(255&x)/255,this}setRGB(x,S,w){return this.r=x,this.g=S,this.b=w,this}setHSL(x,S,w){if(x=euclideanModulo(x,1),S=clamp(S,0,1),w=clamp(w,0,1),0===S)this.r=this.g=this.b=w;else{const U=w<=.5?w*(1+S):w+S-w*S,G=2*w-U;this.r=hue2rgb(G,U,x+1/3),this.g=hue2rgb(G,U,x),this.b=hue2rgb(G,U,x-1/3)}return this}setStyle(x){function handleAlpha(S){void 0!==S&&parseFloat(S)<1&&console.warn("THREE.Color: Alpha component of "+x+" will be ignored.")}let S;if(S=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(x)){let x;const w=S[1],U=S[2];switch(w){case"rgb":case"rgba":if(x=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(U))return this.r=Math.min(255,parseInt(x[1],10))/255,this.g=Math.min(255,parseInt(x[2],10))/255,this.b=Math.min(255,parseInt(x[3],10))/255,handleAlpha(x[4]),this;if(x=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(U))return this.r=Math.min(100,parseInt(x[1],10))/100,this.g=Math.min(100,parseInt(x[2],10))/100,this.b=Math.min(100,parseInt(x[3],10))/100,handleAlpha(x[4]),this;break;case"hsl":case"hsla":if(x=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(U)){const S=parseFloat(x[1])/360,w=parseInt(x[2],10)/100,U=parseInt(x[3],10)/100;return handleAlpha(x[4]),this.setHSL(S,w,U)}}}else if(S=/^\#([A-Fa-f\d]+)$/.exec(x)){const x=S[1],w=x.length;if(3===w)return this.r=parseInt(x.charAt(0)+x.charAt(0),16)/255,this.g=parseInt(x.charAt(1)+x.charAt(1),16)/255,this.b=parseInt(x.charAt(2)+x.charAt(2),16)/255,this;if(6===w)return this.r=parseInt(x.charAt(0)+x.charAt(1),16)/255,this.g=parseInt(x.charAt(2)+x.charAt(3),16)/255,this.b=parseInt(x.charAt(4)+x.charAt(5),16)/255,this}return x&&x.length>0?this.setColorName(x):this}setColorName(x){const S=Qr[x.toLowerCase()];return void 0!==S?this.setHex(S):console.warn("THREE.Color: Unknown color "+x),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(x){return this.r=x.r,this.g=x.g,this.b=x.b,this}copyGammaToLinear(x,S=2){return this.r=Math.pow(x.r,S),this.g=Math.pow(x.g,S),this.b=Math.pow(x.b,S),this}copyLinearToGamma(x,S=2){const w=S>0?1/S:1;return this.r=Math.pow(x.r,w),this.g=Math.pow(x.g,w),this.b=Math.pow(x.b,w),this}convertGammaToLinear(x){return this.copyGammaToLinear(this,x),this}convertLinearToGamma(x){return this.copyLinearToGamma(this,x),this}copySRGBToLinear(x){return this.r=SRGBToLinear(x.r),this.g=SRGBToLinear(x.g),this.b=SRGBToLinear(x.b),this}copyLinearToSRGB(x){return this.r=LinearToSRGB(x.r),this.g=LinearToSRGB(x.g),this.b=LinearToSRGB(x.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(x){const S=this.r,w=this.g,U=this.b,G=Math.max(S,w,U),H=Math.min(S,w,U);let z,j;const X=(H+G)/2;if(H===G)z=0,j=0;else{const x=G-H;switch(j=X<=.5?x/(G+H):x/(2-G-H),G){case S:z=(w-U)/x+(w<U?6:0);break;case w:z=(U-S)/x+2;break;case U:z=(S-w)/x+4}z/=6}return x.h=z,x.s=j,x.l=X,x}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(x,S,w){return this.getHSL(eo),eo.h+=x,eo.s+=S,eo.l+=w,this.setHSL(eo.h,eo.s,eo.l),this}add(x){return this.r+=x.r,this.g+=x.g,this.b+=x.b,this}addColors(x,S){return this.r=x.r+S.r,this.g=x.g+S.g,this.b=x.b+S.b,this}addScalar(x){return this.r+=x,this.g+=x,this.b+=x,this}sub(x){return this.r=Math.max(0,this.r-x.r),this.g=Math.max(0,this.g-x.g),this.b=Math.max(0,this.b-x.b),this}multiply(x){return this.r*=x.r,this.g*=x.g,this.b*=x.b,this}multiplyScalar(x){return this.r*=x,this.g*=x,this.b*=x,this}lerp(x,S){return this.r+=(x.r-this.r)*S,this.g+=(x.g-this.g)*S,this.b+=(x.b-this.b)*S,this}lerpColors(x,S,w){return this.r=x.r+(S.r-x.r)*w,this.g=x.g+(S.g-x.g)*w,this.b=x.b+(S.b-x.b)*w,this}lerpHSL(x,S){this.getHSL(eo),x.getHSL(to);const w=lerp(eo.h,to.h,S),U=lerp(eo.s,to.s,S),G=lerp(eo.l,to.l,S);return this.setHSL(w,U,G),this}equals(x){return x.r===this.r&&x.g===this.g&&x.b===this.b}fromArray(x,S=0){return this.r=x[S],this.g=x[S+1],this.b=x[S+2],this}toArray(x=[],S=0){return x[S]=this.r,x[S+1]=this.g,x[S+2]=this.b,x}fromBufferAttribute(x,S){return this.r=x.getX(S),this.g=x.getY(S),this.b=x.getZ(S),!0===x.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Color.NAMES=Qr,Color.prototype.isColor=!0,Color.prototype.r=1,Color.prototype.g=1,Color.prototype.b=1;class MeshBasicMaterial extends Material{constructor(x){super(),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.map=x.map,this.lightMap=x.lightMap,this.lightMapIntensity=x.lightMapIntensity,this.aoMap=x.aoMap,this.aoMapIntensity=x.aoMapIntensity,this.specularMap=x.specularMap,this.alphaMap=x.alphaMap,this.envMap=x.envMap,this.combine=x.combine,this.reflectivity=x.reflectivity,this.refractionRatio=x.refractionRatio,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this.wireframeLinejoin=x.wireframeLinejoin,this}}MeshBasicMaterial.prototype.isMeshBasicMaterial=!0;const no=new Vector3,io=new Vector2;class BufferAttribute{constructor(x,S,w){if(Array.isArray(x))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=x,this.itemSize=S,this.count=void 0!==x?x.length/S:0,this.normalized=!0===w,this.usage=Mi,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(x){!0===x&&this.version++}setUsage(x){return this.usage=x,this}copy(x){return this.name=x.name,this.array=new x.array.constructor(x.array),this.itemSize=x.itemSize,this.count=x.count,this.normalized=x.normalized,this.usage=x.usage,this}copyAt(x,S,w){x*=this.itemSize,w*=S.itemSize;for(let U=0,G=this.itemSize;U<G;U++)this.array[x+U]=S.array[w+U];return this}copyArray(x){return this.array.set(x),this}copyColorsArray(x){const S=this.array;let w=0;for(let U=0,G=x.length;U<G;U++){let G=x[U];void 0===G&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",U),G=new Color),S[w++]=G.r,S[w++]=G.g,S[w++]=G.b}return this}copyVector2sArray(x){const S=this.array;let w=0;for(let U=0,G=x.length;U<G;U++){let G=x[U];void 0===G&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",U),G=new Vector2),S[w++]=G.x,S[w++]=G.y}return this}copyVector3sArray(x){const S=this.array;let w=0;for(let U=0,G=x.length;U<G;U++){let G=x[U];void 0===G&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",U),G=new Vector3),S[w++]=G.x,S[w++]=G.y,S[w++]=G.z}return this}copyVector4sArray(x){const S=this.array;let w=0;for(let U=0,G=x.length;U<G;U++){let G=x[U];void 0===G&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",U),G=new Vector4),S[w++]=G.x,S[w++]=G.y,S[w++]=G.z,S[w++]=G.w}return this}applyMatrix3(x){if(2===this.itemSize)for(let S=0,w=this.count;S<w;S++)io.fromBufferAttribute(this,S),io.applyMatrix3(x),this.setXY(S,io.x,io.y);else if(3===this.itemSize)for(let S=0,w=this.count;S<w;S++)no.fromBufferAttribute(this,S),no.applyMatrix3(x),this.setXYZ(S,no.x,no.y,no.z);return this}applyMatrix4(x){for(let S=0,w=this.count;S<w;S++)no.x=this.getX(S),no.y=this.getY(S),no.z=this.getZ(S),no.applyMatrix4(x),this.setXYZ(S,no.x,no.y,no.z);return this}applyNormalMatrix(x){for(let S=0,w=this.count;S<w;S++)no.x=this.getX(S),no.y=this.getY(S),no.z=this.getZ(S),no.applyNormalMatrix(x),this.setXYZ(S,no.x,no.y,no.z);return this}transformDirection(x){for(let S=0,w=this.count;S<w;S++)no.x=this.getX(S),no.y=this.getY(S),no.z=this.getZ(S),no.transformDirection(x),this.setXYZ(S,no.x,no.y,no.z);return this}set(x,S=0){return this.array.set(x,S),this}getX(x){return this.array[x*this.itemSize]}setX(x,S){return this.array[x*this.itemSize]=S,this}getY(x){return this.array[x*this.itemSize+1]}setY(x,S){return this.array[x*this.itemSize+1]=S,this}getZ(x){return this.array[x*this.itemSize+2]}setZ(x,S){return this.array[x*this.itemSize+2]=S,this}getW(x){return this.array[x*this.itemSize+3]}setW(x,S){return this.array[x*this.itemSize+3]=S,this}setXY(x,S,w){return x*=this.itemSize,this.array[x+0]=S,this.array[x+1]=w,this}setXYZ(x,S,w,U){return x*=this.itemSize,this.array[x+0]=S,this.array[x+1]=w,this.array[x+2]=U,this}setXYZW(x,S,w,U,G){return x*=this.itemSize,this.array[x+0]=S,this.array[x+1]=w,this.array[x+2]=U,this.array[x+3]=G,this}onUpload(x){return this.onUploadCallback=x,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const x={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(x.name=this.name),this.usage!==Mi&&(x.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(x.updateRange=this.updateRange),x}}BufferAttribute.prototype.isBufferAttribute=!0;class Int8BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Int8Array(x),S,w)}}class Uint8BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Uint8Array(x),S,w)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Uint8ClampedArray(x),S,w)}}class Int16BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Int16Array(x),S,w)}}class Uint16BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Uint16Array(x),S,w)}}class Int32BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Int32Array(x),S,w)}}class Uint32BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Uint32Array(x),S,w)}}class Float16BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Uint16Array(x),S,w)}}Float16BufferAttribute.prototype.isFloat16BufferAttribute=!0;class Float32BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Float32Array(x),S,w)}}class Float64BufferAttribute extends BufferAttribute{constructor(x,S,w){super(new Float64Array(x),S,w)}}let ro=0;const oo=new Matrix4,ao=new Object3D,so=new Vector3,lo=new Box3,co=new Box3,uo=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:ro++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(x){return Array.isArray(x)?this.index=new(arrayMax(x)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(x,1):this.index=x,this}getAttribute(x){return this.attributes[x]}setAttribute(x,S){return this.attributes[x]=S,this}deleteAttribute(x){return delete this.attributes[x],this}hasAttribute(x){return void 0!==this.attributes[x]}addGroup(x,S,w=0){this.groups.push({start:x,count:S,materialIndex:w})}clearGroups(){this.groups=[]}setDrawRange(x,S){this.drawRange.start=x,this.drawRange.count=S}applyMatrix4(x){const S=this.attributes.position;void 0!==S&&(S.applyMatrix4(x),S.needsUpdate=!0);const w=this.attributes.normal;if(void 0!==w){const S=(new Matrix3).getNormalMatrix(x);w.applyNormalMatrix(S),w.needsUpdate=!0}const U=this.attributes.tangent;return void 0!==U&&(U.transformDirection(x),U.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(x){return oo.makeRotationFromQuaternion(x),this.applyMatrix4(oo),this}rotateX(x){return oo.makeRotationX(x),this.applyMatrix4(oo),this}rotateY(x){return oo.makeRotationY(x),this.applyMatrix4(oo),this}rotateZ(x){return oo.makeRotationZ(x),this.applyMatrix4(oo),this}translate(x,S,w){return oo.makeTranslation(x,S,w),this.applyMatrix4(oo),this}scale(x,S,w){return oo.makeScale(x,S,w),this.applyMatrix4(oo),this}lookAt(x){return ao.lookAt(x),ao.updateMatrix(),this.applyMatrix4(ao.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(so).negate(),this.translate(so.x,so.y,so.z),this}setFromPoints(x){const S=[];for(let w=0,U=x.length;w<U;w++){const U=x[w];S.push(U.x,U.y,U.z||0)}return this.setAttribute("position",new Float32BufferAttribute(S,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Box3);const x=this.attributes.position,S=this.morphAttributes.position;if(x&&x.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));if(void 0!==x){if(this.boundingBox.setFromBufferAttribute(x),S)for(let x=0,w=S.length;x<w;x++){const w=S[x];lo.setFromBufferAttribute(w),this.morphTargetsRelative?(uo.addVectors(this.boundingBox.min,lo.min),this.boundingBox.expandByPoint(uo),uo.addVectors(this.boundingBox.max,lo.max),this.boundingBox.expandByPoint(uo)):(this.boundingBox.expandByPoint(lo.min),this.boundingBox.expandByPoint(lo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);const x=this.attributes.position,S=this.morphAttributes.position;if(x&&x.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Vector3,1/0);if(x){const w=this.boundingSphere.center;if(lo.setFromBufferAttribute(x),S)for(let x=0,w=S.length;x<w;x++){const w=S[x];co.setFromBufferAttribute(w),this.morphTargetsRelative?(uo.addVectors(lo.min,co.min),lo.expandByPoint(uo),uo.addVectors(lo.max,co.max),lo.expandByPoint(uo)):(lo.expandByPoint(co.min),lo.expandByPoint(co.max))}lo.getCenter(w);let U=0;for(let S=0,G=x.count;S<G;S++)uo.fromBufferAttribute(x,S),U=Math.max(U,w.distanceToSquared(uo));if(S)for(let G=0,H=S.length;G<H;G++){const H=S[G],z=this.morphTargetsRelative;for(let S=0,G=H.count;S<G;S++)uo.fromBufferAttribute(H,S),z&&(so.fromBufferAttribute(x,S),uo.add(so)),U=Math.max(U,w.distanceToSquared(uo))}this.boundingSphere.radius=Math.sqrt(U),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const x=this.index,S=this.attributes;if(null===x||void 0===S.position||void 0===S.normal||void 0===S.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const w=x.array,U=S.position.array,G=S.normal.array,H=S.uv.array,z=U.length/3;void 0===S.tangent&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*z),4));const j=S.tangent.array,X=[],K=[];for(let x=0;x<z;x++)X[x]=new Vector3,K[x]=new Vector3;const q=new Vector3,Y=new Vector3,Z=new Vector3,J=new Vector2,Q=new Vector2,ee=new Vector2,te=new Vector3,ne=new Vector3;function handleTriangle(x,S,w){q.fromArray(U,3*x),Y.fromArray(U,3*S),Z.fromArray(U,3*w),J.fromArray(H,2*x),Q.fromArray(H,2*S),ee.fromArray(H,2*w),Y.sub(q),Z.sub(q),Q.sub(J),ee.sub(J);const G=1/(Q.x*ee.y-ee.x*Q.y);isFinite(G)&&(te.copy(Y).multiplyScalar(ee.y).addScaledVector(Z,-Q.y).multiplyScalar(G),ne.copy(Z).multiplyScalar(Q.x).addScaledVector(Y,-ee.x).multiplyScalar(G),X[x].add(te),X[S].add(te),X[w].add(te),K[x].add(ne),K[S].add(ne),K[w].add(ne))}let ie=this.groups;0===ie.length&&(ie=[{start:0,count:w.length}]);for(let x=0,S=ie.length;x<S;++x){const S=ie[x],U=S.start;for(let x=U,G=U+S.count;x<G;x+=3)handleTriangle(w[x+0],w[x+1],w[x+2])}const re=new Vector3,oe=new Vector3,ae=new Vector3,se=new Vector3;function handleVertex(x){ae.fromArray(G,3*x),se.copy(ae);const S=X[x];re.copy(S),re.sub(ae.multiplyScalar(ae.dot(S))).normalize(),oe.crossVectors(se,S);const w=oe.dot(K[x])<0?-1:1;j[4*x]=re.x,j[4*x+1]=re.y,j[4*x+2]=re.z,j[4*x+3]=w}for(let x=0,S=ie.length;x<S;++x){const S=ie[x],U=S.start;for(let x=U,G=U+S.count;x<G;x+=3)handleVertex(w[x+0]),handleVertex(w[x+1]),handleVertex(w[x+2])}}computeVertexNormals(){const x=this.index,S=this.getAttribute("position");if(void 0!==S){let w=this.getAttribute("normal");if(void 0===w)w=new BufferAttribute(new Float32Array(3*S.count),3),this.setAttribute("normal",w);else for(let x=0,S=w.count;x<S;x++)w.setXYZ(x,0,0,0);const U=new Vector3,G=new Vector3,H=new Vector3,z=new Vector3,j=new Vector3,X=new Vector3,K=new Vector3,q=new Vector3;if(x)for(let Y=0,Z=x.count;Y<Z;Y+=3){const Z=x.getX(Y+0),J=x.getX(Y+1),Q=x.getX(Y+2);U.fromBufferAttribute(S,Z),G.fromBufferAttribute(S,J),H.fromBufferAttribute(S,Q),K.subVectors(H,G),q.subVectors(U,G),K.cross(q),z.fromBufferAttribute(w,Z),j.fromBufferAttribute(w,J),X.fromBufferAttribute(w,Q),z.add(K),j.add(K),X.add(K),w.setXYZ(Z,z.x,z.y,z.z),w.setXYZ(J,j.x,j.y,j.z),w.setXYZ(Q,X.x,X.y,X.z)}else for(let x=0,z=S.count;x<z;x+=3)U.fromBufferAttribute(S,x+0),G.fromBufferAttribute(S,x+1),H.fromBufferAttribute(S,x+2),K.subVectors(H,G),q.subVectors(U,G),K.cross(q),w.setXYZ(x+0,K.x,K.y,K.z),w.setXYZ(x+1,K.x,K.y,K.z),w.setXYZ(x+2,K.x,K.y,K.z);this.normalizeNormals(),w.needsUpdate=!0}}merge(x,S){if(!x||!x.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",x);void 0===S&&(S=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const w=this.attributes;for(const U in w){if(void 0===x.attributes[U])continue;const G=w[U].array,H=x.attributes[U],z=H.array,j=H.itemSize*S,X=Math.min(z.length,G.length-j);for(let x=0,S=j;x<X;x++,S++)G[S]=z[x]}return this}normalizeNormals(){const x=this.attributes.normal;for(let S=0,w=x.count;S<w;S++)uo.fromBufferAttribute(x,S),uo.normalize(),x.setXYZ(S,uo.x,uo.y,uo.z)}toNonIndexed(){function convertBufferAttribute(x,S){const w=x.array,U=x.itemSize,G=x.normalized,H=new w.constructor(S.length*U);let z=0,j=0;for(let G=0,X=S.length;G<X;G++){z=x.isInterleavedBufferAttribute?S[G]*x.data.stride+x.offset:S[G]*U;for(let x=0;x<U;x++)H[j++]=w[z++]}return new BufferAttribute(H,U,G)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const x=new BufferGeometry,S=this.index.array,w=this.attributes;for(const U in w){const G=convertBufferAttribute(w[U],S);x.setAttribute(U,G)}const U=this.morphAttributes;for(const w in U){const G=[],H=U[w];for(let x=0,w=H.length;x<w;x++){const w=convertBufferAttribute(H[x],S);G.push(w)}x.morphAttributes[w]=G}x.morphTargetsRelative=this.morphTargetsRelative;const G=this.groups;for(let S=0,w=G.length;S<w;S++){const w=G[S];x.addGroup(w.start,w.count,w.materialIndex)}return x}toJSON(){const x={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(x.uuid=this.uuid,x.type=this.type,""!==this.name&&(x.name=this.name),Object.keys(this.userData).length>0&&(x.userData=this.userData),void 0!==this.parameters){const S=this.parameters;for(const w in S)void 0!==S[w]&&(x[w]=S[w]);return x}x.data={attributes:{}};const S=this.index;null!==S&&(x.data.index={type:S.array.constructor.name,array:Array.prototype.slice.call(S.array)});const w=this.attributes;for(const S in w){const U=w[S];x.data.attributes[S]=U.toJSON(x.data)}const U={};let G=!1;for(const S in this.morphAttributes){const w=this.morphAttributes[S],H=[];for(let S=0,U=w.length;S<U;S++){const U=w[S];H.push(U.toJSON(x.data))}H.length>0&&(U[S]=H,G=!0)}G&&(x.data.morphAttributes=U,x.data.morphTargetsRelative=this.morphTargetsRelative);const H=this.groups;H.length>0&&(x.data.groups=JSON.parse(JSON.stringify(H)));const z=this.boundingSphere;return null!==z&&(x.data.boundingSphere={center:z.center.toArray(),radius:z.radius}),x}clone(){return(new this.constructor).copy(this)}copy(x){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const S={};this.name=x.name;const w=x.index;null!==w&&this.setIndex(w.clone(S));const U=x.attributes;for(const x in U){const w=U[x];this.setAttribute(x,w.clone(S))}const G=x.morphAttributes;for(const x in G){const w=[],U=G[x];for(let x=0,G=U.length;x<G;x++)w.push(U[x].clone(S));this.morphAttributes[x]=w}this.morphTargetsRelative=x.morphTargetsRelative;const H=x.groups;for(let x=0,S=H.length;x<S;x++){const S=H[x];this.addGroup(S.start,S.count,S.materialIndex)}const z=x.boundingBox;null!==z&&(this.boundingBox=z.clone());const j=x.boundingSphere;return null!==j&&(this.boundingSphere=j.clone()),this.drawRange.start=x.drawRange.start,this.drawRange.count=x.drawRange.count,this.userData=x.userData,void 0!==x.parameters&&(this.parameters=Object.assign({},x.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}BufferGeometry.prototype.isBufferGeometry=!0;const ho=new Matrix4,po=new Ray,mo=new Sphere,fo=new Vector3,go=new Vector3,vo=new Vector3,_o=new Vector3,yo=new Vector3,bo=new Vector3,xo=new Vector3,Eo=new Vector3,So=new Vector3,wo=new Vector2,To=new Vector2,Co=new Vector2,Ao=new Vector3,Mo=new Vector3;class Mesh extends Object3D{constructor(x=new BufferGeometry,S=new MeshBasicMaterial){super(),this.type="Mesh",this.geometry=x,this.material=S,this.updateMorphTargets()}copy(x){return super.copy(x),void 0!==x.morphTargetInfluences&&(this.morphTargetInfluences=x.morphTargetInfluences.slice()),void 0!==x.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},x.morphTargetDictionary)),this.material=x.material,this.geometry=x.geometry,this}updateMorphTargets(){const x=this.geometry;if(x.isBufferGeometry){const S=x.morphAttributes,w=Object.keys(S);if(w.length>0){const x=S[w[0]];if(void 0!==x){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,w=x.length;S<w;S++){const w=x[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[w]=S}}}}else{const S=x.morphTargets;void 0!==S&&S.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(x,S){const w=this.geometry,U=this.material,G=this.matrixWorld;if(void 0===U)return;if(null===w.boundingSphere&&w.computeBoundingSphere(),mo.copy(w.boundingSphere),mo.applyMatrix4(G),!1===x.ray.intersectsSphere(mo))return;if(ho.copy(G).invert(),po.copy(x.ray).applyMatrix4(ho),null!==w.boundingBox&&!1===po.intersectsBox(w.boundingBox))return;let H;if(w.isBufferGeometry){const G=w.index,z=w.attributes.position,j=w.morphAttributes.position,X=w.morphTargetsRelative,K=w.attributes.uv,q=w.attributes.uv2,Y=w.groups,Z=w.drawRange;if(null!==G)if(Array.isArray(U))for(let w=0,J=Y.length;w<J;w++){const J=Y[w],Q=U[J.materialIndex];for(let w=Math.max(J.start,Z.start),U=Math.min(G.count,Math.min(J.start+J.count,Z.start+Z.count));w<U;w+=3){const U=G.getX(w),Y=G.getX(w+1),Z=G.getX(w+2);H=checkBufferGeometryIntersection(this,Q,x,po,z,j,X,K,q,U,Y,Z),H&&(H.faceIndex=Math.floor(w/3),H.face.materialIndex=J.materialIndex,S.push(H))}}else{for(let w=Math.max(0,Z.start),Y=Math.min(G.count,Z.start+Z.count);w<Y;w+=3){const Y=G.getX(w),Z=G.getX(w+1),J=G.getX(w+2);H=checkBufferGeometryIntersection(this,U,x,po,z,j,X,K,q,Y,Z,J),H&&(H.faceIndex=Math.floor(w/3),S.push(H))}}else if(void 0!==z)if(Array.isArray(U))for(let w=0,G=Y.length;w<G;w++){const G=Y[w],J=U[G.materialIndex];for(let w=Math.max(G.start,Z.start),U=Math.min(z.count,Math.min(G.start+G.count,Z.start+Z.count));w<U;w+=3){H=checkBufferGeometryIntersection(this,J,x,po,z,j,X,K,q,w,w+1,w+2),H&&(H.faceIndex=Math.floor(w/3),H.face.materialIndex=G.materialIndex,S.push(H))}}else{for(let w=Math.max(0,Z.start),G=Math.min(z.count,Z.start+Z.count);w<G;w+=3){H=checkBufferGeometryIntersection(this,U,x,po,z,j,X,K,q,w,w+1,w+2),H&&(H.faceIndex=Math.floor(w/3),S.push(H))}}}else w.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function checkBufferGeometryIntersection(x,S,w,U,G,H,z,j,X,K,q,Y){fo.fromBufferAttribute(G,K),go.fromBufferAttribute(G,q),vo.fromBufferAttribute(G,Y);const Z=x.morphTargetInfluences;if(H&&Z){xo.set(0,0,0),Eo.set(0,0,0),So.set(0,0,0);for(let x=0,S=H.length;x<S;x++){const S=Z[x],w=H[x];0!==S&&(_o.fromBufferAttribute(w,K),yo.fromBufferAttribute(w,q),bo.fromBufferAttribute(w,Y),z?(xo.addScaledVector(_o,S),Eo.addScaledVector(yo,S),So.addScaledVector(bo,S)):(xo.addScaledVector(_o.sub(fo),S),Eo.addScaledVector(yo.sub(go),S),So.addScaledVector(bo.sub(vo),S)))}fo.add(xo),go.add(Eo),vo.add(So)}x.isSkinnedMesh&&(x.boneTransform(K,fo),x.boneTransform(q,go),x.boneTransform(Y,vo));const J=function checkIntersection(x,S,w,U,G,H,z,j){let X;if(X=S.side===ee?U.intersectTriangle(z,H,G,!0,j):U.intersectTriangle(G,H,z,S.side!==te,j),null===X)return null;Mo.copy(j),Mo.applyMatrix4(x.matrixWorld);const K=w.ray.origin.distanceTo(Mo);return K<w.near||K>w.far?null:{distance:K,point:Mo.clone(),object:x}}(x,S,w,U,fo,go,vo,Ao);if(J){j&&(wo.fromBufferAttribute(j,K),To.fromBufferAttribute(j,q),Co.fromBufferAttribute(j,Y),J.uv=Triangle.getUV(Ao,fo,go,vo,wo,To,Co,new Vector2)),X&&(wo.fromBufferAttribute(X,K),To.fromBufferAttribute(X,q),Co.fromBufferAttribute(X,Y),J.uv2=Triangle.getUV(Ao,fo,go,vo,wo,To,Co,new Vector2));const x={a:K,b:q,c:Y,normal:new Vector3,materialIndex:0};Triangle.getNormal(fo,go,vo,x.normal),J.face=x}return J}Mesh.prototype.isMesh=!0;class BoxGeometry extends BufferGeometry{constructor(x=1,S=1,w=1,U=1,G=1,H=1){super(),this.type="BoxGeometry",this.parameters={width:x,height:S,depth:w,widthSegments:U,heightSegments:G,depthSegments:H};const z=this;U=Math.floor(U),G=Math.floor(G),H=Math.floor(H);const j=[],X=[],K=[],q=[];let Y=0,Z=0;function buildPlane(x,S,w,U,G,H,J,Q,ee,te,ne){const ie=H/ee,re=J/te,oe=H/2,ae=J/2,se=Q/2,le=ee+1,ce=te+1;let ue=0,he=0;const de=new Vector3;for(let H=0;H<ce;H++){const z=H*re-ae;for(let j=0;j<le;j++){const Y=j*ie-oe;de[x]=Y*U,de[S]=z*G,de[w]=se,X.push(de.x,de.y,de.z),de[x]=0,de[S]=0,de[w]=Q>0?1:-1,K.push(de.x,de.y,de.z),q.push(j/ee),q.push(1-H/te),ue+=1}}for(let x=0;x<te;x++)for(let S=0;S<ee;S++){const w=Y+S+le*x,U=Y+S+le*(x+1),G=Y+(S+1)+le*(x+1),H=Y+(S+1)+le*x;j.push(w,U,H),j.push(U,G,H),he+=6}z.addGroup(Z,he,ne),Z+=he,Y+=ue}buildPlane("z","y","x",-1,-1,w,S,x,H,G,0),buildPlane("z","y","x",1,-1,w,S,-x,H,G,1),buildPlane("x","z","y",1,1,x,w,S,U,H,2),buildPlane("x","z","y",1,-1,x,w,-S,U,H,3),buildPlane("x","y","z",1,-1,x,S,w,U,G,4),buildPlane("x","y","z",-1,-1,x,S,-w,U,G,5),this.setIndex(j),this.setAttribute("position",new Float32BufferAttribute(X,3)),this.setAttribute("normal",new Float32BufferAttribute(K,3)),this.setAttribute("uv",new Float32BufferAttribute(q,2))}static fromJSON(x){return new BoxGeometry(x.width,x.height,x.depth,x.widthSegments,x.heightSegments,x.depthSegments)}}function cloneUniforms(x){const S={};for(const w in x){S[w]={};for(const U in x[w]){const G=x[w][U];G&&(G.isColor||G.isMatrix3||G.isMatrix4||G.isVector2||G.isVector3||G.isVector4||G.isTexture||G.isQuaternion)?S[w][U]=G.clone():Array.isArray(G)?S[w][U]=G.slice():S[w][U]=G}}return S}function mergeUniforms(x){const S={};for(let w=0;w<x.length;w++){const U=cloneUniforms(x[w]);for(const x in U)S[x]=U[x]}return S}const Ro={clone:cloneUniforms,merge:mergeUniforms};class ShaderMaterial extends Material{constructor(x){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==x&&(void 0!==x.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(x))}copy(x){return super.copy(x),this.fragmentShader=x.fragmentShader,this.vertexShader=x.vertexShader,this.uniforms=cloneUniforms(x.uniforms),this.defines=Object.assign({},x.defines),this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.lights=x.lights,this.clipping=x.clipping,this.extensions=Object.assign({},x.extensions),this.glslVersion=x.glslVersion,this}toJSON(x){const S=super.toJSON(x);S.glslVersion=this.glslVersion,S.uniforms={};for(const w in this.uniforms){const U=this.uniforms[w].value;U&&U.isTexture?S.uniforms[w]={type:"t",value:U.toJSON(x).uuid}:U&&U.isColor?S.uniforms[w]={type:"c",value:U.getHex()}:U&&U.isVector2?S.uniforms[w]={type:"v2",value:U.toArray()}:U&&U.isVector3?S.uniforms[w]={type:"v3",value:U.toArray()}:U&&U.isVector4?S.uniforms[w]={type:"v4",value:U.toArray()}:U&&U.isMatrix3?S.uniforms[w]={type:"m3",value:U.toArray()}:U&&U.isMatrix4?S.uniforms[w]={type:"m4",value:U.toArray()}:S.uniforms[w]={value:U}}Object.keys(this.defines).length>0&&(S.defines=this.defines),S.vertexShader=this.vertexShader,S.fragmentShader=this.fragmentShader;const w={};for(const x in this.extensions)!0===this.extensions[x]&&(w[x]=!0);return Object.keys(w).length>0&&(S.extensions=w),S}}ShaderMaterial.prototype.isShaderMaterial=!0;class Camera extends Object3D{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}copy(x,S){return super.copy(x,S),this.matrixWorldInverse.copy(x.matrixWorldInverse),this.projectionMatrix.copy(x.projectionMatrix),this.projectionMatrixInverse.copy(x.projectionMatrixInverse),this}getWorldDirection(x){this.updateWorldMatrix(!0,!1);const S=this.matrixWorld.elements;return x.set(-S[8],-S[9],-S[10]).normalize()}updateMatrixWorld(x){super.updateMatrixWorld(x),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(x,S){super.updateWorldMatrix(x,S),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Camera.prototype.isCamera=!0;class PerspectiveCamera extends Camera{constructor(x=50,S=1,w=.1,U=2e3){super(),this.type="PerspectiveCamera",this.fov=x,this.zoom=1,this.near=w,this.far=U,this.focus=10,this.aspect=S,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(x,S){return super.copy(x,S),this.fov=x.fov,this.zoom=x.zoom,this.near=x.near,this.far=x.far,this.focus=x.focus,this.aspect=x.aspect,this.view=null===x.view?null:Object.assign({},x.view),this.filmGauge=x.filmGauge,this.filmOffset=x.filmOffset,this}setFocalLength(x){const S=.5*this.getFilmHeight()/x;this.fov=2*Vi*Math.atan(S),this.updateProjectionMatrix()}getFocalLength(){const x=Math.tan(.5*Gi*this.fov);return.5*this.getFilmHeight()/x}getEffectiveFOV(){return 2*Vi*Math.atan(Math.tan(.5*Gi*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(x,S,w,U,G,H){this.aspect=x/S,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=x,this.view.fullHeight=S,this.view.offsetX=w,this.view.offsetY=U,this.view.width=G,this.view.height=H,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const x=this.near;let S=x*Math.tan(.5*Gi*this.fov)/this.zoom,w=2*S,U=this.aspect*w,G=-.5*U;const H=this.view;if(null!==this.view&&this.view.enabled){const x=H.fullWidth,z=H.fullHeight;G+=H.offsetX*U/x,S-=H.offsetY*w/z,U*=H.width/x,w*=H.height/z}const z=this.filmOffset;0!==z&&(G+=x*z/this.getFilmWidth()),this.projectionMatrix.makePerspective(G,G+U,S,S-w,x,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(x){const S=super.toJSON(x);return S.object.fov=this.fov,S.object.zoom=this.zoom,S.object.near=this.near,S.object.far=this.far,S.object.focus=this.focus,S.object.aspect=this.aspect,null!==this.view&&(S.object.view=Object.assign({},this.view)),S.object.filmGauge=this.filmGauge,S.object.filmOffset=this.filmOffset,S}}PerspectiveCamera.prototype.isPerspectiveCamera=!0;const Lo=90;class CubeCamera extends Object3D{constructor(x,S,w){if(super(),this.type="CubeCamera",!0!==w.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=w;const U=new PerspectiveCamera(Lo,1,x,S);U.layers=this.layers,U.up.set(0,-1,0),U.lookAt(new Vector3(1,0,0)),this.add(U);const G=new PerspectiveCamera(Lo,1,x,S);G.layers=this.layers,G.up.set(0,-1,0),G.lookAt(new Vector3(-1,0,0)),this.add(G);const H=new PerspectiveCamera(Lo,1,x,S);H.layers=this.layers,H.up.set(0,0,1),H.lookAt(new Vector3(0,1,0)),this.add(H);const z=new PerspectiveCamera(Lo,1,x,S);z.layers=this.layers,z.up.set(0,0,-1),z.lookAt(new Vector3(0,-1,0)),this.add(z);const j=new PerspectiveCamera(Lo,1,x,S);j.layers=this.layers,j.up.set(0,-1,0),j.lookAt(new Vector3(0,0,1)),this.add(j);const X=new PerspectiveCamera(Lo,1,x,S);X.layers=this.layers,X.up.set(0,-1,0),X.lookAt(new Vector3(0,0,-1)),this.add(X)}update(x,S){null===this.parent&&this.updateMatrixWorld();const w=this.renderTarget,[U,G,H,z,j,X]=this.children,K=x.xr.enabled,q=x.getRenderTarget();x.xr.enabled=!1;const Y=w.texture.generateMipmaps;w.texture.generateMipmaps=!1,x.setRenderTarget(w,0),x.render(S,U),x.setRenderTarget(w,1),x.render(S,G),x.setRenderTarget(w,2),x.render(S,H),x.setRenderTarget(w,3),x.render(S,z),x.setRenderTarget(w,4),x.render(S,j),w.texture.generateMipmaps=Y,x.setRenderTarget(w,5),x.render(S,X),x.setRenderTarget(q),x.xr.enabled=K}}class CubeTexture extends Texture{constructor(x,S,w,U,G,H,z,j,X,K){super(x=void 0!==x?x:[],S=void 0!==S?S:$e,w,U,G,H,z,j,X,K),this.flipY=!1}get images(){return this.image}set images(x){this.image=x}}CubeTexture.prototype.isCubeTexture=!0;class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(x,S,w){Number.isInteger(S)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),S=w),super(x,x,S),S=S||{},this.texture=new CubeTexture(void 0,S.mapping,S.wrapS,S.wrapT,S.magFilter,S.minFilter,S.format,S.type,S.anisotropy,S.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==S.generateMipmaps&&S.generateMipmaps,this.texture.minFilter=void 0!==S.minFilter?S.minFilter:rt,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(x,S){this.texture.type=S.type,this.texture.format=wt,this.texture.encoding=S.encoding,this.texture.generateMipmaps=S.generateMipmaps,this.texture.minFilter=S.minFilter,this.texture.magFilter=S.magFilter;const w={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},U=new BoxGeometry(5,5,5),G=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(w.uniforms),vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,side:ee,blending:re});G.uniforms.tEquirect.value=S;const H=new Mesh(U,G),z=S.minFilter;S.minFilter===st&&(S.minFilter=rt);return new CubeCamera(1,10,this).update(x,H),S.minFilter=z,H.geometry.dispose(),H.material.dispose(),this}clear(x,S,w,U){const G=x.getRenderTarget();for(let G=0;G<6;G++)x.setRenderTarget(this,G),x.clear(S,w,U);x.setRenderTarget(G)}}WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget=!0;const Io=new Vector3,Po=new Vector3,Fo=new Matrix3;class Plane{constructor(x=new Vector3(1,0,0),S=0){this.normal=x,this.constant=S}set(x,S){return this.normal.copy(x),this.constant=S,this}setComponents(x,S,w,U){return this.normal.set(x,S,w),this.constant=U,this}setFromNormalAndCoplanarPoint(x,S){return this.normal.copy(x),this.constant=-S.dot(this.normal),this}setFromCoplanarPoints(x,S,w){const U=Io.subVectors(w,S).cross(Po.subVectors(x,S)).normalize();return this.setFromNormalAndCoplanarPoint(U,x),this}copy(x){return this.normal.copy(x.normal),this.constant=x.constant,this}normalize(){const x=1/this.normal.length();return this.normal.multiplyScalar(x),this.constant*=x,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(x){return this.normal.dot(x)+this.constant}distanceToSphere(x){return this.distanceToPoint(x.center)-x.radius}projectPoint(x,S){return S.copy(this.normal).multiplyScalar(-this.distanceToPoint(x)).add(x)}intersectLine(x,S){const w=x.delta(Io),U=this.normal.dot(w);if(0===U)return 0===this.distanceToPoint(x.start)?S.copy(x.start):null;const G=-(x.start.dot(this.normal)+this.constant)/U;return G<0||G>1?null:S.copy(w).multiplyScalar(G).add(x.start)}intersectsLine(x){const S=this.distanceToPoint(x.start),w=this.distanceToPoint(x.end);return S<0&&w>0||w<0&&S>0}intersectsBox(x){return x.intersectsPlane(this)}intersectsSphere(x){return x.intersectsPlane(this)}coplanarPoint(x){return x.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(x,S){const w=S||Fo.getNormalMatrix(x),U=this.coplanarPoint(Io).applyMatrix4(x),G=this.normal.applyMatrix3(w).normalize();return this.constant=-U.dot(G),this}translate(x){return this.constant-=x.dot(this.normal),this}equals(x){return x.normal.equals(this.normal)&&x.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Plane.prototype.isPlane=!0;const Oo=new Sphere,No=new Vector3;class Frustum{constructor(x=new Plane,S=new Plane,w=new Plane,U=new Plane,G=new Plane,H=new Plane){this.planes=[x,S,w,U,G,H]}set(x,S,w,U,G,H){const z=this.planes;return z[0].copy(x),z[1].copy(S),z[2].copy(w),z[3].copy(U),z[4].copy(G),z[5].copy(H),this}copy(x){const S=this.planes;for(let w=0;w<6;w++)S[w].copy(x.planes[w]);return this}setFromProjectionMatrix(x){const S=this.planes,w=x.elements,U=w[0],G=w[1],H=w[2],z=w[3],j=w[4],X=w[5],K=w[6],q=w[7],Y=w[8],Z=w[9],J=w[10],Q=w[11],ee=w[12],te=w[13],ne=w[14],ie=w[15];return S[0].setComponents(z-U,q-j,Q-Y,ie-ee).normalize(),S[1].setComponents(z+U,q+j,Q+Y,ie+ee).normalize(),S[2].setComponents(z+G,q+X,Q+Z,ie+te).normalize(),S[3].setComponents(z-G,q-X,Q-Z,ie-te).normalize(),S[4].setComponents(z-H,q-K,Q-J,ie-ne).normalize(),S[5].setComponents(z+H,q+K,Q+J,ie+ne).normalize(),this}intersectsObject(x){const S=x.geometry;return null===S.boundingSphere&&S.computeBoundingSphere(),Oo.copy(S.boundingSphere).applyMatrix4(x.matrixWorld),this.intersectsSphere(Oo)}intersectsSprite(x){return Oo.center.set(0,0,0),Oo.radius=.7071067811865476,Oo.applyMatrix4(x.matrixWorld),this.intersectsSphere(Oo)}intersectsSphere(x){const S=this.planes,w=x.center,U=-x.radius;for(let x=0;x<6;x++){if(S[x].distanceToPoint(w)<U)return!1}return!0}intersectsBox(x){const S=this.planes;for(let w=0;w<6;w++){const U=S[w];if(No.x=U.normal.x>0?x.max.x:x.min.x,No.y=U.normal.y>0?x.max.y:x.min.y,No.z=U.normal.z>0?x.max.z:x.min.z,U.distanceToPoint(No)<0)return!1}return!0}containsPoint(x){const S=this.planes;for(let w=0;w<6;w++)if(S[w].distanceToPoint(x)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function WebGLAnimation(){let x=null,S=!1,w=null,U=null;function onAnimationFrame(S,G){w(S,G),U=x.requestAnimationFrame(onAnimationFrame)}return{start:function(){!0!==S&&null!==w&&(U=x.requestAnimationFrame(onAnimationFrame),S=!0)},stop:function(){x.cancelAnimationFrame(U),S=!1},setAnimationLoop:function(x){w=x},setContext:function(S){x=S}}}function WebGLAttributes(x,S){const w=S.isWebGL2,U=new WeakMap;return{get:function get(x){return x.isInterleavedBufferAttribute&&(x=x.data),U.get(x)},remove:function remove(S){S.isInterleavedBufferAttribute&&(S=S.data);const w=U.get(S);w&&(x.deleteBuffer(w.buffer),U.delete(S))},update:function update(S,G){if(S.isGLBufferAttribute){const x=U.get(S);return void((!x||x.version<S.version)&&U.set(S,{buffer:S.buffer,type:S.type,bytesPerElement:S.elementSize,version:S.version}))}S.isInterleavedBufferAttribute&&(S=S.data);const H=U.get(S);void 0===H?U.set(S,function createBuffer(S,U){const G=S.array,H=S.usage,z=x.createBuffer();x.bindBuffer(U,z),x.bufferData(U,G,H),S.onUploadCallback();let j=5126;return G instanceof Float32Array?j=5126:G instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):G instanceof Uint16Array?S.isFloat16BufferAttribute?w?j=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):j=5123:G instanceof Int16Array?j=5122:G instanceof Uint32Array?j=5125:G instanceof Int32Array?j=5124:G instanceof Int8Array?j=5120:(G instanceof Uint8Array||G instanceof Uint8ClampedArray)&&(j=5121),{buffer:z,type:j,bytesPerElement:G.BYTES_PER_ELEMENT,version:S.version}}(S,G)):H.version<S.version&&(!function updateBuffer(S,U,G){const H=U.array,z=U.updateRange;x.bindBuffer(G,S),-1===z.count?x.bufferSubData(G,0,H):(w?x.bufferSubData(G,z.offset*H.BYTES_PER_ELEMENT,H,z.offset,z.count):x.bufferSubData(G,z.offset*H.BYTES_PER_ELEMENT,H.subarray(z.offset,z.offset+z.count)),z.count=-1)}(H.buffer,S,G),H.version=S.version)}}}class PlaneGeometry extends BufferGeometry{constructor(x=1,S=1,w=1,U=1){super(),this.type="PlaneGeometry",this.parameters={width:x,height:S,widthSegments:w,heightSegments:U};const G=x/2,H=S/2,z=Math.floor(w),j=Math.floor(U),X=z+1,K=j+1,q=x/z,Y=S/j,Z=[],J=[],Q=[],ee=[];for(let x=0;x<K;x++){const S=x*Y-H;for(let w=0;w<X;w++){const U=w*q-G;J.push(U,-S,0),Q.push(0,0,1),ee.push(w/z),ee.push(1-x/j)}}for(let x=0;x<j;x++)for(let S=0;S<z;S++){const w=S+X*x,U=S+X*(x+1),G=S+1+X*(x+1),H=S+1+X*x;Z.push(w,U,H),Z.push(U,G,H)}this.setIndex(Z),this.setAttribute("position",new Float32BufferAttribute(J,3)),this.setAttribute("normal",new Float32BufferAttribute(Q,3)),this.setAttribute("uv",new Float32BufferAttribute(ee,2))}static fromJSON(x){return new PlaneGeometry(x.width,x.height,x.widthSegments,x.heightSegments)}}const Bo={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenTint, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenTint * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenTint, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n\tuniform float sheenRoughness;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Do={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}}},ko={basic:{uniforms:mergeUniforms([Do.common,Do.specularmap,Do.envmap,Do.aomap,Do.lightmap,Do.fog]),vertexShader:Bo.meshbasic_vert,fragmentShader:Bo.meshbasic_frag},lambert:{uniforms:mergeUniforms([Do.common,Do.specularmap,Do.envmap,Do.aomap,Do.lightmap,Do.emissivemap,Do.fog,Do.lights,{emissive:{value:new Color(0)}}]),vertexShader:Bo.meshlambert_vert,fragmentShader:Bo.meshlambert_frag},phong:{uniforms:mergeUniforms([Do.common,Do.specularmap,Do.envmap,Do.aomap,Do.lightmap,Do.emissivemap,Do.bumpmap,Do.normalmap,Do.displacementmap,Do.fog,Do.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:Bo.meshphong_vert,fragmentShader:Bo.meshphong_frag},standard:{uniforms:mergeUniforms([Do.common,Do.envmap,Do.aomap,Do.lightmap,Do.emissivemap,Do.bumpmap,Do.normalmap,Do.displacementmap,Do.roughnessmap,Do.metalnessmap,Do.fog,Do.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bo.meshphysical_vert,fragmentShader:Bo.meshphysical_frag},toon:{uniforms:mergeUniforms([Do.common,Do.aomap,Do.lightmap,Do.emissivemap,Do.bumpmap,Do.normalmap,Do.displacementmap,Do.gradientmap,Do.fog,Do.lights,{emissive:{value:new Color(0)}}]),vertexShader:Bo.meshtoon_vert,fragmentShader:Bo.meshtoon_frag},matcap:{uniforms:mergeUniforms([Do.common,Do.bumpmap,Do.normalmap,Do.displacementmap,Do.fog,{matcap:{value:null}}]),vertexShader:Bo.meshmatcap_vert,fragmentShader:Bo.meshmatcap_frag},points:{uniforms:mergeUniforms([Do.points,Do.fog]),vertexShader:Bo.points_vert,fragmentShader:Bo.points_frag},dashed:{uniforms:mergeUniforms([Do.common,Do.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bo.linedashed_vert,fragmentShader:Bo.linedashed_frag},depth:{uniforms:mergeUniforms([Do.common,Do.displacementmap]),vertexShader:Bo.depth_vert,fragmentShader:Bo.depth_frag},normal:{uniforms:mergeUniforms([Do.common,Do.bumpmap,Do.normalmap,Do.displacementmap,{opacity:{value:1}}]),vertexShader:Bo.meshnormal_vert,fragmentShader:Bo.meshnormal_frag},sprite:{uniforms:mergeUniforms([Do.sprite,Do.fog]),vertexShader:Bo.sprite_vert,fragmentShader:Bo.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:Bo.background_vert,fragmentShader:Bo.background_frag},cube:{uniforms:mergeUniforms([Do.envmap,{opacity:{value:1}}]),vertexShader:Bo.cube_vert,fragmentShader:Bo.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bo.equirect_vert,fragmentShader:Bo.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([Do.common,Do.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bo.distanceRGBA_vert,fragmentShader:Bo.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([Do.lights,Do.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:Bo.shadow_vert,fragmentShader:Bo.shadow_frag}};function WebGLBackground(x,S,w,U,G){const H=new Color(0);let z,j,X=0,K=null,q=0,Y=null;function setClear(x,S){w.buffers.color.setClear(x.r,x.g,x.b,S,G)}return{getClearColor:function(){return H},setClearColor:function(x,S=1){H.set(x),X=S,setClear(H,X)},getClearAlpha:function(){return X},setClearAlpha:function(x){X=x,setClear(H,X)},render:function render(w,G){let Z=!1,J=!0===G.isScene?G.background:null;J&&J.isTexture&&(J=S.get(J));const te=x.xr,ne=te.getSession&&te.getSession();ne&&"additive"===ne.environmentBlendMode&&(J=null),null===J?setClear(H,X):J&&J.isColor&&(setClear(J,1),Z=!0),(x.autoClear||Z)&&x.clear(x.autoClearColor,x.autoClearDepth,x.autoClearStencil),J&&(J.isCubeTexture||J.mapping===Ke)?(void 0===j&&(j=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ko.cube.uniforms),vertexShader:ko.cube.vertexShader,fragmentShader:ko.cube.fragmentShader,side:ee,depthTest:!1,depthWrite:!1,fog:!1})),j.geometry.deleteAttribute("normal"),j.geometry.deleteAttribute("uv"),j.onBeforeRender=function(x,S,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(j.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),U.update(j)),j.material.uniforms.envMap.value=J,j.material.uniforms.flipEnvMap.value=J.isCubeTexture&&!1===J.isRenderTargetTexture?-1:1,K===J&&q===J.version&&Y===x.toneMapping||(j.material.needsUpdate=!0,K=J,q=J.version,Y=x.toneMapping),w.unshift(j,j.geometry,j.material,0,0,null)):J&&J.isTexture&&(void 0===z&&(z=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ko.background.uniforms),vertexShader:ko.background.vertexShader,fragmentShader:ko.background.fragmentShader,side:Q,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),Object.defineProperty(z.material,"map",{get:function(){return this.uniforms.t2D.value}}),U.update(z)),z.material.uniforms.t2D.value=J,!0===J.matrixAutoUpdate&&J.updateMatrix(),z.material.uniforms.uvTransform.value.copy(J.matrix),K===J&&q===J.version&&Y===x.toneMapping||(z.material.needsUpdate=!0,K=J,q=J.version,Y=x.toneMapping),w.unshift(z,z.geometry,z.material,0,0,null))}}}function WebGLBindingStates(x,S,w,U){const G=x.getParameter(34921),H=U.isWebGL2?null:S.get("OES_vertex_array_object"),z=U.isWebGL2||null!==H,j={},X=createBindingState(null);let K=X;function bindVertexArrayObject(S){return U.isWebGL2?x.bindVertexArray(S):H.bindVertexArrayOES(S)}function deleteVertexArrayObject(S){return U.isWebGL2?x.deleteVertexArray(S):H.deleteVertexArrayOES(S)}function createBindingState(x){const S=[],w=[],U=[];for(let x=0;x<G;x++)S[x]=0,w[x]=0,U[x]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:S,enabledAttributes:w,attributeDivisors:U,object:x,attributes:{},index:null}}function initAttributes(){const x=K.newAttributes;for(let S=0,w=x.length;S<w;S++)x[S]=0}function enableAttribute(x){enableAttributeAndDivisor(x,0)}function enableAttributeAndDivisor(w,G){const H=K.newAttributes,z=K.enabledAttributes,j=K.attributeDivisors;if(H[w]=1,0===z[w]&&(x.enableVertexAttribArray(w),z[w]=1),j[w]!==G){(U.isWebGL2?x:S.get("ANGLE_instanced_arrays"))[U.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](w,G),j[w]=G}}function disableUnusedAttributes(){const S=K.newAttributes,w=K.enabledAttributes;for(let U=0,G=w.length;U<G;U++)w[U]!==S[U]&&(x.disableVertexAttribArray(U),w[U]=0)}function vertexAttribPointer(S,w,G,H,z,j){!0!==U.isWebGL2||5124!==G&&5125!==G?x.vertexAttribPointer(S,w,G,H,z,j):x.vertexAttribIPointer(S,w,G,z,j)}function reset(){resetDefaultState(),K!==X&&(K=X,bindVertexArrayObject(K.object))}function resetDefaultState(){X.geometry=null,X.program=null,X.wireframe=!1}return{setup:function setup(G,X,q,Y,Z){let J=!1;if(z){const S=function getBindingState(S,w,G){const z=!0===G.wireframe;let X=j[S.id];void 0===X&&(X={},j[S.id]=X);let K=X[w.id];void 0===K&&(K={},X[w.id]=K);let q=K[z];void 0===q&&(q=createBindingState(function createVertexArrayObject(){return U.isWebGL2?x.createVertexArray():H.createVertexArrayOES()}()),K[z]=q);return q}(Y,q,X);K!==S&&(K=S,bindVertexArrayObject(K.object)),J=function needsUpdate(x,S){const w=K.attributes,U=x.attributes;let G=0;for(const x in U){const S=w[x],H=U[x];if(void 0===S)return!0;if(S.attribute!==H)return!0;if(S.data!==H.data)return!0;G++}return K.attributesNum!==G||K.index!==S}(Y,Z),J&&function saveCache(x,S){const w={},U=x.attributes;let G=0;for(const x in U){const S=U[x],H={};H.attribute=S,S.data&&(H.data=S.data),w[x]=H,G++}K.attributes=w,K.attributesNum=G,K.index=S}(Y,Z)}else{const x=!0===X.wireframe;K.geometry===Y.id&&K.program===q.id&&K.wireframe===x||(K.geometry=Y.id,K.program=q.id,K.wireframe=x,J=!0)}!0===G.isInstancedMesh&&(J=!0),null!==Z&&w.update(Z,34963),J&&(!function setupVertexAttributes(G,H,z,j){if(!1===U.isWebGL2&&(G.isInstancedMesh||j.isInstancedBufferGeometry)&&null===S.get("ANGLE_instanced_arrays"))return;initAttributes();const X=j.attributes,K=z.getAttributes(),q=H.defaultAttributeValues;for(const S in K){const U=K[S];if(U.location>=0){let H=X[S];if(void 0===H&&("instanceMatrix"===S&&G.instanceMatrix&&(H=G.instanceMatrix),"instanceColor"===S&&G.instanceColor&&(H=G.instanceColor)),void 0!==H){const S=H.normalized,z=H.itemSize,X=w.get(H);if(void 0===X)continue;const K=X.buffer,q=X.type,Y=X.bytesPerElement;if(H.isInterleavedBufferAttribute){const w=H.data,X=w.stride,Z=H.offset;if(w&&w.isInstancedInterleavedBuffer){for(let x=0;x<U.locationSize;x++)enableAttributeAndDivisor(U.location+x,w.meshPerAttribute);!0!==G.isInstancedMesh&&void 0===j._maxInstanceCount&&(j._maxInstanceCount=w.meshPerAttribute*w.count)}else for(let x=0;x<U.locationSize;x++)enableAttribute(U.location+x);x.bindBuffer(34962,K);for(let x=0;x<U.locationSize;x++)vertexAttribPointer(U.location+x,z/U.locationSize,q,S,X*Y,(Z+z/U.locationSize*x)*Y)}else{if(H.isInstancedBufferAttribute){for(let x=0;x<U.locationSize;x++)enableAttributeAndDivisor(U.location+x,H.meshPerAttribute);!0!==G.isInstancedMesh&&void 0===j._maxInstanceCount&&(j._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let x=0;x<U.locationSize;x++)enableAttribute(U.location+x);x.bindBuffer(34962,K);for(let x=0;x<U.locationSize;x++)vertexAttribPointer(U.location+x,z/U.locationSize,q,S,z*Y,z/U.locationSize*x*Y)}}else if(void 0!==q){const w=q[S];if(void 0!==w)switch(w.length){case 2:x.vertexAttrib2fv(U.location,w);break;case 3:x.vertexAttrib3fv(U.location,w);break;case 4:x.vertexAttrib4fv(U.location,w);break;default:x.vertexAttrib1fv(U.location,w)}}}}disableUnusedAttributes()}(G,X,q,Y),null!==Z&&x.bindBuffer(34963,w.get(Z).buffer))},reset,resetDefaultState,dispose:function dispose(){reset();for(const x in j){const S=j[x];for(const x in S){const w=S[x];for(const x in w)deleteVertexArrayObject(w[x].object),delete w[x];delete S[x]}delete j[x]}},releaseStatesOfGeometry:function releaseStatesOfGeometry(x){if(void 0===j[x.id])return;const S=j[x.id];for(const x in S){const w=S[x];for(const x in w)deleteVertexArrayObject(w[x].object),delete w[x];delete S[x]}delete j[x.id]},releaseStatesOfProgram:function releaseStatesOfProgram(x){for(const S in j){const w=j[S];if(void 0===w[x.id])continue;const U=w[x.id];for(const x in U)deleteVertexArrayObject(U[x].object),delete U[x];delete w[x.id]}},initAttributes,enableAttribute,disableUnusedAttributes}}function WebGLBufferRenderer(x,S,w,U){const G=U.isWebGL2;let H;this.setMode=function setMode(x){H=x},this.render=function render(S,U){x.drawArrays(H,S,U),w.update(U,H,1)},this.renderInstances=function renderInstances(U,z,j){if(0===j)return;let X,K;if(G)X=x,K="drawArraysInstanced";else if(X=S.get("ANGLE_instanced_arrays"),K="drawArraysInstancedANGLE",null===X)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");X[K](H,U,z,j),w.update(z,H,j)}}function WebGLCapabilities(x,S,w){let U;function getMaxPrecision(S){if("highp"===S){if(x.getShaderPrecisionFormat(35633,36338).precision>0&&x.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";S="mediump"}return"mediump"===S&&x.getShaderPrecisionFormat(35633,36337).precision>0&&x.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const G="undefined"!=typeof WebGL2RenderingContext&&x instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&x instanceof WebGL2ComputeRenderingContext;let H=void 0!==w.precision?w.precision:"highp";const z=getMaxPrecision(H);z!==H&&(console.warn("THREE.WebGLRenderer:",H,"not supported, using",z,"instead."),H=z);const j=G||S.has("WEBGL_draw_buffers"),X=!0===w.logarithmicDepthBuffer,K=x.getParameter(34930),q=x.getParameter(35660),Y=x.getParameter(3379),Z=x.getParameter(34076),J=x.getParameter(34921),Q=x.getParameter(36347),ee=x.getParameter(36348),te=x.getParameter(36349),ne=q>0,ie=G||S.has("OES_texture_float");return{isWebGL2:G,drawBuffers:j,getMaxAnisotropy:function getMaxAnisotropy(){if(void 0!==U)return U;if(!0===S.has("EXT_texture_filter_anisotropic")){const w=S.get("EXT_texture_filter_anisotropic");U=x.getParameter(w.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else U=0;return U},getMaxPrecision,precision:H,logarithmicDepthBuffer:X,maxTextures:K,maxVertexTextures:q,maxTextureSize:Y,maxCubemapSize:Z,maxAttributes:J,maxVertexUniforms:Q,maxVaryings:ee,maxFragmentUniforms:te,vertexTextures:ne,floatFragmentTextures:ie,floatVertexTextures:ne&&ie,maxSamples:G?x.getParameter(36183):0}}function WebGLClipping(x){const S=this;let w=null,U=0,G=!1,H=!1;const z=new Plane,j=new Matrix3,X={value:null,needsUpdate:!1};function resetGlobalState(){X.value!==w&&(X.value=w,X.needsUpdate=U>0),S.numPlanes=U,S.numIntersection=0}function projectPlanes(x,w,U,G){const H=null!==x?x.length:0;let K=null;if(0!==H){if(K=X.value,!0!==G||null===K){const S=U+4*H,G=w.matrixWorldInverse;j.getNormalMatrix(G),(null===K||K.length<S)&&(K=new Float32Array(S));for(let S=0,w=U;S!==H;++S,w+=4)z.copy(x[S]).applyMatrix4(G,j),z.normal.toArray(K,w),K[w+3]=z.constant}X.value=K,X.needsUpdate=!0}return S.numPlanes=H,S.numIntersection=0,K}this.uniform=X,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S,H){const z=0!==x.length||S||0!==U||G;return G=S,w=projectPlanes(x,H,0),U=x.length,z},this.beginShadows=function(){H=!0,projectPlanes(null)},this.endShadows=function(){H=!1,resetGlobalState()},this.setState=function(S,z,j){const K=S.clippingPlanes,q=S.clipIntersection,Y=S.clipShadows,Z=x.get(S);if(!G||null===K||0===K.length||H&&!Y)H?projectPlanes(null):resetGlobalState();else{const x=H?0:U,S=4*x;let G=Z.clippingState||null;X.value=G,G=projectPlanes(K,z,S,j);for(let x=0;x!==S;++x)G[x]=w[x];Z.clippingState=G,this.numIntersection=q?this.numPlanes:0,this.numPlanes+=x}}}function WebGLCubeMaps(x){let S=new WeakMap;function mapTextureMapping(x,S){return S===je?x.mapping=$e:S===Xe&&(x.mapping=ze),x}function onTextureDispose(x){const w=x.target;w.removeEventListener("dispose",onTextureDispose);const U=S.get(w);void 0!==U&&(S.delete(w),U.dispose())}return{get:function get(w){if(w&&w.isTexture&&!1===w.isRenderTargetTexture){const U=w.mapping;if(U===je||U===Xe){if(S.has(w)){return mapTextureMapping(S.get(w).texture,w.mapping)}{const U=w.image;if(U&&U.height>0){const G=x.getRenderTarget(),H=new WebGLCubeRenderTarget(U.height/2);return H.fromEquirectangularTexture(x,w),S.set(w,H),x.setRenderTarget(G),w.addEventListener("dispose",onTextureDispose),mapTextureMapping(H.texture,w.mapping)}return null}}}return w},dispose:function dispose(){S=new WeakMap}}}ko.physical={uniforms:mergeUniforms([ko.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenTint:{value:new Color(0)},sheenRoughness:{value:0},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Color(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Color(1,1,1)},specularTintMap:{value:null}}]),vertexShader:Bo.meshphysical_vert,fragmentShader:Bo.meshphysical_frag};class OrthographicCamera extends Camera{constructor(x=-1,S=1,w=1,U=-1,G=.1,H=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=x,this.right=S,this.top=w,this.bottom=U,this.near=G,this.far=H,this.updateProjectionMatrix()}copy(x,S){return super.copy(x,S),this.left=x.left,this.right=x.right,this.top=x.top,this.bottom=x.bottom,this.near=x.near,this.far=x.far,this.zoom=x.zoom,this.view=null===x.view?null:Object.assign({},x.view),this}setViewOffset(x,S,w,U,G,H){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=x,this.view.fullHeight=S,this.view.offsetX=w,this.view.offsetY=U,this.view.width=G,this.view.height=H,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const x=(this.right-this.left)/(2*this.zoom),S=(this.top-this.bottom)/(2*this.zoom),w=(this.right+this.left)/2,U=(this.top+this.bottom)/2;let G=w-x,H=w+x,z=U+S,j=U-S;if(null!==this.view&&this.view.enabled){const x=(this.right-this.left)/this.view.fullWidth/this.zoom,S=(this.top-this.bottom)/this.view.fullHeight/this.zoom;G+=x*this.view.offsetX,H=G+x*this.view.width,z-=S*this.view.offsetY,j=z-S*this.view.height}this.projectionMatrix.makeOrthographic(G,H,z,j,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(x){const S=super.toJSON(x);return S.object.zoom=this.zoom,S.object.left=this.left,S.object.right=this.right,S.object.top=this.top,S.object.bottom=this.bottom,S.object.near=this.near,S.object.far=this.far,null!==this.view&&(S.object.view=Object.assign({},this.view)),S}}OrthographicCamera.prototype.isOrthographicCamera=!0;class RawShaderMaterial extends ShaderMaterial{constructor(x){super(x),this.type="RawShaderMaterial"}}RawShaderMaterial.prototype.isRawShaderMaterial=!0;const Uo=Math.pow(2,8),Go=[.125,.215,.35,.446,.526,.582],Vo=5+Go.length,Ho=20,Wo={[Xn]:0,[Kn]:1,[Zn]:2,[ei]:3,[ni]:4,[ii]:5,[qn]:6},$o=new OrthographicCamera,{_lodPlanes:zo,_sizeLods:jo,_sigmas:Xo}=_createPlanes(),Ko=new Color;let qo=null;const Yo=(1+Math.sqrt(5))/2,Zo=1/Yo,Jo=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,Yo,Zo),new Vector3(0,Yo,-Zo),new Vector3(Zo,0,Yo),new Vector3(-Zo,0,Yo),new Vector3(Yo,Zo,0),new Vector3(-Yo,Zo,0)];class PMREMGenerator{constructor(x){this._renderer=x,this._pingPongRenderTarget=null,this._blurMaterial=function _getBlurShader(x){const S=new Float32Array(x),w=new Vector3(0,1,0);return new RawShaderMaterial({name:"SphericalGaussianBlur",defines:{n:x},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:S},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:w},inputEncoding:{value:Wo[Xn]},outputEncoding:{value:Wo[Xn]}},vertexShader:_getCommonVertexShader(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${_getEncodings()}\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:re,depthTest:!1,depthWrite:!1})}(Ho),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(x,S=0,w=.1,U=100){qo=this._renderer.getRenderTarget();const G=this._allocateTargets();return this._sceneToCubeUV(x,w,U,G),S>0&&this._blur(G,0,0,S),this._applyPMREM(G),this._cleanup(G),G}fromEquirectangular(x){return this._fromTexture(x)}fromCubemap(x){return this._fromTexture(x)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=_getCubemapShader(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=_getEquirectShader(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let x=0;x<zo.length;x++)zo[x].dispose()}_cleanup(x){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(qo),x.scissorTest=!1,_setViewport(x,0,0,x.width,x.height)}_fromTexture(x){qo=this._renderer.getRenderTarget();const S=this._allocateTargets(x);return this._textureToCubeUV(x,S),this._applyPMREM(S),this._cleanup(S),S}_allocateTargets(x){const S={magFilter:Qe,minFilter:Qe,generateMipmaps:!1,type:ct,format:At,encoding:_isLDR(x)?x.encoding:Zn,depthBuffer:!1},w=_createRenderTarget(S);return w.depthBuffer=!x,this._pingPongRenderTarget=_createRenderTarget(S),w}_compileMaterial(x){const S=new Mesh(zo[0],x);this._renderer.compile(S,$o)}_sceneToCubeUV(x,S,w,U){const G=new PerspectiveCamera(90,1,S,w),H=[1,-1,1,1,1,1],z=[1,1,1,-1,-1,-1],j=this._renderer,X=j.autoClear,K=j.outputEncoding,q=j.toneMapping;j.getClearColor(Ko),j.toneMapping=De,j.outputEncoding=Xn,j.autoClear=!1;const Y=new MeshBasicMaterial({name:"PMREM.Background",side:ee,depthWrite:!1,depthTest:!1}),Z=new Mesh(new BoxGeometry,Y);let J=!1;const Q=x.background;Q?Q.isColor&&(Y.color.copy(Q),x.background=null,J=!0):(Y.color.copy(Ko),J=!0);for(let S=0;S<6;S++){const w=S%3;0==w?(G.up.set(0,H[S],0),G.lookAt(z[S],0,0)):1==w?(G.up.set(0,0,H[S]),G.lookAt(0,z[S],0)):(G.up.set(0,H[S],0),G.lookAt(0,0,z[S])),_setViewport(U,w*Uo,S>2?Uo:0,Uo,Uo),j.setRenderTarget(U),J&&j.render(Z,G),j.render(x,G)}Z.geometry.dispose(),Z.material.dispose(),j.toneMapping=q,j.outputEncoding=K,j.autoClear=X,x.background=Q}_setEncoding(x,S){!0===this._renderer.capabilities.isWebGL2&&S.format===wt&&S.type===ct&&S.encoding===Kn?x.value=Wo[Xn]:x.value=Wo[S.encoding]}_textureToCubeUV(x,S){const w=this._renderer;x.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=_getCubemapShader()):null==this._equirectShader&&(this._equirectShader=_getEquirectShader());const U=x.isCubeTexture?this._cubemapShader:this._equirectShader,G=new Mesh(zo[0],U),H=U.uniforms;H.envMap.value=x,x.isCubeTexture||H.texelSize.value.set(1/x.image.width,1/x.image.height),this._setEncoding(H.inputEncoding,x),this._setEncoding(H.outputEncoding,S.texture),_setViewport(S,0,0,3*Uo,2*Uo),w.setRenderTarget(S),w.render(G,$o)}_applyPMREM(x){const S=this._renderer,w=S.autoClear;S.autoClear=!1;for(let S=1;S<Vo;S++){const w=Math.sqrt(Xo[S]*Xo[S]-Xo[S-1]*Xo[S-1]),U=Jo[(S-1)%Jo.length];this._blur(x,S-1,S,w,U)}S.autoClear=w}_blur(x,S,w,U,G){const H=this._pingPongRenderTarget;this._halfBlur(x,H,S,w,U,"latitudinal",G),this._halfBlur(H,x,w,w,U,"longitudinal",G)}_halfBlur(x,S,w,U,G,H,z){const j=this._renderer,X=this._blurMaterial;"latitudinal"!==H&&"longitudinal"!==H&&console.error("blur direction must be either latitudinal or longitudinal!");const K=new Mesh(zo[U],X),q=X.uniforms,Y=jo[w]-1,Z=isFinite(G)?Math.PI/(2*Y):2*Math.PI/39,J=G/Z,Q=isFinite(G)?1+Math.floor(3*J):Ho;Q>Ho&&console.warn(`sigmaRadians, ${G}, is too large and will clip, as it requested ${Q} samples when the maximum is set to 20`);const ee=[];let te=0;for(let x=0;x<Ho;++x){const S=x/J,w=Math.exp(-S*S/2);ee.push(w),0==x?te+=w:x<Q&&(te+=2*w)}for(let x=0;x<ee.length;x++)ee[x]=ee[x]/te;q.envMap.value=x.texture,q.samples.value=Q,q.weights.value=ee,q.latitudinal.value="latitudinal"===H,z&&(q.poleAxis.value=z),q.dTheta.value=Z,q.mipInt.value=8-w,this._setEncoding(q.inputEncoding,x.texture),this._setEncoding(q.outputEncoding,x.texture);const ne=jo[U];_setViewport(S,3*Math.max(0,Uo-2*ne),(0===U?0:2*Uo)+2*ne*(U>4?U-8+4:0),3*ne,2*ne),j.setRenderTarget(S),j.render(K,$o)}}function _isLDR(x){return void 0!==x&&x.type===ct&&(x.encoding===Xn||x.encoding===Kn||x.encoding===qn)}function _createPlanes(){const x=[],S=[],w=[];let U=8;for(let G=0;G<Vo;G++){const H=Math.pow(2,U);S.push(H);let z=1/H;G>4?z=Go[G-8+4-1]:0==G&&(z=0),w.push(z);const j=1/(H-1),X=-j/2,K=1+j/2,q=[X,X,K,X,K,K,X,X,K,K,X,K],Y=6,Z=6,J=3,Q=2,ee=1,te=new Float32Array(J*Z*Y),ne=new Float32Array(Q*Z*Y),ie=new Float32Array(ee*Z*Y);for(let x=0;x<Y;x++){const S=x%3*2/3-1,w=x>2?0:-1,U=[S,w,0,S+2/3,w,0,S+2/3,w+1,0,S,w,0,S+2/3,w+1,0,S,w+1,0];te.set(U,J*Z*x),ne.set(q,Q*Z*x);const G=[x,x,x,x,x,x];ie.set(G,ee*Z*x)}const re=new BufferGeometry;re.setAttribute("position",new BufferAttribute(te,J)),re.setAttribute("uv",new BufferAttribute(ne,Q)),re.setAttribute("faceIndex",new BufferAttribute(ie,ee)),x.push(re),U>4&&U--}return{_lodPlanes:x,_sizeLods:S,_sigmas:w}}function _createRenderTarget(x){const S=new WebGLRenderTarget(3*Uo,3*Uo,x);return S.texture.mapping=Ke,S.texture.name="PMREM.cubeUv",S.scissorTest=!0,S}function _setViewport(x,S,w,U,G){x.viewport.set(S,w,U,G),x.scissor.set(S,w,U,G)}function _getEquirectShader(){const x=new Vector2(1,1);return new RawShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:x},inputEncoding:{value:Wo[Xn]},outputEncoding:{value:Wo[Xn]}},vertexShader:_getCommonVertexShader(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${_getEncodings()}\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:re,depthTest:!1,depthWrite:!1})}function _getCubemapShader(){return new RawShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Wo[Xn]},outputEncoding:{value:Wo[Xn]}},vertexShader:_getCommonVertexShader(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${_getEncodings()}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:re,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function _getEncodings(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}function WebGLCubeUVMaps(x){let S=new WeakMap,w=null;function onTextureDispose(x){const w=x.target;w.removeEventListener("dispose",onTextureDispose);const U=S.get(w);void 0!==U&&(S.delete(w),U.dispose())}return{get:function get(U){if(U&&U.isTexture&&!1===U.isRenderTargetTexture){const G=U.mapping,H=G===je||G===Xe,z=G===$e||G===ze;if(H||z){if(S.has(U))return S.get(U).texture;{const G=U.image;if(H&&G&&G.height>0||z&&G&&function isCubeTextureComplete(x){let S=0;const w=6;for(let U=0;U<w;U++)void 0!==x[U]&&S++;return S===w}(G)){const G=x.getRenderTarget();null===w&&(w=new PMREMGenerator(x));const z=H?w.fromEquirectangular(U):w.fromCubemap(U);return S.set(U,z),x.setRenderTarget(G),U.addEventListener("dispose",onTextureDispose),z.texture}return null}}}return U},dispose:function dispose(){S=new WeakMap,null!==w&&(w.dispose(),w=null)}}}function WebGLExtensions(x){const S={};function getExtension(w){if(void 0!==S[w])return S[w];let U;switch(w){case"WEBGL_depth_texture":U=x.getExtension("WEBGL_depth_texture")||x.getExtension("MOZ_WEBGL_depth_texture")||x.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":U=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":U=x.getExtension("WEBGL_compressed_texture_s3tc")||x.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||x.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":U=x.getExtension("WEBGL_compressed_texture_pvrtc")||x.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:U=x.getExtension(w)}return S[w]=U,U}return{has:function(x){return null!==getExtension(x)},init:function(x){x.isWebGL2?getExtension("EXT_color_buffer_float"):(getExtension("WEBGL_depth_texture"),getExtension("OES_texture_float"),getExtension("OES_texture_half_float"),getExtension("OES_texture_half_float_linear"),getExtension("OES_standard_derivatives"),getExtension("OES_element_index_uint"),getExtension("OES_vertex_array_object"),getExtension("ANGLE_instanced_arrays")),getExtension("OES_texture_float_linear"),getExtension("EXT_color_buffer_half_float")},get:function(x){const S=getExtension(x);return null===S&&console.warn("THREE.WebGLRenderer: "+x+" extension not supported."),S}}}function WebGLGeometries(x,S,w,U){const G={},H=new WeakMap;function onGeometryDispose(x){const z=x.target;null!==z.index&&S.remove(z.index);for(const x in z.attributes)S.remove(z.attributes[x]);z.removeEventListener("dispose",onGeometryDispose),delete G[z.id];const j=H.get(z);j&&(S.remove(j),H.delete(z)),U.releaseStatesOfGeometry(z),!0===z.isInstancedBufferGeometry&&delete z._maxInstanceCount,w.memory.geometries--}function updateWireframeAttribute(x){const w=[],U=x.index,G=x.attributes.position;let z=0;if(null!==U){const x=U.array;z=U.version;for(let S=0,U=x.length;S<U;S+=3){const U=x[S+0],G=x[S+1],H=x[S+2];w.push(U,G,G,H,H,U)}}else{const x=G.array;z=G.version;for(let S=0,U=x.length/3-1;S<U;S+=3){const x=S+0,U=S+1,G=S+2;w.push(x,U,U,G,G,x)}}const j=new(arrayMax(w)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(w,1);j.version=z;const X=H.get(x);X&&S.remove(X),H.set(x,j)}return{get:function get(x,S){return!0===G[S.id]||(S.addEventListener("dispose",onGeometryDispose),G[S.id]=!0,w.memory.geometries++),S},update:function update(x){const w=x.attributes;for(const x in w)S.update(w[x],34962);const U=x.morphAttributes;for(const x in U){const w=U[x];for(let x=0,U=w.length;x<U;x++)S.update(w[x],34962)}},getWireframeAttribute:function getWireframeAttribute(x){const S=H.get(x);if(S){const w=x.index;null!==w&&S.version<w.version&&updateWireframeAttribute(x)}else updateWireframeAttribute(x);return H.get(x)}}}function WebGLIndexedBufferRenderer(x,S,w,U){const G=U.isWebGL2;let H,z,j;this.setMode=function setMode(x){H=x},this.setIndex=function setIndex(x){z=x.type,j=x.bytesPerElement},this.render=function render(S,U){x.drawElements(H,U,z,S*j),w.update(U,H,1)},this.renderInstances=function renderInstances(U,X,K){if(0===K)return;let q,Y;if(G)q=x,Y="drawElementsInstanced";else if(q=S.get("ANGLE_instanced_arrays"),Y="drawElementsInstancedANGLE",null===q)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");q[Y](H,X,z,U*j,K),w.update(X,H,K)}}function WebGLInfo(x){const S={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:S,programs:null,autoReset:!0,reset:function reset(){S.frame++,S.calls=0,S.triangles=0,S.points=0,S.lines=0},update:function update(x,w,U){switch(S.calls++,w){case 4:S.triangles+=U*(x/3);break;case 1:S.lines+=U*(x/2);break;case 3:S.lines+=U*(x-1);break;case 2:S.lines+=U*x;break;case 0:S.points+=U*x;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",w)}}}}class DataTexture2DArray extends Texture{constructor(x=null,S=1,w=1,U=1){super(null),this.image={data:x,width:S,height:w,depth:U},this.magFilter=Qe,this.minFilter=Qe,this.wrapR=Ze,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}function numericalSort(x,S){return x[0]-S[0]}function absNumericalSort(x,S){return Math.abs(S[1])-Math.abs(x[1])}function denormalize(x,S){let w=1;const U=S.isInterleavedBufferAttribute?S.data.array:S.array;U instanceof Int8Array?w=127:U instanceof Int16Array?w=32767:U instanceof Int32Array?w=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",U),x.divideScalar(w)}function WebGLMorphtargets(x,S,w){const U={},G=new Float32Array(8),H=new WeakMap,z=new Vector3,j=[];for(let x=0;x<8;x++)j[x]=[x,0];return{update:function update(X,K,q,Y){const Z=X.morphTargetInfluences;if(!0===S.isWebGL2){const U=K.morphAttributes.position.length;let G=H.get(K);if(void 0===G||G.count!==U){void 0!==G&&G.texture.dispose();const x=void 0!==K.morphAttributes.normal,w=K.morphAttributes.position,j=K.morphAttributes.normal||[],X=!0===x?2:1;let q=K.attributes.position.count*X,Y=1;q>S.maxTextureSize&&(Y=Math.ceil(q/S.maxTextureSize),q=S.maxTextureSize);const Z=new Float32Array(q*Y*4*U),J=new DataTexture2DArray(Z,q,Y,U);J.format=wt,J.type=gt;const Q=4*X;for(let S=0;S<U;S++){const U=w[S],G=j[S],H=q*Y*4*S;for(let S=0;S<U.count;S++){z.fromBufferAttribute(U,S),!0===U.normalized&&denormalize(z,U);const w=S*Q;Z[H+w+0]=z.x,Z[H+w+1]=z.y,Z[H+w+2]=z.z,Z[H+w+3]=0,!0===x&&(z.fromBufferAttribute(G,S),!0===G.normalized&&denormalize(z,G),Z[H+w+4]=z.x,Z[H+w+5]=z.y,Z[H+w+6]=z.z,Z[H+w+7]=0)}}G={count:U,texture:J,size:new Vector2(q,Y)},H.set(K,G)}let j=0;for(let x=0;x<Z.length;x++)j+=Z[x];const X=K.morphTargetsRelative?1:1-j;Y.getUniforms().setValue(x,"morphTargetBaseInfluence",X),Y.getUniforms().setValue(x,"morphTargetInfluences",Z),Y.getUniforms().setValue(x,"morphTargetsTexture",G.texture,w),Y.getUniforms().setValue(x,"morphTargetsTextureSize",G.size)}else{const S=void 0===Z?0:Z.length;let w=U[K.id];if(void 0===w||w.length!==S){w=[];for(let x=0;x<S;x++)w[x]=[x,0];U[K.id]=w}for(let x=0;x<S;x++){const S=w[x];S[0]=x,S[1]=Z[x]}w.sort(absNumericalSort);for(let x=0;x<8;x++)x<S&&w[x][1]?(j[x][0]=w[x][0],j[x][1]=w[x][1]):(j[x][0]=Number.MAX_SAFE_INTEGER,j[x][1]=0);j.sort(numericalSort);const H=K.morphAttributes.position,z=K.morphAttributes.normal;let X=0;for(let x=0;x<8;x++){const S=j[x],w=S[0],U=S[1];w!==Number.MAX_SAFE_INTEGER&&U?(H&&K.getAttribute("morphTarget"+x)!==H[w]&&K.setAttribute("morphTarget"+x,H[w]),z&&K.getAttribute("morphNormal"+x)!==z[w]&&K.setAttribute("morphNormal"+x,z[w]),G[x]=U,X+=U):(H&&!0===K.hasAttribute("morphTarget"+x)&&K.deleteAttribute("morphTarget"+x),z&&!0===K.hasAttribute("morphNormal"+x)&&K.deleteAttribute("morphNormal"+x),G[x]=0)}const q=K.morphTargetsRelative?1:1-X;Y.getUniforms().setValue(x,"morphTargetBaseInfluence",q),Y.getUniforms().setValue(x,"morphTargetInfluences",G)}}}}function WebGLObjects(x,S,w,U){let G=new WeakMap;function onInstancedMeshDispose(x){const S=x.target;S.removeEventListener("dispose",onInstancedMeshDispose),w.remove(S.instanceMatrix),null!==S.instanceColor&&w.remove(S.instanceColor)}return{update:function update(x){const H=U.render.frame,z=x.geometry,j=S.get(x,z);return G.get(j)!==H&&(S.update(j),G.set(j,H)),x.isInstancedMesh&&(!1===x.hasEventListener("dispose",onInstancedMeshDispose)&&x.addEventListener("dispose",onInstancedMeshDispose),w.update(x.instanceMatrix,34962),null!==x.instanceColor&&w.update(x.instanceColor,34962)),j},dispose:function dispose(){G=new WeakMap}}}DataTexture2DArray.prototype.isDataTexture2DArray=!0;class DataTexture3D extends Texture{constructor(x=null,S=1,w=1,U=1){super(null),this.image={data:x,width:S,height:w,depth:U},this.magFilter=Qe,this.minFilter=Qe,this.wrapR=Ze,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}DataTexture3D.prototype.isDataTexture3D=!0;const Qo=new Texture,ea=new DataTexture2DArray,ta=new DataTexture3D,na=new CubeTexture,ia=[],ra=[],oa=new Float32Array(16),aa=new Float32Array(9),sa=new Float32Array(4);function flatten(x,S,w){const U=x[0];if(U<=0||U>0)return x;const G=S*w;let H=ia[G];if(void 0===H&&(H=new Float32Array(G),ia[G]=H),0!==S){U.toArray(H,0);for(let U=1,G=0;U!==S;++U)G+=w,x[U].toArray(H,G)}return H}function arraysEqual(x,S){if(x.length!==S.length)return!1;for(let w=0,U=x.length;w<U;w++)if(x[w]!==S[w])return!1;return!0}function copyArray(x,S){for(let w=0,U=S.length;w<U;w++)x[w]=S[w]}function allocTexUnits(x,S){let w=ra[S];void 0===w&&(w=new Int32Array(S),ra[S]=w);for(let U=0;U!==S;++U)w[U]=x.allocateTextureUnit();return w}function setValueV1f(x,S){const w=this.cache;w[0]!==S&&(x.uniform1f(this.addr,S),w[0]=S)}function setValueV2f(x,S){const w=this.cache;if(void 0!==S.x)w[0]===S.x&&w[1]===S.y||(x.uniform2f(this.addr,S.x,S.y),w[0]=S.x,w[1]=S.y);else{if(arraysEqual(w,S))return;x.uniform2fv(this.addr,S),copyArray(w,S)}}function setValueV3f(x,S){const w=this.cache;if(void 0!==S.x)w[0]===S.x&&w[1]===S.y&&w[2]===S.z||(x.uniform3f(this.addr,S.x,S.y,S.z),w[0]=S.x,w[1]=S.y,w[2]=S.z);else if(void 0!==S.r)w[0]===S.r&&w[1]===S.g&&w[2]===S.b||(x.uniform3f(this.addr,S.r,S.g,S.b),w[0]=S.r,w[1]=S.g,w[2]=S.b);else{if(arraysEqual(w,S))return;x.uniform3fv(this.addr,S),copyArray(w,S)}}function setValueV4f(x,S){const w=this.cache;if(void 0!==S.x)w[0]===S.x&&w[1]===S.y&&w[2]===S.z&&w[3]===S.w||(x.uniform4f(this.addr,S.x,S.y,S.z,S.w),w[0]=S.x,w[1]=S.y,w[2]=S.z,w[3]=S.w);else{if(arraysEqual(w,S))return;x.uniform4fv(this.addr,S),copyArray(w,S)}}function setValueM2(x,S){const w=this.cache,U=S.elements;if(void 0===U){if(arraysEqual(w,S))return;x.uniformMatrix2fv(this.addr,!1,S),copyArray(w,S)}else{if(arraysEqual(w,U))return;sa.set(U),x.uniformMatrix2fv(this.addr,!1,sa),copyArray(w,U)}}function setValueM3(x,S){const w=this.cache,U=S.elements;if(void 0===U){if(arraysEqual(w,S))return;x.uniformMatrix3fv(this.addr,!1,S),copyArray(w,S)}else{if(arraysEqual(w,U))return;aa.set(U),x.uniformMatrix3fv(this.addr,!1,aa),copyArray(w,U)}}function setValueM4(x,S){const w=this.cache,U=S.elements;if(void 0===U){if(arraysEqual(w,S))return;x.uniformMatrix4fv(this.addr,!1,S),copyArray(w,S)}else{if(arraysEqual(w,U))return;oa.set(U),x.uniformMatrix4fv(this.addr,!1,oa),copyArray(w,U)}}function setValueV1i(x,S){const w=this.cache;w[0]!==S&&(x.uniform1i(this.addr,S),w[0]=S)}function setValueV2i(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform2iv(this.addr,S),copyArray(w,S))}function setValueV3i(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform3iv(this.addr,S),copyArray(w,S))}function setValueV4i(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform4iv(this.addr,S),copyArray(w,S))}function setValueV1ui(x,S){const w=this.cache;w[0]!==S&&(x.uniform1ui(this.addr,S),w[0]=S)}function setValueV2ui(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform2uiv(this.addr,S),copyArray(w,S))}function setValueV3ui(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform3uiv(this.addr,S),copyArray(w,S))}function setValueV4ui(x,S){const w=this.cache;arraysEqual(w,S)||(x.uniform4uiv(this.addr,S),copyArray(w,S))}function setValueT1(x,S,w){const U=this.cache,G=w.allocateTextureUnit();U[0]!==G&&(x.uniform1i(this.addr,G),U[0]=G),w.safeSetTexture2D(S||Qo,G)}function setValueT3D1(x,S,w){const U=this.cache,G=w.allocateTextureUnit();U[0]!==G&&(x.uniform1i(this.addr,G),U[0]=G),w.setTexture3D(S||ta,G)}function setValueT6(x,S,w){const U=this.cache,G=w.allocateTextureUnit();U[0]!==G&&(x.uniform1i(this.addr,G),U[0]=G),w.safeSetTextureCube(S||na,G)}function setValueT2DArray1(x,S,w){const U=this.cache,G=w.allocateTextureUnit();U[0]!==G&&(x.uniform1i(this.addr,G),U[0]=G),w.setTexture2DArray(S||ea,G)}function setValueV1fArray(x,S){x.uniform1fv(this.addr,S)}function setValueV2fArray(x,S){const w=flatten(S,this.size,2);x.uniform2fv(this.addr,w)}function setValueV3fArray(x,S){const w=flatten(S,this.size,3);x.uniform3fv(this.addr,w)}function setValueV4fArray(x,S){const w=flatten(S,this.size,4);x.uniform4fv(this.addr,w)}function setValueM2Array(x,S){const w=flatten(S,this.size,4);x.uniformMatrix2fv(this.addr,!1,w)}function setValueM3Array(x,S){const w=flatten(S,this.size,9);x.uniformMatrix3fv(this.addr,!1,w)}function setValueM4Array(x,S){const w=flatten(S,this.size,16);x.uniformMatrix4fv(this.addr,!1,w)}function setValueV1iArray(x,S){x.uniform1iv(this.addr,S)}function setValueV2iArray(x,S){x.uniform2iv(this.addr,S)}function setValueV3iArray(x,S){x.uniform3iv(this.addr,S)}function setValueV4iArray(x,S){x.uniform4iv(this.addr,S)}function setValueV1uiArray(x,S){x.uniform1uiv(this.addr,S)}function setValueV2uiArray(x,S){x.uniform2uiv(this.addr,S)}function setValueV3uiArray(x,S){x.uniform3uiv(this.addr,S)}function setValueV4uiArray(x,S){x.uniform4uiv(this.addr,S)}function setValueT1Array(x,S,w){const U=S.length,G=allocTexUnits(w,U);x.uniform1iv(this.addr,G);for(let x=0;x!==U;++x)w.safeSetTexture2D(S[x]||Qo,G[x])}function setValueT6Array(x,S,w){const U=S.length,G=allocTexUnits(w,U);x.uniform1iv(this.addr,G);for(let x=0;x!==U;++x)w.safeSetTextureCube(S[x]||na,G[x])}function SingleUniform(x,S,w){this.id=x,this.addr=w,this.cache=[],this.setValue=function getSingularSetter(x){switch(x){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}(S.type)}function PureArrayUniform(x,S,w){this.id=x,this.addr=w,this.cache=[],this.size=S.size,this.setValue=function getPureArraySetter(x){switch(x){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35680:case 36300:case 36308:case 36293:return setValueT6Array}}(S.type)}function StructuredUniform(x){this.id=x,this.seq=[],this.map={}}PureArrayUniform.prototype.updateCache=function(x){const S=this.cache;x instanceof Float32Array&&S.length!==x.length&&(this.cache=new Float32Array(x.length)),copyArray(S,x)},StructuredUniform.prototype.setValue=function(x,S,w){const U=this.seq;for(let G=0,H=U.length;G!==H;++G){const H=U[G];H.setValue(x,S[H.id],w)}};const la=/(\w+)(\])?(\[|\.)?/g;function addUniform(x,S){x.seq.push(S),x.map[S.id]=S}function parseUniform(x,S,w){const U=x.name,G=U.length;for(la.lastIndex=0;;){const H=la.exec(U),z=la.lastIndex;let j=H[1];const X="]"===H[2],K=H[3];if(X&&(j|=0),void 0===K||"["===K&&z+2===G){addUniform(w,void 0===K?new SingleUniform(j,x,S):new PureArrayUniform(j,x,S));break}{let x=w.map[j];void 0===x&&(x=new StructuredUniform(j),addUniform(w,x)),w=x}}}function WebGLUniforms(x,S){this.seq=[],this.map={};const w=x.getProgramParameter(S,35718);for(let U=0;U<w;++U){const w=x.getActiveUniform(S,U);parseUniform(w,x.getUniformLocation(S,w.name),this)}}function WebGLShader(x,S,w){const U=x.createShader(S);return x.shaderSource(U,w),x.compileShader(U),U}WebGLUniforms.prototype.setValue=function(x,S,w,U){const G=this.map[S];void 0!==G&&G.setValue(x,w,U)},WebGLUniforms.prototype.setOptional=function(x,S,w){const U=S[w];void 0!==U&&this.setValue(x,w,U)},WebGLUniforms.upload=function(x,S,w,U){for(let G=0,H=S.length;G!==H;++G){const H=S[G],z=w[H.id];!1!==z.needsUpdate&&H.setValue(x,z.value,U)}},WebGLUniforms.seqWithValue=function(x,S){const w=[];for(let U=0,G=x.length;U!==G;++U){const G=x[U];G.id in S&&w.push(G)}return w};let ca=0;function getEncodingComponents(x){switch(x){case Xn:return["Linear","( value )"];case Kn:return["sRGB","( value )"];case Zn:return["RGBE","( value )"];case ei:return["RGBM","( value, 7.0 )"];case ni:return["RGBM","( value, 16.0 )"];case ii:return["RGBD","( value, 256.0 )"];case qn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Jn:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",x),["Linear","( value )"]}}function getShaderErrors(x,S,w){const U=x.getShaderParameter(S,35713),G=x.getShaderInfoLog(S).trim();return U&&""===G?"":w.toUpperCase()+"\n\n"+G+"\n\n"+function addLineNumbers(x){const S=x.split("\n");for(let x=0;x<S.length;x++)S[x]=x+1+": "+S[x];return S.join("\n")}(x.getShaderSource(S))}function getTexelDecodingFunction(x,S){const w=getEncodingComponents(S);return"vec4 "+x+"( vec4 value ) { return "+w[0]+"ToLinear"+w[1]+"; }"}function getTexelEncodingFunction(x,S){const w=getEncodingComponents(S);return"vec4 "+x+"( vec4 value ) { return LinearTo"+w[0]+w[1]+"; }"}function getToneMappingFunction(x,S){let w;switch(S){case ke:w="Linear";break;case Ue:w="Reinhard";break;case Ge:w="OptimizedCineon";break;case Ve:w="ACESFilmic";break;case He:w="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",S),w="Linear"}return"vec3 "+x+"( vec3 color ) { return "+w+"ToneMapping( color ); }"}function filterEmptyLine(x){return""!==x}function replaceLightNums(x,S){return x.replace(/NUM_DIR_LIGHTS/g,S.numDirLights).replace(/NUM_SPOT_LIGHTS/g,S.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,S.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,S.numPointLights).replace(/NUM_HEMI_LIGHTS/g,S.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,S.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,S.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,S.numPointLightShadows)}function replaceClippingPlaneNums(x,S){return x.replace(/NUM_CLIPPING_PLANES/g,S.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,S.numClippingPlanes-S.numClipIntersection)}const ua=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(x){return x.replace(ua,includeReplacer)}function includeReplacer(x,S){const w=Bo[S];if(void 0===w)throw new Error("Can not resolve #include <"+S+">");return resolveIncludes(w)}const ha=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,da=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(x){return x.replace(da,loopReplacer).replace(ha,deprecatedLoopReplacer)}function deprecatedLoopReplacer(x,S,w,U){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),loopReplacer(x,S,w,U)}function loopReplacer(x,S,w,U){let G="";for(let x=parseInt(S);x<parseInt(w);x++)G+=U.replace(/\[\s*i\s*\]/g,"[ "+x+" ]").replace(/UNROLLED_LOOP_INDEX/g,x);return G}function generatePrecision(x){let S="precision "+x.precision+" float;\nprecision "+x.precision+" int;";return"highp"===x.precision?S+="\n#define HIGH_PRECISION":"mediump"===x.precision?S+="\n#define MEDIUM_PRECISION":"lowp"===x.precision&&(S+="\n#define LOW_PRECISION"),S}function WebGLProgram(x,S,w,U){const G=x.getContext(),H=w.defines;let z=w.vertexShader,j=w.fragmentShader;const X=function generateShadowMapTypeDefine(x){let S="SHADOWMAP_TYPE_BASIC";return x.shadowMapType===Y?S="SHADOWMAP_TYPE_PCF":x.shadowMapType===Z?S="SHADOWMAP_TYPE_PCF_SOFT":x.shadowMapType===J&&(S="SHADOWMAP_TYPE_VSM"),S}(w),K=function generateEnvMapTypeDefine(x){let S="ENVMAP_TYPE_CUBE";if(x.envMap)switch(x.envMapMode){case $e:case ze:S="ENVMAP_TYPE_CUBE";break;case Ke:case qe:S="ENVMAP_TYPE_CUBE_UV"}return S}(w),q=function generateEnvMapModeDefine(x){let S="ENVMAP_MODE_REFLECTION";if(x.envMap)switch(x.envMapMode){case ze:case qe:S="ENVMAP_MODE_REFRACTION"}return S}(w),Q=function generateEnvMapBlendingDefine(x){let S="ENVMAP_BLENDING_NONE";if(x.envMap)switch(x.combine){case Oe:S="ENVMAP_BLENDING_MULTIPLY";break;case Ne:S="ENVMAP_BLENDING_MIX";break;case Be:S="ENVMAP_BLENDING_ADD"}return S}(w),ee=x.gammaFactor>0?x.gammaFactor:1,te=w.isWebGL2?"":function generateExtensions(x){return[x.extensionDerivatives||x.envMapCubeUV||x.bumpMap||x.tangentSpaceNormalMap||x.clearcoatNormalMap||x.flatShading||"physical"===x.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(x.extensionFragDepth||x.logarithmicDepthBuffer)&&x.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",x.extensionDrawBuffers&&x.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(x.extensionShaderTextureLOD||x.envMap||x.transmission)&&x.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join("\n")}(w),ne=function generateDefines(x){const S=[];for(const w in x){const U=x[w];!1!==U&&S.push("#define "+w+" "+U)}return S.join("\n")}(H),ie=G.createProgram();let re,oe,ae=w.glslVersion?"#version "+w.glslVersion+"\n":"";w.isRawShaderMaterial?(re=[ne].filter(filterEmptyLine).join("\n"),re.length>0&&(re+="\n"),oe=[te,ne].filter(filterEmptyLine).join("\n"),oe.length>0&&(oe+="\n")):(re=[generatePrecision(w),"#define SHADER_NAME "+w.shaderName,ne,w.instancing?"#define USE_INSTANCING":"",w.instancingColor?"#define USE_INSTANCING_COLOR":"",w.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+ee,"#define MAX_BONES "+w.maxBones,w.useFog&&w.fog?"#define USE_FOG":"",w.useFog&&w.fogExp2?"#define FOG_EXP2":"",w.map?"#define USE_MAP":"",w.envMap?"#define USE_ENVMAP":"",w.envMap?"#define "+q:"",w.lightMap?"#define USE_LIGHTMAP":"",w.aoMap?"#define USE_AOMAP":"",w.emissiveMap?"#define USE_EMISSIVEMAP":"",w.bumpMap?"#define USE_BUMPMAP":"",w.normalMap?"#define USE_NORMALMAP":"",w.normalMap&&w.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",w.normalMap&&w.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",w.clearcoatMap?"#define USE_CLEARCOATMAP":"",w.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",w.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",w.displacementMap&&w.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",w.specularMap?"#define USE_SPECULARMAP":"",w.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",w.specularTintMap?"#define USE_SPECULARTINTMAP":"",w.roughnessMap?"#define USE_ROUGHNESSMAP":"",w.metalnessMap?"#define USE_METALNESSMAP":"",w.alphaMap?"#define USE_ALPHAMAP":"",w.transmission?"#define USE_TRANSMISSION":"",w.transmissionMap?"#define USE_TRANSMISSIONMAP":"",w.thicknessMap?"#define USE_THICKNESSMAP":"",w.vertexTangents?"#define USE_TANGENT":"",w.vertexColors?"#define USE_COLOR":"",w.vertexAlphas?"#define USE_COLOR_ALPHA":"",w.vertexUvs?"#define USE_UV":"",w.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",w.flatShading?"#define FLAT_SHADED":"",w.skinning?"#define USE_SKINNING":"",w.useVertexTexture?"#define BONE_TEXTURE":"",w.morphTargets?"#define USE_MORPHTARGETS":"",w.morphNormals&&!1===w.flatShading?"#define USE_MORPHNORMALS":"",w.morphTargets&&w.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",w.morphTargets&&w.isWebGL2?"#define MORPHTARGETS_COUNT "+w.morphTargetsCount:"",w.doubleSided?"#define DOUBLE_SIDED":"",w.flipSided?"#define FLIP_SIDED":"",w.shadowMapEnabled?"#define USE_SHADOWMAP":"",w.shadowMapEnabled?"#define "+X:"",w.sizeAttenuation?"#define USE_SIZEATTENUATION":"",w.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",w.logarithmicDepthBuffer&&w.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n"),oe=[te,generatePrecision(w),"#define SHADER_NAME "+w.shaderName,ne,"#define GAMMA_FACTOR "+ee,w.useFog&&w.fog?"#define USE_FOG":"",w.useFog&&w.fogExp2?"#define FOG_EXP2":"",w.map?"#define USE_MAP":"",w.matcap?"#define USE_MATCAP":"",w.envMap?"#define USE_ENVMAP":"",w.envMap?"#define "+K:"",w.envMap?"#define "+q:"",w.envMap?"#define "+Q:"",w.lightMap?"#define USE_LIGHTMAP":"",w.aoMap?"#define USE_AOMAP":"",w.emissiveMap?"#define USE_EMISSIVEMAP":"",w.bumpMap?"#define USE_BUMPMAP":"",w.normalMap?"#define USE_NORMALMAP":"",w.normalMap&&w.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",w.normalMap&&w.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",w.clearcoat?"#define USE_CLEARCOAT":"",w.clearcoatMap?"#define USE_CLEARCOATMAP":"",w.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",w.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",w.specularMap?"#define USE_SPECULARMAP":"",w.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",w.specularTintMap?"#define USE_SPECULARTINTMAP":"",w.roughnessMap?"#define USE_ROUGHNESSMAP":"",w.metalnessMap?"#define USE_METALNESSMAP":"",w.alphaMap?"#define USE_ALPHAMAP":"",w.alphaTest?"#define USE_ALPHATEST":"",w.sheen?"#define USE_SHEEN":"",w.transmission?"#define USE_TRANSMISSION":"",w.transmissionMap?"#define USE_TRANSMISSIONMAP":"",w.thicknessMap?"#define USE_THICKNESSMAP":"",w.vertexTangents?"#define USE_TANGENT":"",w.vertexColors||w.instancingColor?"#define USE_COLOR":"",w.vertexAlphas?"#define USE_COLOR_ALPHA":"",w.vertexUvs?"#define USE_UV":"",w.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",w.gradientMap?"#define USE_GRADIENTMAP":"",w.flatShading?"#define FLAT_SHADED":"",w.doubleSided?"#define DOUBLE_SIDED":"",w.flipSided?"#define FLIP_SIDED":"",w.shadowMapEnabled?"#define USE_SHADOWMAP":"",w.shadowMapEnabled?"#define "+X:"",w.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",w.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",w.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",w.logarithmicDepthBuffer&&w.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(w.extensionShaderTextureLOD||w.envMap)&&w.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",w.toneMapping!==De?"#define TONE_MAPPING":"",w.toneMapping!==De?Bo.tonemapping_pars_fragment:"",w.toneMapping!==De?getToneMappingFunction("toneMapping",w.toneMapping):"",w.dithering?"#define DITHERING":"",w.format===St?"#define OPAQUE":"",Bo.encodings_pars_fragment,w.map?getTexelDecodingFunction("mapTexelToLinear",w.mapEncoding):"",w.matcap?getTexelDecodingFunction("matcapTexelToLinear",w.matcapEncoding):"",w.envMap?getTexelDecodingFunction("envMapTexelToLinear",w.envMapEncoding):"",w.emissiveMap?getTexelDecodingFunction("emissiveMapTexelToLinear",w.emissiveMapEncoding):"",w.specularTintMap?getTexelDecodingFunction("specularTintMapTexelToLinear",w.specularTintMapEncoding):"",w.lightMap?getTexelDecodingFunction("lightMapTexelToLinear",w.lightMapEncoding):"",getTexelEncodingFunction("linearToOutputTexel",w.outputEncoding),w.depthPacking?"#define DEPTH_PACKING "+w.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")),z=resolveIncludes(z),z=replaceLightNums(z,w),z=replaceClippingPlaneNums(z,w),j=resolveIncludes(j),j=replaceLightNums(j,w),j=replaceClippingPlaneNums(j,w),z=unrollLoops(z),j=unrollLoops(j),w.isWebGL2&&!0!==w.isRawShaderMaterial&&(ae="#version 300 es\n",re=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+re,oe=["#define varying in",w.glslVersion===ki?"":"out highp vec4 pc_fragColor;",w.glslVersion===ki?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+oe);const se=ae+oe+j,le=WebGLShader(G,35633,ae+re+z),ce=WebGLShader(G,35632,se);if(G.attachShader(ie,le),G.attachShader(ie,ce),void 0!==w.index0AttributeName?G.bindAttribLocation(ie,0,w.index0AttributeName):!0===w.morphTargets&&G.bindAttribLocation(ie,0,"position"),G.linkProgram(ie),x.debug.checkShaderErrors){const x=G.getProgramInfoLog(ie).trim(),S=G.getShaderInfoLog(le).trim(),w=G.getShaderInfoLog(ce).trim();let U=!0,H=!0;if(!1===G.getProgramParameter(ie,35714)){U=!1;const S=getShaderErrors(G,le,"vertex"),w=getShaderErrors(G,ce,"fragment");console.error("THREE.WebGLProgram: Shader Error "+G.getError()+" - VALIDATE_STATUS "+G.getProgramParameter(ie,35715)+"\n\nProgram Info Log: "+x+"\n"+S+"\n"+w)}else""!==x?console.warn("THREE.WebGLProgram: Program Info Log:",x):""!==S&&""!==w||(H=!1);H&&(this.diagnostics={runnable:U,programLog:x,vertexShader:{log:S,prefix:re},fragmentShader:{log:w,prefix:oe}})}let ue,he;return G.deleteShader(le),G.deleteShader(ce),this.getUniforms=function(){return void 0===ue&&(ue=new WebGLUniforms(G,ie)),ue},this.getAttributes=function(){return void 0===he&&(he=function fetchAttributeLocations(x,S){const w={},U=x.getProgramParameter(S,35721);for(let G=0;G<U;G++){const U=x.getActiveAttrib(S,G),H=U.name;let z=1;35674===U.type&&(z=2),35675===U.type&&(z=3),35676===U.type&&(z=4),w[H]={type:U.type,location:x.getAttribLocation(S,H),locationSize:z}}return w}(G,ie)),he},this.destroy=function(){U.releaseStatesOfProgram(this),G.deleteProgram(ie),this.program=void 0},this.name=w.shaderName,this.id=ca++,this.cacheKey=S,this.usedTimes=1,this.program=ie,this.vertexShader=le,this.fragmentShader=ce,this}function WebGLPrograms(x,S,w,U,G,H,z){const j=[],X=G.isWebGL2,K=G.logarithmicDepthBuffer,q=G.floatVertexTextures,Y=G.maxVertexUniforms,Z=G.vertexTextures;let J=G.precision;const Q={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},ne=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheen","transmission","transmissionMap","thicknessMap"];function getTextureEncodingFromMap(x){let S;return x&&x.isTexture?S=x.encoding:x&&x.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),S=x.texture.encoding):S=Xn,X&&x&&x.isTexture&&x.format===wt&&x.type===ct&&x.encoding===Kn&&(S=Xn),S}return{getParameters:function getParameters(H,j,ne,ie,re){const oe=ie.fog,ae=H.isMeshStandardMaterial?ie.environment:null,se=(H.isMeshStandardMaterial?w:S).get(H.envMap||ae),le=Q[H.type],ce=re.isSkinnedMesh?function getMaxBones(x){const S=x.skeleton.bones;if(q)return 1024;{const x=Y,w=Math.floor((x-20)/4),U=Math.min(w,S.length);return U<S.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+S.length+" bones. This GPU supports "+U+"."),0):U}}(re):0;let ue,he;if(null!==H.precision&&(J=G.getMaxPrecision(H.precision),J!==H.precision&&console.warn("THREE.WebGLProgram.getParameters:",H.precision,"not supported, using",J,"instead.")),le){const x=ko[le];ue=x.vertexShader,he=x.fragmentShader}else ue=H.vertexShader,he=H.fragmentShader;const de=x.getRenderTarget(),pe=H.alphaTest>0,me=H.clearcoat>0;return{isWebGL2:X,shaderID:le,shaderName:H.type,vertexShader:ue,fragmentShader:he,defines:H.defines,isRawShaderMaterial:!0===H.isRawShaderMaterial,glslVersion:H.glslVersion,precision:J,instancing:!0===re.isInstancedMesh,instancingColor:!0===re.isInstancedMesh&&null!==re.instanceColor,supportsVertexTextures:Z,outputEncoding:null!==de?getTextureEncodingFromMap(de.texture):x.outputEncoding,map:!!H.map,mapEncoding:getTextureEncodingFromMap(H.map),matcap:!!H.matcap,matcapEncoding:getTextureEncodingFromMap(H.matcap),envMap:!!se,envMapMode:se&&se.mapping,envMapEncoding:getTextureEncodingFromMap(se),envMapCubeUV:!!se&&(se.mapping===Ke||se.mapping===qe),lightMap:!!H.lightMap,lightMapEncoding:getTextureEncodingFromMap(H.lightMap),aoMap:!!H.aoMap,emissiveMap:!!H.emissiveMap,emissiveMapEncoding:getTextureEncodingFromMap(H.emissiveMap),bumpMap:!!H.bumpMap,normalMap:!!H.normalMap,objectSpaceNormalMap:H.normalMapType===li,tangentSpaceNormalMap:H.normalMapType===ai,clearcoat:me,clearcoatMap:me&&!!H.clearcoatMap,clearcoatRoughnessMap:me&&!!H.clearcoatRoughnessMap,clearcoatNormalMap:me&&!!H.clearcoatNormalMap,displacementMap:!!H.displacementMap,roughnessMap:!!H.roughnessMap,metalnessMap:!!H.metalnessMap,specularMap:!!H.specularMap,specularIntensityMap:!!H.specularIntensityMap,specularTintMap:!!H.specularTintMap,specularTintMapEncoding:getTextureEncodingFromMap(H.specularTintMap),alphaMap:!!H.alphaMap,alphaTest:pe,gradientMap:!!H.gradientMap,sheen:H.sheen>0,transmission:H.transmission>0,transmissionMap:!!H.transmissionMap,thicknessMap:!!H.thicknessMap,combine:H.combine,vertexTangents:!!H.normalMap&&!!re.geometry&&!!re.geometry.attributes.tangent,vertexColors:H.vertexColors,vertexAlphas:!0===H.vertexColors&&!!re.geometry&&!!re.geometry.attributes.color&&4===re.geometry.attributes.color.itemSize,vertexUvs:!!(H.map||H.bumpMap||H.normalMap||H.specularMap||H.alphaMap||H.emissiveMap||H.roughnessMap||H.metalnessMap||H.clearcoatMap||H.clearcoatRoughnessMap||H.clearcoatNormalMap||H.displacementMap||H.transmissionMap||H.thicknessMap||H.specularIntensityMap||H.specularTintMap),uvsVertexOnly:!(H.map||H.bumpMap||H.normalMap||H.specularMap||H.alphaMap||H.emissiveMap||H.roughnessMap||H.metalnessMap||H.clearcoatNormalMap||H.transmission>0||H.transmissionMap||H.thicknessMap||H.specularIntensityMap||H.specularTintMap||!H.displacementMap),fog:!!oe,useFog:H.fog,fogExp2:oe&&oe.isFogExp2,flatShading:!!H.flatShading,sizeAttenuation:H.sizeAttenuation,logarithmicDepthBuffer:K,skinning:!0===re.isSkinnedMesh&&ce>0,maxBones:ce,useVertexTexture:q,morphTargets:!!re.geometry&&!!re.geometry.morphAttributes.position,morphNormals:!!re.geometry&&!!re.geometry.morphAttributes.normal,morphTargetsCount:re.geometry&&re.geometry.morphAttributes.position?re.geometry.morphAttributes.position.length:0,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numClippingPlanes:z.numPlanes,numClipIntersection:z.numIntersection,format:H.format,dithering:H.dithering,shadowMapEnabled:x.shadowMap.enabled&&ne.length>0,shadowMapType:x.shadowMap.type,toneMapping:H.toneMapped?x.toneMapping:De,physicallyCorrectLights:x.physicallyCorrectLights,premultipliedAlpha:H.premultipliedAlpha,doubleSided:H.side===te,flipSided:H.side===ee,depthPacking:void 0!==H.depthPacking&&H.depthPacking,index0AttributeName:H.index0AttributeName,extensionDerivatives:H.extensions&&H.extensions.derivatives,extensionFragDepth:H.extensions&&H.extensions.fragDepth,extensionDrawBuffers:H.extensions&&H.extensions.drawBuffers,extensionShaderTextureLOD:H.extensions&&H.extensions.shaderTextureLOD,rendererExtensionFragDepth:X||U.has("EXT_frag_depth"),rendererExtensionDrawBuffers:X||U.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:X||U.has("EXT_shader_texture_lod"),customProgramCacheKey:H.customProgramCacheKey()}},getProgramCacheKey:function getProgramCacheKey(S){const w=[];if(S.shaderID?w.push(S.shaderID):(w.push(S.fragmentShader),w.push(S.vertexShader)),void 0!==S.defines)for(const x in S.defines)w.push(x),w.push(S.defines[x]);if(!1===S.isRawShaderMaterial){for(let x=0;x<ne.length;x++)w.push(S[ne[x]]);w.push(x.outputEncoding),w.push(x.gammaFactor)}return w.push(S.customProgramCacheKey),w.join()},getUniforms:function getUniforms(x){const S=Q[x.type];let w;if(S){const x=ko[S];w=Ro.clone(x.uniforms)}else w=x.uniforms;return w},acquireProgram:function acquireProgram(S,w){let U;for(let x=0,S=j.length;x<S;x++){const S=j[x];if(S.cacheKey===w){U=S,++U.usedTimes;break}}return void 0===U&&(U=new WebGLProgram(x,w,S,H),j.push(U)),U},releaseProgram:function releaseProgram(x){if(0==--x.usedTimes){const S=j.indexOf(x);j[S]=j[j.length-1],j.pop(),x.destroy()}},programs:j}}function WebGLProperties(){let x=new WeakMap;return{get:function get(S){let w=x.get(S);return void 0===w&&(w={},x.set(S,w)),w},remove:function remove(S){x.delete(S)},update:function update(S,w,U){x.get(S)[w]=U},dispose:function dispose(){x=new WeakMap}}}function painterSortStable(x,S){return x.groupOrder!==S.groupOrder?x.groupOrder-S.groupOrder:x.renderOrder!==S.renderOrder?x.renderOrder-S.renderOrder:x.program!==S.program?x.program.id-S.program.id:x.material.id!==S.material.id?x.material.id-S.material.id:x.z!==S.z?x.z-S.z:x.id-S.id}function reversePainterSortStable(x,S){return x.groupOrder!==S.groupOrder?x.groupOrder-S.groupOrder:x.renderOrder!==S.renderOrder?x.renderOrder-S.renderOrder:x.z!==S.z?S.z-x.z:x.id-S.id}function WebGLRenderList(x){const S=[];let w=0;const U=[],G=[],H=[],z={id:-1};function getNextRenderItem(U,G,H,j,X,K){let q=S[w];const Y=x.get(H);return void 0===q?(q={id:U.id,object:U,geometry:G,material:H,program:Y.program||z,groupOrder:j,renderOrder:U.renderOrder,z:X,group:K},S[w]=q):(q.id=U.id,q.object=U,q.geometry=G,q.material=H,q.program=Y.program||z,q.groupOrder=j,q.renderOrder=U.renderOrder,q.z=X,q.group=K),w++,q}return{opaque:U,transmissive:G,transparent:H,init:function init(){w=0,U.length=0,G.length=0,H.length=0},push:function push(x,S,w,z,j,X){const K=getNextRenderItem(x,S,w,z,j,X);w.transmission>0?G.push(K):!0===w.transparent?H.push(K):U.push(K)},unshift:function unshift(x,S,w,z,j,X){const K=getNextRenderItem(x,S,w,z,j,X);w.transmission>0?G.unshift(K):!0===w.transparent?H.unshift(K):U.unshift(K)},finish:function finish(){for(let x=w,U=S.length;x<U;x++){const w=S[x];if(null===w.id)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.program=null,w.group=null}},sort:function sort(x,S){U.length>1&&U.sort(x||painterSortStable),G.length>1&&G.sort(S||reversePainterSortStable),H.length>1&&H.sort(S||reversePainterSortStable)}}}function WebGLRenderLists(x){let S=new WeakMap;return{get:function get(w,U){let G;return!1===S.has(w)?(G=new WebGLRenderList(x),S.set(w,[G])):U>=S.get(w).length?(G=new WebGLRenderList(x),S.get(w).push(G)):G=S.get(w)[U],G},dispose:function dispose(){S=new WeakMap}}}function UniformsCache(){const x={};return{get:function(S){if(void 0!==x[S.id])return x[S.id];let w;switch(S.type){case"DirectionalLight":w={direction:new Vector3,color:new Color};break;case"SpotLight":w={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":w={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":w={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":w={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return x[S.id]=w,w}}}let pa=0;function shadowCastingLightsFirst(x,S){return(S.castShadow?1:0)-(x.castShadow?1:0)}function WebGLLights(x,S){const w=new UniformsCache,U=function ShadowUniformsCache(){const x={};return{get:function(S){if(void 0!==x[S.id])return x[S.id];let w;switch(S.type){case"DirectionalLight":case"SpotLight":w={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":w={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3}}return x[S.id]=w,w}}}(),G={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let x=0;x<9;x++)G.probe.push(new Vector3);const H=new Vector3,z=new Matrix4,j=new Matrix4;return{setup:function setup(H,z){let j=0,X=0,K=0;for(let x=0;x<9;x++)G.probe[x].set(0,0,0);let q=0,Y=0,Z=0,J=0,Q=0,ee=0,te=0,ne=0;H.sort(shadowCastingLightsFirst);const ie=!0!==z?Math.PI:1;for(let x=0,S=H.length;x<S;x++){const S=H[x],z=S.color,re=S.intensity,oe=S.distance,ae=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)j+=z.r*re*ie,X+=z.g*re*ie,K+=z.b*re*ie;else if(S.isLightProbe)for(let x=0;x<9;x++)G.probe[x].addScaledVector(S.sh.coefficients[x],re);else if(S.isDirectionalLight){const x=w.get(S);if(x.color.copy(S.color).multiplyScalar(S.intensity*ie),S.castShadow){const x=S.shadow,w=U.get(S);w.shadowBias=x.bias,w.shadowNormalBias=x.normalBias,w.shadowRadius=x.radius,w.shadowMapSize=x.mapSize,G.directionalShadow[q]=w,G.directionalShadowMap[q]=ae,G.directionalShadowMatrix[q]=S.shadow.matrix,ee++}G.directional[q]=x,q++}else if(S.isSpotLight){const x=w.get(S);if(x.position.setFromMatrixPosition(S.matrixWorld),x.color.copy(z).multiplyScalar(re*ie),x.distance=oe,x.coneCos=Math.cos(S.angle),x.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),x.decay=S.decay,S.castShadow){const x=S.shadow,w=U.get(S);w.shadowBias=x.bias,w.shadowNormalBias=x.normalBias,w.shadowRadius=x.radius,w.shadowMapSize=x.mapSize,G.spotShadow[Z]=w,G.spotShadowMap[Z]=ae,G.spotShadowMatrix[Z]=S.shadow.matrix,ne++}G.spot[Z]=x,Z++}else if(S.isRectAreaLight){const x=w.get(S);x.color.copy(z).multiplyScalar(re),x.halfWidth.set(.5*S.width,0,0),x.halfHeight.set(0,.5*S.height,0),G.rectArea[J]=x,J++}else if(S.isPointLight){const x=w.get(S);if(x.color.copy(S.color).multiplyScalar(S.intensity*ie),x.distance=S.distance,x.decay=S.decay,S.castShadow){const x=S.shadow,w=U.get(S);w.shadowBias=x.bias,w.shadowNormalBias=x.normalBias,w.shadowRadius=x.radius,w.shadowMapSize=x.mapSize,w.shadowCameraNear=x.camera.near,w.shadowCameraFar=x.camera.far,G.pointShadow[Y]=w,G.pointShadowMap[Y]=ae,G.pointShadowMatrix[Y]=S.shadow.matrix,te++}G.point[Y]=x,Y++}else if(S.isHemisphereLight){const x=w.get(S);x.skyColor.copy(S.color).multiplyScalar(re*ie),x.groundColor.copy(S.groundColor).multiplyScalar(re*ie),G.hemi[Q]=x,Q++}}J>0&&(S.isWebGL2||!0===x.has("OES_texture_float_linear")?(G.rectAreaLTC1=Do.LTC_FLOAT_1,G.rectAreaLTC2=Do.LTC_FLOAT_2):!0===x.has("OES_texture_half_float_linear")?(G.rectAreaLTC1=Do.LTC_HALF_1,G.rectAreaLTC2=Do.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),G.ambient[0]=j,G.ambient[1]=X,G.ambient[2]=K;const re=G.hash;re.directionalLength===q&&re.pointLength===Y&&re.spotLength===Z&&re.rectAreaLength===J&&re.hemiLength===Q&&re.numDirectionalShadows===ee&&re.numPointShadows===te&&re.numSpotShadows===ne||(G.directional.length=q,G.spot.length=Z,G.rectArea.length=J,G.point.length=Y,G.hemi.length=Q,G.directionalShadow.length=ee,G.directionalShadowMap.length=ee,G.pointShadow.length=te,G.pointShadowMap.length=te,G.spotShadow.length=ne,G.spotShadowMap.length=ne,G.directionalShadowMatrix.length=ee,G.pointShadowMatrix.length=te,G.spotShadowMatrix.length=ne,re.directionalLength=q,re.pointLength=Y,re.spotLength=Z,re.rectAreaLength=J,re.hemiLength=Q,re.numDirectionalShadows=ee,re.numPointShadows=te,re.numSpotShadows=ne,G.version=pa++)},setupView:function setupView(x,S){let w=0,U=0,X=0,K=0,q=0;const Y=S.matrixWorldInverse;for(let S=0,Z=x.length;S<Z;S++){const Z=x[S];if(Z.isDirectionalLight){const x=G.directional[w];x.direction.setFromMatrixPosition(Z.matrixWorld),H.setFromMatrixPosition(Z.target.matrixWorld),x.direction.sub(H),x.direction.transformDirection(Y),w++}else if(Z.isSpotLight){const x=G.spot[X];x.position.setFromMatrixPosition(Z.matrixWorld),x.position.applyMatrix4(Y),x.direction.setFromMatrixPosition(Z.matrixWorld),H.setFromMatrixPosition(Z.target.matrixWorld),x.direction.sub(H),x.direction.transformDirection(Y),X++}else if(Z.isRectAreaLight){const x=G.rectArea[K];x.position.setFromMatrixPosition(Z.matrixWorld),x.position.applyMatrix4(Y),j.identity(),z.copy(Z.matrixWorld),z.premultiply(Y),j.extractRotation(z),x.halfWidth.set(.5*Z.width,0,0),x.halfHeight.set(0,.5*Z.height,0),x.halfWidth.applyMatrix4(j),x.halfHeight.applyMatrix4(j),K++}else if(Z.isPointLight){const x=G.point[U];x.position.setFromMatrixPosition(Z.matrixWorld),x.position.applyMatrix4(Y),U++}else if(Z.isHemisphereLight){const x=G.hemi[q];x.direction.setFromMatrixPosition(Z.matrixWorld),x.direction.transformDirection(Y),x.direction.normalize(),q++}}},state:G}}function WebGLRenderState(x,S){const w=new WebGLLights(x,S),U=[],G=[];return{init:function init(){U.length=0,G.length=0},state:{lightsArray:U,shadowsArray:G,lights:w},setupLights:function setupLights(x){w.setup(U,x)},setupLightsView:function setupLightsView(x){w.setupView(U,x)},pushLight:function pushLight(x){U.push(x)},pushShadow:function pushShadow(x){G.push(x)}}}function WebGLRenderStates(x,S){let w=new WeakMap;return{get:function get(U,G=0){let H;return!1===w.has(U)?(H=new WebGLRenderState(x,S),w.set(U,[H])):G>=w.get(U).length?(H=new WebGLRenderState(x,S),w.get(U).push(H)):H=w.get(U)[G],H},dispose:function dispose(){w=new WeakMap}}}class MeshDepthMaterial extends Material{constructor(x){super(),this.type="MeshDepthMaterial",this.depthPacking=ri,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(x)}copy(x){return super.copy(x),this.depthPacking=x.depthPacking,this.map=x.map,this.alphaMap=x.alphaMap,this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this}}MeshDepthMaterial.prototype.isMeshDepthMaterial=!0;class MeshDistanceMaterial extends Material{constructor(x){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(x)}copy(x){return super.copy(x),this.referencePosition.copy(x.referencePosition),this.nearDistance=x.nearDistance,this.farDistance=x.farDistance,this.map=x.map,this.alphaMap=x.alphaMap,this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this}}MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0;function WebGLShadowMap(x,S,w){let U=new Frustum;const G=new Vector2,H=new Vector2,z=new Vector4,j=new MeshDepthMaterial({depthPacking:oi}),X=new MeshDistanceMaterial,K={},q=w.maxTextureSize,Z={0:ee,1:Q,2:te},ne=new ShaderMaterial({uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4},samples:{value:8}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),ie=ne.clone();ie.defines.HORIZONTAL_PASS=1;const oe=new BufferGeometry;oe.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ae=new Mesh(oe,ne),se=this;function VSMPass(w,U){const G=S.update(ae);ne.uniforms.shadow_pass.value=w.map.texture,ne.uniforms.resolution.value=w.mapSize,ne.uniforms.radius.value=w.radius,ne.uniforms.samples.value=w.blurSamples,x.setRenderTarget(w.mapPass),x.clear(),x.renderBufferDirect(U,null,G,ne,ae,null),ie.uniforms.shadow_pass.value=w.mapPass.texture,ie.uniforms.resolution.value=w.mapSize,ie.uniforms.radius.value=w.radius,ie.uniforms.samples.value=w.blurSamples,x.setRenderTarget(w.map),x.clear(),x.renderBufferDirect(U,null,G,ie,ae,null)}function getDepthMaterial(S,w,U,G,H,z,q){let Y=null;const Q=!0===G.isPointLight?S.customDistanceMaterial:S.customDepthMaterial;if(Y=void 0!==Q?Q:!0===G.isPointLight?X:j,x.localClippingEnabled&&!0===U.clipShadows&&0!==U.clippingPlanes.length||U.displacementMap&&0!==U.displacementScale||U.alphaMap&&U.alphaTest>0){const x=Y.uuid,S=U.uuid;let w=K[x];void 0===w&&(w={},K[x]=w);let G=w[S];void 0===G&&(G=Y.clone(),w[S]=G),Y=G}return Y.visible=U.visible,Y.wireframe=U.wireframe,Y.side=q===J?null!==U.shadowSide?U.shadowSide:U.side:null!==U.shadowSide?U.shadowSide:Z[U.side],Y.alphaMap=U.alphaMap,Y.alphaTest=U.alphaTest,Y.clipShadows=U.clipShadows,Y.clippingPlanes=U.clippingPlanes,Y.clipIntersection=U.clipIntersection,Y.displacementMap=U.displacementMap,Y.displacementScale=U.displacementScale,Y.displacementBias=U.displacementBias,Y.wireframeLinewidth=U.wireframeLinewidth,Y.linewidth=U.linewidth,!0===G.isPointLight&&!0===Y.isMeshDistanceMaterial&&(Y.referencePosition.setFromMatrixPosition(G.matrixWorld),Y.nearDistance=H,Y.farDistance=z),Y}function renderObject(w,G,H,z,j){if(!1===w.visible)return;if(w.layers.test(G.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&j===J)&&(!w.frustumCulled||U.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(H.matrixWorldInverse,w.matrixWorld);const U=S.update(w),G=w.material;if(Array.isArray(G)){const S=U.groups;for(let X=0,K=S.length;X<K;X++){const K=S[X],q=G[K.materialIndex];if(q&&q.visible){const S=getDepthMaterial(w,0,q,z,H.near,H.far,j);x.renderBufferDirect(H,null,U,S,w,K)}}}else if(G.visible){const S=getDepthMaterial(w,0,G,z,H.near,H.far,j);x.renderBufferDirect(H,null,U,S,w,null)}}const X=w.children;for(let x=0,S=X.length;x<S;x++)renderObject(X[x],G,H,z,j)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Y,this.render=function(S,w,j){if(!1===se.enabled)return;if(!1===se.autoUpdate&&!1===se.needsUpdate)return;if(0===S.length)return;const X=x.getRenderTarget(),K=x.getActiveCubeFace(),Y=x.getActiveMipmapLevel(),Z=x.state;Z.setBlending(re),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);for(let X=0,K=S.length;X<K;X++){const K=S[X],Y=K.shadow;if(void 0===Y){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(!1===Y.autoUpdate&&!1===Y.needsUpdate)continue;G.copy(Y.mapSize);const Q=Y.getFrameExtents();if(G.multiply(Q),H.copy(Y.mapSize),(G.x>q||G.y>q)&&(G.x>q&&(H.x=Math.floor(q/Q.x),G.x=H.x*Q.x,Y.mapSize.x=H.x),G.y>q&&(H.y=Math.floor(q/Q.y),G.y=H.y*Q.y,Y.mapSize.y=H.y)),null===Y.map&&!Y.isPointLightShadow&&this.type===J){const x={minFilter:rt,magFilter:rt,format:wt};Y.map=new WebGLRenderTarget(G.x,G.y,x),Y.map.texture.name=K.name+".shadowMap",Y.mapPass=new WebGLRenderTarget(G.x,G.y,x),Y.camera.updateProjectionMatrix()}if(null===Y.map){const x={minFilter:Qe,magFilter:Qe,format:wt};Y.map=new WebGLRenderTarget(G.x,G.y,x),Y.map.texture.name=K.name+".shadowMap",Y.camera.updateProjectionMatrix()}x.setRenderTarget(Y.map),x.clear();const ee=Y.getViewportCount();for(let x=0;x<ee;x++){const S=Y.getViewport(x);z.set(H.x*S.x,H.y*S.y,H.x*S.z,H.y*S.w),Z.viewport(z),Y.updateMatrices(K,x),U=Y.getFrustum(),renderObject(w,j,Y.camera,K,this.type)}Y.isPointLightShadow||this.type!==J||VSMPass(Y,j),Y.needsUpdate=!1}se.needsUpdate=!1,x.setRenderTarget(X,K,Y)}}function WebGLState(x,S,w){const U=w.isWebGL2;const G=new function ColorBuffer(){let S=!1;const w=new Vector4;let U=null;const G=new Vector4(0,0,0,0);return{setMask:function(w){U===w||S||(x.colorMask(w,w,w,w),U=w)},setLocked:function(x){S=x},setClear:function(S,U,H,z,j){!0===j&&(S*=z,U*=z,H*=z),w.set(S,U,H,z),!1===G.equals(w)&&(x.clearColor(S,U,H,z),G.copy(w))},reset:function(){S=!1,U=null,G.set(-1,0,0,0)}}},H=new function DepthBuffer(){let S=!1,w=null,U=null,G=null;return{setTest:function(x){x?enable(2929):disable(2929)},setMask:function(U){w===U||S||(x.depthMask(U),w=U)},setFunc:function(S){if(U!==S){if(S)switch(S){case Ce:x.depthFunc(512);break;case Ae:x.depthFunc(519);break;case Me:x.depthFunc(513);break;default:x.depthFunc(515);break;case Le:x.depthFunc(514);break;case Ie:x.depthFunc(518);break;case Pe:x.depthFunc(516);break;case Fe:x.depthFunc(517)}else x.depthFunc(515);U=S}},setLocked:function(x){S=x},setClear:function(S){G!==S&&(x.clearDepth(S),G=S)},reset:function(){S=!1,w=null,U=null,G=null}}},K=new function StencilBuffer(){let S=!1,w=null,U=null,G=null,H=null,z=null,j=null,X=null,K=null;return{setTest:function(x){S||(x?enable(2960):disable(2960))},setMask:function(U){w===U||S||(x.stencilMask(U),w=U)},setFunc:function(S,w,z){U===S&&G===w&&H===z||(x.stencilFunc(S,w,z),U=S,G=w,H=z)},setOp:function(S,w,U){z===S&&j===w&&X===U||(x.stencilOp(S,w,U),z=S,j=w,X=U)},setLocked:function(x){S=x},setClear:function(S){K!==S&&(x.clearStencil(S),K=S)},reset:function(){S=!1,w=null,U=null,G=null,H=null,z=null,j=null,X=null,K=null}}};let q={},Y=null,Z={},J=null,Q=!1,ne=null,ie=null,Oe=null,Ne=null,Be=null,De=null,ke=null,Ue=!1,Ge=null,Ve=null,He=null,We=null,$e=null;const ze=x.getParameter(35661);let je=!1,Xe=0;const Ke=x.getParameter(7938);-1!==Ke.indexOf("WebGL")?(Xe=parseFloat(/^WebGL (\d)/.exec(Ke)[1]),je=Xe>=1):-1!==Ke.indexOf("OpenGL ES")&&(Xe=parseFloat(/^OpenGL ES (\d)/.exec(Ke)[1]),je=Xe>=2);let qe=null,Ye={};const Ze=x.getParameter(3088),Je=x.getParameter(2978),Qe=(new Vector4).fromArray(Ze),et=(new Vector4).fromArray(Je);function createTexture(S,w,U){const G=new Uint8Array(4),H=x.createTexture();x.bindTexture(S,H),x.texParameteri(S,10241,9728),x.texParameteri(S,10240,9728);for(let S=0;S<U;S++)x.texImage2D(w+S,0,6408,1,1,0,6408,5121,G);return H}const tt={};function enable(S){!0!==q[S]&&(x.enable(S),q[S]=!0)}function disable(S){!1!==q[S]&&(x.disable(S),q[S]=!1)}tt[3553]=createTexture(3553,3553,1),tt[34067]=createTexture(34067,34069,6),G.setClear(0,0,0,1),H.setClear(1),K.setClear(0),enable(2929),H.setFunc(Re),setFlipSided(!1),setCullFace(j),enable(2884),setBlending(re);const nt={[ue]:32774,[he]:32778,[de]:32779};if(U)nt[pe]=32775,nt[me]=32776;else{const x=S.get("EXT_blend_minmax");null!==x&&(nt[pe]=x.MIN_EXT,nt[me]=x.MAX_EXT)}const it={[fe]:0,[ge]:1,[ve]:768,[ye]:770,[Te]:776,[Se]:774,[xe]:772,[_e]:769,[be]:771,[we]:775,[Ee]:773};function setBlending(S,w,U,G,H,z,j,X){if(S!==re){if(!1===Q&&(enable(3042),Q=!0),S===ce)H=H||w,z=z||U,j=j||G,w===ie&&H===Be||(x.blendEquationSeparate(nt[w],nt[H]),ie=w,Be=H),U===Oe&&G===Ne&&z===De&&j===ke||(x.blendFuncSeparate(it[U],it[G],it[z],it[j]),Oe=U,Ne=G,De=z,ke=j),ne=S,Ue=null;else if(S!==ne||X!==Ue){if(ie===ue&&Be===ue||(x.blendEquation(32774),ie=ue,Be=ue),X)switch(S){case oe:x.blendFuncSeparate(1,771,1,771);break;case ae:x.blendFunc(1,1);break;case se:x.blendFuncSeparate(0,0,769,771);break;case le:x.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",S)}else switch(S){case oe:x.blendFuncSeparate(770,771,1,771);break;case ae:x.blendFunc(770,1);break;case se:x.blendFunc(0,769);break;case le:x.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",S)}Oe=null,Ne=null,De=null,ke=null,ne=S,Ue=X}}else!0===Q&&(disable(3042),Q=!1)}function setFlipSided(S){Ge!==S&&(S?x.frontFace(2304):x.frontFace(2305),Ge=S)}function setCullFace(S){S!==z?(enable(2884),S!==Ve&&(S===j?x.cullFace(1029):S===X?x.cullFace(1028):x.cullFace(1032))):disable(2884),Ve=S}function setPolygonOffset(S,w,U){S?(enable(32823),We===w&&$e===U||(x.polygonOffset(w,U),We=w,$e=U)):disable(32823)}function activeTexture(S){void 0===S&&(S=33984+ze-1),qe!==S&&(x.activeTexture(S),qe=S)}return{buffers:{color:G,depth:H,stencil:K},enable,disable,bindFramebuffer:function bindFramebuffer(S,w){return null===w&&null!==Y&&(w=Y),Z[S]!==w&&(x.bindFramebuffer(S,w),Z[S]=w,U&&(36009===S&&(Z[36160]=w),36160===S&&(Z[36009]=w)),!0)},bindXRFramebuffer:function bindXRFramebuffer(S){S!==Y&&(x.bindFramebuffer(36160,S),Y=S)},useProgram:function useProgram(S){return J!==S&&(x.useProgram(S),J=S,!0)},setBlending,setMaterial:function setMaterial(x,S){x.side===te?disable(2884):enable(2884);let w=x.side===ee;S&&(w=!w),setFlipSided(w),x.blending===oe&&!1===x.transparent?setBlending(re):setBlending(x.blending,x.blendEquation,x.blendSrc,x.blendDst,x.blendEquationAlpha,x.blendSrcAlpha,x.blendDstAlpha,x.premultipliedAlpha),H.setFunc(x.depthFunc),H.setTest(x.depthTest),H.setMask(x.depthWrite),G.setMask(x.colorWrite);const U=x.stencilWrite;K.setTest(U),U&&(K.setMask(x.stencilWriteMask),K.setFunc(x.stencilFunc,x.stencilRef,x.stencilFuncMask),K.setOp(x.stencilFail,x.stencilZFail,x.stencilZPass)),setPolygonOffset(x.polygonOffset,x.polygonOffsetFactor,x.polygonOffsetUnits),!0===x.alphaToCoverage?enable(32926):disable(32926)},setFlipSided,setCullFace,setLineWidth:function setLineWidth(S){S!==He&&(je&&x.lineWidth(S),He=S)},setPolygonOffset,setScissorTest:function setScissorTest(x){x?enable(3089):disable(3089)},activeTexture,bindTexture:function bindTexture(S,w){null===qe&&activeTexture();let U=Ye[qe];void 0===U&&(U={type:void 0,texture:void 0},Ye[qe]=U),U.type===S&&U.texture===w||(x.bindTexture(S,w||tt[S]),U.type=S,U.texture=w)},unbindTexture:function unbindTexture(){const S=Ye[qe];void 0!==S&&void 0!==S.type&&(x.bindTexture(S.type,null),S.type=void 0,S.texture=void 0)},compressedTexImage2D:function compressedTexImage2D(){try{x.compressedTexImage2D.apply(x,arguments)}catch(x){console.error("THREE.WebGLState:",x)}},texImage2D:function texImage2D(){try{x.texImage2D.apply(x,arguments)}catch(x){console.error("THREE.WebGLState:",x)}},texImage3D:function texImage3D(){try{x.texImage3D.apply(x,arguments)}catch(x){console.error("THREE.WebGLState:",x)}},scissor:function scissor(S){!1===Qe.equals(S)&&(x.scissor(S.x,S.y,S.z,S.w),Qe.copy(S))},viewport:function viewport(S){!1===et.equals(S)&&(x.viewport(S.x,S.y,S.z,S.w),et.copy(S))},reset:function reset(){x.disable(3042),x.disable(2884),x.disable(2929),x.disable(32823),x.disable(3089),x.disable(2960),x.disable(32926),x.blendEquation(32774),x.blendFunc(1,0),x.blendFuncSeparate(1,0,1,0),x.colorMask(!0,!0,!0,!0),x.clearColor(0,0,0,0),x.depthMask(!0),x.depthFunc(513),x.clearDepth(1),x.stencilMask(4294967295),x.stencilFunc(519,0,4294967295),x.stencilOp(7680,7680,7680),x.clearStencil(0),x.cullFace(1029),x.frontFace(2305),x.polygonOffset(0,0),x.activeTexture(33984),x.bindFramebuffer(36160,null),!0===U&&(x.bindFramebuffer(36009,null),x.bindFramebuffer(36008,null)),x.useProgram(null),x.lineWidth(1),x.scissor(0,0,x.canvas.width,x.canvas.height),x.viewport(0,0,x.canvas.width,x.canvas.height),q={},qe=null,Ye={},Y=null,Z={},J=null,Q=!1,ne=null,ie=null,Oe=null,Ne=null,Be=null,De=null,ke=null,Ue=!1,Ge=null,Ve=null,He=null,We=null,$e=null,Qe.set(0,0,x.canvas.width,x.canvas.height),et.set(0,0,x.canvas.width,x.canvas.height),G.reset(),H.reset(),K.reset()}}}function WebGLTextures(x,S,w,U,G,H,z){const j=G.isWebGL2,X=G.maxTextures,K=G.maxCubemapSize,q=G.maxTextureSize,Y=G.maxSamples,Z=new WeakMap;let J,Q=!1;try{Q="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(x){}function createCanvas(x,S){return Q?new OffscreenCanvas(x,S):createElementNS("canvas")}function resizeImage(x,S,w,U){let G=1;if((x.width>U||x.height>U)&&(G=U/Math.max(x.width,x.height)),G<1||!0===S){if("undefined"!=typeof HTMLImageElement&&x instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&x instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&x instanceof ImageBitmap){const U=S?floorPowerOfTwo:Math.floor,H=U(G*x.width),z=U(G*x.height);void 0===J&&(J=createCanvas(H,z));const j=w?createCanvas(H,z):J;j.width=H,j.height=z;return j.getContext("2d").drawImage(x,0,0,H,z),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+x.width+"x"+x.height+") to ("+H+"x"+z+")."),j}return"data"in x&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+x.width+"x"+x.height+")."),x}return x}function isPowerOfTwo$1(x){return isPowerOfTwo(x.width)&&isPowerOfTwo(x.height)}function textureNeedsGenerateMipmaps(x,S){return x.generateMipmaps&&S&&x.minFilter!==Qe&&x.minFilter!==rt}function generateMipmap(S,w,G,H,z=1){x.generateMipmap(S);U.get(w).__maxMipLevel=Math.log2(Math.max(G,H,z))}function getInternalFormat(w,U,G,H){if(!1===j)return U;if(null!==w){if(void 0!==x[w])return x[w];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+w+"'")}let z=U;return 6403===U&&(5126===G&&(z=33326),5131===G&&(z=33325),5121===G&&(z=33321)),6407===U&&(5126===G&&(z=34837),5131===G&&(z=34843),5121===G&&(z=32849)),6408===U&&(5126===G&&(z=34836),5131===G&&(z=34842),5121===G&&(z=H===Kn?35907:32856)),33325!==z&&33326!==z&&34842!==z&&34836!==z||S.get("EXT_color_buffer_float"),z}function filterFallback(x){return x===Qe||x===et||x===nt?9728:9729}function onTextureDispose(S){const w=S.target;w.removeEventListener("dispose",onTextureDispose),function deallocateTexture(S){const w=U.get(S);if(void 0===w.__webglInit)return;x.deleteTexture(w.__webglTexture),U.remove(S)}(w),w.isVideoTexture&&Z.delete(w),z.memory.textures--}function onRenderTargetDispose(S){const w=S.target;w.removeEventListener("dispose",onRenderTargetDispose),function deallocateRenderTarget(S){const w=S.texture,G=U.get(S),H=U.get(w);if(!S)return;void 0!==H.__webglTexture&&(x.deleteTexture(H.__webglTexture),z.memory.textures--);S.depthTexture&&S.depthTexture.dispose();if(S.isWebGLCubeRenderTarget)for(let S=0;S<6;S++)x.deleteFramebuffer(G.__webglFramebuffer[S]),G.__webglDepthbuffer&&x.deleteRenderbuffer(G.__webglDepthbuffer[S]);else x.deleteFramebuffer(G.__webglFramebuffer),G.__webglDepthbuffer&&x.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&x.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer&&x.deleteRenderbuffer(G.__webglColorRenderbuffer),G.__webglDepthRenderbuffer&&x.deleteRenderbuffer(G.__webglDepthRenderbuffer);if(S.isWebGLMultipleRenderTargets)for(let S=0,G=w.length;S<G;S++){const G=U.get(w[S]);G.__webglTexture&&(x.deleteTexture(G.__webglTexture),z.memory.textures--),U.remove(w[S])}U.remove(w),U.remove(S)}(w)}let ee=0;function setTexture2D(x,S){const G=U.get(x);if(x.isVideoTexture&&function updateVideoTexture(x){const S=z.render.frame;Z.get(x)!==S&&(Z.set(x,S),x.update())}(x),x.version>0&&G.__version!==x.version){const w=x.image;if(void 0===w)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==w.complete)return void uploadTexture(G,x,S);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}w.activeTexture(33984+S),w.bindTexture(3553,G.__webglTexture)}function setTextureCube(S,G){const z=U.get(S);S.version>0&&z.__version!==S.version?function uploadCubeTexture(S,U,G){if(6!==U.image.length)return;initTexture(S,U),w.activeTexture(33984+G),w.bindTexture(34067,S.__webglTexture),x.pixelStorei(37440,U.flipY),x.pixelStorei(37441,U.premultiplyAlpha),x.pixelStorei(3317,U.unpackAlignment),x.pixelStorei(37443,0);const z=U&&(U.isCompressedTexture||U.image[0].isCompressedTexture),X=U.image[0]&&U.image[0].isDataTexture,q=[];for(let x=0;x<6;x++)q[x]=z||X?X?U.image[x].image:U.image[x]:resizeImage(U.image[x],!1,!0,K);const Y=q[0],Z=isPowerOfTwo$1(Y)||j,J=H.convert(U.format),Q=H.convert(U.type),ee=getInternalFormat(U.internalFormat,J,Q,U.encoding);let te;if(setTextureParameters(34067,U,Z),z){for(let x=0;x<6;x++){te=q[x].mipmaps;for(let S=0;S<te.length;S++){const G=te[S];U.format!==wt&&U.format!==St?null!==J?w.compressedTexImage2D(34069+x,S,ee,G.width,G.height,0,G.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):w.texImage2D(34069+x,S,ee,G.width,G.height,0,J,Q,G.data)}}S.__maxMipLevel=te.length-1}else{te=U.mipmaps;for(let x=0;x<6;x++)if(X){w.texImage2D(34069+x,0,ee,q[x].width,q[x].height,0,J,Q,q[x].data);for(let S=0;S<te.length;S++){const U=te[S].image[x].image;w.texImage2D(34069+x,S+1,ee,U.width,U.height,0,J,Q,U.data)}}else{w.texImage2D(34069+x,0,ee,J,Q,q[x]);for(let S=0;S<te.length;S++){const U=te[S];w.texImage2D(34069+x,S+1,ee,J,Q,U.image[x])}}S.__maxMipLevel=te.length}textureNeedsGenerateMipmaps(U,Z)&&generateMipmap(34067,U,Y.width,Y.height);S.__version=U.version,U.onUpdate&&U.onUpdate(U)}(z,S,G):(w.activeTexture(33984+G),w.bindTexture(34067,z.__webglTexture))}const te={[Ye]:10497,[Ze]:33071,[Je]:33648},ne={[Qe]:9728,[et]:9984,[nt]:9986,[rt]:9729,[ot]:9985,[st]:9987};function setTextureParameters(w,H,z){if(z?(x.texParameteri(w,10242,te[H.wrapS]),x.texParameteri(w,10243,te[H.wrapT]),32879!==w&&35866!==w||x.texParameteri(w,32882,te[H.wrapR]),x.texParameteri(w,10240,ne[H.magFilter]),x.texParameteri(w,10241,ne[H.minFilter])):(x.texParameteri(w,10242,33071),x.texParameteri(w,10243,33071),32879!==w&&35866!==w||x.texParameteri(w,32882,33071),H.wrapS===Ze&&H.wrapT===Ze||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),x.texParameteri(w,10240,filterFallback(H.magFilter)),x.texParameteri(w,10241,filterFallback(H.minFilter)),H.minFilter!==Qe&&H.minFilter!==rt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===S.has("EXT_texture_filter_anisotropic")){const z=S.get("EXT_texture_filter_anisotropic");if(H.type===gt&&!1===S.has("OES_texture_float_linear"))return;if(!1===j&&H.type===vt&&!1===S.has("OES_texture_half_float_linear"))return;(H.anisotropy>1||U.get(H).__currentAnisotropy)&&(x.texParameterf(w,z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,G.getMaxAnisotropy())),U.get(H).__currentAnisotropy=H.anisotropy)}}function initTexture(S,w){void 0===S.__webglInit&&(S.__webglInit=!0,w.addEventListener("dispose",onTextureDispose),S.__webglTexture=x.createTexture(),z.memory.textures++)}function uploadTexture(S,U,G){let z=3553;U.isDataTexture2DArray&&(z=35866),U.isDataTexture3D&&(z=32879),initTexture(S,U),w.activeTexture(33984+G),w.bindTexture(z,S.__webglTexture),x.pixelStorei(37440,U.flipY),x.pixelStorei(37441,U.premultiplyAlpha),x.pixelStorei(3317,U.unpackAlignment),x.pixelStorei(37443,0);const X=function textureNeedsPowerOfTwo(x){return!j&&(x.wrapS!==Ze||x.wrapT!==Ze||x.minFilter!==Qe&&x.minFilter!==rt)}(U)&&!1===isPowerOfTwo$1(U.image),K=resizeImage(U.image,X,!1,q),Y=isPowerOfTwo$1(K)||j,Z=H.convert(U.format);let J,Q=H.convert(U.type),ee=getInternalFormat(U.internalFormat,Z,Q,U.encoding);setTextureParameters(z,U,Y);const te=U.mipmaps;if(U.isDepthTexture)ee=6402,j?ee=U.type===gt?36012:U.type===ft?33190:U.type===xt?35056:33189:U.type===gt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),U.format===Mt&&6402===ee&&U.type!==pt&&U.type!==ft&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),U.type=pt,Q=H.convert(U.type)),U.format===Rt&&6402===ee&&(ee=34041,U.type!==xt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),U.type=xt,Q=H.convert(U.type))),w.texImage2D(3553,0,ee,K.width,K.height,0,Z,Q,null);else if(U.isDataTexture)if(te.length>0&&Y){for(let x=0,S=te.length;x<S;x++)J=te[x],w.texImage2D(3553,x,ee,J.width,J.height,0,Z,Q,J.data);U.generateMipmaps=!1,S.__maxMipLevel=te.length-1}else w.texImage2D(3553,0,ee,K.width,K.height,0,Z,Q,K.data),S.__maxMipLevel=0;else if(U.isCompressedTexture){for(let x=0,S=te.length;x<S;x++)J=te[x],U.format!==wt&&U.format!==St?null!==Z?w.compressedTexImage2D(3553,x,ee,J.width,J.height,0,J.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):w.texImage2D(3553,x,ee,J.width,J.height,0,Z,Q,J.data);S.__maxMipLevel=te.length-1}else if(U.isDataTexture2DArray)w.texImage3D(35866,0,ee,K.width,K.height,K.depth,0,Z,Q,K.data),S.__maxMipLevel=0;else if(U.isDataTexture3D)w.texImage3D(32879,0,ee,K.width,K.height,K.depth,0,Z,Q,K.data),S.__maxMipLevel=0;else if(te.length>0&&Y){for(let x=0,S=te.length;x<S;x++)J=te[x],w.texImage2D(3553,x,ee,Z,Q,J);U.generateMipmaps=!1,S.__maxMipLevel=te.length-1}else w.texImage2D(3553,0,ee,Z,Q,K),S.__maxMipLevel=0;textureNeedsGenerateMipmaps(U,Y)&&generateMipmap(z,U,K.width,K.height),S.__version=U.version,U.onUpdate&&U.onUpdate(U)}function setupFrameBufferTexture(S,G,z,j,X){const K=H.convert(z.format),q=H.convert(z.type),Y=getInternalFormat(z.internalFormat,K,q,z.encoding);32879===X||35866===X?w.texImage3D(X,0,Y,G.width,G.height,G.depth,0,K,q,null):w.texImage2D(X,0,Y,G.width,G.height,0,K,q,null),w.bindFramebuffer(36160,S),x.framebufferTexture2D(36160,j,X,U.get(z).__webglTexture,0),w.bindFramebuffer(36160,null)}function setupRenderBufferStorage(S,w,U){if(x.bindRenderbuffer(36161,S),w.depthBuffer&&!w.stencilBuffer){let G=33189;if(U){const S=w.depthTexture;S&&S.isDepthTexture&&(S.type===gt?G=36012:S.type===ft&&(G=33190));const U=getRenderTargetSamples(w);x.renderbufferStorageMultisample(36161,U,G,w.width,w.height)}else x.renderbufferStorage(36161,G,w.width,w.height);x.framebufferRenderbuffer(36160,36096,36161,S)}else if(w.depthBuffer&&w.stencilBuffer){if(U){const S=getRenderTargetSamples(w);x.renderbufferStorageMultisample(36161,S,35056,w.width,w.height)}else x.renderbufferStorage(36161,34041,w.width,w.height);x.framebufferRenderbuffer(36160,33306,36161,S)}else{const S=!0===w.isWebGLMultipleRenderTargets?w.texture[0]:w.texture,G=H.convert(S.format),z=H.convert(S.type),j=getInternalFormat(S.internalFormat,G,z,S.encoding);if(U){const S=getRenderTargetSamples(w);x.renderbufferStorageMultisample(36161,S,j,w.width,w.height)}else x.renderbufferStorage(36161,j,w.width,w.height)}x.bindRenderbuffer(36161,null)}function setupDepthRenderbuffer(S){const G=U.get(S),H=!0===S.isWebGLCubeRenderTarget;if(S.depthTexture){if(H)throw new Error("target.depthTexture not supported in Cube render targets");!function setupDepthTexture(S,G){if(G&&G.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(w.bindFramebuffer(36160,S),!G.depthTexture||!G.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");U.get(G.depthTexture).__webglTexture&&G.depthTexture.image.width===G.width&&G.depthTexture.image.height===G.height||(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),setTexture2D(G.depthTexture,0);const H=U.get(G.depthTexture).__webglTexture;if(G.depthTexture.format===Mt)x.framebufferTexture2D(36160,36096,3553,H,0);else{if(G.depthTexture.format!==Rt)throw new Error("Unknown depthTexture format");x.framebufferTexture2D(36160,33306,3553,H,0)}}(G.__webglFramebuffer,S)}else if(H){G.__webglDepthbuffer=[];for(let U=0;U<6;U++)w.bindFramebuffer(36160,G.__webglFramebuffer[U]),G.__webglDepthbuffer[U]=x.createRenderbuffer(),setupRenderBufferStorage(G.__webglDepthbuffer[U],S,!1)}else w.bindFramebuffer(36160,G.__webglFramebuffer),G.__webglDepthbuffer=x.createRenderbuffer(),setupRenderBufferStorage(G.__webglDepthbuffer,S,!1);w.bindFramebuffer(36160,null)}function getRenderTargetSamples(x){return j&&x.isWebGLMultisampleRenderTarget?Math.min(Y,x.samples):0}let ie=!1,re=!1;this.allocateTextureUnit=function allocateTextureUnit(){const x=ee;return x>=X&&console.warn("THREE.WebGLTextures: Trying to use "+x+" texture units while this GPU supports only "+X),ee+=1,x},this.resetTextureUnits=function resetTextureUnits(){ee=0},this.setTexture2D=setTexture2D,this.setTexture2DArray=function setTexture2DArray(x,S){const G=U.get(x);x.version>0&&G.__version!==x.version?uploadTexture(G,x,S):(w.activeTexture(33984+S),w.bindTexture(35866,G.__webglTexture))},this.setTexture3D=function setTexture3D(x,S){const G=U.get(x);x.version>0&&G.__version!==x.version?uploadTexture(G,x,S):(w.activeTexture(33984+S),w.bindTexture(32879,G.__webglTexture))},this.setTextureCube=setTextureCube,this.setupRenderTarget=function setupRenderTarget(S){const X=S.texture,K=U.get(S),q=U.get(X);S.addEventListener("dispose",onRenderTargetDispose),!0!==S.isWebGLMultipleRenderTargets&&(q.__webglTexture=x.createTexture(),q.__version=X.version,z.memory.textures++);const Y=!0===S.isWebGLCubeRenderTarget,Z=!0===S.isWebGLMultipleRenderTargets,J=!0===S.isWebGLMultisampleRenderTarget,Q=X.isDataTexture3D||X.isDataTexture2DArray,ee=isPowerOfTwo$1(S)||j;if(!j||X.format!==St||X.type!==gt&&X.type!==vt||(X.format=wt,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Y){K.__webglFramebuffer=[];for(let S=0;S<6;S++)K.__webglFramebuffer[S]=x.createFramebuffer()}else if(K.__webglFramebuffer=x.createFramebuffer(),Z)if(G.drawBuffers){const w=S.texture;for(let S=0,G=w.length;S<G;S++){const G=U.get(w[S]);void 0===G.__webglTexture&&(G.__webglTexture=x.createTexture(),z.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(J)if(j){K.__webglMultisampledFramebuffer=x.createFramebuffer(),K.__webglColorRenderbuffer=x.createRenderbuffer(),x.bindRenderbuffer(36161,K.__webglColorRenderbuffer);const U=H.convert(X.format),G=H.convert(X.type),z=getInternalFormat(X.internalFormat,U,G,X.encoding),j=getRenderTargetSamples(S);x.renderbufferStorageMultisample(36161,j,z,S.width,S.height),w.bindFramebuffer(36160,K.__webglMultisampledFramebuffer),x.framebufferRenderbuffer(36160,36064,36161,K.__webglColorRenderbuffer),x.bindRenderbuffer(36161,null),S.depthBuffer&&(K.__webglDepthRenderbuffer=x.createRenderbuffer(),setupRenderBufferStorage(K.__webglDepthRenderbuffer,S,!0)),w.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Y){w.bindTexture(34067,q.__webglTexture),setTextureParameters(34067,X,ee);for(let x=0;x<6;x++)setupFrameBufferTexture(K.__webglFramebuffer[x],S,X,36064,34069+x);textureNeedsGenerateMipmaps(X,ee)&&generateMipmap(34067,X,S.width,S.height),w.unbindTexture()}else if(Z){const x=S.texture;for(let G=0,H=x.length;G<H;G++){const H=x[G],z=U.get(H);w.bindTexture(3553,z.__webglTexture),setTextureParameters(3553,H,ee),setupFrameBufferTexture(K.__webglFramebuffer,S,H,36064+G,3553),textureNeedsGenerateMipmaps(H,ee)&&generateMipmap(3553,H,S.width,S.height)}w.unbindTexture()}else{let x=3553;if(Q)if(j){x=X.isDataTexture3D?32879:35866}else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");w.bindTexture(x,q.__webglTexture),setTextureParameters(x,X,ee),setupFrameBufferTexture(K.__webglFramebuffer,S,X,36064,x),textureNeedsGenerateMipmaps(X,ee)&&generateMipmap(x,X,S.width,S.height,S.depth),w.unbindTexture()}S.depthBuffer&&setupDepthRenderbuffer(S)},this.updateRenderTargetMipmap=function updateRenderTargetMipmap(x){const S=isPowerOfTwo$1(x)||j,G=!0===x.isWebGLMultipleRenderTargets?x.texture:[x.texture];for(let H=0,z=G.length;H<z;H++){const z=G[H];if(textureNeedsGenerateMipmaps(z,S)){const S=x.isWebGLCubeRenderTarget?34067:3553,G=U.get(z).__webglTexture;w.bindTexture(S,G),generateMipmap(S,z,x.width,x.height),w.unbindTexture()}}},this.updateMultisampleRenderTarget=function updateMultisampleRenderTarget(S){if(S.isWebGLMultisampleRenderTarget)if(j){const G=S.width,H=S.height;let z=16384;S.depthBuffer&&(z|=256),S.stencilBuffer&&(z|=1024);const j=U.get(S);w.bindFramebuffer(36008,j.__webglMultisampledFramebuffer),w.bindFramebuffer(36009,j.__webglFramebuffer),x.blitFramebuffer(0,0,G,H,0,0,G,H,z,9728),w.bindFramebuffer(36008,null),w.bindFramebuffer(36009,j.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function safeSetTexture2D(x,S){x&&x.isWebGLRenderTarget&&(!1===ie&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ie=!0),x=x.texture),setTexture2D(x,S)},this.safeSetTextureCube=function safeSetTextureCube(x,S){x&&x.isWebGLCubeRenderTarget&&(!1===re&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),re=!0),x=x.texture),setTextureCube(x,S)}}function WebGLUtils(x,S,w){const U=w.isWebGL2;return{convert:function convert(x){let w;if(x===ct)return 5121;if(x===_t)return 32819;if(x===yt)return 32820;if(x===bt)return 33635;if(x===ut)return 5120;if(x===ht)return 5122;if(x===pt)return 5123;if(x===mt)return 5124;if(x===ft)return 5125;if(x===gt)return 5126;if(x===vt)return U?5131:(w=S.get("OES_texture_half_float"),null!==w?w.HALF_FLOAT_OES:null);if(x===Et)return 6406;if(x===St)return 6407;if(x===wt)return 6408;if(x===Tt)return 6409;if(x===Ct)return 6410;if(x===Mt)return 6402;if(x===Rt)return 34041;if(x===Lt)return 6403;if(x===It)return 36244;if(x===Pt)return 33319;if(x===Ft)return 33320;if(x===Nt)return 36248;if(x===Bt)return 36249;if(x===Dt||x===kt||x===Ut||x===Gt){if(w=S.get("WEBGL_compressed_texture_s3tc"),null===w)return null;if(x===Dt)return w.COMPRESSED_RGB_S3TC_DXT1_EXT;if(x===kt)return w.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(x===Ut)return w.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(x===Gt)return w.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(x===Vt||x===Ht||x===Wt||x===$t){if(w=S.get("WEBGL_compressed_texture_pvrtc"),null===w)return null;if(x===Vt)return w.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(x===Ht)return w.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(x===Wt)return w.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(x===$t)return w.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(x===zt)return w=S.get("WEBGL_compressed_texture_etc1"),null!==w?w.COMPRESSED_RGB_ETC1_WEBGL:null;if((x===jt||x===Xt)&&(w=S.get("WEBGL_compressed_texture_etc"),null!==w)){if(x===jt)return w.COMPRESSED_RGB8_ETC2;if(x===Xt)return w.COMPRESSED_RGBA8_ETC2_EAC}return x===Kt||x===qt||x===Yt||x===Zt||x===Jt||x===Qt||x===en||x===tn||x===nn||x===rn||x===on||x===an||x===sn||x===ln||x===hn||x===dn||x===pn||x===mn||x===gn||x===vn||x===bn||x===xn||x===En||x===Sn||x===wn||x===Tn||x===Cn||x===An?(w=S.get("WEBGL_compressed_texture_astc"),null!==w?x:null):x===cn?(w=S.get("EXT_texture_compression_bptc"),null!==w?x:null):x===xt?U?34042:(w=S.get("WEBGL_depth_texture"),null!==w?w.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class ArrayCamera extends PerspectiveCamera{constructor(x=[]){super(),this.cameras=x}}ArrayCamera.prototype.isArrayCamera=!0;class Group extends Object3D{constructor(){super(),this.type="Group"}}Group.prototype.isGroup=!0;const ma={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(x){return null!==this._targetRay&&this._targetRay.dispatchEvent(x),null!==this._grip&&this._grip.dispatchEvent(x),null!==this._hand&&this._hand.dispatchEvent(x),this}disconnect(x){return this.dispatchEvent({type:"disconnected",data:x}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(x,S,w){let U=null,G=null,H=null;const z=this._targetRay,j=this._grip,X=this._hand;if(x&&"visible-blurred"!==S.session.visibilityState)if(null!==z&&(U=S.getPose(x.targetRaySpace,w),null!==U&&(z.matrix.fromArray(U.transform.matrix),z.matrix.decompose(z.position,z.rotation,z.scale),U.linearVelocity?(z.hasLinearVelocity=!0,z.linearVelocity.copy(U.linearVelocity)):z.hasLinearVelocity=!1,U.angularVelocity?(z.hasAngularVelocity=!0,z.angularVelocity.copy(U.angularVelocity)):z.hasAngularVelocity=!1,this.dispatchEvent(ma))),X&&x.hand){H=!0;for(const U of x.hand.values()){const x=S.getJointPose(U,w);if(void 0===X.joints[U.jointName]){const x=new Group;x.matrixAutoUpdate=!1,x.visible=!1,X.joints[U.jointName]=x,X.add(x)}const G=X.joints[U.jointName];null!==x&&(G.matrix.fromArray(x.transform.matrix),G.matrix.decompose(G.position,G.rotation,G.scale),G.jointRadius=x.radius),G.visible=null!==x}const U=X.joints["index-finger-tip"],G=X.joints["thumb-tip"],z=U.position.distanceTo(G.position),j=.02,K=.005;X.inputState.pinching&&z>j+K?(X.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:x.handedness,target:this})):!X.inputState.pinching&&z<=j-K&&(X.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:x.handedness,target:this}))}else null!==j&&x.gripSpace&&(G=S.getPose(x.gripSpace,w),null!==G&&(j.matrix.fromArray(G.transform.matrix),j.matrix.decompose(j.position,j.rotation,j.scale),G.linearVelocity?(j.hasLinearVelocity=!0,j.linearVelocity.copy(G.linearVelocity)):j.hasLinearVelocity=!1,G.angularVelocity?(j.hasAngularVelocity=!0,j.angularVelocity.copy(G.angularVelocity)):j.hasAngularVelocity=!1));return null!==z&&(z.visible=null!==U),null!==j&&(j.visible=null!==G),null!==X&&(X.visible=null!==H),this}}class WebXRManager extends EventDispatcher{constructor(x,S){super();const w=this,U=x.state;let G=null,H=1,z=null,j="local-floor",X=null,K=null,q=null,Y=null,Z=null,J=!1,Q=null,ee=null,te=null,ne=null,ie=null,re=null;const oe=[],ae=new Map,se=new PerspectiveCamera;se.layers.enable(1),se.viewport=new Vector4;const le=new PerspectiveCamera;le.layers.enable(2),le.viewport=new Vector4;const ce=[se,le],ue=new ArrayCamera;ue.layers.enable(1),ue.layers.enable(2);let he=null,de=null;function onSessionEvent(x){const S=ae.get(x.inputSource);S&&S.dispatchEvent({type:x.type,data:x.inputSource})}function onSessionEnd(){ae.forEach((function(x,S){x.disconnect(S)})),ae.clear(),he=null,de=null,U.bindXRFramebuffer(null),x.setRenderTarget(x.getRenderTarget()),q&&S.deleteFramebuffer(q),Q&&S.deleteFramebuffer(Q),ee&&S.deleteRenderbuffer(ee),te&&S.deleteRenderbuffer(te),q=null,Q=null,ee=null,te=null,Z=null,Y=null,K=null,G=null,ge.stop(),w.isPresenting=!1,w.dispatchEvent({type:"sessionend"})}function onInputSourcesChange(x){const S=G.inputSources;for(let x=0;x<oe.length;x++)ae.set(S[x],oe[x]);for(let S=0;S<x.removed.length;S++){const w=x.removed[S],U=ae.get(w);U&&(U.dispatchEvent({type:"disconnected",data:w}),ae.delete(w))}for(let S=0;S<x.added.length;S++){const w=x.added[S],U=ae.get(w);U&&U.dispatchEvent({type:"connected",data:w})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(x){let S=oe[x];return void 0===S&&(S=new WebXRController,oe[x]=S),S.getTargetRaySpace()},this.getControllerGrip=function(x){let S=oe[x];return void 0===S&&(S=new WebXRController,oe[x]=S),S.getGripSpace()},this.getHand=function(x){let S=oe[x];return void 0===S&&(S=new WebXRController,oe[x]=S),S.getHandSpace()},this.setFramebufferScaleFactor=function(x){H=x,!0===w.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(x){j=x,!0===w.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return z},this.getBaseLayer=function(){return null!==Y?Y:Z},this.getBinding=function(){return K},this.getFrame=function(){return ne},this.getSession=function(){return G},this.setSession=async function(x){if(G=x,null!==G){G.addEventListener("select",onSessionEvent),G.addEventListener("selectstart",onSessionEvent),G.addEventListener("selectend",onSessionEvent),G.addEventListener("squeeze",onSessionEvent),G.addEventListener("squeezestart",onSessionEvent),G.addEventListener("squeezeend",onSessionEvent),G.addEventListener("end",onSessionEnd),G.addEventListener("inputsourceschange",onInputSourcesChange);const x=S.getContextAttributes();if(!0!==x.xrCompatible&&await S.makeXRCompatible(),void 0===G.renderState.layers){const w={antialias:x.antialias,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:H};Z=new XRWebGLLayer(G,S,w),G.updateRenderState({baseLayer:Z})}else if(S instanceof WebGLRenderingContext){const w={antialias:!0,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:H};Z=new XRWebGLLayer(G,S,w),G.updateRenderState({layers:[Z]})}else{J=x.antialias;let w=null;x.depth&&(re=256,x.stencil&&(re|=1024),ie=x.stencil?33306:36096,w=x.stencil?35056:33190);const z={colorFormat:x.alpha?32856:32849,depthFormat:w,scaleFactor:H};K=new XRWebGLBinding(G,S),Y=K.createProjectionLayer(z),q=S.createFramebuffer(),G.updateRenderState({layers:[Y]}),J&&(Q=S.createFramebuffer(),ee=S.createRenderbuffer(),S.bindRenderbuffer(36161,ee),S.renderbufferStorageMultisample(36161,4,32856,Y.textureWidth,Y.textureHeight),U.bindFramebuffer(36160,Q),S.framebufferRenderbuffer(36160,36064,36161,ee),S.bindRenderbuffer(36161,null),null!==w&&(te=S.createRenderbuffer(),S.bindRenderbuffer(36161,te),S.renderbufferStorageMultisample(36161,4,w,Y.textureWidth,Y.textureHeight),S.framebufferRenderbuffer(36160,ie,36161,te),S.bindRenderbuffer(36161,null)),U.bindFramebuffer(36160,null))}z=await G.requestReferenceSpace(j),ge.setContext(G),ge.start(),w.isPresenting=!0,w.dispatchEvent({type:"sessionstart"})}};const pe=new Vector3,me=new Vector3;function updateCamera(x,S){null===S?x.matrixWorld.copy(x.matrix):x.matrixWorld.multiplyMatrices(S.matrixWorld,x.matrix),x.matrixWorldInverse.copy(x.matrixWorld).invert()}this.updateCamera=function(x){if(null===G)return;ue.near=le.near=se.near=x.near,ue.far=le.far=se.far=x.far,he===ue.near&&de===ue.far||(G.updateRenderState({depthNear:ue.near,depthFar:ue.far}),he=ue.near,de=ue.far);const S=x.parent,w=ue.cameras;updateCamera(ue,S);for(let x=0;x<w.length;x++)updateCamera(w[x],S);ue.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),x.position.copy(ue.position),x.quaternion.copy(ue.quaternion),x.scale.copy(ue.scale),x.matrix.copy(ue.matrix),x.matrixWorld.copy(ue.matrixWorld);const U=x.children;for(let x=0,S=U.length;x<S;x++)U[x].updateMatrixWorld(!0);2===w.length?function setProjectionFromUnion(x,S,w){pe.setFromMatrixPosition(S.matrixWorld),me.setFromMatrixPosition(w.matrixWorld);const U=pe.distanceTo(me),G=S.projectionMatrix.elements,H=w.projectionMatrix.elements,z=G[14]/(G[10]-1),j=G[14]/(G[10]+1),X=(G[9]+1)/G[5],K=(G[9]-1)/G[5],q=(G[8]-1)/G[0],Y=(H[8]+1)/H[0],Z=z*q,J=z*Y,Q=U/(-q+Y),ee=Q*-q;S.matrixWorld.decompose(x.position,x.quaternion,x.scale),x.translateX(ee),x.translateZ(Q),x.matrixWorld.compose(x.position,x.quaternion,x.scale),x.matrixWorldInverse.copy(x.matrixWorld).invert();const te=z+Q,ne=j+Q,ie=Z-ee,re=J+(U-ee),oe=X*j/ne*te,ae=K*j/ne*te;x.projectionMatrix.makePerspective(ie,re,oe,ae,te,ne)}(ue,se,le):ue.projectionMatrix.copy(se.projectionMatrix)},this.getCamera=function(){return ue},this.getFoveation=function(){return null!==Y?Y.fixedFoveation:null!==Z?Z.fixedFoveation:void 0},this.setFoveation=function(x){null!==Y&&(Y.fixedFoveation=x),null!==Z&&void 0!==Z.fixedFoveation&&(Z.fixedFoveation=x)};let fe=null;const ge=new WebGLAnimation;ge.setAnimationLoop((function onAnimationFrame(x,w){if(X=w.getViewerPose(z),ne=w,null!==X){const x=X.views;null!==Z&&U.bindXRFramebuffer(Z.framebuffer);let w=!1;x.length!==ue.cameras.length&&(ue.cameras.length=0,w=!0);for(let G=0;G<x.length;G++){const H=x[G];let z=null;if(null!==Z)z=Z.getViewport(H);else{const x=K.getViewSubImage(Y,H);U.bindXRFramebuffer(q),void 0!==x.depthStencilTexture&&S.framebufferTexture2D(36160,ie,3553,x.depthStencilTexture,0),S.framebufferTexture2D(36160,36064,3553,x.colorTexture,0),z=x.viewport}const j=ce[G];j.matrix.fromArray(H.transform.matrix),j.projectionMatrix.fromArray(H.projectionMatrix),j.viewport.set(z.x,z.y,z.width,z.height),0===G&&ue.matrix.copy(j.matrix),!0===w&&ue.cameras.push(j)}J&&(U.bindXRFramebuffer(Q),null!==re&&S.clear(re))}const H=G.inputSources;for(let x=0;x<oe.length;x++){const S=oe[x],U=H[x];S.update(U,w,z)}if(fe&&fe(x,w),J){const x=Y.textureWidth,w=Y.textureHeight;U.bindFramebuffer(36008,Q),U.bindFramebuffer(36009,q),S.invalidateFramebuffer(36008,[ie]),S.invalidateFramebuffer(36009,[ie]),S.blitFramebuffer(0,0,x,w,0,0,x,w,16384,9728),S.invalidateFramebuffer(36008,[36064]),U.bindFramebuffer(36008,null),U.bindFramebuffer(36009,null),U.bindFramebuffer(36160,Q)}ne=null})),this.setAnimationLoop=function(x){fe=x},this.dispose=function(){}}}function WebGLMaterials(x){function refreshUniformsCommon(S,w){S.opacity.value=w.opacity,w.color&&S.diffuse.value.copy(w.color),w.emissive&&S.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(S.map.value=w.map),w.alphaMap&&(S.alphaMap.value=w.alphaMap),w.specularMap&&(S.specularMap.value=w.specularMap),w.alphaTest>0&&(S.alphaTest.value=w.alphaTest);const U=x.get(w).envMap;if(U){S.envMap.value=U,S.flipEnvMap.value=U.isCubeTexture&&!1===U.isRenderTargetTexture?-1:1,S.reflectivity.value=w.reflectivity,S.ior.value=w.ior,S.refractionRatio.value=w.refractionRatio;const G=x.get(U).__maxMipLevel;void 0!==G&&(S.maxMipLevel.value=G)}let G,H;w.lightMap&&(S.lightMap.value=w.lightMap,S.lightMapIntensity.value=w.lightMapIntensity),w.aoMap&&(S.aoMap.value=w.aoMap,S.aoMapIntensity.value=w.aoMapIntensity),w.map?G=w.map:w.specularMap?G=w.specularMap:w.displacementMap?G=w.displacementMap:w.normalMap?G=w.normalMap:w.bumpMap?G=w.bumpMap:w.roughnessMap?G=w.roughnessMap:w.metalnessMap?G=w.metalnessMap:w.alphaMap?G=w.alphaMap:w.emissiveMap?G=w.emissiveMap:w.clearcoatMap?G=w.clearcoatMap:w.clearcoatNormalMap?G=w.clearcoatNormalMap:w.clearcoatRoughnessMap?G=w.clearcoatRoughnessMap:w.specularIntensityMap?G=w.specularIntensityMap:w.specularTintMap?G=w.specularTintMap:w.transmissionMap?G=w.transmissionMap:w.thicknessMap&&(G=w.thicknessMap),void 0!==G&&(G.isWebGLRenderTarget&&(G=G.texture),!0===G.matrixAutoUpdate&&G.updateMatrix(),S.uvTransform.value.copy(G.matrix)),w.aoMap?H=w.aoMap:w.lightMap&&(H=w.lightMap),void 0!==H&&(H.isWebGLRenderTarget&&(H=H.texture),!0===H.matrixAutoUpdate&&H.updateMatrix(),S.uv2Transform.value.copy(H.matrix))}function refreshUniformsStandard(S,w){S.roughness.value=w.roughness,S.metalness.value=w.metalness,w.roughnessMap&&(S.roughnessMap.value=w.roughnessMap),w.metalnessMap&&(S.metalnessMap.value=w.metalnessMap),w.emissiveMap&&(S.emissiveMap.value=w.emissiveMap),w.bumpMap&&(S.bumpMap.value=w.bumpMap,S.bumpScale.value=w.bumpScale,w.side===ee&&(S.bumpScale.value*=-1)),w.normalMap&&(S.normalMap.value=w.normalMap,S.normalScale.value.copy(w.normalScale),w.side===ee&&S.normalScale.value.negate()),w.displacementMap&&(S.displacementMap.value=w.displacementMap,S.displacementScale.value=w.displacementScale,S.displacementBias.value=w.displacementBias);x.get(w).envMap&&(S.envMapIntensity.value=w.envMapIntensity)}return{refreshFogUniforms:function refreshFogUniforms(x,S){x.fogColor.value.copy(S.color),S.isFog?(x.fogNear.value=S.near,x.fogFar.value=S.far):S.isFogExp2&&(x.fogDensity.value=S.density)},refreshMaterialUniforms:function refreshMaterialUniforms(x,S,w,U,G){S.isMeshBasicMaterial?refreshUniformsCommon(x,S):S.isMeshLambertMaterial?(refreshUniformsCommon(x,S),function refreshUniformsLambert(x,S){S.emissiveMap&&(x.emissiveMap.value=S.emissiveMap)}(x,S)):S.isMeshToonMaterial?(refreshUniformsCommon(x,S),function refreshUniformsToon(x,S){S.gradientMap&&(x.gradientMap.value=S.gradientMap);S.emissiveMap&&(x.emissiveMap.value=S.emissiveMap);S.bumpMap&&(x.bumpMap.value=S.bumpMap,x.bumpScale.value=S.bumpScale,S.side===ee&&(x.bumpScale.value*=-1));S.normalMap&&(x.normalMap.value=S.normalMap,x.normalScale.value.copy(S.normalScale),S.side===ee&&x.normalScale.value.negate());S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias)}(x,S)):S.isMeshPhongMaterial?(refreshUniformsCommon(x,S),function refreshUniformsPhong(x,S){x.specular.value.copy(S.specular),x.shininess.value=Math.max(S.shininess,1e-4),S.emissiveMap&&(x.emissiveMap.value=S.emissiveMap);S.bumpMap&&(x.bumpMap.value=S.bumpMap,x.bumpScale.value=S.bumpScale,S.side===ee&&(x.bumpScale.value*=-1));S.normalMap&&(x.normalMap.value=S.normalMap,x.normalScale.value.copy(S.normalScale),S.side===ee&&x.normalScale.value.negate());S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias)}(x,S)):S.isMeshStandardMaterial?(refreshUniformsCommon(x,S),S.isMeshPhysicalMaterial?function refreshUniformsPhysical(x,S,w){refreshUniformsStandard(x,S),x.ior.value=S.ior,S.sheen>0&&(x.sheenTint.value.copy(S.sheenTint).multiplyScalar(S.sheen),x.sheenRoughness.value=S.sheenRoughness);S.clearcoat>0&&(x.clearcoat.value=S.clearcoat,x.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(x.clearcoatMap.value=S.clearcoatMap),S.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap),S.clearcoatNormalMap&&(x.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),x.clearcoatNormalMap.value=S.clearcoatNormalMap,S.side===ee&&x.clearcoatNormalScale.value.negate()));S.transmission>0&&(x.transmission.value=S.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),S.transmissionMap&&(x.transmissionMap.value=S.transmissionMap),x.thickness.value=S.thickness,S.thicknessMap&&(x.thicknessMap.value=S.thicknessMap),x.attenuationDistance.value=S.attenuationDistance,x.attenuationTint.value.copy(S.attenuationTint));x.specularIntensity.value=S.specularIntensity,x.specularTint.value.copy(S.specularTint),S.specularIntensityMap&&(x.specularIntensityMap.value=S.specularIntensityMap);S.specularTintMap&&(x.specularTintMap.value=S.specularTintMap)}(x,S,G):refreshUniformsStandard(x,S)):S.isMeshMatcapMaterial?(refreshUniformsCommon(x,S),function refreshUniformsMatcap(x,S){S.matcap&&(x.matcap.value=S.matcap);S.bumpMap&&(x.bumpMap.value=S.bumpMap,x.bumpScale.value=S.bumpScale,S.side===ee&&(x.bumpScale.value*=-1));S.normalMap&&(x.normalMap.value=S.normalMap,x.normalScale.value.copy(S.normalScale),S.side===ee&&x.normalScale.value.negate());S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias)}(x,S)):S.isMeshDepthMaterial?(refreshUniformsCommon(x,S),function refreshUniformsDepth(x,S){S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias)}(x,S)):S.isMeshDistanceMaterial?(refreshUniformsCommon(x,S),function refreshUniformsDistance(x,S){S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias);x.referencePosition.value.copy(S.referencePosition),x.nearDistance.value=S.nearDistance,x.farDistance.value=S.farDistance}(x,S)):S.isMeshNormalMaterial?(refreshUniformsCommon(x,S),function refreshUniformsNormal(x,S){S.bumpMap&&(x.bumpMap.value=S.bumpMap,x.bumpScale.value=S.bumpScale,S.side===ee&&(x.bumpScale.value*=-1));S.normalMap&&(x.normalMap.value=S.normalMap,x.normalScale.value.copy(S.normalScale),S.side===ee&&x.normalScale.value.negate());S.displacementMap&&(x.displacementMap.value=S.displacementMap,x.displacementScale.value=S.displacementScale,x.displacementBias.value=S.displacementBias)}(x,S)):S.isLineBasicMaterial?(!function refreshUniformsLine(x,S){x.diffuse.value.copy(S.color),x.opacity.value=S.opacity}(x,S),S.isLineDashedMaterial&&function refreshUniformsDash(x,S){x.dashSize.value=S.dashSize,x.totalSize.value=S.dashSize+S.gapSize,x.scale.value=S.scale}(x,S)):S.isPointsMaterial?function refreshUniformsPoints(x,S,w,U){x.diffuse.value.copy(S.color),x.opacity.value=S.opacity,x.size.value=S.size*w,x.scale.value=.5*U,S.map&&(x.map.value=S.map);S.alphaMap&&(x.alphaMap.value=S.alphaMap);S.alphaTest>0&&(x.alphaTest.value=S.alphaTest);let G;S.map?G=S.map:S.alphaMap&&(G=S.alphaMap);void 0!==G&&(!0===G.matrixAutoUpdate&&G.updateMatrix(),x.uvTransform.value.copy(G.matrix))}(x,S,w,U):S.isSpriteMaterial?function refreshUniformsSprites(x,S){x.diffuse.value.copy(S.color),x.opacity.value=S.opacity,x.rotation.value=S.rotation,S.map&&(x.map.value=S.map);S.alphaMap&&(x.alphaMap.value=S.alphaMap);S.alphaTest>0&&(x.alphaTest.value=S.alphaTest);let w;S.map?w=S.map:S.alphaMap&&(w=S.alphaMap);void 0!==w&&(!0===w.matrixAutoUpdate&&w.updateMatrix(),x.uvTransform.value.copy(w.matrix))}(x,S):S.isShadowMaterial?(x.color.value.copy(S.color),x.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}}}function WebGLRenderer(x={}){const S=void 0!==x.canvas?x.canvas:function createCanvasElement(){const x=createElementNS("canvas");return x.style.display="block",x}(),w=void 0!==x.context?x.context:null,U=void 0!==x.alpha&&x.alpha,G=void 0===x.depth||x.depth,H=void 0===x.stencil||x.stencil,z=void 0!==x.antialias&&x.antialias,j=void 0===x.premultipliedAlpha||x.premultipliedAlpha,X=void 0!==x.preserveDrawingBuffer&&x.preserveDrawingBuffer,K=void 0!==x.powerPreference?x.powerPreference:"default",q=void 0!==x.failIfMajorPerformanceCaveat&&x.failIfMajorPerformanceCaveat;let Y=null,Z=null;const J=[],ne=[];this.domElement=S,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Xn,this.physicallyCorrectLights=!1,this.toneMapping=De,this.toneMappingExposure=1;const ie=this;let re=!1,oe=0,ae=0,se=null,le=-1,ce=null;const ue=new Vector4,he=new Vector4;let de=null,pe=S.width,me=S.height,fe=1,ge=null,ve=null;const _e=new Vector4(0,0,pe,me),ye=new Vector4(0,0,pe,me);let be=!1;const xe=[],Ee=new Frustum;let Se=!1,we=!1,Te=null;const Ce=new Matrix4,Ae=new Vector3,Me={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function getTargetPixelRatio(){return null===se?fe:1}let Re,Le,Ie,Pe,Fe,Oe,Ne,Be,ke,Ue,Ge,Ve,He,We,$e,ze,je,Xe,Ke,qe,Ye,Je,et,tt=w;function getContext(x,w){for(let U=0;U<x.length;U++){const G=x[U],H=S.getContext(G,w);if(null!==H)return H}return null}try{const x={alpha:U,depth:G,stencil:H,antialias:z,premultipliedAlpha:j,preserveDrawingBuffer:X,powerPreference:K,failIfMajorPerformanceCaveat:q};if(S.addEventListener("webglcontextlost",onContextLost,!1),S.addEventListener("webglcontextrestored",onContextRestore,!1),null===tt){const S=["webgl2","webgl","experimental-webgl"];if(!0===ie.isWebGL1Renderer&&S.shift(),tt=getContext(S,x),null===tt)throw getContext(S)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===tt.getShaderPrecisionFormat&&(tt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(x){throw console.error("THREE.WebGLRenderer: "+x.message),x}function initGLContext(){Re=new WebGLExtensions(tt),Le=new WebGLCapabilities(tt,Re,x),Re.init(Le),Je=new WebGLUtils(tt,Re,Le),Ie=new WebGLState(tt,Re,Le),xe[0]=1029,Pe=new WebGLInfo(tt),Fe=new WebGLProperties,Oe=new WebGLTextures(tt,Re,Ie,Fe,Le,Je,Pe),Ne=new WebGLCubeMaps(ie),Be=new WebGLCubeUVMaps(ie),ke=new WebGLAttributes(tt,Le),et=new WebGLBindingStates(tt,Re,ke,Le),Ue=new WebGLGeometries(tt,ke,Pe,et),Ge=new WebGLObjects(tt,Ue,ke,Pe),Ke=new WebGLMorphtargets(tt,Le,Oe),ze=new WebGLClipping(Fe),Ve=new WebGLPrograms(ie,Ne,Be,Re,Le,et,ze),He=new WebGLMaterials(Fe),We=new WebGLRenderLists(Fe),$e=new WebGLRenderStates(Re,Le),Xe=new WebGLBackground(ie,Ne,Ie,Ge,j),je=new WebGLShadowMap(ie,Ge,Le),qe=new WebGLBufferRenderer(tt,Re,Pe,Le),Ye=new WebGLIndexedBufferRenderer(tt,Re,Pe,Le),Pe.programs=Ve.programs,ie.capabilities=Le,ie.extensions=Re,ie.properties=Fe,ie.renderLists=We,ie.shadowMap=je,ie.state=Ie,ie.info=Pe}initGLContext();const nt=new WebXRManager(ie,tt);function onContextLost(x){x.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),re=!0}function onContextRestore(){console.log("THREE.WebGLRenderer: Context Restored."),re=!1;const x=Pe.autoReset,S=je.enabled,w=je.autoUpdate,U=je.needsUpdate,G=je.type;initGLContext(),Pe.autoReset=x,je.enabled=S,je.autoUpdate=w,je.needsUpdate=U,je.type=G}function onMaterialDispose(x){const S=x.target;S.removeEventListener("dispose",onMaterialDispose),function deallocateMaterial(x){(function releaseMaterialProgramReferences(x){const S=Fe.get(x).programs;void 0!==S&&S.forEach((function(x){Ve.releaseProgram(x)}))})(x),Fe.remove(x)}(S)}this.xr=nt,this.getContext=function(){return tt},this.getContextAttributes=function(){return tt.getContextAttributes()},this.forceContextLoss=function(){const x=Re.get("WEBGL_lose_context");x&&x.loseContext()},this.forceContextRestore=function(){const x=Re.get("WEBGL_lose_context");x&&x.restoreContext()},this.getPixelRatio=function(){return fe},this.setPixelRatio=function(x){void 0!==x&&(fe=x,this.setSize(pe,me,!1))},this.getSize=function(x){return x.set(pe,me)},this.setSize=function(x,w,U){nt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(pe=x,me=w,S.width=Math.floor(x*fe),S.height=Math.floor(w*fe),!1!==U&&(S.style.width=x+"px",S.style.height=w+"px"),this.setViewport(0,0,x,w))},this.getDrawingBufferSize=function(x){return x.set(pe*fe,me*fe).floor()},this.setDrawingBufferSize=function(x,w,U){pe=x,me=w,fe=U,S.width=Math.floor(x*U),S.height=Math.floor(w*U),this.setViewport(0,0,x,w)},this.getCurrentViewport=function(x){return x.copy(ue)},this.getViewport=function(x){return x.copy(_e)},this.setViewport=function(x,S,w,U){x.isVector4?_e.set(x.x,x.y,x.z,x.w):_e.set(x,S,w,U),Ie.viewport(ue.copy(_e).multiplyScalar(fe).floor())},this.getScissor=function(x){return x.copy(ye)},this.setScissor=function(x,S,w,U){x.isVector4?ye.set(x.x,x.y,x.z,x.w):ye.set(x,S,w,U),Ie.scissor(he.copy(ye).multiplyScalar(fe).floor())},this.getScissorTest=function(){return be},this.setScissorTest=function(x){Ie.setScissorTest(be=x)},this.setOpaqueSort=function(x){ge=x},this.setTransparentSort=function(x){ve=x},this.getClearColor=function(x){return x.copy(Xe.getClearColor())},this.setClearColor=function(){Xe.setClearColor.apply(Xe,arguments)},this.getClearAlpha=function(){return Xe.getClearAlpha()},this.setClearAlpha=function(){Xe.setClearAlpha.apply(Xe,arguments)},this.clear=function(x,S,w){let U=0;(void 0===x||x)&&(U|=16384),(void 0===S||S)&&(U|=256),(void 0===w||w)&&(U|=1024),tt.clear(U)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){S.removeEventListener("webglcontextlost",onContextLost,!1),S.removeEventListener("webglcontextrestored",onContextRestore,!1),We.dispose(),$e.dispose(),Fe.dispose(),Ne.dispose(),Be.dispose(),Ge.dispose(),et.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",onXRSessionStart),nt.removeEventListener("sessionend",onXRSessionEnd),Te&&(Te.dispose(),Te=null),rt.stop()},this.renderBufferImmediate=function(x,S){et.initAttributes();const w=Fe.get(x);x.hasPositions&&!w.position&&(w.position=tt.createBuffer()),x.hasNormals&&!w.normal&&(w.normal=tt.createBuffer()),x.hasUvs&&!w.uv&&(w.uv=tt.createBuffer()),x.hasColors&&!w.color&&(w.color=tt.createBuffer());const U=S.getAttributes();x.hasPositions&&(tt.bindBuffer(34962,w.position),tt.bufferData(34962,x.positionArray,35048),et.enableAttribute(U.position.location),tt.vertexAttribPointer(U.position.location,3,5126,!1,0,0)),x.hasNormals&&(tt.bindBuffer(34962,w.normal),tt.bufferData(34962,x.normalArray,35048),et.enableAttribute(U.normal.location),tt.vertexAttribPointer(U.normal.location,3,5126,!1,0,0)),x.hasUvs&&(tt.bindBuffer(34962,w.uv),tt.bufferData(34962,x.uvArray,35048),et.enableAttribute(U.uv.location),tt.vertexAttribPointer(U.uv.location,2,5126,!1,0,0)),x.hasColors&&(tt.bindBuffer(34962,w.color),tt.bufferData(34962,x.colorArray,35048),et.enableAttribute(U.color.location),tt.vertexAttribPointer(U.color.location,3,5126,!1,0,0)),et.disableUnusedAttributes(),tt.drawArrays(4,0,x.count),x.count=0},this.renderBufferDirect=function(x,S,w,U,G,H){null===S&&(S=Me);const z=G.isMesh&&G.matrixWorld.determinant()<0,j=setProgram(x,S,w,U,G);Ie.setMaterial(U,z);let X=w.index;const K=w.attributes.position;if(null===X){if(void 0===K||0===K.count)return}else if(0===X.count)return;let q,Y=1;!0===U.wireframe&&(X=Ue.getWireframeAttribute(w),Y=2),et.setup(G,U,j,w,X);let Z=qe;null!==X&&(q=ke.get(X),Z=Ye,Z.setIndex(q));const J=null!==X?X.count:K.count,Q=w.drawRange.start*Y,ee=w.drawRange.count*Y,te=null!==H?H.start*Y:0,ne=null!==H?H.count*Y:1/0,ie=Math.max(Q,te),re=Math.min(J,Q+ee,te+ne)-1,oe=Math.max(0,re-ie+1);if(0!==oe){if(G.isMesh)!0===U.wireframe?(Ie.setLineWidth(U.wireframeLinewidth*getTargetPixelRatio()),Z.setMode(1)):Z.setMode(4);else if(G.isLine){let x=U.linewidth;void 0===x&&(x=1),Ie.setLineWidth(x*getTargetPixelRatio()),G.isLineSegments?Z.setMode(1):G.isLineLoop?Z.setMode(2):Z.setMode(3)}else G.isPoints?Z.setMode(0):G.isSprite&&Z.setMode(4);if(G.isInstancedMesh)Z.renderInstances(ie,oe,G.count);else if(w.isInstancedBufferGeometry){const x=Math.min(w.instanceCount,w._maxInstanceCount);Z.renderInstances(ie,oe,x)}else Z.render(ie,oe)}},this.compile=function(x,S){Z=$e.get(x),Z.init(),ne.push(Z),x.traverseVisible((function(x){x.isLight&&x.layers.test(S.layers)&&(Z.pushLight(x),x.castShadow&&Z.pushShadow(x))})),Z.setupLights(ie.physicallyCorrectLights),x.traverse((function(S){const w=S.material;if(w)if(Array.isArray(w))for(let U=0;U<w.length;U++){getProgram(w[U],x,S)}else getProgram(w,x,S)})),ne.pop(),Z=null};let it=null;function onXRSessionStart(){rt.stop()}function onXRSessionEnd(){rt.start()}const rt=new WebGLAnimation;function projectObject(x,S,w,U){if(!1===x.visible)return;if(x.layers.test(S.layers))if(x.isGroup)w=x.renderOrder;else if(x.isLOD)!0===x.autoUpdate&&x.update(S);else if(x.isLight)Z.pushLight(x),x.castShadow&&Z.pushShadow(x);else if(x.isSprite){if(!x.frustumCulled||Ee.intersectsSprite(x)){U&&Ae.setFromMatrixPosition(x.matrixWorld).applyMatrix4(Ce);const S=Ge.update(x),G=x.material;G.visible&&Y.push(x,S,G,w,Ae.z,null)}}else if(x.isImmediateRenderObject)U&&Ae.setFromMatrixPosition(x.matrixWorld).applyMatrix4(Ce),Y.push(x,null,x.material,w,Ae.z,null);else if((x.isMesh||x.isLine||x.isPoints)&&(x.isSkinnedMesh&&x.skeleton.frame!==Pe.render.frame&&(x.skeleton.update(),x.skeleton.frame=Pe.render.frame),!x.frustumCulled||Ee.intersectsObject(x))){U&&Ae.setFromMatrixPosition(x.matrixWorld).applyMatrix4(Ce);const S=Ge.update(x),G=x.material;if(Array.isArray(G)){const U=S.groups;for(let H=0,z=U.length;H<z;H++){const z=U[H],j=G[z.materialIndex];j&&j.visible&&Y.push(x,S,j,w,Ae.z,z)}}else G.visible&&Y.push(x,S,G,w,Ae.z,null)}const G=x.children;for(let x=0,H=G.length;x<H;x++)projectObject(G[x],S,w,U)}function renderScene(x,S,w,U){const G=x.opaque,H=x.transmissive,j=x.transparent;Z.setupLightsView(w),H.length>0&&function renderTransmissionPass(x,S,w){if(null===Te){const x=!0===z&&!0===Le.isWebGL2;Te=new(x?WebGLMultisampleRenderTarget:WebGLRenderTarget)(1024,1024,{generateMipmaps:!0,type:null!==Je.convert(vt)?vt:ct,minFilter:st,magFilter:Qe,wrapS:Ze,wrapT:Ze})}const U=ie.getRenderTarget();ie.setRenderTarget(Te),ie.clear();const G=ie.toneMapping;ie.toneMapping=De,renderObjects(x,S,w),ie.toneMapping=G,Oe.updateMultisampleRenderTarget(Te),Oe.updateRenderTargetMipmap(Te),ie.setRenderTarget(U)}(G,S,w),U&&Ie.viewport(ue.copy(U)),G.length>0&&renderObjects(G,S,w),H.length>0&&renderObjects(H,S,w),j.length>0&&renderObjects(j,S,w)}function renderObjects(x,S,w){const U=!0===S.isScene?S.overrideMaterial:null;for(let G=0,H=x.length;G<H;G++){const H=x[G],z=H.object,j=H.geometry,X=null===U?H.material:U,K=H.group;z.layers.test(w.layers)&&renderObject(z,S,w,j,X,K)}}function renderObject(x,S,w,U,G,H){if(x.onBeforeRender(ie,S,w,U,G,H),x.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,x.matrixWorld),x.normalMatrix.getNormalMatrix(x.modelViewMatrix),G.onBeforeRender(ie,S,w,U,x,H),x.isImmediateRenderObject){const H=setProgram(w,S,U,G,x);Ie.setMaterial(G),et.reset(),function renderObjectImmediate(x,S){x.render((function(x){ie.renderBufferImmediate(x,S)}))}(x,H)}else!0===G.transparent&&G.side===te?(G.side=ee,G.needsUpdate=!0,ie.renderBufferDirect(w,S,U,G,x,H),G.side=Q,G.needsUpdate=!0,ie.renderBufferDirect(w,S,U,G,x,H),G.side=te):ie.renderBufferDirect(w,S,U,G,x,H);x.onAfterRender(ie,S,w,U,G,H)}function getProgram(x,S,w){!0!==S.isScene&&(S=Me);const U=Fe.get(x),G=Z.state.lights,H=Z.state.shadowsArray,z=G.state.version,j=Ve.getParameters(x,G.state,H,S,w),X=Ve.getProgramCacheKey(j);let K=U.programs;U.environment=x.isMeshStandardMaterial?S.environment:null,U.fog=S.fog,U.envMap=(x.isMeshStandardMaterial?Be:Ne).get(x.envMap||U.environment),void 0===K&&(x.addEventListener("dispose",onMaterialDispose),K=new Map,U.programs=K);let q=K.get(X);if(void 0!==q){if(U.currentProgram===q&&U.lightsStateVersion===z)return updateCommonMaterialProperties(x,j),q}else j.uniforms=Ve.getUniforms(x),x.onBuild(j,ie),x.onBeforeCompile(j,ie),q=Ve.acquireProgram(j,X),K.set(X,q),U.uniforms=j.uniforms;const Y=U.uniforms;(x.isShaderMaterial||x.isRawShaderMaterial)&&!0!==x.clipping||(Y.clippingPlanes=ze.uniform),updateCommonMaterialProperties(x,j),U.needsLights=function materialNeedsLights(x){return x.isMeshLambertMaterial||x.isMeshToonMaterial||x.isMeshPhongMaterial||x.isMeshStandardMaterial||x.isShadowMaterial||x.isShaderMaterial&&!0===x.lights}(x),U.lightsStateVersion=z,U.needsLights&&(Y.ambientLightColor.value=G.state.ambient,Y.lightProbe.value=G.state.probe,Y.directionalLights.value=G.state.directional,Y.directionalLightShadows.value=G.state.directionalShadow,Y.spotLights.value=G.state.spot,Y.spotLightShadows.value=G.state.spotShadow,Y.rectAreaLights.value=G.state.rectArea,Y.ltc_1.value=G.state.rectAreaLTC1,Y.ltc_2.value=G.state.rectAreaLTC2,Y.pointLights.value=G.state.point,Y.pointLightShadows.value=G.state.pointShadow,Y.hemisphereLights.value=G.state.hemi,Y.directionalShadowMap.value=G.state.directionalShadowMap,Y.directionalShadowMatrix.value=G.state.directionalShadowMatrix,Y.spotShadowMap.value=G.state.spotShadowMap,Y.spotShadowMatrix.value=G.state.spotShadowMatrix,Y.pointShadowMap.value=G.state.pointShadowMap,Y.pointShadowMatrix.value=G.state.pointShadowMatrix);const J=q.getUniforms(),Q=WebGLUniforms.seqWithValue(J.seq,Y);return U.currentProgram=q,U.uniformsList=Q,q}function updateCommonMaterialProperties(x,S){const w=Fe.get(x);w.outputEncoding=S.outputEncoding,w.instancing=S.instancing,w.skinning=S.skinning,w.morphTargets=S.morphTargets,w.morphNormals=S.morphNormals,w.morphTargetsCount=S.morphTargetsCount,w.numClippingPlanes=S.numClippingPlanes,w.numIntersection=S.numClipIntersection,w.vertexAlphas=S.vertexAlphas,w.vertexTangents=S.vertexTangents}function setProgram(x,S,w,U,G){!0!==S.isScene&&(S=Me),Oe.resetTextureUnits();const H=S.fog,z=U.isMeshStandardMaterial?S.environment:null,j=null===se?ie.outputEncoding:se.texture.encoding,X=(U.isMeshStandardMaterial?Be:Ne).get(U.envMap||z),K=!0===U.vertexColors&&!!w&&!!w.attributes.color&&4===w.attributes.color.itemSize,q=!!U.normalMap&&!!w&&!!w.attributes.tangent,Y=!!w&&!!w.morphAttributes.position,J=!!w&&!!w.morphAttributes.normal,Q=w&&w.morphAttributes.position?w.morphAttributes.position.length:0,ee=Fe.get(U),te=Z.state.lights;if(!0===Se&&(!0===we||x!==ce)){const S=x===ce&&U.id===le;ze.setState(U,x,S)}let ne=!1;U.version===ee.__version?ee.needsLights&&ee.lightsStateVersion!==te.state.version||ee.outputEncoding!==j||G.isInstancedMesh&&!1===ee.instancing?ne=!0:G.isInstancedMesh||!0!==ee.instancing?G.isSkinnedMesh&&!1===ee.skinning?ne=!0:G.isSkinnedMesh||!0!==ee.skinning?ee.envMap!==X||U.fog&&ee.fog!==H?ne=!0:void 0===ee.numClippingPlanes||ee.numClippingPlanes===ze.numPlanes&&ee.numIntersection===ze.numIntersection?(ee.vertexAlphas!==K||ee.vertexTangents!==q||ee.morphTargets!==Y||ee.morphNormals!==J||!0===Le.isWebGL2&&ee.morphTargetsCount!==Q)&&(ne=!0):ne=!0:ne=!0:ne=!0:(ne=!0,ee.__version=U.version);let re=ee.currentProgram;!0===ne&&(re=getProgram(U,S,G));let oe=!1,ae=!1,ue=!1;const he=re.getUniforms(),de=ee.uniforms;if(Ie.useProgram(re.program)&&(oe=!0,ae=!0,ue=!0),U.id!==le&&(le=U.id,ae=!0),oe||ce!==x){if(he.setValue(tt,"projectionMatrix",x.projectionMatrix),Le.logarithmicDepthBuffer&&he.setValue(tt,"logDepthBufFC",2/(Math.log(x.far+1)/Math.LN2)),ce!==x&&(ce=x,ae=!0,ue=!0),U.isShaderMaterial||U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshStandardMaterial||U.envMap){const S=he.map.cameraPosition;void 0!==S&&S.setValue(tt,Ae.setFromMatrixPosition(x.matrixWorld))}(U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshLambertMaterial||U.isMeshBasicMaterial||U.isMeshStandardMaterial||U.isShaderMaterial)&&he.setValue(tt,"isOrthographic",!0===x.isOrthographicCamera),(U.isMeshPhongMaterial||U.isMeshToonMaterial||U.isMeshLambertMaterial||U.isMeshBasicMaterial||U.isMeshStandardMaterial||U.isShaderMaterial||U.isShadowMaterial||G.isSkinnedMesh)&&he.setValue(tt,"viewMatrix",x.matrixWorldInverse)}if(G.isSkinnedMesh){he.setOptional(tt,G,"bindMatrix"),he.setOptional(tt,G,"bindMatrixInverse");const x=G.skeleton;x&&(Le.floatVertexTextures?(null===x.boneTexture&&x.computeBoneTexture(),he.setValue(tt,"boneTexture",x.boneTexture,Oe),he.setValue(tt,"boneTextureSize",x.boneTextureSize)):he.setOptional(tt,x,"boneMatrices"))}return!w||void 0===w.morphAttributes.position&&void 0===w.morphAttributes.normal||Ke.update(G,w,U,re),(ae||ee.receiveShadow!==G.receiveShadow)&&(ee.receiveShadow=G.receiveShadow,he.setValue(tt,"receiveShadow",G.receiveShadow)),ae&&(he.setValue(tt,"toneMappingExposure",ie.toneMappingExposure),ee.needsLights&&function markUniformsLightsNeedsUpdate(x,S){x.ambientLightColor.needsUpdate=S,x.lightProbe.needsUpdate=S,x.directionalLights.needsUpdate=S,x.directionalLightShadows.needsUpdate=S,x.pointLights.needsUpdate=S,x.pointLightShadows.needsUpdate=S,x.spotLights.needsUpdate=S,x.spotLightShadows.needsUpdate=S,x.rectAreaLights.needsUpdate=S,x.hemisphereLights.needsUpdate=S}(de,ue),H&&U.fog&&He.refreshFogUniforms(de,H),He.refreshMaterialUniforms(de,U,fe,me,Te),WebGLUniforms.upload(tt,ee.uniformsList,de,Oe)),U.isShaderMaterial&&!0===U.uniformsNeedUpdate&&(WebGLUniforms.upload(tt,ee.uniformsList,de,Oe),U.uniformsNeedUpdate=!1),U.isSpriteMaterial&&he.setValue(tt,"center",G.center),he.setValue(tt,"modelViewMatrix",G.modelViewMatrix),he.setValue(tt,"normalMatrix",G.normalMatrix),he.setValue(tt,"modelMatrix",G.matrixWorld),re}rt.setAnimationLoop((function onAnimationFrame(x){it&&it(x)})),"undefined"!=typeof window&&rt.setContext(window),this.setAnimationLoop=function(x){it=x,nt.setAnimationLoop(x),null===x?rt.stop():rt.start()},nt.addEventListener("sessionstart",onXRSessionStart),nt.addEventListener("sessionend",onXRSessionEnd),this.render=function(x,S){if(void 0!==S&&!0!==S.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===re)return;!0===x.autoUpdate&&x.updateMatrixWorld(),null===S.parent&&S.updateMatrixWorld(),!0===nt.enabled&&!0===nt.isPresenting&&(!0===nt.cameraAutoUpdate&&nt.updateCamera(S),S=nt.getCamera()),!0===x.isScene&&x.onBeforeRender(ie,x,S,se),Z=$e.get(x,ne.length),Z.init(),ne.push(Z),Ce.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),Ee.setFromProjectionMatrix(Ce),we=this.localClippingEnabled,Se=ze.init(this.clippingPlanes,we,S),Y=We.get(x,J.length),Y.init(),J.push(Y),projectObject(x,S,0,ie.sortObjects),Y.finish(),!0===ie.sortObjects&&Y.sort(ge,ve),!0===Se&&ze.beginShadows();const w=Z.state.shadowsArray;if(je.render(w,x,S),!0===Se&&ze.endShadows(),!0===this.info.autoReset&&this.info.reset(),Xe.render(Y,x),Z.setupLights(ie.physicallyCorrectLights),S.isArrayCamera){const w=S.cameras;for(let S=0,U=w.length;S<U;S++){const U=w[S];renderScene(Y,x,U,U.viewport)}}else renderScene(Y,x,S);null!==se&&(Oe.updateMultisampleRenderTarget(se),Oe.updateRenderTargetMipmap(se)),!0===x.isScene&&x.onAfterRender(ie,x,S),Ie.buffers.depth.setTest(!0),Ie.buffers.depth.setMask(!0),Ie.buffers.color.setMask(!0),Ie.setPolygonOffset(!1),et.resetDefaultState(),le=-1,ce=null,ne.pop(),Z=ne.length>0?ne[ne.length-1]:null,J.pop(),Y=J.length>0?J[J.length-1]:null},this.getActiveCubeFace=function(){return oe},this.getActiveMipmapLevel=function(){return ae},this.getRenderTarget=function(){return se},this.setRenderTarget=function(x,S=0,w=0){se=x,oe=S,ae=w,x&&void 0===Fe.get(x).__webglFramebuffer&&Oe.setupRenderTarget(x);let U=null,G=!1,H=!1;if(x){const w=x.texture;(w.isDataTexture3D||w.isDataTexture2DArray)&&(H=!0);const z=Fe.get(x).__webglFramebuffer;x.isWebGLCubeRenderTarget?(U=z[S],G=!0):U=x.isWebGLMultisampleRenderTarget?Fe.get(x).__webglMultisampledFramebuffer:z,ue.copy(x.viewport),he.copy(x.scissor),de=x.scissorTest}else ue.copy(_e).multiplyScalar(fe).floor(),he.copy(ye).multiplyScalar(fe).floor(),de=be;if(Ie.bindFramebuffer(36160,U)&&Le.drawBuffers){let S=!1;if(x)if(x.isWebGLMultipleRenderTargets){const w=x.texture;if(xe.length!==w.length||36064!==xe[0]){for(let x=0,S=w.length;x<S;x++)xe[x]=36064+x;xe.length=w.length,S=!0}}else 1===xe.length&&36064===xe[0]||(xe[0]=36064,xe.length=1,S=!0);else 1===xe.length&&1029===xe[0]||(xe[0]=1029,xe.length=1,S=!0);S&&(Le.isWebGL2?tt.drawBuffers(xe):Re.get("WEBGL_draw_buffers").drawBuffersWEBGL(xe))}if(Ie.viewport(ue),Ie.scissor(he),Ie.setScissorTest(de),G){const U=Fe.get(x.texture);tt.framebufferTexture2D(36160,36064,34069+S,U.__webglTexture,w)}else if(H){const U=Fe.get(x.texture),G=S||0;tt.framebufferTextureLayer(36160,36064,U.__webglTexture,w||0,G)}le=-1},this.readRenderTargetPixels=function(x,S,w,U,G,H,z){if(!x||!x.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let j=Fe.get(x).__webglFramebuffer;if(x.isWebGLCubeRenderTarget&&void 0!==z&&(j=j[z]),j){Ie.bindFramebuffer(36160,j);try{const z=x.texture,j=z.format,X=z.type;if(j!==wt&&Je.convert(j)!==tt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const K=X===vt&&(Re.has("EXT_color_buffer_half_float")||Le.isWebGL2&&Re.has("EXT_color_buffer_float"));if(!(X===ct||Je.convert(X)===tt.getParameter(35738)||X===gt&&(Le.isWebGL2||Re.has("OES_texture_float")||Re.has("WEBGL_color_buffer_float"))||K))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===tt.checkFramebufferStatus(36160)?S>=0&&S<=x.width-U&&w>=0&&w<=x.height-G&&tt.readPixels(S,w,U,G,Je.convert(j),Je.convert(X),H):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const x=null!==se?Fe.get(se).__webglFramebuffer:null;Ie.bindFramebuffer(36160,x)}}},this.copyFramebufferToTexture=function(x,S,w=0){const U=Math.pow(2,-w),G=Math.floor(S.image.width*U),H=Math.floor(S.image.height*U);let z=Je.convert(S.format);Le.isWebGL2&&(6407===z&&(z=32849),6408===z&&(z=32856)),Oe.setTexture2D(S,0),tt.copyTexImage2D(3553,w,z,x.x,x.y,G,H,0),Ie.unbindTexture()},this.copyTextureToTexture=function(x,S,w,U=0){const G=S.image.width,H=S.image.height,z=Je.convert(w.format),j=Je.convert(w.type);Oe.setTexture2D(w,0),tt.pixelStorei(37440,w.flipY),tt.pixelStorei(37441,w.premultiplyAlpha),tt.pixelStorei(3317,w.unpackAlignment),S.isDataTexture?tt.texSubImage2D(3553,U,x.x,x.y,G,H,z,j,S.image.data):S.isCompressedTexture?tt.compressedTexSubImage2D(3553,U,x.x,x.y,S.mipmaps[0].width,S.mipmaps[0].height,z,S.mipmaps[0].data):tt.texSubImage2D(3553,U,x.x,x.y,z,j,S.image),0===U&&w.generateMipmaps&&tt.generateMipmap(3553),Ie.unbindTexture()},this.copyTextureToTexture3D=function(x,S,w,U,G=0){if(ie.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const H=x.max.x-x.min.x+1,z=x.max.y-x.min.y+1,j=x.max.z-x.min.z+1,X=Je.convert(U.format),K=Je.convert(U.type);let q;if(U.isDataTexture3D)Oe.setTexture3D(U,0),q=32879;else{if(!U.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Oe.setTexture2DArray(U,0),q=35866}tt.pixelStorei(37440,U.flipY),tt.pixelStorei(37441,U.premultiplyAlpha),tt.pixelStorei(3317,U.unpackAlignment);const Y=tt.getParameter(3314),Z=tt.getParameter(32878),J=tt.getParameter(3316),Q=tt.getParameter(3315),ee=tt.getParameter(32877),te=w.isCompressedTexture?w.mipmaps[0]:w.image;tt.pixelStorei(3314,te.width),tt.pixelStorei(32878,te.height),tt.pixelStorei(3316,x.min.x),tt.pixelStorei(3315,x.min.y),tt.pixelStorei(32877,x.min.z),w.isDataTexture||w.isDataTexture3D?tt.texSubImage3D(q,G,S.x,S.y,S.z,H,z,j,X,K,te.data):w.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),tt.compressedTexSubImage3D(q,G,S.x,S.y,S.z,H,z,j,X,te.data)):tt.texSubImage3D(q,G,S.x,S.y,S.z,H,z,j,X,K,te),tt.pixelStorei(3314,Y),tt.pixelStorei(32878,Z),tt.pixelStorei(3316,J),tt.pixelStorei(3315,Q),tt.pixelStorei(32877,ee),0===G&&U.generateMipmaps&&tt.generateMipmap(q),Ie.unbindTexture()},this.initTexture=function(x){Oe.setTexture2D(x,0),Ie.unbindTexture()},this.resetState=function(){oe=0,ae=0,se=null,Ie.reset(),et.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(x,S=25e-5){this.name="",this.color=new Color(x),this.density=S}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}FogExp2.prototype.isFogExp2=!0;class Fog{constructor(x,S=1,w=1e3){this.name="",this.color=new Color(x),this.near=S,this.far=w}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Fog.prototype.isFog=!0;class Scene extends Object3D{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(x,S){return super.copy(x,S),null!==x.background&&(this.background=x.background.clone()),null!==x.environment&&(this.environment=x.environment.clone()),null!==x.fog&&(this.fog=x.fog.clone()),null!==x.overrideMaterial&&(this.overrideMaterial=x.overrideMaterial.clone()),this.autoUpdate=x.autoUpdate,this.matrixAutoUpdate=x.matrixAutoUpdate,this}toJSON(x){const S=super.toJSON(x);return null!==this.fog&&(S.object.fog=this.fog.toJSON()),S}}Scene.prototype.isScene=!0;class InterleavedBuffer{constructor(x,S){this.array=x,this.stride=S,this.count=void 0!==x?x.length/S:0,this.usage=Mi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(x){!0===x&&this.version++}setUsage(x){return this.usage=x,this}copy(x){return this.array=new x.array.constructor(x.array),this.count=x.count,this.stride=x.stride,this.usage=x.usage,this}copyAt(x,S,w){x*=this.stride,w*=S.stride;for(let U=0,G=this.stride;U<G;U++)this.array[x+U]=S.array[w+U];return this}set(x,S=0){return this.array.set(x,S),this}clone(x){void 0===x.arrayBuffers&&(x.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=generateUUID()),void 0===x.arrayBuffers[this.array.buffer._uuid]&&(x.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const S=new this.array.constructor(x.arrayBuffers[this.array.buffer._uuid]),w=new this.constructor(S,this.stride);return w.setUsage(this.usage),w}onUpload(x){return this.onUploadCallback=x,this}toJSON(x){return void 0===x.arrayBuffers&&(x.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=generateUUID()),void 0===x.arrayBuffers[this.array.buffer._uuid]&&(x.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}InterleavedBuffer.prototype.isInterleavedBuffer=!0;const fa=new Vector3;class InterleavedBufferAttribute{constructor(x,S,w,U=!1){this.name="",this.data=x,this.itemSize=S,this.offset=w,this.normalized=!0===U}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(x){this.data.needsUpdate=x}applyMatrix4(x){for(let S=0,w=this.data.count;S<w;S++)fa.x=this.getX(S),fa.y=this.getY(S),fa.z=this.getZ(S),fa.applyMatrix4(x),this.setXYZ(S,fa.x,fa.y,fa.z);return this}applyNormalMatrix(x){for(let S=0,w=this.count;S<w;S++)fa.x=this.getX(S),fa.y=this.getY(S),fa.z=this.getZ(S),fa.applyNormalMatrix(x),this.setXYZ(S,fa.x,fa.y,fa.z);return this}transformDirection(x){for(let S=0,w=this.count;S<w;S++)fa.x=this.getX(S),fa.y=this.getY(S),fa.z=this.getZ(S),fa.transformDirection(x),this.setXYZ(S,fa.x,fa.y,fa.z);return this}setX(x,S){return this.data.array[x*this.data.stride+this.offset]=S,this}setY(x,S){return this.data.array[x*this.data.stride+this.offset+1]=S,this}setZ(x,S){return this.data.array[x*this.data.stride+this.offset+2]=S,this}setW(x,S){return this.data.array[x*this.data.stride+this.offset+3]=S,this}getX(x){return this.data.array[x*this.data.stride+this.offset]}getY(x){return this.data.array[x*this.data.stride+this.offset+1]}getZ(x){return this.data.array[x*this.data.stride+this.offset+2]}getW(x){return this.data.array[x*this.data.stride+this.offset+3]}setXY(x,S,w){return x=x*this.data.stride+this.offset,this.data.array[x+0]=S,this.data.array[x+1]=w,this}setXYZ(x,S,w,U){return x=x*this.data.stride+this.offset,this.data.array[x+0]=S,this.data.array[x+1]=w,this.data.array[x+2]=U,this}setXYZW(x,S,w,U,G){return x=x*this.data.stride+this.offset,this.data.array[x+0]=S,this.data.array[x+1]=w,this.data.array[x+2]=U,this.data.array[x+3]=G,this}clone(x){if(void 0===x){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const x=[];for(let S=0;S<this.count;S++){const w=S*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)x.push(this.data.array[w+S])}return new BufferAttribute(new this.array.constructor(x),this.itemSize,this.normalized)}return void 0===x.interleavedBuffers&&(x.interleavedBuffers={}),void 0===x.interleavedBuffers[this.data.uuid]&&(x.interleavedBuffers[this.data.uuid]=this.data.clone(x)),new InterleavedBufferAttribute(x.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(x){if(void 0===x){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const x=[];for(let S=0;S<this.count;S++){const w=S*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)x.push(this.data.array[w+S])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:x,normalized:this.normalized}}return void 0===x.interleavedBuffers&&(x.interleavedBuffers={}),void 0===x.interleavedBuffers[this.data.uuid]&&(x.interleavedBuffers[this.data.uuid]=this.data.toJSON(x)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}InterleavedBufferAttribute.prototype.isInterleavedBufferAttribute=!0;class SpriteMaterial extends Material{constructor(x){super(),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.map=x.map,this.alphaMap=x.alphaMap,this.rotation=x.rotation,this.sizeAttenuation=x.sizeAttenuation,this}}let ga;SpriteMaterial.prototype.isSpriteMaterial=!0;const va=new Vector3,_a=new Vector3,ya=new Vector3,ba=new Vector2,xa=new Vector2,Ea=new Matrix4,Sa=new Vector3,wa=new Vector3,Ta=new Vector3,Ca=new Vector2,Aa=new Vector2,Ma=new Vector2;class Sprite extends Object3D{constructor(x){if(super(),this.type="Sprite",void 0===ga){ga=new BufferGeometry;const x=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),S=new InterleavedBuffer(x,5);ga.setIndex([0,1,2,0,2,3]),ga.setAttribute("position",new InterleavedBufferAttribute(S,3,0,!1)),ga.setAttribute("uv",new InterleavedBufferAttribute(S,2,3,!1))}this.geometry=ga,this.material=void 0!==x?x:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(x,S){null===x.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_a.setFromMatrixScale(this.matrixWorld),Ea.copy(x.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(x.camera.matrixWorldInverse,this.matrixWorld),ya.setFromMatrixPosition(this.modelViewMatrix),x.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&_a.multiplyScalar(-ya.z);const w=this.material.rotation;let U,G;0!==w&&(G=Math.cos(w),U=Math.sin(w));const H=this.center;transformVertex(Sa.set(-.5,-.5,0),ya,H,_a,U,G),transformVertex(wa.set(.5,-.5,0),ya,H,_a,U,G),transformVertex(Ta.set(.5,.5,0),ya,H,_a,U,G),Ca.set(0,0),Aa.set(1,0),Ma.set(1,1);let z=x.ray.intersectTriangle(Sa,wa,Ta,!1,va);if(null===z&&(transformVertex(wa.set(-.5,.5,0),ya,H,_a,U,G),Aa.set(0,1),z=x.ray.intersectTriangle(Sa,Ta,wa,!1,va),null===z))return;const j=x.ray.origin.distanceTo(va);j<x.near||j>x.far||S.push({distance:j,point:va.clone(),uv:Triangle.getUV(va,Sa,wa,Ta,Ca,Aa,Ma,new Vector2),face:null,object:this})}copy(x){return super.copy(x),void 0!==x.center&&this.center.copy(x.center),this.material=x.material,this}}function transformVertex(x,S,w,U,G,H){ba.subVectors(x,w).addScalar(.5).multiply(U),void 0!==G?(xa.x=H*ba.x-G*ba.y,xa.y=G*ba.x+H*ba.y):xa.copy(ba),x.copy(S),x.x+=xa.x,x.y+=xa.y,x.applyMatrix4(Ea)}Sprite.prototype.isSprite=!0;const Ra=new Vector3,La=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(x){super.copy(x,!1);const S=x.levels;for(let x=0,w=S.length;x<w;x++){const w=S[x];this.addLevel(w.object.clone(),w.distance)}return this.autoUpdate=x.autoUpdate,this}addLevel(x,S=0){S=Math.abs(S);const w=this.levels;let U;for(U=0;U<w.length&&!(S<w[U].distance);U++);return w.splice(U,0,{distance:S,object:x}),this.add(x),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(x){const S=this.levels;if(S.length>0){let w,U;for(w=1,U=S.length;w<U&&!(x<S[w].distance);w++);return S[w-1].object}return null}raycast(x,S){if(this.levels.length>0){Ra.setFromMatrixPosition(this.matrixWorld);const w=x.ray.origin.distanceTo(Ra);this.getObjectForDistance(w).raycast(x,S)}}update(x){const S=this.levels;if(S.length>1){Ra.setFromMatrixPosition(x.matrixWorld),La.setFromMatrixPosition(this.matrixWorld);const w=Ra.distanceTo(La)/x.zoom;let U,G;for(S[0].object.visible=!0,U=1,G=S.length;U<G&&w>=S[U].distance;U++)S[U-1].object.visible=!1,S[U].object.visible=!0;for(this._currentLevel=U-1;U<G;U++)S[U].object.visible=!1}}toJSON(x){const S=super.toJSON(x);!1===this.autoUpdate&&(S.object.autoUpdate=!1),S.object.levels=[];const w=this.levels;for(let x=0,U=w.length;x<U;x++){const U=w[x];S.object.levels.push({object:U.object.uuid,distance:U.distance})}return S}}const Ia=new Vector3,Pa=new Vector4,Fa=new Vector4,Oa=new Vector3,Na=new Matrix4;class SkinnedMesh extends Mesh{constructor(x,S){super(x,S),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}copy(x){return super.copy(x),this.bindMode=x.bindMode,this.bindMatrix.copy(x.bindMatrix),this.bindMatrixInverse.copy(x.bindMatrixInverse),this.skeleton=x.skeleton,this}bind(x,S){this.skeleton=x,void 0===S&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),S=this.matrixWorld),this.bindMatrix.copy(S),this.bindMatrixInverse.copy(S).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const x=new Vector4,S=this.geometry.attributes.skinWeight;for(let w=0,U=S.count;w<U;w++){x.x=S.getX(w),x.y=S.getY(w),x.z=S.getZ(w),x.w=S.getW(w);const U=1/x.manhattanLength();U!==1/0?x.multiplyScalar(U):x.set(1,0,0,0),S.setXYZW(w,x.x,x.y,x.z,x.w)}}updateMatrixWorld(x){super.updateMatrixWorld(x),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(x,S){const w=this.skeleton,U=this.geometry;Pa.fromBufferAttribute(U.attributes.skinIndex,x),Fa.fromBufferAttribute(U.attributes.skinWeight,x),Ia.copy(S).applyMatrix4(this.bindMatrix),S.set(0,0,0);for(let x=0;x<4;x++){const U=Fa.getComponent(x);if(0!==U){const G=Pa.getComponent(x);Na.multiplyMatrices(w.bones[G].matrixWorld,w.boneInverses[G]),S.addScaledVector(Oa.copy(Ia).applyMatrix4(Na),U)}}return S.applyMatrix4(this.bindMatrixInverse)}}SkinnedMesh.prototype.isSkinnedMesh=!0;class Bone extends Object3D{constructor(){super(),this.type="Bone"}}Bone.prototype.isBone=!0;class DataTexture extends Texture{constructor(x=null,S=1,w=1,U,G,H,z,j,X=Qe,K=Qe,q,Y){super(null,H,z,j,X,K,U,G,q,Y),this.image={data:x,width:S,height:w},this.magFilter=X,this.minFilter=K,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}DataTexture.prototype.isDataTexture=!0;const Ba=new Matrix4,Da=new Matrix4;class Skeleton{constructor(x=[],S=[]){this.uuid=generateUUID(),this.bones=x.slice(0),this.boneInverses=S,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const x=this.bones,S=this.boneInverses;if(this.boneMatrices=new Float32Array(16*x.length),0===S.length)this.calculateInverses();else if(x.length!==S.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let x=0,S=this.bones.length;x<S;x++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let x=0,S=this.bones.length;x<S;x++){const S=new Matrix4;this.bones[x]&&S.copy(this.bones[x].matrixWorld).invert(),this.boneInverses.push(S)}}pose(){for(let x=0,S=this.bones.length;x<S;x++){const S=this.bones[x];S&&S.matrixWorld.copy(this.boneInverses[x]).invert()}for(let x=0,S=this.bones.length;x<S;x++){const S=this.bones[x];S&&(S.parent&&S.parent.isBone?(S.matrix.copy(S.parent.matrixWorld).invert(),S.matrix.multiply(S.matrixWorld)):S.matrix.copy(S.matrixWorld),S.matrix.decompose(S.position,S.quaternion,S.scale))}}update(){const x=this.bones,S=this.boneInverses,w=this.boneMatrices,U=this.boneTexture;for(let U=0,G=x.length;U<G;U++){const G=x[U]?x[U].matrixWorld:Da;Ba.multiplyMatrices(G,S[U]),Ba.toArray(w,16*U)}null!==U&&(U.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let x=Math.sqrt(4*this.bones.length);x=ceilPowerOfTwo(x),x=Math.max(x,4);const S=new Float32Array(x*x*4);S.set(this.boneMatrices);const w=new DataTexture(S,x,x,wt,gt);return this.boneMatrices=S,this.boneTexture=w,this.boneTextureSize=x,this}getBoneByName(x){for(let S=0,w=this.bones.length;S<w;S++){const w=this.bones[S];if(w.name===x)return w}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(x,S){this.uuid=x.uuid;for(let w=0,U=x.bones.length;w<U;w++){const U=x.bones[w];let G=S[U];void 0===G&&(console.warn("THREE.Skeleton: No bone found with UUID:",U),G=new Bone),this.bones.push(G),this.boneInverses.push((new Matrix4).fromArray(x.boneInverses[w]))}return this.init(),this}toJSON(){const x={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};x.uuid=this.uuid;const S=this.bones,w=this.boneInverses;for(let U=0,G=S.length;U<G;U++){const G=S[U];x.bones.push(G.uuid);const H=w[U];x.boneInverses.push(H.toArray())}return x}}class InstancedBufferAttribute extends BufferAttribute{constructor(x,S,w,U=1){"number"==typeof w&&(U=w,w=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(x,S,w),this.meshPerAttribute=U}copy(x){return super.copy(x),this.meshPerAttribute=x.meshPerAttribute,this}toJSON(){const x=super.toJSON();return x.meshPerAttribute=this.meshPerAttribute,x.isInstancedBufferAttribute=!0,x}}InstancedBufferAttribute.prototype.isInstancedBufferAttribute=!0;const ka=new Matrix4,Ua=new Matrix4,Ga=[],Va=new Mesh;class InstancedMesh extends Mesh{constructor(x,S,w){super(x,S),this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(16*w),16),this.instanceColor=null,this.count=w,this.frustumCulled=!1}copy(x){return super.copy(x),this.instanceMatrix.copy(x.instanceMatrix),null!==x.instanceColor&&(this.instanceColor=x.instanceColor.clone()),this.count=x.count,this}getColorAt(x,S){S.fromArray(this.instanceColor.array,3*x)}getMatrixAt(x,S){S.fromArray(this.instanceMatrix.array,16*x)}raycast(x,S){const w=this.matrixWorld,U=this.count;if(Va.geometry=this.geometry,Va.material=this.material,void 0!==Va.material)for(let G=0;G<U;G++){this.getMatrixAt(G,ka),Ua.multiplyMatrices(w,ka),Va.matrixWorld=Ua,Va.raycast(x,Ga);for(let x=0,w=Ga.length;x<w;x++){const w=Ga[x];w.instanceId=G,w.object=this,S.push(w)}Ga.length=0}}setColorAt(x,S){null===this.instanceColor&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(3*this.instanceMatrix.count),3)),S.toArray(this.instanceColor.array,3*x)}setMatrixAt(x,S){S.toArray(this.instanceMatrix.array,16*x)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}InstancedMesh.prototype.isInstancedMesh=!0;class LineBasicMaterial extends Material{constructor(x){super(),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.linewidth=x.linewidth,this.linecap=x.linecap,this.linejoin=x.linejoin,this}}LineBasicMaterial.prototype.isLineBasicMaterial=!0;const Ha=new Vector3,Wa=new Vector3,$a=new Matrix4,za=new Ray,ja=new Sphere;class Line extends Object3D{constructor(x=new BufferGeometry,S=new LineBasicMaterial){super(),this.type="Line",this.geometry=x,this.material=S,this.updateMorphTargets()}copy(x){return super.copy(x),this.material=x.material,this.geometry=x.geometry,this}computeLineDistances(){const x=this.geometry;if(x.isBufferGeometry)if(null===x.index){const S=x.attributes.position,w=[0];for(let x=1,U=S.count;x<U;x++)Ha.fromBufferAttribute(S,x-1),Wa.fromBufferAttribute(S,x),w[x]=w[x-1],w[x]+=Ha.distanceTo(Wa);x.setAttribute("lineDistance",new Float32BufferAttribute(w,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else x.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(x,S){const w=this.geometry,U=this.matrixWorld,G=x.params.Line.threshold,H=w.drawRange;if(null===w.boundingSphere&&w.computeBoundingSphere(),ja.copy(w.boundingSphere),ja.applyMatrix4(U),ja.radius+=G,!1===x.ray.intersectsSphere(ja))return;$a.copy(U).invert(),za.copy(x.ray).applyMatrix4($a);const z=G/((this.scale.x+this.scale.y+this.scale.z)/3),j=z*z,X=new Vector3,K=new Vector3,q=new Vector3,Y=new Vector3,Z=this.isLineSegments?2:1;if(w.isBufferGeometry){const U=w.index,G=w.attributes.position;if(null!==U){for(let w=Math.max(0,H.start),z=Math.min(U.count,H.start+H.count)-1;w<z;w+=Z){const H=U.getX(w),z=U.getX(w+1);X.fromBufferAttribute(G,H),K.fromBufferAttribute(G,z);if(za.distanceSqToSegment(X,K,Y,q)>j)continue;Y.applyMatrix4(this.matrixWorld);const Z=x.ray.origin.distanceTo(Y);Z<x.near||Z>x.far||S.push({distance:Z,point:q.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{for(let w=Math.max(0,H.start),U=Math.min(G.count,H.start+H.count)-1;w<U;w+=Z){X.fromBufferAttribute(G,w),K.fromBufferAttribute(G,w+1);if(za.distanceSqToSegment(X,K,Y,q)>j)continue;Y.applyMatrix4(this.matrixWorld);const U=x.ray.origin.distanceTo(Y);U<x.near||U>x.far||S.push({distance:U,point:q.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}else w.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const x=this.geometry;if(x.isBufferGeometry){const S=x.morphAttributes,w=Object.keys(S);if(w.length>0){const x=S[w[0]];if(void 0!==x){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,w=x.length;S<w;S++){const w=x[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[w]=S}}}}else{const S=x.morphTargets;void 0!==S&&S.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Line.prototype.isLine=!0;const Xa=new Vector3,Ka=new Vector3;class LineSegments extends Line{constructor(x,S){super(x,S),this.type="LineSegments"}computeLineDistances(){const x=this.geometry;if(x.isBufferGeometry)if(null===x.index){const S=x.attributes.position,w=[];for(let x=0,U=S.count;x<U;x+=2)Xa.fromBufferAttribute(S,x),Ka.fromBufferAttribute(S,x+1),w[x]=0===x?0:w[x-1],w[x+1]=w[x]+Xa.distanceTo(Ka);x.setAttribute("lineDistance",new Float32BufferAttribute(w,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else x.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}LineSegments.prototype.isLineSegments=!0;class LineLoop extends Line{constructor(x,S){super(x,S),this.type="LineLoop"}}LineLoop.prototype.isLineLoop=!0;class PointsMaterial extends Material{constructor(x){super(),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.map=x.map,this.alphaMap=x.alphaMap,this.size=x.size,this.sizeAttenuation=x.sizeAttenuation,this}}PointsMaterial.prototype.isPointsMaterial=!0;const qa=new Matrix4,Ya=new Ray,Za=new Sphere,Ja=new Vector3;class Points extends Object3D{constructor(x=new BufferGeometry,S=new PointsMaterial){super(),this.type="Points",this.geometry=x,this.material=S,this.updateMorphTargets()}copy(x){return super.copy(x),this.material=x.material,this.geometry=x.geometry,this}raycast(x,S){const w=this.geometry,U=this.matrixWorld,G=x.params.Points.threshold,H=w.drawRange;if(null===w.boundingSphere&&w.computeBoundingSphere(),Za.copy(w.boundingSphere),Za.applyMatrix4(U),Za.radius+=G,!1===x.ray.intersectsSphere(Za))return;qa.copy(U).invert(),Ya.copy(x.ray).applyMatrix4(qa);const z=G/((this.scale.x+this.scale.y+this.scale.z)/3),j=z*z;if(w.isBufferGeometry){const G=w.index,z=w.attributes.position;if(null!==G){for(let w=Math.max(0,H.start),X=Math.min(G.count,H.start+H.count);w<X;w++){const H=G.getX(w);Ja.fromBufferAttribute(z,H),testPoint(Ja,H,j,U,x,S,this)}}else{for(let w=Math.max(0,H.start),G=Math.min(z.count,H.start+H.count);w<G;w++)Ja.fromBufferAttribute(z,w),testPoint(Ja,w,j,U,x,S,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const x=this.geometry;if(x.isBufferGeometry){const S=x.morphAttributes,w=Object.keys(S);if(w.length>0){const x=S[w[0]];if(void 0!==x){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,w=x.length;S<w;S++){const w=x[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[w]=S}}}}else{const S=x.morphTargets;void 0!==S&&S.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function testPoint(x,S,w,U,G,H,z){const j=Ya.distanceSqToPoint(x);if(j<w){const w=new Vector3;Ya.closestPointToPoint(x,w),w.applyMatrix4(U);const X=G.ray.origin.distanceTo(w);if(X<G.near||X>G.far)return;H.push({distance:X,distanceToRay:Math.sqrt(j),point:w,index:S,face:null,object:z})}}Points.prototype.isPoints=!0;class VideoTexture extends Texture{constructor(x,S,w,U,G,H,z,j,X){super(x,S,w,U,G,H,z,j,X),this.format=void 0!==z?z:St,this.minFilter=void 0!==H?H:rt,this.magFilter=void 0!==G?G:rt,this.generateMipmaps=!1;const K=this;"requestVideoFrameCallback"in x&&x.requestVideoFrameCallback((function updateVideo(){K.needsUpdate=!0,x.requestVideoFrameCallback(updateVideo)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const x=this.image;!1==="requestVideoFrameCallback"in x&&x.readyState>=x.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}VideoTexture.prototype.isVideoTexture=!0;class CompressedTexture extends Texture{constructor(x,S,w,U,G,H,z,j,X,K,q,Y){super(null,H,z,j,X,K,U,G,q,Y),this.image={width:S,height:w},this.mipmaps=x,this.flipY=!1,this.generateMipmaps=!1}}CompressedTexture.prototype.isCompressedTexture=!0;class CanvasTexture extends Texture{constructor(x,S,w,U,G,H,z,j,X){super(x,S,w,U,G,H,z,j,X),this.needsUpdate=!0}}CanvasTexture.prototype.isCanvasTexture=!0;class DepthTexture extends Texture{constructor(x,S,w,U,G,H,z,j,X,K){if((K=void 0!==K?K:Mt)!==Mt&&K!==Rt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===w&&K===Mt&&(w=pt),void 0===w&&K===Rt&&(w=xt),super(null,U,G,H,z,j,K,w,X),this.image={width:x,height:S},this.magFilter=void 0!==z?z:Qe,this.minFilter=void 0!==j?j:Qe,this.flipY=!1,this.generateMipmaps=!1}}DepthTexture.prototype.isDepthTexture=!0;class CircleGeometry extends BufferGeometry{constructor(x=1,S=8,w=0,U=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:x,segments:S,thetaStart:w,thetaLength:U},S=Math.max(3,S);const G=[],H=[],z=[],j=[],X=new Vector3,K=new Vector2;H.push(0,0,0),z.push(0,0,1),j.push(.5,.5);for(let G=0,q=3;G<=S;G++,q+=3){const Y=w+G/S*U;X.x=x*Math.cos(Y),X.y=x*Math.sin(Y),H.push(X.x,X.y,X.z),z.push(0,0,1),K.x=(H[q]/x+1)/2,K.y=(H[q+1]/x+1)/2,j.push(K.x,K.y)}for(let x=1;x<=S;x++)G.push(x,x+1,0);this.setIndex(G),this.setAttribute("position",new Float32BufferAttribute(H,3)),this.setAttribute("normal",new Float32BufferAttribute(z,3)),this.setAttribute("uv",new Float32BufferAttribute(j,2))}static fromJSON(x){return new CircleGeometry(x.radius,x.segments,x.thetaStart,x.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(x=1,S=1,w=1,U=8,G=1,H=!1,z=0,j=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:x,radiusBottom:S,height:w,radialSegments:U,heightSegments:G,openEnded:H,thetaStart:z,thetaLength:j};const X=this;U=Math.floor(U),G=Math.floor(G);const K=[],q=[],Y=[],Z=[];let J=0;const Q=[],ee=w/2;let te=0;function generateCap(w){const G=J,H=new Vector2,Q=new Vector3;let ne=0;const ie=!0===w?x:S,re=!0===w?1:-1;for(let x=1;x<=U;x++)q.push(0,ee*re,0),Y.push(0,re,0),Z.push(.5,.5),J++;const oe=J;for(let x=0;x<=U;x++){const S=x/U*j+z,w=Math.cos(S),G=Math.sin(S);Q.x=ie*G,Q.y=ee*re,Q.z=ie*w,q.push(Q.x,Q.y,Q.z),Y.push(0,re,0),H.x=.5*w+.5,H.y=.5*G*re+.5,Z.push(H.x,H.y),J++}for(let x=0;x<U;x++){const S=G+x,U=oe+x;!0===w?K.push(U,U+1,S):K.push(U+1,U,S),ne+=3}X.addGroup(te,ne,!0===w?1:2),te+=ne}!function generateTorso(){const H=new Vector3,ne=new Vector3;let ie=0;const re=(S-x)/w;for(let X=0;X<=G;X++){const K=[],te=X/G,ie=te*(S-x)+x;for(let x=0;x<=U;x++){const S=x/U,G=S*j+z,X=Math.sin(G),Q=Math.cos(G);ne.x=ie*X,ne.y=-te*w+ee,ne.z=ie*Q,q.push(ne.x,ne.y,ne.z),H.set(X,re,Q).normalize(),Y.push(H.x,H.y,H.z),Z.push(S,1-te),K.push(J++)}Q.push(K)}for(let x=0;x<U;x++)for(let S=0;S<G;S++){const w=Q[S][x],U=Q[S+1][x],G=Q[S+1][x+1],H=Q[S][x+1];K.push(w,U,H),K.push(U,G,H),ie+=6}X.addGroup(te,ie,0),te+=ie}(),!1===H&&(x>0&&generateCap(!0),S>0&&generateCap(!1)),this.setIndex(K),this.setAttribute("position",new Float32BufferAttribute(q,3)),this.setAttribute("normal",new Float32BufferAttribute(Y,3)),this.setAttribute("uv",new Float32BufferAttribute(Z,2))}static fromJSON(x){return new CylinderGeometry(x.radiusTop,x.radiusBottom,x.height,x.radialSegments,x.heightSegments,x.openEnded,x.thetaStart,x.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(x=1,S=1,w=8,U=1,G=!1,H=0,z=2*Math.PI){super(0,x,S,w,U,G,H,z),this.type="ConeGeometry",this.parameters={radius:x,height:S,radialSegments:w,heightSegments:U,openEnded:G,thetaStart:H,thetaLength:z}}static fromJSON(x){return new ConeGeometry(x.radius,x.height,x.radialSegments,x.heightSegments,x.openEnded,x.thetaStart,x.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(x=[],S=[],w=1,U=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:x,indices:S,radius:w,detail:U};const G=[],H=[];function subdivideFace(x,S,w,U){const G=U+1,H=[];for(let U=0;U<=G;U++){H[U]=[];const z=x.clone().lerp(w,U/G),j=S.clone().lerp(w,U/G),X=G-U;for(let x=0;x<=X;x++)H[U][x]=0===x&&U===G?z:z.clone().lerp(j,x/X)}for(let x=0;x<G;x++)for(let S=0;S<2*(G-x)-1;S++){const w=Math.floor(S/2);S%2==0?(pushVertex(H[x][w+1]),pushVertex(H[x+1][w]),pushVertex(H[x][w])):(pushVertex(H[x][w+1]),pushVertex(H[x+1][w+1]),pushVertex(H[x+1][w]))}}function pushVertex(x){G.push(x.x,x.y,x.z)}function getVertexByIndex(S,w){const U=3*S;w.x=x[U+0],w.y=x[U+1],w.z=x[U+2]}function correctUV(x,S,w,U){U<0&&1===x.x&&(H[S]=x.x-1),0===w.x&&0===w.z&&(H[S]=U/2/Math.PI+.5)}function azimuth(x){return Math.atan2(x.z,-x.x)}!function subdivide(x){const w=new Vector3,U=new Vector3,G=new Vector3;for(let H=0;H<S.length;H+=3)getVertexByIndex(S[H+0],w),getVertexByIndex(S[H+1],U),getVertexByIndex(S[H+2],G),subdivideFace(w,U,G,x)}(U),function applyRadius(x){const S=new Vector3;for(let w=0;w<G.length;w+=3)S.x=G[w+0],S.y=G[w+1],S.z=G[w+2],S.normalize().multiplyScalar(x),G[w+0]=S.x,G[w+1]=S.y,G[w+2]=S.z}(w),function generateUVs(){const x=new Vector3;for(let w=0;w<G.length;w+=3){x.x=G[w+0],x.y=G[w+1],x.z=G[w+2];const U=azimuth(x)/2/Math.PI+.5,z=(S=x,Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))/Math.PI+.5);H.push(U,1-z)}var S;(function correctUVs(){const x=new Vector3,S=new Vector3,w=new Vector3,U=new Vector3,z=new Vector2,j=new Vector2,X=new Vector2;for(let K=0,q=0;K<G.length;K+=9,q+=6){x.set(G[K+0],G[K+1],G[K+2]),S.set(G[K+3],G[K+4],G[K+5]),w.set(G[K+6],G[K+7],G[K+8]),z.set(H[q+0],H[q+1]),j.set(H[q+2],H[q+3]),X.set(H[q+4],H[q+5]),U.copy(x).add(S).add(w).divideScalar(3);const Y=azimuth(U);correctUV(z,q+0,x,Y),correctUV(j,q+2,S,Y),correctUV(X,q+4,w,Y)}})(),function correctSeam(){for(let x=0;x<H.length;x+=6){const S=H[x+0],w=H[x+2],U=H[x+4],G=Math.max(S,w,U),z=Math.min(S,w,U);G>.9&&z<.1&&(S<.2&&(H[x+0]+=1),w<.2&&(H[x+2]+=1),U<.2&&(H[x+4]+=1))}}()}(),this.setAttribute("position",new Float32BufferAttribute(G,3)),this.setAttribute("normal",new Float32BufferAttribute(G.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(H,2)),0===U?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(x){return new PolyhedronGeometry(x.vertices,x.indices,x.radius,x.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(x=1,S=0){const w=(1+Math.sqrt(5))/2,U=1/w;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-U,-w,0,-U,w,0,U,-w,0,U,w,-U,-w,0,-U,w,0,U,-w,0,U,w,0,-w,0,-U,w,0,-U,-w,0,U,w,0,U],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],x,S),this.type="DodecahedronGeometry",this.parameters={radius:x,detail:S}}static fromJSON(x){return new DodecahedronGeometry(x.radius,x.detail)}}const Qa=new Vector3,es=new Vector3,ts=new Vector3,ns=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(x=null,S=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:x,thresholdAngle:S},null!==x){const w=4,U=Math.pow(10,w),G=Math.cos(Gi*S),H=x.getIndex(),z=x.getAttribute("position"),j=H?H.count:z.count,X=[0,0,0],K=["a","b","c"],q=new Array(3),Y={},Z=[];for(let x=0;x<j;x+=3){H?(X[0]=H.getX(x),X[1]=H.getX(x+1),X[2]=H.getX(x+2)):(X[0]=x,X[1]=x+1,X[2]=x+2);const{a:S,b:w,c:j}=ns;if(S.fromBufferAttribute(z,X[0]),w.fromBufferAttribute(z,X[1]),j.fromBufferAttribute(z,X[2]),ns.getNormal(ts),q[0]=`${Math.round(S.x*U)},${Math.round(S.y*U)},${Math.round(S.z*U)}`,q[1]=`${Math.round(w.x*U)},${Math.round(w.y*U)},${Math.round(w.z*U)}`,q[2]=`${Math.round(j.x*U)},${Math.round(j.y*U)},${Math.round(j.z*U)}`,q[0]!==q[1]&&q[1]!==q[2]&&q[2]!==q[0])for(let x=0;x<3;x++){const S=(x+1)%3,w=q[x],U=q[S],H=ns[K[x]],z=ns[K[S]],j=`${w}_${U}`,J=`${U}_${w}`;J in Y&&Y[J]?(ts.dot(Y[J].normal)<=G&&(Z.push(H.x,H.y,H.z),Z.push(z.x,z.y,z.z)),Y[J]=null):j in Y||(Y[j]={index0:X[x],index1:X[S],normal:ts.clone()})}}for(const x in Y)if(Y[x]){const{index0:S,index1:w}=Y[x];Qa.fromBufferAttribute(z,S),es.fromBufferAttribute(z,w),Z.push(Qa.x,Qa.y,Qa.z),Z.push(es.x,es.y,es.z)}this.setAttribute("position",new Float32BufferAttribute(Z,3))}}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(x,S){const w=this.getUtoTmapping(x);return this.getPoint(w,S)}getPoints(x=5){const S=[];for(let w=0;w<=x;w++)S.push(this.getPoint(w/x));return S}getSpacedPoints(x=5){const S=[];for(let w=0;w<=x;w++)S.push(this.getPointAt(w/x));return S}getLength(){const x=this.getLengths();return x[x.length-1]}getLengths(x=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===x+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const S=[];let w,U=this.getPoint(0),G=0;S.push(0);for(let H=1;H<=x;H++)w=this.getPoint(H/x),G+=w.distanceTo(U),S.push(G),U=w;return this.cacheArcLengths=S,S}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(x,S){const w=this.getLengths();let U=0;const G=w.length;let H;H=S||x*w[G-1];let z,j=0,X=G-1;for(;j<=X;)if(U=Math.floor(j+(X-j)/2),z=w[U]-H,z<0)j=U+1;else{if(!(z>0)){X=U;break}X=U-1}if(U=X,w[U]===H)return U/(G-1);const K=w[U];return(U+(H-K)/(w[U+1]-K))/(G-1)}getTangent(x,S){const w=1e-4;let U=x-w,G=x+w;U<0&&(U=0),G>1&&(G=1);const H=this.getPoint(U),z=this.getPoint(G),j=S||(H.isVector2?new Vector2:new Vector3);return j.copy(z).sub(H).normalize(),j}getTangentAt(x,S){const w=this.getUtoTmapping(x);return this.getTangent(w,S)}computeFrenetFrames(x,S){const w=new Vector3,U=[],G=[],H=[],z=new Vector3,j=new Matrix4;for(let S=0;S<=x;S++){const w=S/x;U[S]=this.getTangentAt(w,new Vector3)}G[0]=new Vector3,H[0]=new Vector3;let X=Number.MAX_VALUE;const K=Math.abs(U[0].x),q=Math.abs(U[0].y),Y=Math.abs(U[0].z);K<=X&&(X=K,w.set(1,0,0)),q<=X&&(X=q,w.set(0,1,0)),Y<=X&&w.set(0,0,1),z.crossVectors(U[0],w).normalize(),G[0].crossVectors(U[0],z),H[0].crossVectors(U[0],G[0]);for(let S=1;S<=x;S++){if(G[S]=G[S-1].clone(),H[S]=H[S-1].clone(),z.crossVectors(U[S-1],U[S]),z.length()>Number.EPSILON){z.normalize();const x=Math.acos(clamp(U[S-1].dot(U[S]),-1,1));G[S].applyMatrix4(j.makeRotationAxis(z,x))}H[S].crossVectors(U[S],G[S])}if(!0===S){let S=Math.acos(clamp(G[0].dot(G[x]),-1,1));S/=x,U[0].dot(z.crossVectors(G[0],G[x]))>0&&(S=-S);for(let w=1;w<=x;w++)G[w].applyMatrix4(j.makeRotationAxis(U[w],S*w)),H[w].crossVectors(U[w],G[w])}return{tangents:U,normals:G,binormals:H}}clone(){return(new this.constructor).copy(this)}copy(x){return this.arcLengthDivisions=x.arcLengthDivisions,this}toJSON(){const x={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return x.arcLengthDivisions=this.arcLengthDivisions,x.type=this.type,x}fromJSON(x){return this.arcLengthDivisions=x.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(x=0,S=0,w=1,U=1,G=0,H=2*Math.PI,z=!1,j=0){super(),this.type="EllipseCurve",this.aX=x,this.aY=S,this.xRadius=w,this.yRadius=U,this.aStartAngle=G,this.aEndAngle=H,this.aClockwise=z,this.aRotation=j}getPoint(x,S){const w=S||new Vector2,U=2*Math.PI;let G=this.aEndAngle-this.aStartAngle;const H=Math.abs(G)<Number.EPSILON;for(;G<0;)G+=U;for(;G>U;)G-=U;G<Number.EPSILON&&(G=H?0:U),!0!==this.aClockwise||H||(G===U?G=-U:G-=U);const z=this.aStartAngle+x*G;let j=this.aX+this.xRadius*Math.cos(z),X=this.aY+this.yRadius*Math.sin(z);if(0!==this.aRotation){const x=Math.cos(this.aRotation),S=Math.sin(this.aRotation),w=j-this.aX,U=X-this.aY;j=w*x-U*S+this.aX,X=w*S+U*x+this.aY}return w.set(j,X)}copy(x){return super.copy(x),this.aX=x.aX,this.aY=x.aY,this.xRadius=x.xRadius,this.yRadius=x.yRadius,this.aStartAngle=x.aStartAngle,this.aEndAngle=x.aEndAngle,this.aClockwise=x.aClockwise,this.aRotation=x.aRotation,this}toJSON(){const x=super.toJSON();return x.aX=this.aX,x.aY=this.aY,x.xRadius=this.xRadius,x.yRadius=this.yRadius,x.aStartAngle=this.aStartAngle,x.aEndAngle=this.aEndAngle,x.aClockwise=this.aClockwise,x.aRotation=this.aRotation,x}fromJSON(x){return super.fromJSON(x),this.aX=x.aX,this.aY=x.aY,this.xRadius=x.xRadius,this.yRadius=x.yRadius,this.aStartAngle=x.aStartAngle,this.aEndAngle=x.aEndAngle,this.aClockwise=x.aClockwise,this.aRotation=x.aRotation,this}}EllipseCurve.prototype.isEllipseCurve=!0;class ArcCurve extends EllipseCurve{constructor(x,S,w,U,G,H){super(x,S,w,w,U,G,H),this.type="ArcCurve"}}function CubicPoly(){let x=0,S=0,w=0,U=0;function init(G,H,z,j){x=G,S=z,w=-3*G+3*H-2*z-j,U=2*G-2*H+z+j}return{initCatmullRom:function(x,S,w,U,G){init(S,w,G*(w-x),G*(U-S))},initNonuniformCatmullRom:function(x,S,w,U,G,H,z){let j=(S-x)/G-(w-x)/(G+H)+(w-S)/H,X=(w-S)/H-(U-S)/(H+z)+(U-w)/z;j*=H,X*=H,init(S,w,j,X)},calc:function(G){const H=G*G;return x+S*G+w*H+U*(H*G)}}}ArcCurve.prototype.isArcCurve=!0;const is=new Vector3,rs=new CubicPoly,os=new CubicPoly,as=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(x=[],S=!1,w="centripetal",U=.5){super(),this.type="CatmullRomCurve3",this.points=x,this.closed=S,this.curveType=w,this.tension=U}getPoint(x,S=new Vector3){const w=S,U=this.points,G=U.length,H=(G-(this.closed?0:1))*x;let z,j,X=Math.floor(H),K=H-X;this.closed?X+=X>0?0:(Math.floor(Math.abs(X)/G)+1)*G:0===K&&X===G-1&&(X=G-2,K=1),this.closed||X>0?z=U[(X-1)%G]:(is.subVectors(U[0],U[1]).add(U[0]),z=is);const q=U[X%G],Y=U[(X+1)%G];if(this.closed||X+2<G?j=U[(X+2)%G]:(is.subVectors(U[G-1],U[G-2]).add(U[G-1]),j=is),"centripetal"===this.curveType||"chordal"===this.curveType){const x="chordal"===this.curveType?.5:.25;let S=Math.pow(z.distanceToSquared(q),x),w=Math.pow(q.distanceToSquared(Y),x),U=Math.pow(Y.distanceToSquared(j),x);w<1e-4&&(w=1),S<1e-4&&(S=w),U<1e-4&&(U=w),rs.initNonuniformCatmullRom(z.x,q.x,Y.x,j.x,S,w,U),os.initNonuniformCatmullRom(z.y,q.y,Y.y,j.y,S,w,U),as.initNonuniformCatmullRom(z.z,q.z,Y.z,j.z,S,w,U)}else"catmullrom"===this.curveType&&(rs.initCatmullRom(z.x,q.x,Y.x,j.x,this.tension),os.initCatmullRom(z.y,q.y,Y.y,j.y,this.tension),as.initCatmullRom(z.z,q.z,Y.z,j.z,this.tension));return w.set(rs.calc(K),os.calc(K),as.calc(K)),w}copy(x){super.copy(x),this.points=[];for(let S=0,w=x.points.length;S<w;S++){const w=x.points[S];this.points.push(w.clone())}return this.closed=x.closed,this.curveType=x.curveType,this.tension=x.tension,this}toJSON(){const x=super.toJSON();x.points=[];for(let S=0,w=this.points.length;S<w;S++){const w=this.points[S];x.points.push(w.toArray())}return x.closed=this.closed,x.curveType=this.curveType,x.tension=this.tension,x}fromJSON(x){super.fromJSON(x),this.points=[];for(let S=0,w=x.points.length;S<w;S++){const w=x.points[S];this.points.push((new Vector3).fromArray(w))}return this.closed=x.closed,this.curveType=x.curveType,this.tension=x.tension,this}}function CatmullRom(x,S,w,U,G){const H=.5*(U-S),z=.5*(G-w),j=x*x;return(2*w-2*U+H+z)*(x*j)+(-3*w+3*U-2*H-z)*j+H*x+w}function QuadraticBezier(x,S,w,U){return function QuadraticBezierP0(x,S){const w=1-x;return w*w*S}(x,S)+function QuadraticBezierP1(x,S){return 2*(1-x)*x*S}(x,w)+function QuadraticBezierP2(x,S){return x*x*S}(x,U)}function CubicBezier(x,S,w,U,G){return function CubicBezierP0(x,S){const w=1-x;return w*w*w*S}(x,S)+function CubicBezierP1(x,S){const w=1-x;return 3*w*w*x*S}(x,w)+function CubicBezierP2(x,S){return 3*(1-x)*x*x*S}(x,U)+function CubicBezierP3(x,S){return x*x*x*S}(x,G)}CatmullRomCurve3.prototype.isCatmullRomCurve3=!0;class CubicBezierCurve extends Curve{constructor(x=new Vector2,S=new Vector2,w=new Vector2,U=new Vector2){super(),this.type="CubicBezierCurve",this.v0=x,this.v1=S,this.v2=w,this.v3=U}getPoint(x,S=new Vector2){const w=S,U=this.v0,G=this.v1,H=this.v2,z=this.v3;return w.set(CubicBezier(x,U.x,G.x,H.x,z.x),CubicBezier(x,U.y,G.y,H.y,z.y)),w}copy(x){return super.copy(x),this.v0.copy(x.v0),this.v1.copy(x.v1),this.v2.copy(x.v2),this.v3.copy(x.v3),this}toJSON(){const x=super.toJSON();return x.v0=this.v0.toArray(),x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x.v3=this.v3.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v0.fromArray(x.v0),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this.v3.fromArray(x.v3),this}}CubicBezierCurve.prototype.isCubicBezierCurve=!0;class CubicBezierCurve3 extends Curve{constructor(x=new Vector3,S=new Vector3,w=new Vector3,U=new Vector3){super(),this.type="CubicBezierCurve3",this.v0=x,this.v1=S,this.v2=w,this.v3=U}getPoint(x,S=new Vector3){const w=S,U=this.v0,G=this.v1,H=this.v2,z=this.v3;return w.set(CubicBezier(x,U.x,G.x,H.x,z.x),CubicBezier(x,U.y,G.y,H.y,z.y),CubicBezier(x,U.z,G.z,H.z,z.z)),w}copy(x){return super.copy(x),this.v0.copy(x.v0),this.v1.copy(x.v1),this.v2.copy(x.v2),this.v3.copy(x.v3),this}toJSON(){const x=super.toJSON();return x.v0=this.v0.toArray(),x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x.v3=this.v3.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v0.fromArray(x.v0),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this.v3.fromArray(x.v3),this}}CubicBezierCurve3.prototype.isCubicBezierCurve3=!0;class LineCurve extends Curve{constructor(x=new Vector2,S=new Vector2){super(),this.type="LineCurve",this.v1=x,this.v2=S}getPoint(x,S=new Vector2){const w=S;return 1===x?w.copy(this.v2):(w.copy(this.v2).sub(this.v1),w.multiplyScalar(x).add(this.v1)),w}getPointAt(x,S){return this.getPoint(x,S)}getTangent(x,S){const w=S||new Vector2;return w.copy(this.v2).sub(this.v1).normalize(),w}copy(x){return super.copy(x),this.v1.copy(x.v1),this.v2.copy(x.v2),this}toJSON(){const x=super.toJSON();return x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this}}LineCurve.prototype.isLineCurve=!0;class LineCurve3 extends Curve{constructor(x=new Vector3,S=new Vector3){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=x,this.v2=S}getPoint(x,S=new Vector3){const w=S;return 1===x?w.copy(this.v2):(w.copy(this.v2).sub(this.v1),w.multiplyScalar(x).add(this.v1)),w}getPointAt(x,S){return this.getPoint(x,S)}copy(x){return super.copy(x),this.v1.copy(x.v1),this.v2.copy(x.v2),this}toJSON(){const x=super.toJSON();return x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this}}class QuadraticBezierCurve extends Curve{constructor(x=new Vector2,S=new Vector2,w=new Vector2){super(),this.type="QuadraticBezierCurve",this.v0=x,this.v1=S,this.v2=w}getPoint(x,S=new Vector2){const w=S,U=this.v0,G=this.v1,H=this.v2;return w.set(QuadraticBezier(x,U.x,G.x,H.x),QuadraticBezier(x,U.y,G.y,H.y)),w}copy(x){return super.copy(x),this.v0.copy(x.v0),this.v1.copy(x.v1),this.v2.copy(x.v2),this}toJSON(){const x=super.toJSON();return x.v0=this.v0.toArray(),x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v0.fromArray(x.v0),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this}}QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0;class QuadraticBezierCurve3 extends Curve{constructor(x=new Vector3,S=new Vector3,w=new Vector3){super(),this.type="QuadraticBezierCurve3",this.v0=x,this.v1=S,this.v2=w}getPoint(x,S=new Vector3){const w=S,U=this.v0,G=this.v1,H=this.v2;return w.set(QuadraticBezier(x,U.x,G.x,H.x),QuadraticBezier(x,U.y,G.y,H.y),QuadraticBezier(x,U.z,G.z,H.z)),w}copy(x){return super.copy(x),this.v0.copy(x.v0),this.v1.copy(x.v1),this.v2.copy(x.v2),this}toJSON(){const x=super.toJSON();return x.v0=this.v0.toArray(),x.v1=this.v1.toArray(),x.v2=this.v2.toArray(),x}fromJSON(x){return super.fromJSON(x),this.v0.fromArray(x.v0),this.v1.fromArray(x.v1),this.v2.fromArray(x.v2),this}}QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0;class SplineCurve extends Curve{constructor(x=[]){super(),this.type="SplineCurve",this.points=x}getPoint(x,S=new Vector2){const w=S,U=this.points,G=(U.length-1)*x,H=Math.floor(G),z=G-H,j=U[0===H?H:H-1],X=U[H],K=U[H>U.length-2?U.length-1:H+1],q=U[H>U.length-3?U.length-1:H+2];return w.set(CatmullRom(z,j.x,X.x,K.x,q.x),CatmullRom(z,j.y,X.y,K.y,q.y)),w}copy(x){super.copy(x),this.points=[];for(let S=0,w=x.points.length;S<w;S++){const w=x.points[S];this.points.push(w.clone())}return this}toJSON(){const x=super.toJSON();x.points=[];for(let S=0,w=this.points.length;S<w;S++){const w=this.points[S];x.points.push(w.toArray())}return x}fromJSON(x){super.fromJSON(x),this.points=[];for(let S=0,w=x.points.length;S<w;S++){const w=x.points[S];this.points.push((new Vector2).fromArray(w))}return this}}SplineCurve.prototype.isSplineCurve=!0;var ss=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(x){this.curves.push(x)}closePath(){const x=this.curves[0].getPoint(0),S=this.curves[this.curves.length-1].getPoint(1);x.equals(S)||this.curves.push(new LineCurve(S,x))}getPoint(x,S){const w=x*this.getLength(),U=this.getCurveLengths();let G=0;for(;G<U.length;){if(U[G]>=w){const x=U[G]-w,H=this.curves[G],z=H.getLength(),j=0===z?0:1-x/z;return H.getPointAt(j,S)}G++}return null}getLength(){const x=this.getCurveLengths();return x[x.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const x=[];let S=0;for(let w=0,U=this.curves.length;w<U;w++)S+=this.curves[w].getLength(),x.push(S);return this.cacheLengths=x,x}getSpacedPoints(x=40){const S=[];for(let w=0;w<=x;w++)S.push(this.getPoint(w/x));return this.autoClose&&S.push(S[0]),S}getPoints(x=12){const S=[];let w;for(let U=0,G=this.curves;U<G.length;U++){const H=G[U],z=H&&H.isEllipseCurve?2*x:H&&(H.isLineCurve||H.isLineCurve3)?1:H&&H.isSplineCurve?x*H.points.length:x,j=H.getPoints(z);for(let x=0;x<j.length;x++){const U=j[x];w&&w.equals(U)||(S.push(U),w=U)}}return this.autoClose&&S.length>1&&!S[S.length-1].equals(S[0])&&S.push(S[0]),S}copy(x){super.copy(x),this.curves=[];for(let S=0,w=x.curves.length;S<w;S++){const w=x.curves[S];this.curves.push(w.clone())}return this.autoClose=x.autoClose,this}toJSON(){const x=super.toJSON();x.autoClose=this.autoClose,x.curves=[];for(let S=0,w=this.curves.length;S<w;S++){const w=this.curves[S];x.curves.push(w.toJSON())}return x}fromJSON(x){super.fromJSON(x),this.autoClose=x.autoClose,this.curves=[];for(let S=0,w=x.curves.length;S<w;S++){const w=x.curves[S];this.curves.push((new ss[w.type]).fromJSON(w))}return this}}class Path extends CurvePath{constructor(x){super(),this.type="Path",this.currentPoint=new Vector2,x&&this.setFromPoints(x)}setFromPoints(x){this.moveTo(x[0].x,x[0].y);for(let S=1,w=x.length;S<w;S++)this.lineTo(x[S].x,x[S].y);return this}moveTo(x,S){return this.currentPoint.set(x,S),this}lineTo(x,S){const w=new LineCurve(this.currentPoint.clone(),new Vector2(x,S));return this.curves.push(w),this.currentPoint.set(x,S),this}quadraticCurveTo(x,S,w,U){const G=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(x,S),new Vector2(w,U));return this.curves.push(G),this.currentPoint.set(w,U),this}bezierCurveTo(x,S,w,U,G,H){const z=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(x,S),new Vector2(w,U),new Vector2(G,H));return this.curves.push(z),this.currentPoint.set(G,H),this}splineThru(x){const S=[this.currentPoint.clone()].concat(x),w=new SplineCurve(S);return this.curves.push(w),this.currentPoint.copy(x[x.length-1]),this}arc(x,S,w,U,G,H){const z=this.currentPoint.x,j=this.currentPoint.y;return this.absarc(x+z,S+j,w,U,G,H),this}absarc(x,S,w,U,G,H){return this.absellipse(x,S,w,w,U,G,H),this}ellipse(x,S,w,U,G,H,z,j){const X=this.currentPoint.x,K=this.currentPoint.y;return this.absellipse(x+X,S+K,w,U,G,H,z,j),this}absellipse(x,S,w,U,G,H,z,j){const X=new EllipseCurve(x,S,w,U,G,H,z,j);if(this.curves.length>0){const x=X.getPoint(0);x.equals(this.currentPoint)||this.lineTo(x.x,x.y)}this.curves.push(X);const K=X.getPoint(1);return this.currentPoint.copy(K),this}copy(x){return super.copy(x),this.currentPoint.copy(x.currentPoint),this}toJSON(){const x=super.toJSON();return x.currentPoint=this.currentPoint.toArray(),x}fromJSON(x){return super.fromJSON(x),this.currentPoint.fromArray(x.currentPoint),this}}class Shape extends Path{constructor(x){super(x),this.uuid=generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(x){const S=[];for(let w=0,U=this.holes.length;w<U;w++)S[w]=this.holes[w].getPoints(x);return S}extractPoints(x){return{shape:this.getPoints(x),holes:this.getPointsHoles(x)}}copy(x){super.copy(x),this.holes=[];for(let S=0,w=x.holes.length;S<w;S++){const w=x.holes[S];this.holes.push(w.clone())}return this}toJSON(){const x=super.toJSON();x.uuid=this.uuid,x.holes=[];for(let S=0,w=this.holes.length;S<w;S++){const w=this.holes[S];x.holes.push(w.toJSON())}return x}fromJSON(x){super.fromJSON(x),this.uuid=x.uuid,this.holes=[];for(let S=0,w=x.holes.length;S<w;S++){const w=x.holes[S];this.holes.push((new Path).fromJSON(w))}return this}}const Earcut_triangulate=function(x,S,w=2){const U=S&&S.length,G=U?S[0]*w:x.length;let H=linkedList(x,0,G,w,!0);const z=[];if(!H||H.next===H.prev)return z;let j,X,K,q,Y,Z,J;if(U&&(H=function eliminateHoles(x,S,w,U){const G=[];let H,z,j,X,K;for(H=0,z=S.length;H<z;H++)j=S[H]*U,X=H<z-1?S[H+1]*U:x.length,K=linkedList(x,j,X,U,!1),K===K.next&&(K.steiner=!0),G.push(getLeftmost(K));for(G.sort(compareX),H=0;H<G.length;H++)eliminateHole(G[H],w),w=filterPoints(w,w.next);return w}(x,S,H,w)),x.length>80*w){j=K=x[0],X=q=x[1];for(let S=w;S<G;S+=w)Y=x[S],Z=x[S+1],Y<j&&(j=Y),Z<X&&(X=Z),Y>K&&(K=Y),Z>q&&(q=Z);J=Math.max(K-j,q-X),J=0!==J?1/J:0}return earcutLinked(H,z,w,j,X,J),z};function linkedList(x,S,w,U,G){let H,z;if(G===function signedArea(x,S,w,U){let G=0;for(let H=S,z=w-U;H<w;H+=U)G+=(x[z]-x[H])*(x[H+1]+x[z+1]),z=H;return G}(x,S,w,U)>0)for(H=S;H<w;H+=U)z=insertNode(H,x[H],x[H+1],z);else for(H=w-U;H>=S;H-=U)z=insertNode(H,x[H],x[H+1],z);return z&&equals(z,z.next)&&(removeNode(z),z=z.next),z}function filterPoints(x,S){if(!x)return x;S||(S=x);let w,U=x;do{if(w=!1,U.steiner||!equals(U,U.next)&&0!==area(U.prev,U,U.next))U=U.next;else{if(removeNode(U),U=S=U.prev,U===U.next)break;w=!0}}while(w||U!==S);return S}function earcutLinked(x,S,w,U,G,H,z){if(!x)return;!z&&H&&function indexCurve(x,S,w,U){let G=x;do{null===G.z&&(G.z=zOrder(G.x,G.y,S,w,U)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next}while(G!==x);G.prevZ.nextZ=null,G.prevZ=null,function sortLinked(x){let S,w,U,G,H,z,j,X,K=1;do{for(w=x,x=null,H=null,z=0;w;){for(z++,U=w,j=0,S=0;S<K&&(j++,U=U.nextZ,U);S++);for(X=K;j>0||X>0&&U;)0!==j&&(0===X||!U||w.z<=U.z)?(G=w,w=w.nextZ,j--):(G=U,U=U.nextZ,X--),H?H.nextZ=G:x=G,G.prevZ=H,H=G;w=U}H.nextZ=null,K*=2}while(z>1);return x}(G)}(x,U,G,H);let j,X,K=x;for(;x.prev!==x.next;)if(j=x.prev,X=x.next,H?isEarHashed(x,U,G,H):isEar(x))S.push(j.i/w),S.push(x.i/w),S.push(X.i/w),removeNode(x),x=X.next,K=X.next;else if((x=X)===K){z?1===z?earcutLinked(x=cureLocalIntersections(filterPoints(x),S,w),S,w,U,G,H,2):2===z&&splitEarcut(x,S,w,U,G,H):earcutLinked(filterPoints(x),S,w,U,G,H,1);break}}function isEar(x){const S=x.prev,w=x,U=x.next;if(area(S,w,U)>=0)return!1;let G=x.next.next;for(;G!==x.prev;){if(pointInTriangle(S.x,S.y,w.x,w.y,U.x,U.y,G.x,G.y)&&area(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function isEarHashed(x,S,w,U){const G=x.prev,H=x,z=x.next;if(area(G,H,z)>=0)return!1;const j=G.x<H.x?G.x<z.x?G.x:z.x:H.x<z.x?H.x:z.x,X=G.y<H.y?G.y<z.y?G.y:z.y:H.y<z.y?H.y:z.y,K=G.x>H.x?G.x>z.x?G.x:z.x:H.x>z.x?H.x:z.x,q=G.y>H.y?G.y>z.y?G.y:z.y:H.y>z.y?H.y:z.y,Y=zOrder(j,X,S,w,U),Z=zOrder(K,q,S,w,U);let J=x.prevZ,Q=x.nextZ;for(;J&&J.z>=Y&&Q&&Q.z<=Z;){if(J!==x.prev&&J!==x.next&&pointInTriangle(G.x,G.y,H.x,H.y,z.x,z.y,J.x,J.y)&&area(J.prev,J,J.next)>=0)return!1;if(J=J.prevZ,Q!==x.prev&&Q!==x.next&&pointInTriangle(G.x,G.y,H.x,H.y,z.x,z.y,Q.x,Q.y)&&area(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}for(;J&&J.z>=Y;){if(J!==x.prev&&J!==x.next&&pointInTriangle(G.x,G.y,H.x,H.y,z.x,z.y,J.x,J.y)&&area(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;Q&&Q.z<=Z;){if(Q!==x.prev&&Q!==x.next&&pointInTriangle(G.x,G.y,H.x,H.y,z.x,z.y,Q.x,Q.y)&&area(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function cureLocalIntersections(x,S,w){let U=x;do{const G=U.prev,H=U.next.next;!equals(G,H)&&intersects(G,U,U.next,H)&&locallyInside(G,H)&&locallyInside(H,G)&&(S.push(G.i/w),S.push(U.i/w),S.push(H.i/w),removeNode(U),removeNode(U.next),U=x=H),U=U.next}while(U!==x);return filterPoints(U)}function splitEarcut(x,S,w,U,G,H){let z=x;do{let x=z.next.next;for(;x!==z.prev;){if(z.i!==x.i&&isValidDiagonal(z,x)){let j=splitPolygon(z,x);return z=filterPoints(z,z.next),j=filterPoints(j,j.next),earcutLinked(z,S,w,U,G,H),void earcutLinked(j,S,w,U,G,H)}x=x.next}z=z.next}while(z!==x)}function compareX(x,S){return x.x-S.x}function eliminateHole(x,S){if(S=function findHoleBridge(x,S){let w=S;const U=x.x,G=x.y;let H,z=-1/0;do{if(G<=w.y&&G>=w.next.y&&w.next.y!==w.y){const x=w.x+(G-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(x<=U&&x>z){if(z=x,x===U){if(G===w.y)return w;if(G===w.next.y)return w.next}H=w.x<w.next.x?w:w.next}}w=w.next}while(w!==S);if(!H)return null;if(U===z)return H;const j=H,X=H.x,K=H.y;let q,Y=1/0;w=H;do{U>=w.x&&w.x>=X&&U!==w.x&&pointInTriangle(G<K?U:z,G,X,K,G<K?z:U,G,w.x,w.y)&&(q=Math.abs(G-w.y)/(U-w.x),locallyInside(w,x)&&(q<Y||q===Y&&(w.x>H.x||w.x===H.x&&sectorContainsSector(H,w)))&&(H=w,Y=q)),w=w.next}while(w!==j);return H}(x,S),S){const w=splitPolygon(S,x);filterPoints(S,S.next),filterPoints(w,w.next)}}function sectorContainsSector(x,S){return area(x.prev,x,S.prev)<0&&area(S.next,x,x.next)<0}function zOrder(x,S,w,U,G){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-w)*G)|x<<8))|x<<4))|x<<2))|x<<1))|(S=1431655765&((S=858993459&((S=252645135&((S=16711935&((S=32767*(S-U)*G)|S<<8))|S<<4))|S<<2))|S<<1))<<1}function getLeftmost(x){let S=x,w=x;do{(S.x<w.x||S.x===w.x&&S.y<w.y)&&(w=S),S=S.next}while(S!==x);return w}function pointInTriangle(x,S,w,U,G,H,z,j){return(G-z)*(S-j)-(x-z)*(H-j)>=0&&(x-z)*(U-j)-(w-z)*(S-j)>=0&&(w-z)*(H-j)-(G-z)*(U-j)>=0}function isValidDiagonal(x,S){return x.next.i!==S.i&&x.prev.i!==S.i&&!function intersectsPolygon(x,S){let w=x;do{if(w.i!==x.i&&w.next.i!==x.i&&w.i!==S.i&&w.next.i!==S.i&&intersects(w,w.next,x,S))return!0;w=w.next}while(w!==x);return!1}(x,S)&&(locallyInside(x,S)&&locallyInside(S,x)&&function middleInside(x,S){let w=x,U=!1;const G=(x.x+S.x)/2,H=(x.y+S.y)/2;do{w.y>H!=w.next.y>H&&w.next.y!==w.y&&G<(w.next.x-w.x)*(H-w.y)/(w.next.y-w.y)+w.x&&(U=!U),w=w.next}while(w!==x);return U}(x,S)&&(area(x.prev,x,S.prev)||area(x,S.prev,S))||equals(x,S)&&area(x.prev,x,x.next)>0&&area(S.prev,S,S.next)>0)}function area(x,S,w){return(S.y-x.y)*(w.x-S.x)-(S.x-x.x)*(w.y-S.y)}function equals(x,S){return x.x===S.x&&x.y===S.y}function intersects(x,S,w,U){const G=sign(area(x,S,w)),H=sign(area(x,S,U)),z=sign(area(w,U,x)),j=sign(area(w,U,S));return G!==H&&z!==j||(!(0!==G||!onSegment(x,w,S))||(!(0!==H||!onSegment(x,U,S))||(!(0!==z||!onSegment(w,x,U))||!(0!==j||!onSegment(w,S,U)))))}function onSegment(x,S,w){return S.x<=Math.max(x.x,w.x)&&S.x>=Math.min(x.x,w.x)&&S.y<=Math.max(x.y,w.y)&&S.y>=Math.min(x.y,w.y)}function sign(x){return x>0?1:x<0?-1:0}function locallyInside(x,S){return area(x.prev,x,x.next)<0?area(x,S,x.next)>=0&&area(x,x.prev,S)>=0:area(x,S,x.prev)<0||area(x,x.next,S)<0}function splitPolygon(x,S){const w=new Node(x.i,x.x,x.y),U=new Node(S.i,S.x,S.y),G=x.next,H=S.prev;return x.next=S,S.prev=x,w.next=G,G.prev=w,U.next=w,w.prev=U,H.next=U,U.prev=H,U}function insertNode(x,S,w,U){const G=new Node(x,S,w);return U?(G.next=U.next,G.prev=U,U.next.prev=G,U.next=G):(G.prev=G,G.next=G),G}function removeNode(x){x.next.prev=x.prev,x.prev.next=x.next,x.prevZ&&(x.prevZ.nextZ=x.nextZ),x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function Node(x,S,w){this.i=x,this.x=S,this.y=w,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class ShapeUtils{static area(x){const S=x.length;let w=0;for(let U=S-1,G=0;G<S;U=G++)w+=x[U].x*x[G].y-x[G].x*x[U].y;return.5*w}static isClockWise(x){return ShapeUtils.area(x)<0}static triangulateShape(x,S){const w=[],U=[],G=[];removeDupEndPts(x),addContour(w,x);let H=x.length;S.forEach(removeDupEndPts);for(let x=0;x<S.length;x++)U.push(H),H+=S[x].length,addContour(w,S[x]);const z=Earcut_triangulate(w,U);for(let x=0;x<z.length;x+=3)G.push(z.slice(x,x+3));return G}}function removeDupEndPts(x){const S=x.length;S>2&&x[S-1].equals(x[0])&&x.pop()}function addContour(x,S){for(let w=0;w<S.length;w++)x.push(S[w].x),x.push(S[w].y)}class ExtrudeGeometry extends BufferGeometry{constructor(x=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),S={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:x,options:S},x=Array.isArray(x)?x:[x];const w=this,U=[],G=[];for(let S=0,w=x.length;S<w;S++){addShape(x[S])}function addShape(x){const H=[],z=void 0!==S.curveSegments?S.curveSegments:12,j=void 0!==S.steps?S.steps:1;let X=void 0!==S.depth?S.depth:1,K=void 0===S.bevelEnabled||S.bevelEnabled,q=void 0!==S.bevelThickness?S.bevelThickness:.2,Y=void 0!==S.bevelSize?S.bevelSize:q-.1,Z=void 0!==S.bevelOffset?S.bevelOffset:0,J=void 0!==S.bevelSegments?S.bevelSegments:3;const Q=S.extrudePath,ee=void 0!==S.UVGenerator?S.UVGenerator:ls;void 0!==S.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),X=S.amount);let te,ne,ie,re,oe,ae=!1;Q&&(te=Q.getSpacedPoints(j),ae=!0,K=!1,ne=Q.computeFrenetFrames(j,!1),ie=new Vector3,re=new Vector3,oe=new Vector3),K||(J=0,q=0,Y=0,Z=0);const se=x.extractPoints(z);let le=se.shape;const ce=se.holes;if(!ShapeUtils.isClockWise(le)){le=le.reverse();for(let x=0,S=ce.length;x<S;x++){const S=ce[x];ShapeUtils.isClockWise(S)&&(ce[x]=S.reverse())}}const ue=ShapeUtils.triangulateShape(le,ce),he=le;for(let x=0,S=ce.length;x<S;x++){const S=ce[x];le=le.concat(S)}function scalePt2(x,S,w){return S||console.error("THREE.ExtrudeGeometry: vec does not exist"),S.clone().multiplyScalar(w).add(x)}const de=le.length,pe=ue.length;function getBevelVec(x,S,w){let U,G,H;const z=x.x-S.x,j=x.y-S.y,X=w.x-x.x,K=w.y-x.y,q=z*z+j*j,Y=z*K-j*X;if(Math.abs(Y)>Number.EPSILON){const Y=Math.sqrt(q),Z=Math.sqrt(X*X+K*K),J=S.x-j/Y,Q=S.y+z/Y,ee=((w.x-K/Z-J)*K-(w.y+X/Z-Q)*X)/(z*K-j*X);U=J+z*ee-x.x,G=Q+j*ee-x.y;const te=U*U+G*G;if(te<=2)return new Vector2(U,G);H=Math.sqrt(te/2)}else{let x=!1;z>Number.EPSILON?X>Number.EPSILON&&(x=!0):z<-Number.EPSILON?X<-Number.EPSILON&&(x=!0):Math.sign(j)===Math.sign(K)&&(x=!0),x?(U=-j,G=z,H=Math.sqrt(q)):(U=z,G=j,H=Math.sqrt(q/2))}return new Vector2(U/H,G/H)}const me=[];for(let x=0,S=he.length,w=S-1,U=x+1;x<S;x++,w++,U++)w===S&&(w=0),U===S&&(U=0),me[x]=getBevelVec(he[x],he[w],he[U]);const fe=[];let ge,ve=me.concat();for(let x=0,S=ce.length;x<S;x++){const S=ce[x];ge=[];for(let x=0,w=S.length,U=w-1,G=x+1;x<w;x++,U++,G++)U===w&&(U=0),G===w&&(G=0),ge[x]=getBevelVec(S[x],S[U],S[G]);fe.push(ge),ve=ve.concat(ge)}for(let x=0;x<J;x++){const S=x/J,w=q*Math.cos(S*Math.PI/2),U=Y*Math.sin(S*Math.PI/2)+Z;for(let x=0,S=he.length;x<S;x++){const S=scalePt2(he[x],me[x],U);v(S.x,S.y,-w)}for(let x=0,S=ce.length;x<S;x++){const S=ce[x];ge=fe[x];for(let x=0,G=S.length;x<G;x++){const G=scalePt2(S[x],ge[x],U);v(G.x,G.y,-w)}}}const _e=Y+Z;for(let x=0;x<de;x++){const S=K?scalePt2(le[x],ve[x],_e):le[x];ae?(re.copy(ne.normals[0]).multiplyScalar(S.x),ie.copy(ne.binormals[0]).multiplyScalar(S.y),oe.copy(te[0]).add(re).add(ie),v(oe.x,oe.y,oe.z)):v(S.x,S.y,0)}for(let x=1;x<=j;x++)for(let S=0;S<de;S++){const w=K?scalePt2(le[S],ve[S],_e):le[S];ae?(re.copy(ne.normals[x]).multiplyScalar(w.x),ie.copy(ne.binormals[x]).multiplyScalar(w.y),oe.copy(te[x]).add(re).add(ie),v(oe.x,oe.y,oe.z)):v(w.x,w.y,X/j*x)}for(let x=J-1;x>=0;x--){const S=x/J,w=q*Math.cos(S*Math.PI/2),U=Y*Math.sin(S*Math.PI/2)+Z;for(let x=0,S=he.length;x<S;x++){const S=scalePt2(he[x],me[x],U);v(S.x,S.y,X+w)}for(let x=0,S=ce.length;x<S;x++){const S=ce[x];ge=fe[x];for(let x=0,G=S.length;x<G;x++){const G=scalePt2(S[x],ge[x],U);ae?v(G.x,G.y+te[j-1].y,te[j-1].x+w):v(G.x,G.y,X+w)}}}function sidewalls(x,S){let w=x.length;for(;--w>=0;){const U=w;let G=w-1;G<0&&(G=x.length-1);for(let x=0,w=j+2*J;x<w;x++){const w=de*x,H=de*(x+1);f4(S+U+w,S+G+w,S+G+H,S+U+H)}}}function v(x,S,w){H.push(x),H.push(S),H.push(w)}function f3(x,S,G){addVertex(x),addVertex(S),addVertex(G);const H=U.length/3,z=ee.generateTopUV(w,U,H-3,H-2,H-1);addUV(z[0]),addUV(z[1]),addUV(z[2])}function f4(x,S,G,H){addVertex(x),addVertex(S),addVertex(H),addVertex(S),addVertex(G),addVertex(H);const z=U.length/3,j=ee.generateSideWallUV(w,U,z-6,z-3,z-2,z-1);addUV(j[0]),addUV(j[1]),addUV(j[3]),addUV(j[1]),addUV(j[2]),addUV(j[3])}function addVertex(x){U.push(H[3*x+0]),U.push(H[3*x+1]),U.push(H[3*x+2])}function addUV(x){G.push(x.x),G.push(x.y)}!function buildLidFaces(){const x=U.length/3;if(K){let x=0,S=de*x;for(let x=0;x<pe;x++){const w=ue[x];f3(w[2]+S,w[1]+S,w[0]+S)}x=j+2*J,S=de*x;for(let x=0;x<pe;x++){const w=ue[x];f3(w[0]+S,w[1]+S,w[2]+S)}}else{for(let x=0;x<pe;x++){const S=ue[x];f3(S[2],S[1],S[0])}for(let x=0;x<pe;x++){const S=ue[x];f3(S[0]+de*j,S[1]+de*j,S[2]+de*j)}}w.addGroup(x,U.length/3-x,0)}(),function buildSideFaces(){const x=U.length/3;let S=0;sidewalls(he,S),S+=he.length;for(let x=0,w=ce.length;x<w;x++){const w=ce[x];sidewalls(w,S),S+=w.length}w.addGroup(x,U.length/3-x,1)}()}this.setAttribute("position",new Float32BufferAttribute(U,3)),this.setAttribute("uv",new Float32BufferAttribute(G,2)),this.computeVertexNormals()}toJSON(){const x=super.toJSON();return function toJSON$1(x,S,w){if(w.shapes=[],Array.isArray(x))for(let S=0,U=x.length;S<U;S++){const U=x[S];w.shapes.push(U.uuid)}else w.shapes.push(x.uuid);void 0!==S.extrudePath&&(w.options.extrudePath=S.extrudePath.toJSON());return w}(this.parameters.shapes,this.parameters.options,x)}static fromJSON(x,S){const w=[];for(let U=0,G=x.shapes.length;U<G;U++){const G=S[x.shapes[U]];w.push(G)}const U=x.options.extrudePath;return void 0!==U&&(x.options.extrudePath=(new ss[U.type]).fromJSON(U)),new ExtrudeGeometry(w,x.options)}}const ls={generateTopUV:function(x,S,w,U,G){const H=S[3*w],z=S[3*w+1],j=S[3*U],X=S[3*U+1],K=S[3*G],q=S[3*G+1];return[new Vector2(H,z),new Vector2(j,X),new Vector2(K,q)]},generateSideWallUV:function(x,S,w,U,G,H){const z=S[3*w],j=S[3*w+1],X=S[3*w+2],K=S[3*U],q=S[3*U+1],Y=S[3*U+2],Z=S[3*G],J=S[3*G+1],Q=S[3*G+2],ee=S[3*H],te=S[3*H+1],ne=S[3*H+2];return Math.abs(j-q)<Math.abs(z-K)?[new Vector2(z,1-X),new Vector2(K,1-Y),new Vector2(Z,1-Q),new Vector2(ee,1-ne)]:[new Vector2(j,1-X),new Vector2(q,1-Y),new Vector2(J,1-Q),new Vector2(te,1-ne)]}};class IcosahedronGeometry extends PolyhedronGeometry{constructor(x=1,S=0){const w=(1+Math.sqrt(5))/2;super([-1,w,0,1,w,0,-1,-w,0,1,-w,0,0,-1,w,0,1,w,0,-1,-w,0,1,-w,w,0,-1,w,0,1,-w,0,-1,-w,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],x,S),this.type="IcosahedronGeometry",this.parameters={radius:x,detail:S}}static fromJSON(x){return new IcosahedronGeometry(x.radius,x.detail)}}class LatheGeometry extends BufferGeometry{constructor(x=[new Vector2(0,.5),new Vector2(.5,0),new Vector2(0,-.5)],S=12,w=0,U=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:x,segments:S,phiStart:w,phiLength:U},S=Math.floor(S),U=clamp(U,0,2*Math.PI);const G=[],H=[],z=[],j=1/S,X=new Vector3,K=new Vector2;for(let G=0;G<=S;G++){const q=w+G*j*U,Y=Math.sin(q),Z=Math.cos(q);for(let w=0;w<=x.length-1;w++)X.x=x[w].x*Y,X.y=x[w].y,X.z=x[w].x*Z,H.push(X.x,X.y,X.z),K.x=G/S,K.y=w/(x.length-1),z.push(K.x,K.y)}for(let w=0;w<S;w++)for(let S=0;S<x.length-1;S++){const U=S+w*x.length,H=U,z=U+x.length,j=U+x.length+1,X=U+1;G.push(H,z,X),G.push(z,j,X)}if(this.setIndex(G),this.setAttribute("position",new Float32BufferAttribute(H,3)),this.setAttribute("uv",new Float32BufferAttribute(z,2)),this.computeVertexNormals(),U===2*Math.PI){const w=this.attributes.normal.array,U=new Vector3,G=new Vector3,H=new Vector3,z=S*x.length*3;for(let S=0,j=0;S<x.length;S++,j+=3)U.x=w[j+0],U.y=w[j+1],U.z=w[j+2],G.x=w[z+j+0],G.y=w[z+j+1],G.z=w[z+j+2],H.addVectors(U,G).normalize(),w[j+0]=w[z+j+0]=H.x,w[j+1]=w[z+j+1]=H.y,w[j+2]=w[z+j+2]=H.z}}static fromJSON(x){return new LatheGeometry(x.points,x.segments,x.phiStart,x.phiLength)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(x=1,S=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],x,S),this.type="OctahedronGeometry",this.parameters={radius:x,detail:S}}static fromJSON(x){return new OctahedronGeometry(x.radius,x.detail)}}class RingGeometry extends BufferGeometry{constructor(x=.5,S=1,w=8,U=1,G=0,H=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:x,outerRadius:S,thetaSegments:w,phiSegments:U,thetaStart:G,thetaLength:H},w=Math.max(3,w);const z=[],j=[],X=[],K=[];let q=x;const Y=(S-x)/(U=Math.max(1,U)),Z=new Vector3,J=new Vector2;for(let x=0;x<=U;x++){for(let x=0;x<=w;x++){const U=G+x/w*H;Z.x=q*Math.cos(U),Z.y=q*Math.sin(U),j.push(Z.x,Z.y,Z.z),X.push(0,0,1),J.x=(Z.x/S+1)/2,J.y=(Z.y/S+1)/2,K.push(J.x,J.y)}q+=Y}for(let x=0;x<U;x++){const S=x*(w+1);for(let x=0;x<w;x++){const U=x+S,G=U,H=U+w+1,j=U+w+2,X=U+1;z.push(G,H,X),z.push(H,j,X)}}this.setIndex(z),this.setAttribute("position",new Float32BufferAttribute(j,3)),this.setAttribute("normal",new Float32BufferAttribute(X,3)),this.setAttribute("uv",new Float32BufferAttribute(K,2))}static fromJSON(x){return new RingGeometry(x.innerRadius,x.outerRadius,x.thetaSegments,x.phiSegments,x.thetaStart,x.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(x=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),S=12){super(),this.type="ShapeGeometry",this.parameters={shapes:x,curveSegments:S};const w=[],U=[],G=[],H=[];let z=0,j=0;if(!1===Array.isArray(x))addShape(x);else for(let S=0;S<x.length;S++)addShape(x[S]),this.addGroup(z,j,S),z+=j,j=0;function addShape(x){const z=U.length/3,X=x.extractPoints(S);let K=X.shape;const q=X.holes;!1===ShapeUtils.isClockWise(K)&&(K=K.reverse());for(let x=0,S=q.length;x<S;x++){const S=q[x];!0===ShapeUtils.isClockWise(S)&&(q[x]=S.reverse())}const Y=ShapeUtils.triangulateShape(K,q);for(let x=0,S=q.length;x<S;x++){const S=q[x];K=K.concat(S)}for(let x=0,S=K.length;x<S;x++){const S=K[x];U.push(S.x,S.y,0),G.push(0,0,1),H.push(S.x,S.y)}for(let x=0,S=Y.length;x<S;x++){const S=Y[x],U=S[0]+z,G=S[1]+z,H=S[2]+z;w.push(U,G,H),j+=3}}this.setIndex(w),this.setAttribute("position",new Float32BufferAttribute(U,3)),this.setAttribute("normal",new Float32BufferAttribute(G,3)),this.setAttribute("uv",new Float32BufferAttribute(H,2))}toJSON(){const x=super.toJSON();return function toJSON(x,S){if(S.shapes=[],Array.isArray(x))for(let w=0,U=x.length;w<U;w++){const U=x[w];S.shapes.push(U.uuid)}else S.shapes.push(x.uuid);return S}(this.parameters.shapes,x)}static fromJSON(x,S){const w=[];for(let U=0,G=x.shapes.length;U<G;U++){const G=S[x.shapes[U]];w.push(G)}return new ShapeGeometry(w,x.curveSegments)}}class SphereGeometry extends BufferGeometry{constructor(x=1,S=32,w=16,U=0,G=2*Math.PI,H=0,z=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:x,widthSegments:S,heightSegments:w,phiStart:U,phiLength:G,thetaStart:H,thetaLength:z},S=Math.max(3,Math.floor(S)),w=Math.max(2,Math.floor(w));const j=Math.min(H+z,Math.PI);let X=0;const K=[],q=new Vector3,Y=new Vector3,Z=[],J=[],Q=[],ee=[];for(let Z=0;Z<=w;Z++){const te=[],ne=Z/w;let ie=0;0==Z&&0==H?ie=.5/S:Z==w&&j==Math.PI&&(ie=-.5/S);for(let w=0;w<=S;w++){const j=w/S;q.x=-x*Math.cos(U+j*G)*Math.sin(H+ne*z),q.y=x*Math.cos(H+ne*z),q.z=x*Math.sin(U+j*G)*Math.sin(H+ne*z),J.push(q.x,q.y,q.z),Y.copy(q).normalize(),Q.push(Y.x,Y.y,Y.z),ee.push(j+ie,1-ne),te.push(X++)}K.push(te)}for(let x=0;x<w;x++)for(let U=0;U<S;U++){const S=K[x][U+1],G=K[x][U],z=K[x+1][U],X=K[x+1][U+1];(0!==x||H>0)&&Z.push(S,G,X),(x!==w-1||j<Math.PI)&&Z.push(G,z,X)}this.setIndex(Z),this.setAttribute("position",new Float32BufferAttribute(J,3)),this.setAttribute("normal",new Float32BufferAttribute(Q,3)),this.setAttribute("uv",new Float32BufferAttribute(ee,2))}static fromJSON(x){return new SphereGeometry(x.radius,x.widthSegments,x.heightSegments,x.phiStart,x.phiLength,x.thetaStart,x.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(x=1,S=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],x,S),this.type="TetrahedronGeometry",this.parameters={radius:x,detail:S}}static fromJSON(x){return new TetrahedronGeometry(x.radius,x.detail)}}class TorusGeometry extends BufferGeometry{constructor(x=1,S=.4,w=8,U=6,G=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:x,tube:S,radialSegments:w,tubularSegments:U,arc:G},w=Math.floor(w),U=Math.floor(U);const H=[],z=[],j=[],X=[],K=new Vector3,q=new Vector3,Y=new Vector3;for(let H=0;H<=w;H++)for(let Z=0;Z<=U;Z++){const J=Z/U*G,Q=H/w*Math.PI*2;q.x=(x+S*Math.cos(Q))*Math.cos(J),q.y=(x+S*Math.cos(Q))*Math.sin(J),q.z=S*Math.sin(Q),z.push(q.x,q.y,q.z),K.x=x*Math.cos(J),K.y=x*Math.sin(J),Y.subVectors(q,K).normalize(),j.push(Y.x,Y.y,Y.z),X.push(Z/U),X.push(H/w)}for(let x=1;x<=w;x++)for(let S=1;S<=U;S++){const w=(U+1)*x+S-1,G=(U+1)*(x-1)+S-1,z=(U+1)*(x-1)+S,j=(U+1)*x+S;H.push(w,G,j),H.push(G,z,j)}this.setIndex(H),this.setAttribute("position",new Float32BufferAttribute(z,3)),this.setAttribute("normal",new Float32BufferAttribute(j,3)),this.setAttribute("uv",new Float32BufferAttribute(X,2))}static fromJSON(x){return new TorusGeometry(x.radius,x.tube,x.radialSegments,x.tubularSegments,x.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(x=1,S=.4,w=64,U=8,G=2,H=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:x,tube:S,tubularSegments:w,radialSegments:U,p:G,q:H},w=Math.floor(w),U=Math.floor(U);const z=[],j=[],X=[],K=[],q=new Vector3,Y=new Vector3,Z=new Vector3,J=new Vector3,Q=new Vector3,ee=new Vector3,te=new Vector3;for(let z=0;z<=w;++z){const ne=z/w*G*Math.PI*2;calculatePositionOnCurve(ne,G,H,x,Z),calculatePositionOnCurve(ne+.01,G,H,x,J),ee.subVectors(J,Z),te.addVectors(J,Z),Q.crossVectors(ee,te),te.crossVectors(Q,ee),Q.normalize(),te.normalize();for(let x=0;x<=U;++x){const G=x/U*Math.PI*2,H=-S*Math.cos(G),J=S*Math.sin(G);q.x=Z.x+(H*te.x+J*Q.x),q.y=Z.y+(H*te.y+J*Q.y),q.z=Z.z+(H*te.z+J*Q.z),j.push(q.x,q.y,q.z),Y.subVectors(q,Z).normalize(),X.push(Y.x,Y.y,Y.z),K.push(z/w),K.push(x/U)}}for(let x=1;x<=w;x++)for(let S=1;S<=U;S++){const w=(U+1)*(x-1)+(S-1),G=(U+1)*x+(S-1),H=(U+1)*x+S,j=(U+1)*(x-1)+S;z.push(w,G,j),z.push(G,H,j)}function calculatePositionOnCurve(x,S,w,U,G){const H=Math.cos(x),z=Math.sin(x),j=w/S*x,X=Math.cos(j);G.x=U*(2+X)*.5*H,G.y=U*(2+X)*z*.5,G.z=U*Math.sin(j)*.5}this.setIndex(z),this.setAttribute("position",new Float32BufferAttribute(j,3)),this.setAttribute("normal",new Float32BufferAttribute(X,3)),this.setAttribute("uv",new Float32BufferAttribute(K,2))}static fromJSON(x){return new TorusKnotGeometry(x.radius,x.tube,x.tubularSegments,x.radialSegments,x.p,x.q)}}class TubeGeometry extends BufferGeometry{constructor(x=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),S=64,w=1,U=8,G=!1){super(),this.type="TubeGeometry",this.parameters={path:x,tubularSegments:S,radius:w,radialSegments:U,closed:G};const H=x.computeFrenetFrames(S,G);this.tangents=H.tangents,this.normals=H.normals,this.binormals=H.binormals;const z=new Vector3,j=new Vector3,X=new Vector2;let K=new Vector3;const q=[],Y=[],Z=[],J=[];function generateSegment(G){K=x.getPointAt(G/S,K);const X=H.normals[G],Z=H.binormals[G];for(let x=0;x<=U;x++){const S=x/U*Math.PI*2,G=Math.sin(S),H=-Math.cos(S);j.x=H*X.x+G*Z.x,j.y=H*X.y+G*Z.y,j.z=H*X.z+G*Z.z,j.normalize(),Y.push(j.x,j.y,j.z),z.x=K.x+w*j.x,z.y=K.y+w*j.y,z.z=K.z+w*j.z,q.push(z.x,z.y,z.z)}}!function generateBufferData(){for(let x=0;x<S;x++)generateSegment(x);generateSegment(!1===G?S:0),function generateUVs(){for(let x=0;x<=S;x++)for(let w=0;w<=U;w++)X.x=x/S,X.y=w/U,Z.push(X.x,X.y)}(),function generateIndices(){for(let x=1;x<=S;x++)for(let S=1;S<=U;S++){const w=(U+1)*(x-1)+(S-1),G=(U+1)*x+(S-1),H=(U+1)*x+S,z=(U+1)*(x-1)+S;J.push(w,G,z),J.push(G,H,z)}}()}(),this.setIndex(J),this.setAttribute("position",new Float32BufferAttribute(q,3)),this.setAttribute("normal",new Float32BufferAttribute(Y,3)),this.setAttribute("uv",new Float32BufferAttribute(Z,2))}toJSON(){const x=super.toJSON();return x.path=this.parameters.path.toJSON(),x}static fromJSON(x){return new TubeGeometry((new ss[x.path.type]).fromJSON(x.path),x.tubularSegments,x.radius,x.radialSegments,x.closed)}}class WireframeGeometry extends BufferGeometry{constructor(x=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:x},null!==x){const S=[],w=new Set,U=new Vector3,G=new Vector3;if(null!==x.index){const H=x.attributes.position,z=x.index;let j=x.groups;0===j.length&&(j=[{start:0,count:z.count,materialIndex:0}]);for(let x=0,X=j.length;x<X;++x){const X=j[x],K=X.start;for(let x=K,j=K+X.count;x<j;x+=3)for(let j=0;j<3;j++){const X=z.getX(x+j),K=z.getX(x+(j+1)%3);U.fromBufferAttribute(H,X),G.fromBufferAttribute(H,K),!0===isUniqueEdge(U,G,w)&&(S.push(U.x,U.y,U.z),S.push(G.x,G.y,G.z))}}}else{const H=x.attributes.position;for(let x=0,z=H.count/3;x<z;x++)for(let z=0;z<3;z++){const j=3*x+z,X=3*x+(z+1)%3;U.fromBufferAttribute(H,j),G.fromBufferAttribute(H,X),!0===isUniqueEdge(U,G,w)&&(S.push(U.x,U.y,U.z),S.push(G.x,G.y,G.z))}}this.setAttribute("position",new Float32BufferAttribute(S,3))}}}function isUniqueEdge(x,S,w){const U=`${x.x},${x.y},${x.z}-${S.x},${S.y},${S.z}`,G=`${S.x},${S.y},${S.z}-${x.x},${x.y},${x.z}`;return!0!==w.has(U)&&!0!==w.has(G)&&(w.add(U,G),!0)}var cs=Object.freeze({__proto__:null,BoxGeometry,BoxBufferGeometry:BoxGeometry,CircleGeometry,CircleBufferGeometry:CircleGeometry,ConeGeometry,ConeBufferGeometry:ConeGeometry,CylinderGeometry,CylinderBufferGeometry:CylinderGeometry,DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeGeometry,IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronGeometry,LatheGeometry,LatheBufferGeometry:LatheGeometry,OctahedronGeometry,OctahedronBufferGeometry:OctahedronGeometry,PlaneGeometry,PlaneBufferGeometry:PlaneGeometry,PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronGeometry,RingGeometry,RingBufferGeometry:RingGeometry,ShapeGeometry,ShapeBufferGeometry:ShapeGeometry,SphereGeometry,SphereBufferGeometry:SphereGeometry,TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronGeometry,TorusGeometry,TorusBufferGeometry:TorusGeometry,TorusKnotGeometry,TorusKnotBufferGeometry:TorusKnotGeometry,TubeGeometry,TubeBufferGeometry:TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(x){super(),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this}}ShadowMaterial.prototype.isShadowMaterial=!0;class MeshStandardMaterial extends Material{constructor(x){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ai,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(x)}copy(x){return super.copy(x),this.defines={STANDARD:""},this.color.copy(x.color),this.roughness=x.roughness,this.metalness=x.metalness,this.map=x.map,this.lightMap=x.lightMap,this.lightMapIntensity=x.lightMapIntensity,this.aoMap=x.aoMap,this.aoMapIntensity=x.aoMapIntensity,this.emissive.copy(x.emissive),this.emissiveMap=x.emissiveMap,this.emissiveIntensity=x.emissiveIntensity,this.bumpMap=x.bumpMap,this.bumpScale=x.bumpScale,this.normalMap=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x.normalScale),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.roughnessMap=x.roughnessMap,this.metalnessMap=x.metalnessMap,this.alphaMap=x.alphaMap,this.envMap=x.envMap,this.envMapIntensity=x.envMapIntensity,this.refractionRatio=x.refractionRatio,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this.wireframeLinejoin=x.wireframeLinejoin,this.flatShading=x.flatShading,this}}MeshStandardMaterial.prototype.isMeshStandardMaterial=!0;class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(x){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(x){this.ior=(1+.4*x)/(1-.4*x)}}),this.sheenTint=new Color(0),this.sheenRoughness=1,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new Color(1,1,1),this.specularTintMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(x)}get sheen(){return this._sheen}set sheen(x){this._sheen>0!=x>0&&this.version++,this._sheen=x}get clearcoat(){return this._clearcoat}set clearcoat(x){this._clearcoat>0!=x>0&&this.version++,this._clearcoat=x}get transmission(){return this._transmission}set transmission(x){this._transmission>0!=x>0&&this.version++,this._transmission=x}copy(x){return super.copy(x),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=x.clearcoat,this.clearcoatMap=x.clearcoatMap,this.clearcoatRoughness=x.clearcoatRoughness,this.clearcoatRoughnessMap=x.clearcoatRoughnessMap,this.clearcoatNormalMap=x.clearcoatNormalMap,this.clearcoatNormalScale.copy(x.clearcoatNormalScale),this.ior=x.ior,this.sheen=x.sheen,this.sheenTint.copy(x.sheenTint),this.sheenRoughness=x.sheenRoughness,this.transmission=x.transmission,this.transmissionMap=x.transmissionMap,this.thickness=x.thickness,this.thicknessMap=x.thicknessMap,this.attenuationDistance=x.attenuationDistance,this.attenuationTint.copy(x.attenuationTint),this.specularIntensity=x.specularIntensity,this.specularIntensityMap=x.specularIntensityMap,this.specularTint.copy(x.specularTint),this.specularTintMap=x.specularTintMap,this}}MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0;class MeshPhongMaterial extends Material{constructor(x){super(),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ai,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.specular.copy(x.specular),this.shininess=x.shininess,this.map=x.map,this.lightMap=x.lightMap,this.lightMapIntensity=x.lightMapIntensity,this.aoMap=x.aoMap,this.aoMapIntensity=x.aoMapIntensity,this.emissive.copy(x.emissive),this.emissiveMap=x.emissiveMap,this.emissiveIntensity=x.emissiveIntensity,this.bumpMap=x.bumpMap,this.bumpScale=x.bumpScale,this.normalMap=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x.normalScale),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.specularMap=x.specularMap,this.alphaMap=x.alphaMap,this.envMap=x.envMap,this.combine=x.combine,this.reflectivity=x.reflectivity,this.refractionRatio=x.refractionRatio,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this.wireframeLinejoin=x.wireframeLinejoin,this.flatShading=x.flatShading,this}}MeshPhongMaterial.prototype.isMeshPhongMaterial=!0;class MeshToonMaterial extends Material{constructor(x){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ai,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.map=x.map,this.gradientMap=x.gradientMap,this.lightMap=x.lightMap,this.lightMapIntensity=x.lightMapIntensity,this.aoMap=x.aoMap,this.aoMapIntensity=x.aoMapIntensity,this.emissive.copy(x.emissive),this.emissiveMap=x.emissiveMap,this.emissiveIntensity=x.emissiveIntensity,this.bumpMap=x.bumpMap,this.bumpScale=x.bumpScale,this.normalMap=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x.normalScale),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.alphaMap=x.alphaMap,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this.wireframeLinejoin=x.wireframeLinejoin,this}}MeshToonMaterial.prototype.isMeshToonMaterial=!0;class MeshNormalMaterial extends Material{constructor(x){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ai,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(x)}copy(x){return super.copy(x),this.bumpMap=x.bumpMap,this.bumpScale=x.bumpScale,this.normalMap=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x.normalScale),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.flatShading=x.flatShading,this}}MeshNormalMaterial.prototype.isMeshNormalMaterial=!0;class MeshLambertMaterial extends Material{constructor(x){super(),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Oe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(x)}copy(x){return super.copy(x),this.color.copy(x.color),this.map=x.map,this.lightMap=x.lightMap,this.lightMapIntensity=x.lightMapIntensity,this.aoMap=x.aoMap,this.aoMapIntensity=x.aoMapIntensity,this.emissive.copy(x.emissive),this.emissiveMap=x.emissiveMap,this.emissiveIntensity=x.emissiveIntensity,this.specularMap=x.specularMap,this.alphaMap=x.alphaMap,this.envMap=x.envMap,this.combine=x.combine,this.reflectivity=x.reflectivity,this.refractionRatio=x.refractionRatio,this.wireframe=x.wireframe,this.wireframeLinewidth=x.wireframeLinewidth,this.wireframeLinecap=x.wireframeLinecap,this.wireframeLinejoin=x.wireframeLinejoin,this}}MeshLambertMaterial.prototype.isMeshLambertMaterial=!0;class MeshMatcapMaterial extends Material{constructor(x){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ai,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(x)}copy(x){return super.copy(x),this.defines={MATCAP:""},this.color.copy(x.color),this.matcap=x.matcap,this.map=x.map,this.bumpMap=x.bumpMap,this.bumpScale=x.bumpScale,this.normalMap=x.normalMap,this.normalMapType=x.normalMapType,this.normalScale.copy(x.normalScale),this.displacementMap=x.displacementMap,this.displacementScale=x.displacementScale,this.displacementBias=x.displacementBias,this.alphaMap=x.alphaMap,this.flatShading=x.flatShading,this}}MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0;class LineDashedMaterial extends LineBasicMaterial{constructor(x){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(x)}copy(x){return super.copy(x),this.scale=x.scale,this.dashSize=x.dashSize,this.gapSize=x.gapSize,this}}LineDashedMaterial.prototype.isLineDashedMaterial=!0;var us=Object.freeze({__proto__:null,ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material});const hs={arraySlice:function(x,S,w){return hs.isTypedArray(x)?new x.constructor(x.subarray(S,void 0!==w?w:x.length)):x.slice(S,w)},convertArray:function(x,S,w){return!x||!w&&x.constructor===S?x:"number"==typeof S.BYTES_PER_ELEMENT?new S(x):Array.prototype.slice.call(x)},isTypedArray:function(x){return ArrayBuffer.isView(x)&&!(x instanceof DataView)},getKeyframeOrder:function(x){const S=x.length,w=new Array(S);for(let x=0;x!==S;++x)w[x]=x;return w.sort((function compareTime(S,w){return x[S]-x[w]})),w},sortedArray:function(x,S,w){const U=x.length,G=new x.constructor(U);for(let H=0,z=0;z!==U;++H){const U=w[H]*S;for(let w=0;w!==S;++w)G[z++]=x[U+w]}return G},flattenJSON:function(x,S,w,U){let G=1,H=x[0];for(;void 0!==H&&void 0===H[U];)H=x[G++];if(void 0===H)return;let z=H[U];if(void 0!==z)if(Array.isArray(z))do{z=H[U],void 0!==z&&(S.push(H.time),w.push.apply(w,z)),H=x[G++]}while(void 0!==H);else if(void 0!==z.toArray)do{z=H[U],void 0!==z&&(S.push(H.time),z.toArray(w,w.length)),H=x[G++]}while(void 0!==H);else do{z=H[U],void 0!==z&&(S.push(H.time),w.push(z)),H=x[G++]}while(void 0!==H)},subclip:function(x,S,w,U,G=30){const H=x.clone();H.name=S;const z=[];for(let x=0;x<H.tracks.length;++x){const S=H.tracks[x],j=S.getValueSize(),X=[],K=[];for(let x=0;x<S.times.length;++x){const H=S.times[x]*G;if(!(H<w||H>=U)){X.push(S.times[x]);for(let w=0;w<j;++w)K.push(S.values[x*j+w])}}0!==X.length&&(S.times=hs.convertArray(X,S.times.constructor),S.values=hs.convertArray(K,S.values.constructor),z.push(S))}H.tracks=z;let j=1/0;for(let x=0;x<H.tracks.length;++x)j>H.tracks[x].times[0]&&(j=H.tracks[x].times[0]);for(let x=0;x<H.tracks.length;++x)H.tracks[x].shift(-1*j);return H.resetDuration(),H},makeClipAdditive:function(x,S=0,w=x,U=30){U<=0&&(U=30);const G=w.tracks.length,H=S/U;for(let S=0;S<G;++S){const U=w.tracks[S],G=U.ValueTypeName;if("bool"===G||"string"===G)continue;const z=x.tracks.find((function(x){return x.name===U.name&&x.ValueTypeName===G}));if(void 0===z)continue;let j=0;const X=U.getValueSize();U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(j=X/3);let K=0;const q=z.getValueSize();z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(K=q/3);const Y=U.times.length-1;let Z;if(H<=U.times[0]){const x=j,S=X-j;Z=hs.arraySlice(U.values,x,S)}else if(H>=U.times[Y]){const x=Y*X+j,S=x+X-j;Z=hs.arraySlice(U.values,x,S)}else{const x=U.createInterpolant(),S=j,w=X-j;x.evaluate(H),Z=hs.arraySlice(x.resultBuffer,S,w)}if("quaternion"===G){(new Quaternion).fromArray(Z).normalize().conjugate().toArray(Z)}const J=z.times.length;for(let x=0;x<J;++x){const S=x*q+K;if("quaternion"===G)Quaternion.multiplyQuaternionsFlat(z.values,S,Z,0,z.values,S);else{const x=q-2*K;for(let w=0;w<x;++w)z.values[S+w]-=Z[w]}}}return x.blendMode=Hn,x}};class Interpolant{constructor(x,S,w,U){this.parameterPositions=x,this._cachedIndex=0,this.resultBuffer=void 0!==U?U:new S.constructor(w),this.sampleValues=S,this.valueSize=w,this.settings=null,this.DefaultSettings_={}}evaluate(x){const S=this.parameterPositions;let w=this._cachedIndex,U=S[w],G=S[w-1];e:{t:{let H;n:{i:if(!(x<U)){for(let H=w+2;;){if(void 0===U){if(x<G)break i;return w=S.length,this._cachedIndex=w,this.afterEnd_(w-1,x,G)}if(w===H)break;if(G=U,U=S[++w],x<U)break t}H=S.length;break n}if(x>=G)break e;{const z=S[1];x<z&&(w=2,G=z);for(let H=w-2;;){if(void 0===G)return this._cachedIndex=0,this.beforeStart_(0,x,U);if(w===H)break;if(U=G,G=S[--w-1],x>=G)break t}H=w,w=0}}for(;w<H;){const U=w+H>>>1;x<S[U]?H=U:w=U+1}if(U=S[w],G=S[w-1],void 0===G)return this._cachedIndex=0,this.beforeStart_(0,x,U);if(void 0===U)return w=S.length,this._cachedIndex=w,this.afterEnd_(w-1,G,x)}this._cachedIndex=w,this.intervalChanged_(w,G,U)}return this.interpolate_(w,G,x,U)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(x){const S=this.resultBuffer,w=this.sampleValues,U=this.valueSize,G=x*U;for(let x=0;x!==U;++x)S[x]=w[G+x];return S}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Interpolant.prototype.beforeStart_=Interpolant.prototype.copySampleValue_,Interpolant.prototype.afterEnd_=Interpolant.prototype.copySampleValue_;class CubicInterpolant extends Interpolant{constructor(x,S,w,U){super(x,S,w,U),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Bn,endingEnd:Bn}}intervalChanged_(x,S,w){const U=this.parameterPositions;let G=x-2,H=x+1,z=U[G],j=U[H];if(void 0===z)switch(this.getSettings_().endingStart){case Dn:G=x,z=2*S-w;break;case kn:G=U.length-2,z=S+U[G]-U[G+1];break;default:G=x,z=w}if(void 0===j)switch(this.getSettings_().endingEnd){case Dn:H=x,j=2*w-S;break;case kn:H=1,j=w+U[1]-U[0];break;default:H=x-1,j=S}const X=.5*(w-S),K=this.valueSize;this._weightPrev=X/(S-z),this._weightNext=X/(j-w),this._offsetPrev=G*K,this._offsetNext=H*K}interpolate_(x,S,w,U){const G=this.resultBuffer,H=this.sampleValues,z=this.valueSize,j=x*z,X=j-z,K=this._offsetPrev,q=this._offsetNext,Y=this._weightPrev,Z=this._weightNext,J=(w-S)/(U-S),Q=J*J,ee=Q*J,te=-Y*ee+2*Y*Q-Y*J,ne=(1+Y)*ee+(-1.5-2*Y)*Q+(-.5+Y)*J+1,ie=(-1-Z)*ee+(1.5+Z)*Q+.5*J,re=Z*ee-Z*Q;for(let x=0;x!==z;++x)G[x]=te*H[K+x]+ne*H[X+x]+ie*H[j+x]+re*H[q+x];return G}}class LinearInterpolant extends Interpolant{constructor(x,S,w,U){super(x,S,w,U)}interpolate_(x,S,w,U){const G=this.resultBuffer,H=this.sampleValues,z=this.valueSize,j=x*z,X=j-z,K=(w-S)/(U-S),q=1-K;for(let x=0;x!==z;++x)G[x]=H[X+x]*q+H[j+x]*K;return G}}class DiscreteInterpolant extends Interpolant{constructor(x,S,w,U){super(x,S,w,U)}interpolate_(x){return this.copySampleValue_(x-1)}}class KeyframeTrack{constructor(x,S,w,U){if(void 0===x)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===S||0===S.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+x);this.name=x,this.times=hs.convertArray(S,this.TimeBufferType),this.values=hs.convertArray(w,this.ValueBufferType),this.setInterpolation(U||this.DefaultInterpolation)}static toJSON(x){const S=x.constructor;let w;if(S.toJSON!==this.toJSON)w=S.toJSON(x);else{w={name:x.name,times:hs.convertArray(x.times,Array),values:hs.convertArray(x.values,Array)};const S=x.getInterpolation();S!==x.DefaultInterpolation&&(w.interpolation=S)}return w.type=x.ValueTypeName,w}InterpolantFactoryMethodDiscrete(x){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),x)}InterpolantFactoryMethodLinear(x){return new LinearInterpolant(this.times,this.values,this.getValueSize(),x)}InterpolantFactoryMethodSmooth(x){return new CubicInterpolant(this.times,this.values,this.getValueSize(),x)}setInterpolation(x){let S;switch(x){case Fn:S=this.InterpolantFactoryMethodDiscrete;break;case On:S=this.InterpolantFactoryMethodLinear;break;case Nn:S=this.InterpolantFactoryMethodSmooth}if(void 0===S){const S="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(x===this.DefaultInterpolation)throw new Error(S);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",S),this}return this.createInterpolant=S,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fn;case this.InterpolantFactoryMethodLinear:return On;case this.InterpolantFactoryMethodSmooth:return Nn}}getValueSize(){return this.values.length/this.times.length}shift(x){if(0!==x){const S=this.times;for(let w=0,U=S.length;w!==U;++w)S[w]+=x}return this}scale(x){if(1!==x){const S=this.times;for(let w=0,U=S.length;w!==U;++w)S[w]*=x}return this}trim(x,S){const w=this.times,U=w.length;let G=0,H=U-1;for(;G!==U&&w[G]<x;)++G;for(;-1!==H&&w[H]>S;)--H;if(++H,0!==G||H!==U){G>=H&&(H=Math.max(H,1),G=H-1);const x=this.getValueSize();this.times=hs.arraySlice(w,G,H),this.values=hs.arraySlice(this.values,G*x,H*x)}return this}validate(){let x=!0;const S=this.getValueSize();S-Math.floor(S)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),x=!1);const w=this.times,U=this.values,G=w.length;0===G&&(console.error("THREE.KeyframeTrack: Track is empty.",this),x=!1);let H=null;for(let S=0;S!==G;S++){const U=w[S];if("number"==typeof U&&isNaN(U)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,S,U),x=!1;break}if(null!==H&&H>U){console.error("THREE.KeyframeTrack: Out of order keys.",this,S,U,H),x=!1;break}H=U}if(void 0!==U&&hs.isTypedArray(U))for(let S=0,w=U.length;S!==w;++S){const w=U[S];if(isNaN(w)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,S,w),x=!1;break}}return x}optimize(){const x=hs.arraySlice(this.times),S=hs.arraySlice(this.values),w=this.getValueSize(),U=this.getInterpolation()===Nn,G=x.length-1;let H=1;for(let z=1;z<G;++z){let G=!1;const j=x[z];if(j!==x[z+1]&&(1!==z||j!==x[0]))if(U)G=!0;else{const x=z*w,U=x-w,H=x+w;for(let z=0;z!==w;++z){const w=S[x+z];if(w!==S[U+z]||w!==S[H+z]){G=!0;break}}}if(G){if(z!==H){x[H]=x[z];const U=z*w,G=H*w;for(let x=0;x!==w;++x)S[G+x]=S[U+x]}++H}}if(G>0){x[H]=x[G];for(let x=G*w,U=H*w,z=0;z!==w;++z)S[U+z]=S[x+z];++H}return H!==x.length?(this.times=hs.arraySlice(x,0,H),this.values=hs.arraySlice(S,0,H*w)):(this.times=x,this.values=S),this}clone(){const x=hs.arraySlice(this.times,0),S=hs.arraySlice(this.values,0),w=new(0,this.constructor)(this.name,x,S);return w.createInterpolant=this.createInterpolant,w}}KeyframeTrack.prototype.TimeBufferType=Float32Array,KeyframeTrack.prototype.ValueBufferType=Float32Array,KeyframeTrack.prototype.DefaultInterpolation=On;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool",BooleanKeyframeTrack.prototype.ValueBufferType=Array,BooleanKeyframeTrack.prototype.DefaultInterpolation=Fn,BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0,BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(x,S,w,U){super(x,S,w,U)}interpolate_(x,S,w,U){const G=this.resultBuffer,H=this.sampleValues,z=this.valueSize,j=(w-S)/(U-S);let X=x*z;for(let x=X+z;X!==x;X+=4)Quaternion.slerpFlat(G,0,H,X-z,H,X,j);return G}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(x){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),x)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion",QuaternionKeyframeTrack.prototype.DefaultInterpolation=On,QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string",StringKeyframeTrack.prototype.ValueBufferType=Array,StringKeyframeTrack.prototype.DefaultInterpolation=Fn,StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0,StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(x,S=-1,w,U=Gn){this.name=x,this.tracks=w,this.duration=S,this.blendMode=U,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(x){const S=[],w=x.tracks,U=1/(x.fps||1);for(let x=0,G=w.length;x!==G;++x)S.push(parseKeyframeTrack(w[x]).scale(U));const G=new this(x.name,x.duration,S,x.blendMode);return G.uuid=x.uuid,G}static toJSON(x){const S=[],w=x.tracks,U={name:x.name,duration:x.duration,tracks:S,uuid:x.uuid,blendMode:x.blendMode};for(let x=0,U=w.length;x!==U;++x)S.push(KeyframeTrack.toJSON(w[x]));return U}static CreateFromMorphTargetSequence(x,S,w,U){const G=S.length,H=[];for(let x=0;x<G;x++){let z=[],j=[];z.push((x+G-1)%G,x,(x+1)%G),j.push(0,1,0);const X=hs.getKeyframeOrder(z);z=hs.sortedArray(z,1,X),j=hs.sortedArray(j,1,X),U||0!==z[0]||(z.push(G),j.push(j[0])),H.push(new NumberKeyframeTrack(".morphTargetInfluences["+S[x].name+"]",z,j).scale(1/w))}return new this(x,-1,H)}static findByName(x,S){let w=x;if(!Array.isArray(x)){const S=x;w=S.geometry&&S.geometry.animations||S.animations}for(let x=0;x<w.length;x++)if(w[x].name===S)return w[x];return null}static CreateClipsFromMorphTargetSequences(x,S,w){const U={},G=/^([\w-]*?)([\d]+)$/;for(let S=0,w=x.length;S<w;S++){const w=x[S],H=w.name.match(G);if(H&&H.length>1){const x=H[1];let S=U[x];S||(U[x]=S=[]),S.push(w)}}const H=[];for(const x in U)H.push(this.CreateFromMorphTargetSequence(x,U[x],S,w));return H}static parseAnimation(x,S){if(!x)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const addNonemptyTrack=function(x,S,w,U,G){if(0!==w.length){const H=[],z=[];hs.flattenJSON(w,H,z,U),0!==H.length&&G.push(new x(S,H,z))}},w=[],U=x.name||"default",G=x.fps||30,H=x.blendMode;let z=x.length||-1;const j=x.hierarchy||[];for(let x=0;x<j.length;x++){const U=j[x].keys;if(U&&0!==U.length)if(U[0].morphTargets){const x={};let S;for(S=0;S<U.length;S++)if(U[S].morphTargets)for(let w=0;w<U[S].morphTargets.length;w++)x[U[S].morphTargets[w]]=-1;for(const G in x){const x=[],H=[];for(let w=0;w!==U[S].morphTargets.length;++w){const w=U[S];x.push(w.time),H.push(w.morphTarget===G?1:0)}w.push(new NumberKeyframeTrack(".morphTargetInfluence["+G+"]",x,H))}z=x.length*(G||1)}else{const G=".bones["+S[x].name+"]";addNonemptyTrack(VectorKeyframeTrack,G+".position",U,"pos",w),addNonemptyTrack(QuaternionKeyframeTrack,G+".quaternion",U,"rot",w),addNonemptyTrack(VectorKeyframeTrack,G+".scale",U,"scl",w)}}if(0===w.length)return null;return new this(U,z,w,H)}resetDuration(){let x=0;for(let S=0,w=this.tracks.length;S!==w;++S){const w=this.tracks[S];x=Math.max(x,w.times[w.times.length-1])}return this.duration=x,this}trim(){for(let x=0;x<this.tracks.length;x++)this.tracks[x].trim(0,this.duration);return this}validate(){let x=!0;for(let S=0;S<this.tracks.length;S++)x=x&&this.tracks[S].validate();return x}optimize(){for(let x=0;x<this.tracks.length;x++)this.tracks[x].optimize();return this}clone(){const x=[];for(let S=0;S<this.tracks.length;S++)x.push(this.tracks[S].clone());return new this.constructor(this.name,this.duration,x,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function parseKeyframeTrack(x){if(void 0===x.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const S=function getTrackTypeForValueTypeName(x){switch(x.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+x)}(x.type);if(void 0===x.times){const S=[],w=[];hs.flattenJSON(x.keys,S,w,"value"),x.times=S,x.values=w}return void 0!==S.parse?S.parse(x):new S(x.name,x.times,x.values,x.interpolation)}const ds={enabled:!1,files:{},add:function(x,S){!1!==this.enabled&&(this.files[x]=S)},get:function(x){if(!1!==this.enabled)return this.files[x]},remove:function(x){delete this.files[x]},clear:function(){this.files={}}};class LoadingManager{constructor(x,S,w){const U=this;let G,H=!1,z=0,j=0;const X=[];this.onStart=void 0,this.onLoad=x,this.onProgress=S,this.onError=w,this.itemStart=function(x){j++,!1===H&&void 0!==U.onStart&&U.onStart(x,z,j),H=!0},this.itemEnd=function(x){z++,void 0!==U.onProgress&&U.onProgress(x,z,j),z===j&&(H=!1,void 0!==U.onLoad&&U.onLoad())},this.itemError=function(x){void 0!==U.onError&&U.onError(x)},this.resolveURL=function(x){return G?G(x):x},this.setURLModifier=function(x){return G=x,this},this.addHandler=function(x,S){return X.push(x,S),this},this.removeHandler=function(x){const S=X.indexOf(x);return-1!==S&&X.splice(S,2),this},this.getHandler=function(x){for(let S=0,w=X.length;S<w;S+=2){const w=X[S],U=X[S+1];if(w.global&&(w.lastIndex=0),w.test(x))return U}return null}}}const ps=new LoadingManager;class Loader{constructor(x){this.manager=void 0!==x?x:ps,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(x,S){const w=this;return new Promise((function(U,G){w.load(x,U,S,G)}))}parse(){}setCrossOrigin(x){return this.crossOrigin=x,this}setWithCredentials(x){return this.withCredentials=x,this}setPath(x){return this.path=x,this}setResourcePath(x){return this.resourcePath=x,this}setRequestHeader(x){return this.requestHeader=x,this}}const ms={};class FileLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){void 0===x&&(x=""),void 0!==this.path&&(x=this.path+x),x=this.manager.resolveURL(x);const G=this,H=ds.get(x);if(void 0!==H)return G.manager.itemStart(x),setTimeout((function(){S&&S(H),G.manager.itemEnd(x)}),0),H;if(void 0!==ms[x])return void ms[x].push({onLoad:S,onProgress:w,onError:U});const z=x.match(/^data:(.*?)(;base64)?,(.*)$/);let j;if(z){const w=z[1],H=!!z[2];let j=z[3];j=decodeURIComponent(j),H&&(j=atob(j));try{let U;const H=(this.responseType||"").toLowerCase();switch(H){case"arraybuffer":case"blob":const x=new Uint8Array(j.length);for(let S=0;S<j.length;S++)x[S]=j.charCodeAt(S);U="blob"===H?new Blob([x.buffer],{type:w}):x.buffer;break;case"document":const S=new DOMParser;U=S.parseFromString(j,w);break;case"json":U=JSON.parse(j);break;default:U=j}setTimeout((function(){S&&S(U),G.manager.itemEnd(x)}),0)}catch(S){setTimeout((function(){U&&U(S),G.manager.itemError(x),G.manager.itemEnd(x)}),0)}}else{ms[x]=[],ms[x].push({onLoad:S,onProgress:w,onError:U}),j=new XMLHttpRequest,j.open("GET",x,!0),j.addEventListener("load",(function(S){const w=this.response,U=ms[x];if(delete ms[x],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ds.add(x,w);for(let x=0,S=U.length;x<S;x++){const S=U[x];S.onLoad&&S.onLoad(w)}G.manager.itemEnd(x)}else{for(let x=0,w=U.length;x<w;x++){const w=U[x];w.onError&&w.onError(S)}G.manager.itemError(x),G.manager.itemEnd(x)}}),!1),j.addEventListener("progress",(function(S){const w=ms[x];for(let x=0,U=w.length;x<U;x++){const U=w[x];U.onProgress&&U.onProgress(S)}}),!1),j.addEventListener("error",(function(S){const w=ms[x];delete ms[x];for(let x=0,U=w.length;x<U;x++){const U=w[x];U.onError&&U.onError(S)}G.manager.itemError(x),G.manager.itemEnd(x)}),!1),j.addEventListener("abort",(function(S){const w=ms[x];delete ms[x];for(let x=0,U=w.length;x<U;x++){const U=w[x];U.onError&&U.onError(S)}G.manager.itemError(x),G.manager.itemEnd(x)}),!1),void 0!==this.responseType&&(j.responseType=this.responseType),void 0!==this.withCredentials&&(j.withCredentials=this.withCredentials),j.overrideMimeType&&j.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const x in this.requestHeader)j.setRequestHeader(x,this.requestHeader[x]);j.send(null)}return G.manager.itemStart(x),j}setResponseType(x){return this.responseType=x,this}setMimeType(x){return this.mimeType=x,this}}class AnimationLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=new FileLoader(this.manager);H.setPath(this.path),H.setRequestHeader(this.requestHeader),H.setWithCredentials(this.withCredentials),H.load(x,(function(w){try{S(G.parse(JSON.parse(w)))}catch(S){U?U(S):console.error(S),G.manager.itemError(x)}}),w,U)}parse(x){const S=[];for(let w=0;w<x.length;w++){const U=AnimationClip.parse(x[w]);S.push(U)}return S}}class CompressedTextureLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=[],z=new CompressedTexture,j=new FileLoader(this.manager);j.setPath(this.path),j.setResponseType("arraybuffer"),j.setRequestHeader(this.requestHeader),j.setWithCredentials(G.withCredentials);let X=0;function loadTexture(K){j.load(x[K],(function(x){const w=G.parse(x,!0);H[K]={width:w.width,height:w.height,format:w.format,mipmaps:w.mipmaps},X+=1,6===X&&(1===w.mipmapCount&&(z.minFilter=rt),z.image=H,z.format=w.format,z.needsUpdate=!0,S&&S(z))}),w,U)}if(Array.isArray(x))for(let S=0,w=x.length;S<w;++S)loadTexture(S);else j.load(x,(function(x){const w=G.parse(x,!0);if(w.isCubemap){const x=w.mipmaps.length/w.mipmapCount;for(let S=0;S<x;S++){H[S]={mipmaps:[]};for(let x=0;x<w.mipmapCount;x++)H[S].mipmaps.push(w.mipmaps[S*w.mipmapCount+x]),H[S].format=w.format,H[S].width=w.width,H[S].height=w.height}z.image=H}else z.image.width=w.width,z.image.height=w.height,z.mipmaps=w.mipmaps;1===w.mipmapCount&&(z.minFilter=rt),z.format=w.format,z.needsUpdate=!0,S&&S(z)}),w,U);return z}}class ImageLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){void 0!==this.path&&(x=this.path+x),x=this.manager.resolveURL(x);const G=this,H=ds.get(x);if(void 0!==H)return G.manager.itemStart(x),setTimeout((function(){S&&S(H),G.manager.itemEnd(x)}),0),H;const z=createElementNS("img");function onImageLoad(){z.removeEventListener("load",onImageLoad,!1),z.removeEventListener("error",onImageError,!1),ds.add(x,this),S&&S(this),G.manager.itemEnd(x)}function onImageError(S){z.removeEventListener("load",onImageLoad,!1),z.removeEventListener("error",onImageError,!1),U&&U(S),G.manager.itemError(x),G.manager.itemEnd(x)}return z.addEventListener("load",onImageLoad,!1),z.addEventListener("error",onImageError,!1),"data:"!==x.substr(0,5)&&void 0!==this.crossOrigin&&(z.crossOrigin=this.crossOrigin),G.manager.itemStart(x),z.src=x,z}}class CubeTextureLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=new CubeTexture,H=new ImageLoader(this.manager);H.setCrossOrigin(this.crossOrigin),H.setPath(this.path);let z=0;function loadTexture(w){H.load(x[w],(function(x){G.images[w]=x,z++,6===z&&(G.needsUpdate=!0,S&&S(G))}),void 0,U)}for(let S=0;S<x.length;++S)loadTexture(S);return G}}class DataTextureLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=new DataTexture,z=new FileLoader(this.manager);return z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setPath(this.path),z.setWithCredentials(G.withCredentials),z.load(x,(function(x){const w=G.parse(x);w&&(void 0!==w.image?H.image=w.image:void 0!==w.data&&(H.image.width=w.width,H.image.height=w.height,H.image.data=w.data),H.wrapS=void 0!==w.wrapS?w.wrapS:Ze,H.wrapT=void 0!==w.wrapT?w.wrapT:Ze,H.magFilter=void 0!==w.magFilter?w.magFilter:rt,H.minFilter=void 0!==w.minFilter?w.minFilter:rt,H.anisotropy=void 0!==w.anisotropy?w.anisotropy:1,void 0!==w.encoding&&(H.encoding=w.encoding),void 0!==w.flipY&&(H.flipY=w.flipY),void 0!==w.format&&(H.format=w.format),void 0!==w.type&&(H.type=w.type),void 0!==w.mipmaps&&(H.mipmaps=w.mipmaps,H.minFilter=st),1===w.mipmapCount&&(H.minFilter=rt),void 0!==w.generateMipmaps&&(H.generateMipmaps=w.generateMipmaps),H.needsUpdate=!0,S&&S(H,w))}),w,U),H}}class TextureLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=new Texture,H=new ImageLoader(this.manager);return H.setCrossOrigin(this.crossOrigin),H.setPath(this.path),H.load(x,(function(x){G.image=x,G.needsUpdate=!0,void 0!==S&&S(G)}),w,U),G}}class Light extends Object3D{constructor(x,S=1){super(),this.type="Light",this.color=new Color(x),this.intensity=S}dispose(){}copy(x){return super.copy(x),this.color.copy(x.color),this.intensity=x.intensity,this}toJSON(x){const S=super.toJSON(x);return S.object.color=this.color.getHex(),S.object.intensity=this.intensity,void 0!==this.groundColor&&(S.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(S.object.distance=this.distance),void 0!==this.angle&&(S.object.angle=this.angle),void 0!==this.decay&&(S.object.decay=this.decay),void 0!==this.penumbra&&(S.object.penumbra=this.penumbra),void 0!==this.shadow&&(S.object.shadow=this.shadow.toJSON()),S}}Light.prototype.isLight=!0;class HemisphereLight extends Light{constructor(x,S,w){super(x,w),this.type="HemisphereLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(S)}copy(x){return Light.prototype.copy.call(this,x),this.groundColor.copy(x.groundColor),this}}HemisphereLight.prototype.isHemisphereLight=!0;const fs=new Matrix4,gs=new Vector3,vs=new Vector3;class LightShadow{constructor(x){this.camera=x,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(x){const S=this.camera,w=this.matrix;gs.setFromMatrixPosition(x.matrixWorld),S.position.copy(gs),vs.setFromMatrixPosition(x.target.matrixWorld),S.lookAt(vs),S.updateMatrixWorld(),fs.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fs),w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(S.projectionMatrix),w.multiply(S.matrixWorldInverse)}getViewport(x){return this._viewports[x]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(x){return this.camera=x.camera.clone(),this.bias=x.bias,this.radius=x.radius,this.mapSize.copy(x.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const x={};return 0!==this.bias&&(x.bias=this.bias),0!==this.normalBias&&(x.normalBias=this.normalBias),1!==this.radius&&(x.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(x.mapSize=this.mapSize.toArray()),x.camera=this.camera.toJSON(!1).object,delete x.camera.matrix,x}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.focus=1}updateMatrices(x){const S=this.camera,w=2*Vi*x.angle*this.focus,U=this.mapSize.width/this.mapSize.height,G=x.distance||S.far;w===S.fov&&U===S.aspect&&G===S.far||(S.fov=w,S.aspect=U,S.far=G,S.updateProjectionMatrix()),super.updateMatrices(x)}copy(x){return super.copy(x),this.focus=x.focus,this}}SpotLightShadow.prototype.isSpotLightShadow=!0;class SpotLight extends Light{constructor(x,S,w=0,U=Math.PI/3,G=0,H=1){super(x,S),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.distance=w,this.angle=U,this.penumbra=G,this.decay=H,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(x){this.intensity=x/Math.PI}dispose(){this.shadow.dispose()}copy(x){return super.copy(x),this.distance=x.distance,this.angle=x.angle,this.penumbra=x.penumbra,this.decay=x.decay,this.target=x.target.clone(),this.shadow=x.shadow.clone(),this}}SpotLight.prototype.isSpotLight=!0;const _s=new Matrix4,ys=new Vector3,bs=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(x,S=0){const w=this.camera,U=this.matrix,G=x.distance||w.far;G!==w.far&&(w.far=G,w.updateProjectionMatrix()),ys.setFromMatrixPosition(x.matrixWorld),w.position.copy(ys),bs.copy(w.position),bs.add(this._cubeDirections[S]),w.up.copy(this._cubeUps[S]),w.lookAt(bs),w.updateMatrixWorld(),U.makeTranslation(-ys.x,-ys.y,-ys.z),_s.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_s)}}PointLightShadow.prototype.isPointLightShadow=!0;class PointLight extends Light{constructor(x,S,w=0,U=1){super(x,S),this.type="PointLight",this.distance=w,this.decay=U,this.shadow=new PointLightShadow}get power(){return 4*this.intensity*Math.PI}set power(x){this.intensity=x/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(x){return super.copy(x),this.distance=x.distance,this.decay=x.decay,this.shadow=x.shadow.clone(),this}}PointLight.prototype.isPointLight=!0;class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500))}}DirectionalLightShadow.prototype.isDirectionalLightShadow=!0;class DirectionalLight extends Light{constructor(x,S){super(x,S),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(x){return super.copy(x),this.target=x.target.clone(),this.shadow=x.shadow.clone(),this}}DirectionalLight.prototype.isDirectionalLight=!0;class AmbientLight extends Light{constructor(x,S){super(x,S),this.type="AmbientLight"}}AmbientLight.prototype.isAmbientLight=!0;class RectAreaLight extends Light{constructor(x,S,w=10,U=10){super(x,S),this.type="RectAreaLight",this.width=w,this.height=U}get power(){return this.intensity*this.width*this.height*Math.PI}set power(x){this.intensity=x/(this.width*this.height*Math.PI)}copy(x){return super.copy(x),this.width=x.width,this.height=x.height,this}toJSON(x){const S=super.toJSON(x);return S.object.width=this.width,S.object.height=this.height,S}}RectAreaLight.prototype.isRectAreaLight=!0;class SphericalHarmonics3{constructor(){this.coefficients=[];for(let x=0;x<9;x++)this.coefficients.push(new Vector3)}set(x){for(let S=0;S<9;S++)this.coefficients[S].copy(x[S]);return this}zero(){for(let x=0;x<9;x++)this.coefficients[x].set(0,0,0);return this}getAt(x,S){const w=x.x,U=x.y,G=x.z,H=this.coefficients;return S.copy(H[0]).multiplyScalar(.282095),S.addScaledVector(H[1],.488603*U),S.addScaledVector(H[2],.488603*G),S.addScaledVector(H[3],.488603*w),S.addScaledVector(H[4],w*U*1.092548),S.addScaledVector(H[5],U*G*1.092548),S.addScaledVector(H[6],.315392*(3*G*G-1)),S.addScaledVector(H[7],w*G*1.092548),S.addScaledVector(H[8],.546274*(w*w-U*U)),S}getIrradianceAt(x,S){const w=x.x,U=x.y,G=x.z,H=this.coefficients;return S.copy(H[0]).multiplyScalar(.886227),S.addScaledVector(H[1],1.023328*U),S.addScaledVector(H[2],1.023328*G),S.addScaledVector(H[3],1.023328*w),S.addScaledVector(H[4],.858086*w*U),S.addScaledVector(H[5],.858086*U*G),S.addScaledVector(H[6],.743125*G*G-.247708),S.addScaledVector(H[7],.858086*w*G),S.addScaledVector(H[8],.429043*(w*w-U*U)),S}add(x){for(let S=0;S<9;S++)this.coefficients[S].add(x.coefficients[S]);return this}addScaledSH(x,S){for(let w=0;w<9;w++)this.coefficients[w].addScaledVector(x.coefficients[w],S);return this}scale(x){for(let S=0;S<9;S++)this.coefficients[S].multiplyScalar(x);return this}lerp(x,S){for(let w=0;w<9;w++)this.coefficients[w].lerp(x.coefficients[w],S);return this}equals(x){for(let S=0;S<9;S++)if(!this.coefficients[S].equals(x.coefficients[S]))return!1;return!0}copy(x){return this.set(x.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(x,S=0){const w=this.coefficients;for(let U=0;U<9;U++)w[U].fromArray(x,S+3*U);return this}toArray(x=[],S=0){const w=this.coefficients;for(let U=0;U<9;U++)w[U].toArray(x,S+3*U);return x}static getBasisAt(x,S){const w=x.x,U=x.y,G=x.z;S[0]=.282095,S[1]=.488603*U,S[2]=.488603*G,S[3]=.488603*w,S[4]=1.092548*w*U,S[5]=1.092548*U*G,S[6]=.315392*(3*G*G-1),S[7]=1.092548*w*G,S[8]=.546274*(w*w-U*U)}}SphericalHarmonics3.prototype.isSphericalHarmonics3=!0;class LightProbe extends Light{constructor(x=new SphericalHarmonics3,S=1){super(void 0,S),this.sh=x}copy(x){return super.copy(x),this.sh.copy(x.sh),this}fromJSON(x){return this.intensity=x.intensity,this.sh.fromArray(x.sh),this}toJSON(x){const S=super.toJSON(x);return S.object.sh=this.sh.toArray(),S}}LightProbe.prototype.isLightProbe=!0;class MaterialLoader extends Loader{constructor(x){super(x),this.textures={}}load(x,S,w,U){const G=this,H=new FileLoader(G.manager);H.setPath(G.path),H.setRequestHeader(G.requestHeader),H.setWithCredentials(G.withCredentials),H.load(x,(function(w){try{S(G.parse(JSON.parse(w)))}catch(S){U?U(S):console.error(S),G.manager.itemError(x)}}),w,U)}parse(x){const S=this.textures;function getTexture(x){return void 0===S[x]&&console.warn("THREE.MaterialLoader: Undefined texture",x),S[x]}const w=new us[x.type];if(void 0!==x.uuid&&(w.uuid=x.uuid),void 0!==x.name&&(w.name=x.name),void 0!==x.color&&void 0!==w.color&&w.color.setHex(x.color),void 0!==x.roughness&&(w.roughness=x.roughness),void 0!==x.metalness&&(w.metalness=x.metalness),void 0!==x.sheen&&(w.sheen=x.sheen),void 0!==x.sheenTint&&(w.sheenTint=(new Color).setHex(x.sheenTint)),void 0!==x.sheenRoughness&&(w.sheenRoughness=x.sheenRoughness),void 0!==x.emissive&&void 0!==w.emissive&&w.emissive.setHex(x.emissive),void 0!==x.specular&&void 0!==w.specular&&w.specular.setHex(x.specular),void 0!==x.specularIntensity&&(w.specularIntensity=x.specularIntensity),void 0!==x.specularTint&&void 0!==w.specularTint&&w.specularTint.setHex(x.specularTint),void 0!==x.shininess&&(w.shininess=x.shininess),void 0!==x.clearcoat&&(w.clearcoat=x.clearcoat),void 0!==x.clearcoatRoughness&&(w.clearcoatRoughness=x.clearcoatRoughness),void 0!==x.transmission&&(w.transmission=x.transmission),void 0!==x.thickness&&(w.thickness=x.thickness),void 0!==x.attenuationDistance&&(w.attenuationDistance=x.attenuationDistance),void 0!==x.attenuationTint&&void 0!==w.attenuationTint&&w.attenuationTint.setHex(x.attenuationTint),void 0!==x.fog&&(w.fog=x.fog),void 0!==x.flatShading&&(w.flatShading=x.flatShading),void 0!==x.blending&&(w.blending=x.blending),void 0!==x.combine&&(w.combine=x.combine),void 0!==x.side&&(w.side=x.side),void 0!==x.shadowSide&&(w.shadowSide=x.shadowSide),void 0!==x.opacity&&(w.opacity=x.opacity),void 0!==x.format&&(w.format=x.format),void 0!==x.transparent&&(w.transparent=x.transparent),void 0!==x.alphaTest&&(w.alphaTest=x.alphaTest),void 0!==x.depthTest&&(w.depthTest=x.depthTest),void 0!==x.depthWrite&&(w.depthWrite=x.depthWrite),void 0!==x.colorWrite&&(w.colorWrite=x.colorWrite),void 0!==x.stencilWrite&&(w.stencilWrite=x.stencilWrite),void 0!==x.stencilWriteMask&&(w.stencilWriteMask=x.stencilWriteMask),void 0!==x.stencilFunc&&(w.stencilFunc=x.stencilFunc),void 0!==x.stencilRef&&(w.stencilRef=x.stencilRef),void 0!==x.stencilFuncMask&&(w.stencilFuncMask=x.stencilFuncMask),void 0!==x.stencilFail&&(w.stencilFail=x.stencilFail),void 0!==x.stencilZFail&&(w.stencilZFail=x.stencilZFail),void 0!==x.stencilZPass&&(w.stencilZPass=x.stencilZPass),void 0!==x.wireframe&&(w.wireframe=x.wireframe),void 0!==x.wireframeLinewidth&&(w.wireframeLinewidth=x.wireframeLinewidth),void 0!==x.wireframeLinecap&&(w.wireframeLinecap=x.wireframeLinecap),void 0!==x.wireframeLinejoin&&(w.wireframeLinejoin=x.wireframeLinejoin),void 0!==x.rotation&&(w.rotation=x.rotation),1!==x.linewidth&&(w.linewidth=x.linewidth),void 0!==x.dashSize&&(w.dashSize=x.dashSize),void 0!==x.gapSize&&(w.gapSize=x.gapSize),void 0!==x.scale&&(w.scale=x.scale),void 0!==x.polygonOffset&&(w.polygonOffset=x.polygonOffset),void 0!==x.polygonOffsetFactor&&(w.polygonOffsetFactor=x.polygonOffsetFactor),void 0!==x.polygonOffsetUnits&&(w.polygonOffsetUnits=x.polygonOffsetUnits),void 0!==x.dithering&&(w.dithering=x.dithering),void 0!==x.alphaToCoverage&&(w.alphaToCoverage=x.alphaToCoverage),void 0!==x.premultipliedAlpha&&(w.premultipliedAlpha=x.premultipliedAlpha),void 0!==x.visible&&(w.visible=x.visible),void 0!==x.toneMapped&&(w.toneMapped=x.toneMapped),void 0!==x.userData&&(w.userData=x.userData),void 0!==x.vertexColors&&("number"==typeof x.vertexColors?w.vertexColors=x.vertexColors>0:w.vertexColors=x.vertexColors),void 0!==x.uniforms)for(const S in x.uniforms){const U=x.uniforms[S];switch(w.uniforms[S]={},U.type){case"t":w.uniforms[S].value=getTexture(U.value);break;case"c":w.uniforms[S].value=(new Color).setHex(U.value);break;case"v2":w.uniforms[S].value=(new Vector2).fromArray(U.value);break;case"v3":w.uniforms[S].value=(new Vector3).fromArray(U.value);break;case"v4":w.uniforms[S].value=(new Vector4).fromArray(U.value);break;case"m3":w.uniforms[S].value=(new Matrix3).fromArray(U.value);break;case"m4":w.uniforms[S].value=(new Matrix4).fromArray(U.value);break;default:w.uniforms[S].value=U.value}}if(void 0!==x.defines&&(w.defines=x.defines),void 0!==x.vertexShader&&(w.vertexShader=x.vertexShader),void 0!==x.fragmentShader&&(w.fragmentShader=x.fragmentShader),void 0!==x.extensions)for(const S in x.extensions)w.extensions[S]=x.extensions[S];if(void 0!==x.shading&&(w.flatShading=1===x.shading),void 0!==x.size&&(w.size=x.size),void 0!==x.sizeAttenuation&&(w.sizeAttenuation=x.sizeAttenuation),void 0!==x.map&&(w.map=getTexture(x.map)),void 0!==x.matcap&&(w.matcap=getTexture(x.matcap)),void 0!==x.alphaMap&&(w.alphaMap=getTexture(x.alphaMap)),void 0!==x.bumpMap&&(w.bumpMap=getTexture(x.bumpMap)),void 0!==x.bumpScale&&(w.bumpScale=x.bumpScale),void 0!==x.normalMap&&(w.normalMap=getTexture(x.normalMap)),void 0!==x.normalMapType&&(w.normalMapType=x.normalMapType),void 0!==x.normalScale){let S=x.normalScale;!1===Array.isArray(S)&&(S=[S,S]),w.normalScale=(new Vector2).fromArray(S)}return void 0!==x.displacementMap&&(w.displacementMap=getTexture(x.displacementMap)),void 0!==x.displacementScale&&(w.displacementScale=x.displacementScale),void 0!==x.displacementBias&&(w.displacementBias=x.displacementBias),void 0!==x.roughnessMap&&(w.roughnessMap=getTexture(x.roughnessMap)),void 0!==x.metalnessMap&&(w.metalnessMap=getTexture(x.metalnessMap)),void 0!==x.emissiveMap&&(w.emissiveMap=getTexture(x.emissiveMap)),void 0!==x.emissiveIntensity&&(w.emissiveIntensity=x.emissiveIntensity),void 0!==x.specularMap&&(w.specularMap=getTexture(x.specularMap)),void 0!==x.specularIntensityMap&&(w.specularIntensityMap=getTexture(x.specularIntensityMap)),void 0!==x.specularTintMap&&(w.specularTintMap=getTexture(x.specularTintMap)),void 0!==x.envMap&&(w.envMap=getTexture(x.envMap)),void 0!==x.envMapIntensity&&(w.envMapIntensity=x.envMapIntensity),void 0!==x.reflectivity&&(w.reflectivity=x.reflectivity),void 0!==x.refractionRatio&&(w.refractionRatio=x.refractionRatio),void 0!==x.lightMap&&(w.lightMap=getTexture(x.lightMap)),void 0!==x.lightMapIntensity&&(w.lightMapIntensity=x.lightMapIntensity),void 0!==x.aoMap&&(w.aoMap=getTexture(x.aoMap)),void 0!==x.aoMapIntensity&&(w.aoMapIntensity=x.aoMapIntensity),void 0!==x.gradientMap&&(w.gradientMap=getTexture(x.gradientMap)),void 0!==x.clearcoatMap&&(w.clearcoatMap=getTexture(x.clearcoatMap)),void 0!==x.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap=getTexture(x.clearcoatRoughnessMap)),void 0!==x.clearcoatNormalMap&&(w.clearcoatNormalMap=getTexture(x.clearcoatNormalMap)),void 0!==x.clearcoatNormalScale&&(w.clearcoatNormalScale=(new Vector2).fromArray(x.clearcoatNormalScale)),void 0!==x.transmissionMap&&(w.transmissionMap=getTexture(x.transmissionMap)),void 0!==x.thicknessMap&&(w.thicknessMap=getTexture(x.thicknessMap)),w}setTextures(x){return this.textures=x,this}}class LoaderUtils{static decodeText(x){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(x);let S="";for(let w=0,U=x.length;w<U;w++)S+=String.fromCharCode(x[w]);try{return decodeURIComponent(escape(S))}catch(x){return S}}static extractUrlBase(x){const S=x.lastIndexOf("/");return-1===S?"./":x.substr(0,S+1)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(x){return super.copy(x),this.instanceCount=x.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const x=super.toJSON(this);return x.instanceCount=this.instanceCount,x.isInstancedBufferGeometry=!0,x}}InstancedBufferGeometry.prototype.isInstancedBufferGeometry=!0;class BufferGeometryLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=new FileLoader(G.manager);H.setPath(G.path),H.setRequestHeader(G.requestHeader),H.setWithCredentials(G.withCredentials),H.load(x,(function(w){try{S(G.parse(JSON.parse(w)))}catch(S){U?U(S):console.error(S),G.manager.itemError(x)}}),w,U)}parse(x){const S={},w={};function getInterleavedBuffer(x,U){if(void 0!==S[U])return S[U];const G=x.interleavedBuffers[U],H=function getArrayBuffer(x,S){if(void 0!==w[S])return w[S];const U=x.arrayBuffers[S],G=new Uint32Array(U).buffer;return w[S]=G,G}(x,G.buffer),z=getTypedArray(G.type,H),j=new InterleavedBuffer(z,G.stride);return j.uuid=G.uuid,S[U]=j,j}const U=x.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,G=x.data.index;if(void 0!==G){const x=getTypedArray(G.type,G.array);U.setIndex(new BufferAttribute(x,1))}const H=x.data.attributes;for(const S in H){const w=H[S];let G;if(w.isInterleavedBufferAttribute){const S=getInterleavedBuffer(x.data,w.data);G=new InterleavedBufferAttribute(S,w.itemSize,w.offset,w.normalized)}else{const x=getTypedArray(w.type,w.array);G=new(w.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute)(x,w.itemSize,w.normalized)}void 0!==w.name&&(G.name=w.name),void 0!==w.usage&&G.setUsage(w.usage),void 0!==w.updateRange&&(G.updateRange.offset=w.updateRange.offset,G.updateRange.count=w.updateRange.count),U.setAttribute(S,G)}const z=x.data.morphAttributes;if(z)for(const S in z){const w=z[S],G=[];for(let S=0,U=w.length;S<U;S++){const U=w[S];let H;if(U.isInterleavedBufferAttribute){const S=getInterleavedBuffer(x.data,U.data);H=new InterleavedBufferAttribute(S,U.itemSize,U.offset,U.normalized)}else{const x=getTypedArray(U.type,U.array);H=new BufferAttribute(x,U.itemSize,U.normalized)}void 0!==U.name&&(H.name=U.name),G.push(H)}U.morphAttributes[S]=G}x.data.morphTargetsRelative&&(U.morphTargetsRelative=!0);const j=x.data.groups||x.data.drawcalls||x.data.offsets;if(void 0!==j)for(let x=0,S=j.length;x!==S;++x){const S=j[x];U.addGroup(S.start,S.count,S.materialIndex)}const X=x.data.boundingSphere;if(void 0!==X){const x=new Vector3;void 0!==X.center&&x.fromArray(X.center),U.boundingSphere=new Sphere(x,X.radius)}return x.name&&(U.name=x.name),x.userData&&(U.userData=x.userData),U}}class ObjectLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=""===this.path?LoaderUtils.extractUrlBase(x):this.path;this.resourcePath=this.resourcePath||H;const z=new FileLoader(this.manager);z.setPath(this.path),z.setRequestHeader(this.requestHeader),z.setWithCredentials(this.withCredentials),z.load(x,(function(w){let H=null;try{H=JSON.parse(w)}catch(S){return void 0!==U&&U(S),void console.error("THREE:ObjectLoader: Can't parse "+x+".",S.message)}const z=H.metadata;void 0!==z&&void 0!==z.type&&"geometry"!==z.type.toLowerCase()?G.parse(H,S):console.error("THREE.ObjectLoader: Can't load "+x)}),w,U)}async loadAsync(x,S){const w=""===this.path?LoaderUtils.extractUrlBase(x):this.path;this.resourcePath=this.resourcePath||w;const U=new FileLoader(this.manager);U.setPath(this.path),U.setRequestHeader(this.requestHeader),U.setWithCredentials(this.withCredentials);const G=await U.loadAsync(x,S),H=JSON.parse(G),z=H.metadata;if(void 0===z||void 0===z.type||"geometry"===z.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+x);return await this.parseAsync(H)}parse(x,S){const w=this.parseAnimations(x.animations),U=this.parseShapes(x.shapes),G=this.parseGeometries(x.geometries,U),H=this.parseImages(x.images,(function(){void 0!==S&&S(X)})),z=this.parseTextures(x.textures,H),j=this.parseMaterials(x.materials,z),X=this.parseObject(x.object,G,j,z,w),K=this.parseSkeletons(x.skeletons,X);if(this.bindSkeletons(X,K),void 0!==S){let x=!1;for(const S in H)if(H[S]instanceof HTMLImageElement){x=!0;break}!1===x&&S(X)}return X}async parseAsync(x){const S=this.parseAnimations(x.animations),w=this.parseShapes(x.shapes),U=this.parseGeometries(x.geometries,w),G=await this.parseImagesAsync(x.images),H=this.parseTextures(x.textures,G),z=this.parseMaterials(x.materials,H),j=this.parseObject(x.object,U,z,H,S),X=this.parseSkeletons(x.skeletons,j);return this.bindSkeletons(j,X),j}parseShapes(x){const S={};if(void 0!==x)for(let w=0,U=x.length;w<U;w++){const U=(new Shape).fromJSON(x[w]);S[U.uuid]=U}return S}parseSkeletons(x,S){const w={},U={};if(S.traverse((function(x){x.isBone&&(U[x.uuid]=x)})),void 0!==x)for(let S=0,G=x.length;S<G;S++){const G=(new Skeleton).fromJSON(x[S],U);w[G.uuid]=G}return w}parseGeometries(x,S){const w={};if(void 0!==x){const U=new BufferGeometryLoader;for(let G=0,H=x.length;G<H;G++){let H;const z=x[G];switch(z.type){case"BufferGeometry":case"InstancedBufferGeometry":H=U.parse(z);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:z.type in cs?H=cs[z.type].fromJSON(z,S):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${z.type}"`)}H.uuid=z.uuid,void 0!==z.name&&(H.name=z.name),!0===H.isBufferGeometry&&void 0!==z.userData&&(H.userData=z.userData),w[z.uuid]=H}}return w}parseMaterials(x,S){const w={},U={};if(void 0!==x){const G=new MaterialLoader;G.setTextures(S);for(let S=0,H=x.length;S<H;S++){const H=x[S];if("MultiMaterial"===H.type){const x=[];for(let S=0;S<H.materials.length;S++){const U=H.materials[S];void 0===w[U.uuid]&&(w[U.uuid]=G.parse(U)),x.push(w[U.uuid])}U[H.uuid]=x}else void 0===w[H.uuid]&&(w[H.uuid]=G.parse(H)),U[H.uuid]=w[H.uuid]}}return U}parseAnimations(x){const S={};if(void 0!==x)for(let w=0;w<x.length;w++){const U=x[w],G=AnimationClip.parse(U);S[G.uuid]=G}return S}parseImages(x,S){const w=this,U={};let G;function deserializeImage(x){if("string"==typeof x){const S=x;return function loadImage(x){return w.manager.itemStart(x),G.load(x,(function(){w.manager.itemEnd(x)}),void 0,(function(){w.manager.itemError(x),w.manager.itemEnd(x)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(S)?S:w.resourcePath+S)}return x.data?{data:getTypedArray(x.type,x.data),width:x.width,height:x.height}:null}if(void 0!==x&&x.length>0){const w=new LoadingManager(S);G=new ImageLoader(w),G.setCrossOrigin(this.crossOrigin);for(let S=0,w=x.length;S<w;S++){const w=x[S],G=w.url;if(Array.isArray(G)){U[w.uuid]=[];for(let x=0,S=G.length;x<S;x++){const S=deserializeImage(G[x]);null!==S&&(S instanceof HTMLImageElement?U[w.uuid].push(S):U[w.uuid].push(new DataTexture(S.data,S.width,S.height)))}}else{const x=deserializeImage(w.url);null!==x&&(U[w.uuid]=x)}}}return U}async parseImagesAsync(x){const S=this,w={};let U;async function deserializeImage(x){if("string"==typeof x){const w=x,G=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:S.resourcePath+w;return await U.loadAsync(G)}return x.data?{data:getTypedArray(x.type,x.data),width:x.width,height:x.height}:null}if(void 0!==x&&x.length>0){U=new ImageLoader(this.manager),U.setCrossOrigin(this.crossOrigin);for(let S=0,U=x.length;S<U;S++){const U=x[S],G=U.url;if(Array.isArray(G)){w[U.uuid]=[];for(let x=0,S=G.length;x<S;x++){const S=G[x],H=await deserializeImage(S);null!==H&&(H instanceof HTMLImageElement?w[U.uuid].push(H):w[U.uuid].push(new DataTexture(H.data,H.width,H.height)))}}else{const x=await deserializeImage(U.url);null!==x&&(w[U.uuid]=x)}}}return w}parseTextures(x,S){function parseConstant(x,S){return"number"==typeof x?x:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",x),S[x])}const w={};if(void 0!==x)for(let U=0,G=x.length;U<G;U++){const G=x[U];let H;void 0===G.image&&console.warn('THREE.ObjectLoader: No "image" specified for',G.uuid),void 0===S[G.image]&&console.warn("THREE.ObjectLoader: Undefined image",G.image);const z=S[G.image];Array.isArray(z)?(H=new CubeTexture(z),6===z.length&&(H.needsUpdate=!0)):(H=z&&z.data?new DataTexture(z.data,z.width,z.height):new Texture(z),z&&(H.needsUpdate=!0)),H.uuid=G.uuid,void 0!==G.name&&(H.name=G.name),void 0!==G.mapping&&(H.mapping=parseConstant(G.mapping,xs)),void 0!==G.offset&&H.offset.fromArray(G.offset),void 0!==G.repeat&&H.repeat.fromArray(G.repeat),void 0!==G.center&&H.center.fromArray(G.center),void 0!==G.rotation&&(H.rotation=G.rotation),void 0!==G.wrap&&(H.wrapS=parseConstant(G.wrap[0],Es),H.wrapT=parseConstant(G.wrap[1],Es)),void 0!==G.format&&(H.format=G.format),void 0!==G.type&&(H.type=G.type),void 0!==G.encoding&&(H.encoding=G.encoding),void 0!==G.minFilter&&(H.minFilter=parseConstant(G.minFilter,Ss)),void 0!==G.magFilter&&(H.magFilter=parseConstant(G.magFilter,Ss)),void 0!==G.anisotropy&&(H.anisotropy=G.anisotropy),void 0!==G.flipY&&(H.flipY=G.flipY),void 0!==G.premultiplyAlpha&&(H.premultiplyAlpha=G.premultiplyAlpha),void 0!==G.unpackAlignment&&(H.unpackAlignment=G.unpackAlignment),w[G.uuid]=H}return w}parseObject(x,S,w,U,G){let H,z,j;function getGeometry(x){return void 0===S[x]&&console.warn("THREE.ObjectLoader: Undefined geometry",x),S[x]}function getMaterial(x){if(void 0!==x){if(Array.isArray(x)){const S=[];for(let U=0,G=x.length;U<G;U++){const G=x[U];void 0===w[G]&&console.warn("THREE.ObjectLoader: Undefined material",G),S.push(w[G])}return S}return void 0===w[x]&&console.warn("THREE.ObjectLoader: Undefined material",x),w[x]}}function getTexture(x){return void 0===U[x]&&console.warn("THREE.ObjectLoader: Undefined texture",x),U[x]}switch(x.type){case"Scene":H=new Scene,void 0!==x.background&&(Number.isInteger(x.background)?H.background=new Color(x.background):H.background=getTexture(x.background)),void 0!==x.environment&&(H.environment=getTexture(x.environment)),void 0!==x.fog&&("Fog"===x.fog.type?H.fog=new Fog(x.fog.color,x.fog.near,x.fog.far):"FogExp2"===x.fog.type&&(H.fog=new FogExp2(x.fog.color,x.fog.density)));break;case"PerspectiveCamera":H=new PerspectiveCamera(x.fov,x.aspect,x.near,x.far),void 0!==x.focus&&(H.focus=x.focus),void 0!==x.zoom&&(H.zoom=x.zoom),void 0!==x.filmGauge&&(H.filmGauge=x.filmGauge),void 0!==x.filmOffset&&(H.filmOffset=x.filmOffset),void 0!==x.view&&(H.view=Object.assign({},x.view));break;case"OrthographicCamera":H=new OrthographicCamera(x.left,x.right,x.top,x.bottom,x.near,x.far),void 0!==x.zoom&&(H.zoom=x.zoom),void 0!==x.view&&(H.view=Object.assign({},x.view));break;case"AmbientLight":H=new AmbientLight(x.color,x.intensity);break;case"DirectionalLight":H=new DirectionalLight(x.color,x.intensity);break;case"PointLight":H=new PointLight(x.color,x.intensity,x.distance,x.decay);break;case"RectAreaLight":H=new RectAreaLight(x.color,x.intensity,x.width,x.height);break;case"SpotLight":H=new SpotLight(x.color,x.intensity,x.distance,x.angle,x.penumbra,x.decay);break;case"HemisphereLight":H=new HemisphereLight(x.color,x.groundColor,x.intensity);break;case"LightProbe":H=(new LightProbe).fromJSON(x);break;case"SkinnedMesh":z=getGeometry(x.geometry),j=getMaterial(x.material),H=new SkinnedMesh(z,j),void 0!==x.bindMode&&(H.bindMode=x.bindMode),void 0!==x.bindMatrix&&H.bindMatrix.fromArray(x.bindMatrix),void 0!==x.skeleton&&(H.skeleton=x.skeleton);break;case"Mesh":z=getGeometry(x.geometry),j=getMaterial(x.material),H=new Mesh(z,j);break;case"InstancedMesh":z=getGeometry(x.geometry),j=getMaterial(x.material);const S=x.count,w=x.instanceMatrix,U=x.instanceColor;H=new InstancedMesh(z,j,S),H.instanceMatrix=new InstancedBufferAttribute(new Float32Array(w.array),16),void 0!==U&&(H.instanceColor=new InstancedBufferAttribute(new Float32Array(U.array),U.itemSize));break;case"LOD":H=new LOD;break;case"Line":H=new Line(getGeometry(x.geometry),getMaterial(x.material));break;case"LineLoop":H=new LineLoop(getGeometry(x.geometry),getMaterial(x.material));break;case"LineSegments":H=new LineSegments(getGeometry(x.geometry),getMaterial(x.material));break;case"PointCloud":case"Points":H=new Points(getGeometry(x.geometry),getMaterial(x.material));break;case"Sprite":H=new Sprite(getMaterial(x.material));break;case"Group":H=new Group;break;case"Bone":H=new Bone;break;default:H=new Object3D}if(H.uuid=x.uuid,void 0!==x.name&&(H.name=x.name),void 0!==x.matrix?(H.matrix.fromArray(x.matrix),void 0!==x.matrixAutoUpdate&&(H.matrixAutoUpdate=x.matrixAutoUpdate),H.matrixAutoUpdate&&H.matrix.decompose(H.position,H.quaternion,H.scale)):(void 0!==x.position&&H.position.fromArray(x.position),void 0!==x.rotation&&H.rotation.fromArray(x.rotation),void 0!==x.quaternion&&H.quaternion.fromArray(x.quaternion),void 0!==x.scale&&H.scale.fromArray(x.scale)),void 0!==x.castShadow&&(H.castShadow=x.castShadow),void 0!==x.receiveShadow&&(H.receiveShadow=x.receiveShadow),x.shadow&&(void 0!==x.shadow.bias&&(H.shadow.bias=x.shadow.bias),void 0!==x.shadow.normalBias&&(H.shadow.normalBias=x.shadow.normalBias),void 0!==x.shadow.radius&&(H.shadow.radius=x.shadow.radius),void 0!==x.shadow.mapSize&&H.shadow.mapSize.fromArray(x.shadow.mapSize),void 0!==x.shadow.camera&&(H.shadow.camera=this.parseObject(x.shadow.camera))),void 0!==x.visible&&(H.visible=x.visible),void 0!==x.frustumCulled&&(H.frustumCulled=x.frustumCulled),void 0!==x.renderOrder&&(H.renderOrder=x.renderOrder),void 0!==x.userData&&(H.userData=x.userData),void 0!==x.layers&&(H.layers.mask=x.layers),void 0!==x.children){const z=x.children;for(let x=0;x<z.length;x++)H.add(this.parseObject(z[x],S,w,U,G))}if(void 0!==x.animations){const S=x.animations;for(let x=0;x<S.length;x++){const w=S[x];H.animations.push(G[w])}}if("LOD"===x.type){void 0!==x.autoUpdate&&(H.autoUpdate=x.autoUpdate);const S=x.levels;for(let x=0;x<S.length;x++){const w=S[x],U=H.getObjectByProperty("uuid",w.object);void 0!==U&&H.addLevel(U,w.distance)}}return H}bindSkeletons(x,S){0!==Object.keys(S).length&&x.traverse((function(x){if(!0===x.isSkinnedMesh&&void 0!==x.skeleton){const w=S[x.skeleton];void 0===w?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",x.skeleton):x.bind(w,x.bindMatrix)}}))}setTexturePath(x){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(x)}}const xs={UVMapping:We,CubeReflectionMapping:$e,CubeRefractionMapping:ze,EquirectangularReflectionMapping:je,EquirectangularRefractionMapping:Xe,CubeUVReflectionMapping:Ke,CubeUVRefractionMapping:qe},Es={RepeatWrapping:Ye,ClampToEdgeWrapping:Ze,MirroredRepeatWrapping:Je},Ss={NearestFilter:Qe,NearestMipmapNearestFilter:et,NearestMipmapLinearFilter:nt,LinearFilter:rt,LinearMipmapNearestFilter:ot,LinearMipmapLinearFilter:st};class ImageBitmapLoader extends Loader{constructor(x){super(x),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(x){return this.options=x,this}load(x,S,w,U){void 0===x&&(x=""),void 0!==this.path&&(x=this.path+x),x=this.manager.resolveURL(x);const G=this,H=ds.get(x);if(void 0!==H)return G.manager.itemStart(x),setTimeout((function(){S&&S(H),G.manager.itemEnd(x)}),0),H;const z={};z.credentials="anonymous"===this.crossOrigin?"same-origin":"include",z.headers=this.requestHeader,fetch(x,z).then((function(x){return x.blob()})).then((function(x){return createImageBitmap(x,Object.assign(G.options,{colorSpaceConversion:"none"}))})).then((function(w){ds.add(x,w),S&&S(w),G.manager.itemEnd(x)})).catch((function(S){U&&U(S),G.manager.itemError(x),G.manager.itemEnd(x)})),G.manager.itemStart(x)}}let ws;ImageBitmapLoader.prototype.isImageBitmapLoader=!0;const Ts={getContext:function(){return void 0===ws&&(ws=new(window.AudioContext||window.webkitAudioContext)),ws},setContext:function(x){ws=x}};class AudioLoader extends Loader{constructor(x){super(x)}load(x,S,w,U){const G=this,H=new FileLoader(this.manager);H.setResponseType("arraybuffer"),H.setPath(this.path),H.setRequestHeader(this.requestHeader),H.setWithCredentials(this.withCredentials),H.load(x,(function(w){try{const x=w.slice(0);Ts.getContext().decodeAudioData(x,(function(x){S(x)}))}catch(S){U?U(S):console.error(S),G.manager.itemError(x)}}),w,U)}}class HemisphereLightProbe extends LightProbe{constructor(x,S,w=1){super(void 0,w);const U=(new Color).set(x),G=(new Color).set(S),H=new Vector3(U.r,U.g,U.b),z=new Vector3(G.r,G.g,G.b),j=Math.sqrt(Math.PI),X=j*Math.sqrt(.75);this.sh.coefficients[0].copy(H).add(z).multiplyScalar(j),this.sh.coefficients[1].copy(H).sub(z).multiplyScalar(X)}}HemisphereLightProbe.prototype.isHemisphereLightProbe=!0;class AmbientLightProbe extends LightProbe{constructor(x,S=1){super(void 0,S);const w=(new Color).set(x);this.sh.coefficients[0].set(w.r,w.g,w.b).multiplyScalar(2*Math.sqrt(Math.PI))}}AmbientLightProbe.prototype.isAmbientLightProbe=!0;const Cs=new Matrix4,As=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(x){const S=this._cache;if(S.focus!==x.focus||S.fov!==x.fov||S.aspect!==x.aspect*this.aspect||S.near!==x.near||S.far!==x.far||S.zoom!==x.zoom||S.eyeSep!==this.eyeSep){S.focus=x.focus,S.fov=x.fov,S.aspect=x.aspect*this.aspect,S.near=x.near,S.far=x.far,S.zoom=x.zoom,S.eyeSep=this.eyeSep;const w=x.projectionMatrix.clone(),U=S.eyeSep/2,G=U*S.near/S.focus,H=S.near*Math.tan(Gi*S.fov*.5)/S.zoom;let z,j;As.elements[12]=-U,Cs.elements[12]=U,z=-H*S.aspect+G,j=H*S.aspect+G,w.elements[0]=2*S.near/(j-z),w.elements[8]=(j+z)/(j-z),this.cameraL.projectionMatrix.copy(w),z=-H*S.aspect-G,j=H*S.aspect-G,w.elements[0]=2*S.near/(j-z),w.elements[8]=(j+z)/(j-z),this.cameraR.projectionMatrix.copy(w)}this.cameraL.matrixWorld.copy(x.matrixWorld).multiply(As),this.cameraR.matrixWorld.copy(x.matrixWorld).multiply(Cs)}}class Clock{constructor(x=!0){this.autoStart=x,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let x=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const S=now();x=(S-this.oldTime)/1e3,this.oldTime=S,this.elapsedTime+=x}return x}}function now(){return("undefined"==typeof performance?Date:performance).now()}const Ms=new Vector3,Rs=new Quaternion,Ls=new Vector3,Is=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=Ts.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(x){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=x,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(x){return this.gain.gain.setTargetAtTime(x,this.context.currentTime,.01),this}updateMatrixWorld(x){super.updateMatrixWorld(x);const S=this.context.listener,w=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ms,Rs,Ls),Is.set(0,0,-1).applyQuaternion(Rs),S.positionX){const x=this.context.currentTime+this.timeDelta;S.positionX.linearRampToValueAtTime(Ms.x,x),S.positionY.linearRampToValueAtTime(Ms.y,x),S.positionZ.linearRampToValueAtTime(Ms.z,x),S.forwardX.linearRampToValueAtTime(Is.x,x),S.forwardY.linearRampToValueAtTime(Is.y,x),S.forwardZ.linearRampToValueAtTime(Is.z,x),S.upX.linearRampToValueAtTime(w.x,x),S.upY.linearRampToValueAtTime(w.y,x),S.upZ.linearRampToValueAtTime(w.z,x)}else S.setPosition(Ms.x,Ms.y,Ms.z),S.setOrientation(Is.x,Is.y,Is.z,w.x,w.y,w.z)}}class Audio extends Object3D{constructor(x){super(),this.type="Audio",this.listener=x,this.context=x.context,this.gain=this.context.createGain(),this.gain.connect(x.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(x){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=x,this.connect(),this}setMediaElementSource(x){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(x),this.connect(),this}setMediaStreamSource(x){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(x),this.connect(),this}setBuffer(x){return this.buffer=x,this.sourceType="buffer",this.autoplay&&this.play(),this}play(x=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+x;const S=this.context.createBufferSource();return S.buffer=this.buffer,S.loop=this.loop,S.loopStart=this.loopStart,S.loopEnd=this.loopEnd,S.onended=this.onEnded.bind(this),S.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=S,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let x=1,S=this.filters.length;x<S;x++)this.filters[x-1].connect(this.filters[x]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let x=1,S=this.filters.length;x<S;x++)this.filters[x-1].disconnect(this.filters[x]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(x){return x||(x=[]),!0===this._connected?(this.disconnect(),this.filters=x.slice(),this.connect()):this.filters=x.slice(),this}setDetune(x){if(this.detune=x,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(x){return this.setFilters(x?[x]:[])}setPlaybackRate(x){if(!1!==this.hasPlaybackControl)return this.playbackRate=x,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(x){if(!1!==this.hasPlaybackControl)return this.loop=x,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(x){return this.loopStart=x,this}setLoopEnd(x){return this.loopEnd=x,this}getVolume(){return this.gain.gain.value}setVolume(x){return this.gain.gain.setTargetAtTime(x,this.context.currentTime,.01),this}}const Ps=new Vector3,Fs=new Quaternion,Os=new Vector3,Ns=new Vector3;class PositionalAudio extends Audio{constructor(x){super(x),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(x){return this.panner.refDistance=x,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(x){return this.panner.rolloffFactor=x,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(x){return this.panner.distanceModel=x,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(x){return this.panner.maxDistance=x,this}setDirectionalCone(x,S,w){return this.panner.coneInnerAngle=x,this.panner.coneOuterAngle=S,this.panner.coneOuterGain=w,this}updateMatrixWorld(x){if(super.updateMatrixWorld(x),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Ps,Fs,Os),Ns.set(0,0,1).applyQuaternion(Fs);const S=this.panner;if(S.positionX){const x=this.context.currentTime+this.listener.timeDelta;S.positionX.linearRampToValueAtTime(Ps.x,x),S.positionY.linearRampToValueAtTime(Ps.y,x),S.positionZ.linearRampToValueAtTime(Ps.z,x),S.orientationX.linearRampToValueAtTime(Ns.x,x),S.orientationY.linearRampToValueAtTime(Ns.y,x),S.orientationZ.linearRampToValueAtTime(Ns.z,x)}else S.setPosition(Ps.x,Ps.y,Ps.z),S.setOrientation(Ns.x,Ns.y,Ns.z)}}class AudioAnalyser{constructor(x,S=2048){this.analyser=x.context.createAnalyser(),this.analyser.fftSize=S,this.data=new Uint8Array(this.analyser.frequencyBinCount),x.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let x=0;const S=this.getFrequencyData();for(let w=0;w<S.length;w++)x+=S[w];return x/S.length}}class PropertyMixer{constructor(x,S,w){let U,G,H;switch(this.binding=x,this.valueSize=w,S){case"quaternion":U=this._slerp,G=this._slerpAdditive,H=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*w),this._workIndex=5;break;case"string":case"bool":U=this._select,G=this._select,H=this._setAdditiveIdentityOther,this.buffer=new Array(5*w);break;default:U=this._lerp,G=this._lerpAdditive,H=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*w)}this._mixBufferRegion=U,this._mixBufferRegionAdditive=G,this._setIdentity=H,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(x,S){const w=this.buffer,U=this.valueSize,G=x*U+U;let H=this.cumulativeWeight;if(0===H){for(let x=0;x!==U;++x)w[G+x]=w[x];H=S}else{H+=S;const x=S/H;this._mixBufferRegion(w,G,0,x,U)}this.cumulativeWeight=H}accumulateAdditive(x){const S=this.buffer,w=this.valueSize,U=w*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(S,U,0,x,w),this.cumulativeWeightAdditive+=x}apply(x){const S=this.valueSize,w=this.buffer,U=x*S+S,G=this.cumulativeWeight,H=this.cumulativeWeightAdditive,z=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,G<1){const x=S*this._origIndex;this._mixBufferRegion(w,U,x,1-G,S)}H>0&&this._mixBufferRegionAdditive(w,U,this._addIndex*S,1,S);for(let x=S,G=S+S;x!==G;++x)if(w[x]!==w[x+S]){z.setValue(w,U);break}}saveOriginalState(){const x=this.binding,S=this.buffer,w=this.valueSize,U=w*this._origIndex;x.getValue(S,U);for(let x=w,G=U;x!==G;++x)S[x]=S[U+x%w];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const x=3*this.valueSize;this.binding.setValue(this.buffer,x)}_setAdditiveIdentityNumeric(){const x=this._addIndex*this.valueSize,S=x+this.valueSize;for(let w=x;w<S;w++)this.buffer[w]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const x=this._origIndex*this.valueSize,S=this._addIndex*this.valueSize;for(let w=0;w<this.valueSize;w++)this.buffer[S+w]=this.buffer[x+w]}_select(x,S,w,U,G){if(U>=.5)for(let U=0;U!==G;++U)x[S+U]=x[w+U]}_slerp(x,S,w,U){Quaternion.slerpFlat(x,S,x,S,x,w,U)}_slerpAdditive(x,S,w,U,G){const H=this._workIndex*G;Quaternion.multiplyQuaternionsFlat(x,H,x,S,x,w),Quaternion.slerpFlat(x,S,x,S,x,H,U)}_lerp(x,S,w,U,G){const H=1-U;for(let z=0;z!==G;++z){const G=S+z;x[G]=x[G]*H+x[w+z]*U}}_lerpAdditive(x,S,w,U,G){for(let H=0;H!==G;++H){const G=S+H;x[G]=x[G]+x[w+H]*U}}}const Bs="\\[\\]\\.:\\/",Ds=new RegExp("[\\[\\]\\.:\\/]","g"),ks="[^\\[\\]\\.:\\/]",Us="[^"+Bs.replace("\\.","")+"]",Gs=/((?:WC+[\/:])*)/.source.replace("WC",ks),Vs=/(WCOD+)?/.source.replace("WCOD",Us),Hs=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ks),Ws=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ks),$s=new RegExp("^"+Gs+Vs+Hs+Ws+"$"),zs=["material","materials","bones"];class PropertyBinding{constructor(x,S,w){this.path=S,this.parsedPath=w||PropertyBinding.parseTrackName(S),this.node=PropertyBinding.findNode(x,this.parsedPath.nodeName)||x,this.rootNode=x,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(x,S,w){return x&&x.isAnimationObjectGroup?new PropertyBinding.Composite(x,S,w):new PropertyBinding(x,S,w)}static sanitizeNodeName(x){return x.replace(/\s/g,"_").replace(Ds,"")}static parseTrackName(x){const S=$s.exec(x);if(!S)throw new Error("PropertyBinding: Cannot parse trackName: "+x);const w={nodeName:S[2],objectName:S[3],objectIndex:S[4],propertyName:S[5],propertyIndex:S[6]},U=w.nodeName&&w.nodeName.lastIndexOf(".");if(void 0!==U&&-1!==U){const x=w.nodeName.substring(U+1);-1!==zs.indexOf(x)&&(w.nodeName=w.nodeName.substring(0,U),w.objectName=x)}if(null===w.propertyName||0===w.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+x);return w}static findNode(x,S){if(!S||""===S||"."===S||-1===S||S===x.name||S===x.uuid)return x;if(x.skeleton){const w=x.skeleton.getBoneByName(S);if(void 0!==w)return w}if(x.children){const searchNodeSubtree=function(x){for(let w=0;w<x.length;w++){const U=x[w];if(U.name===S||U.uuid===S)return U;const G=searchNodeSubtree(U.children);if(G)return G}return null},w=searchNodeSubtree(x.children);if(w)return w}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(x,S){x[S]=this.targetObject[this.propertyName]}_getValue_array(x,S){const w=this.resolvedProperty;for(let U=0,G=w.length;U!==G;++U)x[S++]=w[U]}_getValue_arrayElement(x,S){x[S]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(x,S){this.resolvedProperty.toArray(x,S)}_setValue_direct(x,S){this.targetObject[this.propertyName]=x[S]}_setValue_direct_setNeedsUpdate(x,S){this.targetObject[this.propertyName]=x[S],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(x,S){this.targetObject[this.propertyName]=x[S],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(x,S){const w=this.resolvedProperty;for(let U=0,G=w.length;U!==G;++U)w[U]=x[S++]}_setValue_array_setNeedsUpdate(x,S){const w=this.resolvedProperty;for(let U=0,G=w.length;U!==G;++U)w[U]=x[S++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(x,S){const w=this.resolvedProperty;for(let U=0,G=w.length;U!==G;++U)w[U]=x[S++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(x,S){this.resolvedProperty[this.propertyIndex]=x[S]}_setValue_arrayElement_setNeedsUpdate(x,S){this.resolvedProperty[this.propertyIndex]=x[S],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(x,S){this.resolvedProperty[this.propertyIndex]=x[S],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(x,S){this.resolvedProperty.fromArray(x,S)}_setValue_fromArray_setNeedsUpdate(x,S){this.resolvedProperty.fromArray(x,S),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(x,S){this.resolvedProperty.fromArray(x,S),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(x,S){this.bind(),this.getValue(x,S)}_setValue_unbound(x,S){this.bind(),this.setValue(x,S)}bind(){let x=this.node;const S=this.parsedPath,w=S.objectName,U=S.propertyName;let G=S.propertyIndex;if(x||(x=PropertyBinding.findNode(this.rootNode,S.nodeName)||this.rootNode,this.node=x),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!x)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(w){let U=S.objectIndex;switch(w){case"materials":if(!x.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!x.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);x=x.material.materials;break;case"bones":if(!x.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);x=x.skeleton.bones;for(let S=0;S<x.length;S++)if(x[S].name===U){U=S;break}break;default:if(void 0===x[w])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);x=x[w]}if(void 0!==U){if(void 0===x[U])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,x);x=x[U]}}const H=x[U];if(void 0===H){const w=S.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+w+"."+U+" but it wasn't found.",x)}let z=this.Versioning.None;this.targetObject=x,void 0!==x.needsUpdate?z=this.Versioning.NeedsUpdate:void 0!==x.matrixWorldNeedsUpdate&&(z=this.Versioning.MatrixWorldNeedsUpdate);let j=this.BindingType.Direct;if(void 0!==G){if("morphTargetInfluences"===U){if(!x.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!x.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!x.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==x.morphTargetDictionary[G]&&(G=x.morphTargetDictionary[G])}j=this.BindingType.ArrayElement,this.resolvedProperty=H,this.propertyIndex=G}else void 0!==H.fromArray&&void 0!==H.toArray?(j=this.BindingType.HasFromToArray,this.resolvedProperty=H):Array.isArray(H)?(j=this.BindingType.EntireArray,this.resolvedProperty=H):this.propertyName=U;this.getValue=this.GetterByBindingType[j],this.setValue=this.SetterByBindingTypeAndVersioning[j][z]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=class Composite{constructor(x,S,w){const U=w||PropertyBinding.parseTrackName(S);this._targetGroup=x,this._bindings=x.subscribe_(S,U)}getValue(x,S){this.bind();const w=this._targetGroup.nCachedObjects_,U=this._bindings[w];void 0!==U&&U.getValue(x,S)}setValue(x,S){const w=this._bindings;for(let U=this._targetGroup.nCachedObjects_,G=w.length;U!==G;++U)w[U].setValue(x,S)}bind(){const x=this._bindings;for(let S=this._targetGroup.nCachedObjects_,w=x.length;S!==w;++S)x[S].bind()}unbind(){const x=this._bindings;for(let S=this._targetGroup.nCachedObjects_,w=x.length;S!==w;++S)x[S].unbind()}},PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray],PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.uuid=generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const x={};this._indicesByUUID=x;for(let S=0,w=arguments.length;S!==w;++S)x[arguments[S].uuid]=S;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const S=this;this.stats={objects:{get total(){return S._objects.length},get inUse(){return this.total-S.nCachedObjects_}},get bindingsPerObject(){return S._bindings.length}}}add(){const x=this._objects,S=this._indicesByUUID,w=this._paths,U=this._parsedPaths,G=this._bindings,H=G.length;let z,j=x.length,X=this.nCachedObjects_;for(let K=0,q=arguments.length;K!==q;++K){const q=arguments[K],Y=q.uuid;let Z=S[Y];if(void 0===Z){Z=j++,S[Y]=Z,x.push(q);for(let x=0,S=H;x!==S;++x)G[x].push(new PropertyBinding(q,w[x],U[x]))}else if(Z<X){z=x[Z];const j=--X,K=x[j];S[K.uuid]=Z,x[Z]=K,S[Y]=j,x[j]=q;for(let x=0,S=H;x!==S;++x){const S=G[x],H=S[j];let z=S[Z];S[Z]=H,void 0===z&&(z=new PropertyBinding(q,w[x],U[x])),S[j]=z}}else x[Z]!==z&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=X}remove(){const x=this._objects,S=this._indicesByUUID,w=this._bindings,U=w.length;let G=this.nCachedObjects_;for(let H=0,z=arguments.length;H!==z;++H){const z=arguments[H],j=z.uuid,X=S[j];if(void 0!==X&&X>=G){const H=G++,K=x[H];S[K.uuid]=X,x[X]=K,S[j]=H,x[H]=z;for(let x=0,S=U;x!==S;++x){const S=w[x],U=S[H],G=S[X];S[X]=U,S[H]=G}}}this.nCachedObjects_=G}uncache(){const x=this._objects,S=this._indicesByUUID,w=this._bindings,U=w.length;let G=this.nCachedObjects_,H=x.length;for(let z=0,j=arguments.length;z!==j;++z){const j=arguments[z].uuid,X=S[j];if(void 0!==X)if(delete S[j],X<G){const z=--G,j=x[z],K=--H,q=x[K];S[j.uuid]=X,x[X]=j,S[q.uuid]=z,x[z]=q,x.pop();for(let x=0,S=U;x!==S;++x){const S=w[x],U=S[z],G=S[K];S[X]=U,S[z]=G,S.pop()}}else{const G=--H,z=x[G];G>0&&(S[z.uuid]=X),x[X]=z,x.pop();for(let x=0,S=U;x!==S;++x){const S=w[x];S[X]=S[G],S.pop()}}}this.nCachedObjects_=G}subscribe_(x,S){const w=this._bindingsIndicesByPath;let U=w[x];const G=this._bindings;if(void 0!==U)return G[U];const H=this._paths,z=this._parsedPaths,j=this._objects,X=j.length,K=this.nCachedObjects_,q=new Array(X);U=G.length,w[x]=U,H.push(x),z.push(S),G.push(q);for(let w=K,U=j.length;w!==U;++w){const U=j[w];q[w]=new PropertyBinding(U,x,S)}return q}unsubscribe_(x){const S=this._bindingsIndicesByPath,w=S[x];if(void 0!==w){const U=this._paths,G=this._parsedPaths,H=this._bindings,z=H.length-1,j=H[z];S[x[z]]=w,H[w]=j,H.pop(),G[w]=G[z],G.pop(),U[w]=U[z],U.pop()}}}AnimationObjectGroup.prototype.isAnimationObjectGroup=!0;class AnimationAction{constructor(x,S,w=null,U=S.blendMode){this._mixer=x,this._clip=S,this._localRoot=w,this.blendMode=U;const G=S.tracks,H=G.length,z=new Array(H),j={endingStart:Bn,endingEnd:Bn};for(let x=0;x!==H;++x){const S=G[x].createInterpolant(null);z[x]=S,S.settings=j}this._interpolantSettings=j,this._interpolants=z,this._propertyBindings=new Array(H),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Rn,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(x){return this._startTime=x,this}setLoop(x,S){return this.loop=x,this.repetitions=S,this}setEffectiveWeight(x){return this.weight=x,this._effectiveWeight=this.enabled?x:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(x){return this._scheduleFading(x,0,1)}fadeOut(x){return this._scheduleFading(x,1,0)}crossFadeFrom(x,S,w){if(x.fadeOut(S),this.fadeIn(S),w){const w=this._clip.duration,U=x._clip.duration,G=U/w,H=w/U;x.warp(1,G,S),this.warp(H,1,S)}return this}crossFadeTo(x,S,w){return x.crossFadeFrom(this,S,w)}stopFading(){const x=this._weightInterpolant;return null!==x&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(x)),this}setEffectiveTimeScale(x){return this.timeScale=x,this._effectiveTimeScale=this.paused?0:x,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(x){return this.timeScale=this._clip.duration/x,this.stopWarping()}syncWith(x){return this.time=x.time,this.timeScale=x.timeScale,this.stopWarping()}halt(x){return this.warp(this._effectiveTimeScale,0,x)}warp(x,S,w){const U=this._mixer,G=U.time,H=this.timeScale;let z=this._timeScaleInterpolant;null===z&&(z=U._lendControlInterpolant(),this._timeScaleInterpolant=z);const j=z.parameterPositions,X=z.sampleValues;return j[0]=G,j[1]=G+w,X[0]=x/H,X[1]=S/H,this}stopWarping(){const x=this._timeScaleInterpolant;return null!==x&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(x)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(x,S,w,U){if(!this.enabled)return void this._updateWeight(x);const G=this._startTime;if(null!==G){const U=(x-G)*w;if(U<0||0===w)return;this._startTime=null,S=w*U}S*=this._updateTimeScale(x);const H=this._updateTime(S),z=this._updateWeight(x);if(z>0){const x=this._interpolants,S=this._propertyBindings;if(this.blendMode===Hn)for(let w=0,U=x.length;w!==U;++w)x[w].evaluate(H),S[w].accumulateAdditive(z);else for(let w=0,G=x.length;w!==G;++w)x[w].evaluate(H),S[w].accumulate(U,z)}}_updateWeight(x){let S=0;if(this.enabled){S=this.weight;const w=this._weightInterpolant;if(null!==w){const U=w.evaluate(x)[0];S*=U,x>w.parameterPositions[1]&&(this.stopFading(),0===U&&(this.enabled=!1))}}return this._effectiveWeight=S,S}_updateTimeScale(x){let S=0;if(!this.paused){S=this.timeScale;const w=this._timeScaleInterpolant;if(null!==w){S*=w.evaluate(x)[0],x>w.parameterPositions[1]&&(this.stopWarping(),0===S?this.paused=!0:this.timeScale=S)}}return this._effectiveTimeScale=S,S}_updateTime(x){const S=this._clip.duration,w=this.loop;let U=this.time+x,G=this._loopCount;const H=w===In;if(0===x)return-1===G?U:H&&1==(1&G)?S-U:U;if(w===Mn){-1===G&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(U>=S)U=S;else{if(!(U<0)){this.time=U;break e}U=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=U,this._mixer.dispatchEvent({type:"finished",action:this,direction:x<0?-1:1})}}else{if(-1===G&&(x>=0?(G=0,this._setEndings(!0,0===this.repetitions,H)):this._setEndings(0===this.repetitions,!0,H)),U>=S||U<0){const w=Math.floor(U/S);U-=S*w,G+=Math.abs(w);const z=this.repetitions-G;if(z<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,U=x>0?S:0,this.time=U,this._mixer.dispatchEvent({type:"finished",action:this,direction:x>0?1:-1});else{if(1===z){const S=x<0;this._setEndings(S,!S,H)}else this._setEndings(!1,!1,H);this._loopCount=G,this.time=U,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:w})}}else this.time=U;if(H&&1==(1&G))return S-U}return U}_setEndings(x,S,w){const U=this._interpolantSettings;w?(U.endingStart=Dn,U.endingEnd=Dn):(U.endingStart=x?this.zeroSlopeAtStart?Dn:Bn:kn,U.endingEnd=S?this.zeroSlopeAtEnd?Dn:Bn:kn)}_scheduleFading(x,S,w){const U=this._mixer,G=U.time;let H=this._weightInterpolant;null===H&&(H=U._lendControlInterpolant(),this._weightInterpolant=H);const z=H.parameterPositions,j=H.sampleValues;return z[0]=G,j[0]=S,z[1]=G+x,j[1]=w,this}}class AnimationMixer extends EventDispatcher{constructor(x){super(),this._root=x,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(x,S){const w=x._localRoot||this._root,U=x._clip.tracks,G=U.length,H=x._propertyBindings,z=x._interpolants,j=w.uuid,X=this._bindingsByRootAndName;let K=X[j];void 0===K&&(K={},X[j]=K);for(let x=0;x!==G;++x){const G=U[x],X=G.name;let q=K[X];if(void 0!==q)H[x]=q;else{if(q=H[x],void 0!==q){null===q._cacheIndex&&(++q.referenceCount,this._addInactiveBinding(q,j,X));continue}const U=S&&S._propertyBindings[x].binding.parsedPath;q=new PropertyMixer(PropertyBinding.create(w,X,U),G.ValueTypeName,G.getValueSize()),++q.referenceCount,this._addInactiveBinding(q,j,X),H[x]=q}z[x].resultBuffer=q.buffer}}_activateAction(x){if(!this._isActiveAction(x)){if(null===x._cacheIndex){const S=(x._localRoot||this._root).uuid,w=x._clip.uuid,U=this._actionsByClip[w];this._bindAction(x,U&&U.knownActions[0]),this._addInactiveAction(x,w,S)}const S=x._propertyBindings;for(let x=0,w=S.length;x!==w;++x){const w=S[x];0==w.useCount++&&(this._lendBinding(w),w.saveOriginalState())}this._lendAction(x)}}_deactivateAction(x){if(this._isActiveAction(x)){const S=x._propertyBindings;for(let x=0,w=S.length;x!==w;++x){const w=S[x];0==--w.useCount&&(w.restoreOriginalState(),this._takeBackBinding(w))}this._takeBackAction(x)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const x=this;this.stats={actions:{get total(){return x._actions.length},get inUse(){return x._nActiveActions}},bindings:{get total(){return x._bindings.length},get inUse(){return x._nActiveBindings}},controlInterpolants:{get total(){return x._controlInterpolants.length},get inUse(){return x._nActiveControlInterpolants}}}}_isActiveAction(x){const S=x._cacheIndex;return null!==S&&S<this._nActiveActions}_addInactiveAction(x,S,w){const U=this._actions,G=this._actionsByClip;let H=G[S];if(void 0===H)H={knownActions:[x],actionByRoot:{}},x._byClipCacheIndex=0,G[S]=H;else{const S=H.knownActions;x._byClipCacheIndex=S.length,S.push(x)}x._cacheIndex=U.length,U.push(x),H.actionByRoot[w]=x}_removeInactiveAction(x){const S=this._actions,w=S[S.length-1],U=x._cacheIndex;w._cacheIndex=U,S[U]=w,S.pop(),x._cacheIndex=null;const G=x._clip.uuid,H=this._actionsByClip,z=H[G],j=z.knownActions,X=j[j.length-1],K=x._byClipCacheIndex;X._byClipCacheIndex=K,j[K]=X,j.pop(),x._byClipCacheIndex=null;delete z.actionByRoot[(x._localRoot||this._root).uuid],0===j.length&&delete H[G],this._removeInactiveBindingsForAction(x)}_removeInactiveBindingsForAction(x){const S=x._propertyBindings;for(let x=0,w=S.length;x!==w;++x){const w=S[x];0==--w.referenceCount&&this._removeInactiveBinding(w)}}_lendAction(x){const S=this._actions,w=x._cacheIndex,U=this._nActiveActions++,G=S[U];x._cacheIndex=U,S[U]=x,G._cacheIndex=w,S[w]=G}_takeBackAction(x){const S=this._actions,w=x._cacheIndex,U=--this._nActiveActions,G=S[U];x._cacheIndex=U,S[U]=x,G._cacheIndex=w,S[w]=G}_addInactiveBinding(x,S,w){const U=this._bindingsByRootAndName,G=this._bindings;let H=U[S];void 0===H&&(H={},U[S]=H),H[w]=x,x._cacheIndex=G.length,G.push(x)}_removeInactiveBinding(x){const S=this._bindings,w=x.binding,U=w.rootNode.uuid,G=w.path,H=this._bindingsByRootAndName,z=H[U],j=S[S.length-1],X=x._cacheIndex;j._cacheIndex=X,S[X]=j,S.pop(),delete z[G],0===Object.keys(z).length&&delete H[U]}_lendBinding(x){const S=this._bindings,w=x._cacheIndex,U=this._nActiveBindings++,G=S[U];x._cacheIndex=U,S[U]=x,G._cacheIndex=w,S[w]=G}_takeBackBinding(x){const S=this._bindings,w=x._cacheIndex,U=--this._nActiveBindings,G=S[U];x._cacheIndex=U,S[U]=x,G._cacheIndex=w,S[w]=G}_lendControlInterpolant(){const x=this._controlInterpolants,S=this._nActiveControlInterpolants++;let w=x[S];return void 0===w&&(w=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),w.__cacheIndex=S,x[S]=w),w}_takeBackControlInterpolant(x){const S=this._controlInterpolants,w=x.__cacheIndex,U=--this._nActiveControlInterpolants,G=S[U];x.__cacheIndex=U,S[U]=x,G.__cacheIndex=w,S[w]=G}clipAction(x,S,w){const U=S||this._root,G=U.uuid;let H="string"==typeof x?AnimationClip.findByName(U,x):x;const z=null!==H?H.uuid:x,j=this._actionsByClip[z];let X=null;if(void 0===w&&(w=null!==H?H.blendMode:Gn),void 0!==j){const x=j.actionByRoot[G];if(void 0!==x&&x.blendMode===w)return x;X=j.knownActions[0],null===H&&(H=X._clip)}if(null===H)return null;const K=new AnimationAction(this,H,S,w);return this._bindAction(K,X),this._addInactiveAction(K,z,G),K}existingAction(x,S){const w=S||this._root,U=w.uuid,G="string"==typeof x?AnimationClip.findByName(w,x):x,H=G?G.uuid:x,z=this._actionsByClip[H];return void 0!==z&&z.actionByRoot[U]||null}stopAllAction(){const x=this._actions;for(let S=this._nActiveActions-1;S>=0;--S)x[S].stop();return this}update(x){x*=this.timeScale;const S=this._actions,w=this._nActiveActions,U=this.time+=x,G=Math.sign(x),H=this._accuIndex^=1;for(let z=0;z!==w;++z){S[z]._update(U,x,G,H)}const z=this._bindings,j=this._nActiveBindings;for(let x=0;x!==j;++x)z[x].apply(H);return this}setTime(x){this.time=0;for(let x=0;x<this._actions.length;x++)this._actions[x].time=0;return this.update(x)}getRoot(){return this._root}uncacheClip(x){const S=this._actions,w=x.uuid,U=this._actionsByClip,G=U[w];if(void 0!==G){const x=G.knownActions;for(let w=0,U=x.length;w!==U;++w){const U=x[w];this._deactivateAction(U);const G=U._cacheIndex,H=S[S.length-1];U._cacheIndex=null,U._byClipCacheIndex=null,H._cacheIndex=G,S[G]=H,S.pop(),this._removeInactiveBindingsForAction(U)}delete U[w]}}uncacheRoot(x){const S=x.uuid,w=this._actionsByClip;for(const x in w){const U=w[x].actionByRoot[S];void 0!==U&&(this._deactivateAction(U),this._removeInactiveAction(U))}const U=this._bindingsByRootAndName[S];if(void 0!==U)for(const x in U){const S=U[x];S.restoreOriginalState(),this._removeInactiveBinding(S)}}uncacheAction(x,S){const w=this.existingAction(x,S);null!==w&&(this._deactivateAction(w),this._removeInactiveAction(w))}}AnimationMixer.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Uniform{constructor(x){"string"==typeof x&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),x=arguments[1]),this.value=x}clone(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(x,S,w=1){super(x,S),this.meshPerAttribute=w}copy(x){return super.copy(x),this.meshPerAttribute=x.meshPerAttribute,this}clone(x){const S=super.clone(x);return S.meshPerAttribute=this.meshPerAttribute,S}toJSON(x){const S=super.toJSON(x);return S.isInstancedInterleavedBuffer=!0,S.meshPerAttribute=this.meshPerAttribute,S}}InstancedInterleavedBuffer.prototype.isInstancedInterleavedBuffer=!0;class GLBufferAttribute{constructor(x,S,w,U,G){this.buffer=x,this.type=S,this.itemSize=w,this.elementSize=U,this.count=G,this.version=0}set needsUpdate(x){!0===x&&this.version++}setBuffer(x){return this.buffer=x,this}setType(x,S){return this.type=x,this.elementSize=S,this}setItemSize(x){return this.itemSize=x,this}setCount(x){return this.count=x,this}}GLBufferAttribute.prototype.isGLBufferAttribute=!0;class Raycaster{constructor(x,S,w=0,U=1/0){this.ray=new Ray(x,S),this.near=w,this.far=U,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(x,S){this.ray.set(x,S)}setFromCamera(x,S){S&&S.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(S.matrixWorld),this.ray.direction.set(x.x,x.y,.5).unproject(S).sub(this.ray.origin).normalize(),this.camera=S):S&&S.isOrthographicCamera?(this.ray.origin.set(x.x,x.y,(S.near+S.far)/(S.near-S.far)).unproject(S),this.ray.direction.set(0,0,-1).transformDirection(S.matrixWorld),this.camera=S):console.error("THREE.Raycaster: Unsupported camera type: "+S.type)}intersectObject(x,S=!0,w=[]){return intersectObject(x,this,w,S),w.sort(ascSort),w}intersectObjects(x,S=!0,w=[]){for(let U=0,G=x.length;U<G;U++)intersectObject(x[U],this,w,S);return w.sort(ascSort),w}}function ascSort(x,S){return x.distance-S.distance}function intersectObject(x,S,w,U){if(x.layers.test(S.layers)&&x.raycast(S,w),!0===U){const U=x.children;for(let x=0,G=U.length;x<G;x++)intersectObject(U[x],S,w,!0)}}class Spherical{constructor(x=1,S=0,w=0){return this.radius=x,this.phi=S,this.theta=w,this}set(x,S,w){return this.radius=x,this.phi=S,this.theta=w,this}copy(x){return this.radius=x.radius,this.phi=x.phi,this.theta=x.theta,this}makeSafe(){const x=1e-6;return this.phi=Math.max(x,Math.min(Math.PI-x,this.phi)),this}setFromVector3(x){return this.setFromCartesianCoords(x.x,x.y,x.z)}setFromCartesianCoords(x,S,w){return this.radius=Math.sqrt(x*x+S*S+w*w),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(x,w),this.phi=Math.acos(clamp(S/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Cylindrical{constructor(x=1,S=0,w=0){return this.radius=x,this.theta=S,this.y=w,this}set(x,S,w){return this.radius=x,this.theta=S,this.y=w,this}copy(x){return this.radius=x.radius,this.theta=x.theta,this.y=x.y,this}setFromVector3(x){return this.setFromCartesianCoords(x.x,x.y,x.z)}setFromCartesianCoords(x,S,w){return this.radius=Math.sqrt(x*x+w*w),this.theta=Math.atan2(x,w),this.y=S,this}clone(){return(new this.constructor).copy(this)}}const js=new Vector2;class Box2{constructor(x=new Vector2(1/0,1/0),S=new Vector2(-1/0,-1/0)){this.min=x,this.max=S}set(x,S){return this.min.copy(x),this.max.copy(S),this}setFromPoints(x){this.makeEmpty();for(let S=0,w=x.length;S<w;S++)this.expandByPoint(x[S]);return this}setFromCenterAndSize(x,S){const w=js.copy(S).multiplyScalar(.5);return this.min.copy(x).sub(w),this.max.copy(x).add(w),this}clone(){return(new this.constructor).copy(this)}copy(x){return this.min.copy(x.min),this.max.copy(x.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(x){return this.isEmpty()?x.set(0,0):x.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(x){return this.isEmpty()?x.set(0,0):x.subVectors(this.max,this.min)}expandByPoint(x){return this.min.min(x),this.max.max(x),this}expandByVector(x){return this.min.sub(x),this.max.add(x),this}expandByScalar(x){return this.min.addScalar(-x),this.max.addScalar(x),this}containsPoint(x){return!(x.x<this.min.x||x.x>this.max.x||x.y<this.min.y||x.y>this.max.y)}containsBox(x){return this.min.x<=x.min.x&&x.max.x<=this.max.x&&this.min.y<=x.min.y&&x.max.y<=this.max.y}getParameter(x,S){return S.set((x.x-this.min.x)/(this.max.x-this.min.x),(x.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(x){return!(x.max.x<this.min.x||x.min.x>this.max.x||x.max.y<this.min.y||x.min.y>this.max.y)}clampPoint(x,S){return S.copy(x).clamp(this.min,this.max)}distanceToPoint(x){return js.copy(x).clamp(this.min,this.max).sub(x).length()}intersect(x){return this.min.max(x.min),this.max.min(x.max),this}union(x){return this.min.min(x.min),this.max.max(x.max),this}translate(x){return this.min.add(x),this.max.add(x),this}equals(x){return x.min.equals(this.min)&&x.max.equals(this.max)}}Box2.prototype.isBox2=!0;const Xs=new Vector3,Ks=new Vector3;class Line3{constructor(x=new Vector3,S=new Vector3){this.start=x,this.end=S}set(x,S){return this.start.copy(x),this.end.copy(S),this}copy(x){return this.start.copy(x.start),this.end.copy(x.end),this}getCenter(x){return x.addVectors(this.start,this.end).multiplyScalar(.5)}delta(x){return x.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(x,S){return this.delta(S).multiplyScalar(x).add(this.start)}closestPointToPointParameter(x,S){Xs.subVectors(x,this.start),Ks.subVectors(this.end,this.start);const w=Ks.dot(Ks);let U=Ks.dot(Xs)/w;return S&&(U=clamp(U,0,1)),U}closestPointToPoint(x,S,w){const U=this.closestPointToPointParameter(x,S);return this.delta(w).multiplyScalar(U).add(this.start)}applyMatrix4(x){return this.start.applyMatrix4(x),this.end.applyMatrix4(x),this}equals(x){return x.start.equals(this.start)&&x.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class ImmediateRenderObject extends Object3D{constructor(x){super(),this.material=x,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}ImmediateRenderObject.prototype.isImmediateRenderObject=!0;const qs=new Vector3;class SpotLightHelper extends Object3D{constructor(x,S){super(),this.light=x,this.light.updateMatrixWorld(),this.matrix=x.matrixWorld,this.matrixAutoUpdate=!1,this.color=S;const w=new BufferGeometry,U=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let x=0,S=1,w=32;x<w;x++,S++){const G=x/w*Math.PI*2,H=S/w*Math.PI*2;U.push(Math.cos(G),Math.sin(G),1,Math.cos(H),Math.sin(H),1)}w.setAttribute("position",new Float32BufferAttribute(U,3));const G=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(w,G),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const x=this.light.distance?this.light.distance:1e3,S=x*Math.tan(this.light.angle);this.cone.scale.set(S,S,x),qs.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(qs),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ys=new Vector3,Zs=new Matrix4,Js=new Matrix4;class SkeletonHelper extends LineSegments{constructor(x){const S=getBoneList(x),w=new BufferGeometry,U=[],G=[],H=new Color(0,0,1),z=new Color(0,1,0);for(let x=0;x<S.length;x++){const w=S[x];w.parent&&w.parent.isBone&&(U.push(0,0,0),U.push(0,0,0),G.push(H.r,H.g,H.b),G.push(z.r,z.g,z.b))}w.setAttribute("position",new Float32BufferAttribute(U,3)),w.setAttribute("color",new Float32BufferAttribute(G,3));super(w,new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=x,this.bones=S,this.matrix=x.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(x){const S=this.bones,w=this.geometry,U=w.getAttribute("position");Js.copy(this.root.matrixWorld).invert();for(let x=0,w=0;x<S.length;x++){const G=S[x];G.parent&&G.parent.isBone&&(Zs.multiplyMatrices(Js,G.matrixWorld),Ys.setFromMatrixPosition(Zs),U.setXYZ(w,Ys.x,Ys.y,Ys.z),Zs.multiplyMatrices(Js,G.parent.matrixWorld),Ys.setFromMatrixPosition(Zs),U.setXYZ(w+1,Ys.x,Ys.y,Ys.z),w+=2)}w.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(x)}}function getBoneList(x){const S=[];x&&x.isBone&&S.push(x);for(let w=0;w<x.children.length;w++)S.push.apply(S,getBoneList(x.children[w]));return S}class PointLightHelper extends Mesh{constructor(x,S,w){super(new SphereGeometry(S,4,2),new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1})),this.light=x,this.light.updateMatrixWorld(),this.color=w,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Qs=new Vector3,el=new Color,tl=new Color;class HemisphereLightHelper extends Object3D{constructor(x,S,w){super(),this.light=x,this.light.updateMatrixWorld(),this.matrix=x.matrixWorld,this.matrixAutoUpdate=!1,this.color=w;const U=new OctahedronGeometry(S);U.rotateY(.5*Math.PI),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const G=U.getAttribute("position"),H=new Float32Array(3*G.count);U.setAttribute("color",new BufferAttribute(H,3)),this.add(new Mesh(U,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const x=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const S=x.geometry.getAttribute("color");el.copy(this.light.color),tl.copy(this.light.groundColor);for(let x=0,w=S.count;x<w;x++){const U=x<w/2?el:tl;S.setXYZ(x,U.r,U.g,U.b)}S.needsUpdate=!0}x.lookAt(Qs.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(x=10,S=10,w=4473924,U=8947848){w=new Color(w),U=new Color(U);const G=S/2,H=x/S,z=x/2,j=[],X=[];for(let x=0,K=0,q=-z;x<=S;x++,q+=H){j.push(-z,0,q,z,0,q),j.push(q,0,-z,q,0,z);const S=x===G?w:U;S.toArray(X,K),K+=3,S.toArray(X,K),K+=3,S.toArray(X,K),K+=3,S.toArray(X,K),K+=3}const K=new BufferGeometry;K.setAttribute("position",new Float32BufferAttribute(j,3)),K.setAttribute("color",new Float32BufferAttribute(X,3));super(K,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class PolarGridHelper extends LineSegments{constructor(x=10,S=16,w=8,U=64,G=4473924,H=8947848){G=new Color(G),H=new Color(H);const z=[],j=[];for(let w=0;w<=S;w++){const U=w/S*(2*Math.PI),X=Math.sin(U)*x,K=Math.cos(U)*x;z.push(0,0,0),z.push(X,0,K);const q=1&w?G:H;j.push(q.r,q.g,q.b),j.push(q.r,q.g,q.b)}for(let S=0;S<=w;S++){const X=1&S?G:H,K=x-x/w*S;for(let x=0;x<U;x++){let S=x/U*(2*Math.PI),w=Math.sin(S)*K,G=Math.cos(S)*K;z.push(w,0,G),j.push(X.r,X.g,X.b),S=(x+1)/U*(2*Math.PI),w=Math.sin(S)*K,G=Math.cos(S)*K,z.push(w,0,G),j.push(X.r,X.g,X.b)}}const X=new BufferGeometry;X.setAttribute("position",new Float32BufferAttribute(z,3)),X.setAttribute("color",new Float32BufferAttribute(j,3));super(X,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const nl=new Vector3,il=new Vector3,rl=new Vector3;class DirectionalLightHelper extends Object3D{constructor(x,S,w){super(),this.light=x,this.light.updateMatrixWorld(),this.matrix=x.matrixWorld,this.matrixAutoUpdate=!1,this.color=w,void 0===S&&(S=1);let U=new BufferGeometry;U.setAttribute("position",new Float32BufferAttribute([-S,S,0,S,S,0,S,-S,0,-S,-S,0,-S,S,0],3));const G=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(U,G),this.add(this.lightPlane),U=new BufferGeometry,U.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(U,G),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){nl.setFromMatrixPosition(this.light.matrixWorld),il.setFromMatrixPosition(this.light.target.matrixWorld),rl.subVectors(il,nl),this.lightPlane.lookAt(il),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(il),this.targetLine.scale.z=rl.length()}}const ol=new Vector3,al=new Camera;class CameraHelper extends LineSegments{constructor(x){const S=new BufferGeometry,w=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),U=[],G=[],H={},z=new Color(16755200),j=new Color(16711680),X=new Color(43775),K=new Color(16777215),q=new Color(3355443);function addLine(x,S,w){addPoint(x,w),addPoint(S,w)}function addPoint(x,S){U.push(0,0,0),G.push(S.r,S.g,S.b),void 0===H[x]&&(H[x]=[]),H[x].push(U.length/3-1)}addLine("n1","n2",z),addLine("n2","n4",z),addLine("n4","n3",z),addLine("n3","n1",z),addLine("f1","f2",z),addLine("f2","f4",z),addLine("f4","f3",z),addLine("f3","f1",z),addLine("n1","f1",z),addLine("n2","f2",z),addLine("n3","f3",z),addLine("n4","f4",z),addLine("p","n1",j),addLine("p","n2",j),addLine("p","n3",j),addLine("p","n4",j),addLine("u1","u2",X),addLine("u2","u3",X),addLine("u3","u1",X),addLine("c","t",K),addLine("p","c",q),addLine("cn1","cn2",q),addLine("cn3","cn4",q),addLine("cf1","cf2",q),addLine("cf3","cf4",q),S.setAttribute("position",new Float32BufferAttribute(U,3)),S.setAttribute("color",new Float32BufferAttribute(G,3)),super(S,w),this.type="CameraHelper",this.camera=x,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=x.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=H,this.update()}update(){const x=this.geometry,S=this.pointMap;al.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",S,x,al,0,0,-1),setPoint("t",S,x,al,0,0,1),setPoint("n1",S,x,al,-1,-1,-1),setPoint("n2",S,x,al,1,-1,-1),setPoint("n3",S,x,al,-1,1,-1),setPoint("n4",S,x,al,1,1,-1),setPoint("f1",S,x,al,-1,-1,1),setPoint("f2",S,x,al,1,-1,1),setPoint("f3",S,x,al,-1,1,1),setPoint("f4",S,x,al,1,1,1),setPoint("u1",S,x,al,.7,1.1,-1),setPoint("u2",S,x,al,-.7,1.1,-1),setPoint("u3",S,x,al,0,2,-1),setPoint("cf1",S,x,al,-1,0,1),setPoint("cf2",S,x,al,1,0,1),setPoint("cf3",S,x,al,0,-1,1),setPoint("cf4",S,x,al,0,1,1),setPoint("cn1",S,x,al,-1,0,-1),setPoint("cn2",S,x,al,1,0,-1),setPoint("cn3",S,x,al,0,-1,-1),setPoint("cn4",S,x,al,0,1,-1),x.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(x,S,w,U,G,H,z){ol.set(G,H,z).unproject(U);const j=S[x];if(void 0!==j){const x=w.getAttribute("position");for(let S=0,w=j.length;S<w;S++)x.setXYZ(j[S],ol.x,ol.y,ol.z)}}const sl=new Box3;class BoxHelper extends LineSegments{constructor(x,S=16776960){const w=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),U=new Float32Array(24),G=new BufferGeometry;G.setIndex(new BufferAttribute(w,1)),G.setAttribute("position",new BufferAttribute(U,3)),super(G,new LineBasicMaterial({color:S,toneMapped:!1})),this.object=x,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(x){if(void 0!==x&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&sl.setFromObject(this.object),sl.isEmpty())return;const S=sl.min,w=sl.max,U=this.geometry.attributes.position,G=U.array;G[0]=w.x,G[1]=w.y,G[2]=w.z,G[3]=S.x,G[4]=w.y,G[5]=w.z,G[6]=S.x,G[7]=S.y,G[8]=w.z,G[9]=w.x,G[10]=S.y,G[11]=w.z,G[12]=w.x,G[13]=w.y,G[14]=S.z,G[15]=S.x,G[16]=w.y,G[17]=S.z,G[18]=S.x,G[19]=S.y,G[20]=S.z,G[21]=w.x,G[22]=S.y,G[23]=S.z,U.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(x){return this.object=x,this.update(),this}copy(x){return LineSegments.prototype.copy.call(this,x),this.object=x.object,this}}class Box3Helper extends LineSegments{constructor(x,S=16776960){const w=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),U=new BufferGeometry;U.setIndex(new BufferAttribute(w,1)),U.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(U,new LineBasicMaterial({color:S,toneMapped:!1})),this.box=x,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(x){const S=this.box;S.isEmpty()||(S.getCenter(this.position),S.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(x))}}class PlaneHelper extends Line{constructor(x,S=1,w=16776960){const U=w,G=new BufferGeometry;G.setAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),G.computeBoundingSphere(),super(G,new LineBasicMaterial({color:U,toneMapped:!1})),this.type="PlaneHelper",this.plane=x,this.size=S;const H=new BufferGeometry;H.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),H.computeBoundingSphere(),this.add(new Mesh(H,new MeshBasicMaterial({color:U,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(x){let S=-this.plane.constant;Math.abs(S)<1e-8&&(S=1e-8),this.scale.set(.5*this.size,.5*this.size,S),this.children[0].material.side=S<0?ee:Q,this.lookAt(this.plane.normal),super.updateMatrixWorld(x)}}const ll=new Vector3;let cl,ul;class ArrowHelper extends Object3D{constructor(x=new Vector3(0,0,1),S=new Vector3(0,0,0),w=1,U=16776960,G=.2*w,H=.2*G){super(),this.type="ArrowHelper",void 0===cl&&(cl=new BufferGeometry,cl.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),ul=new CylinderGeometry(0,.5,1,5,1),ul.translate(0,-.5,0)),this.position.copy(S),this.line=new Line(cl,new LineBasicMaterial({color:U,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(ul,new MeshBasicMaterial({color:U,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(x),this.setLength(w,G,H)}setDirection(x){if(x.y>.99999)this.quaternion.set(0,0,0,1);else if(x.y<-.99999)this.quaternion.set(1,0,0,0);else{ll.set(x.z,0,-x.x).normalize();const S=Math.acos(x.y);this.quaternion.setFromAxisAngle(ll,S)}}setLength(x,S=.2*x,w=.2*S){this.line.scale.set(1,Math.max(1e-4,x-S),1),this.line.updateMatrix(),this.cone.scale.set(w,S,w),this.cone.position.y=x,this.cone.updateMatrix()}setColor(x){this.line.material.color.set(x),this.cone.material.color.set(x)}copy(x){return super.copy(x,!1),this.line.copy(x.line),this.cone.copy(x.cone),this}}class AxesHelper extends LineSegments{constructor(x=1){const S=[0,0,0,x,0,0,0,0,0,0,x,0,0,0,0,0,0,x],w=new BufferGeometry;w.setAttribute("position",new Float32BufferAttribute(S,3)),w.setAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(w,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(x,S,w){const U=new Color,G=this.geometry.attributes.color.array;return U.set(x),U.toArray(G,0),U.toArray(G,3),U.set(S),U.toArray(G,6),U.toArray(G,9),U.set(w),U.toArray(G,12),U.toArray(G,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(x,S){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(x,S),this}lineTo(x,S){return this.currentPath.lineTo(x,S),this}quadraticCurveTo(x,S,w,U){return this.currentPath.quadraticCurveTo(x,S,w,U),this}bezierCurveTo(x,S,w,U,G,H){return this.currentPath.bezierCurveTo(x,S,w,U,G,H),this}splineThru(x){return this.currentPath.splineThru(x),this}toShapes(x,S){function toShapesNoHoles(x){const S=[];for(let w=0,U=x.length;w<U;w++){const U=x[w],G=new Shape;G.curves=U.curves,S.push(G)}return S}function isPointInsidePolygon(x,S){const w=S.length;let U=!1;for(let G=w-1,H=0;H<w;G=H++){let w=S[G],z=S[H],j=z.x-w.x,X=z.y-w.y;if(Math.abs(X)>Number.EPSILON){if(X<0&&(w=S[H],j=-j,z=S[G],X=-X),x.y<w.y||x.y>z.y)continue;if(x.y===w.y){if(x.x===w.x)return!0}else{const S=X*(x.x-w.x)-j*(x.y-w.y);if(0===S)return!0;if(S<0)continue;U=!U}}else{if(x.y!==w.y)continue;if(z.x<=x.x&&x.x<=w.x||w.x<=x.x&&x.x<=z.x)return!0}}return U}const w=ShapeUtils.isClockWise,U=this.subPaths;if(0===U.length)return[];if(!0===S)return toShapesNoHoles(U);let G,H,z;const j=[];if(1===U.length)return H=U[0],z=new Shape,z.curves=H.curves,j.push(z),j;let X=!w(U[0].getPoints());X=x?!X:X;const K=[],q=[];let Y,Z,J=[],Q=0;q[Q]=void 0,J[Q]=[];for(let S=0,z=U.length;S<z;S++)H=U[S],Y=H.getPoints(),G=w(Y),G=x?!G:G,G?(!X&&q[Q]&&Q++,q[Q]={s:new Shape,p:Y},q[Q].s.curves=H.curves,X&&Q++,J[Q]=[]):J[Q].push({h:H,p:Y[0]});if(!q[0])return toShapesNoHoles(U);if(q.length>1){let x=!1;const S=[];for(let x=0,S=q.length;x<S;x++)K[x]=[];for(let w=0,U=q.length;w<U;w++){const U=J[w];for(let G=0;G<U.length;G++){const H=U[G];let z=!0;for(let U=0;U<q.length;U++)isPointInsidePolygon(H.p,q[U].p)&&(w!==U&&S.push({froms:w,tos:U,hole:G}),z?(z=!1,K[U].push(H)):x=!0);z&&K[w].push(H)}}S.length>0&&(x||(J=K))}for(let x=0,S=q.length;x<S;x++){z=q[x].s,j.push(z),Z=J[x];for(let x=0,S=Z.length;x<S;x++)z.holes.push(Z[x].h)}return j}}const hl=new Float32Array(1),dl=new Int32Array(hl.buffer);class DataUtils{static toHalfFloat(x){x>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),x=65504),hl[0]=x;const S=dl[0];let w=S>>16&32768,U=S>>12&2047;const G=S>>23&255;return G<103?w:G>142?(w|=31744,w|=(255==G?0:1)&&8388607&S,w):G<113?(U|=2048,w|=(U>>114-G)+(U>>113-G&1),w):(w|=G-112<<10|U>>1,w+=1&U,w)}}const pl=0,ml=1,fl=0,gl=1,vl=2;function MeshFaceMaterial(x){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),x}function MultiMaterial(x=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),x.isMultiMaterial=!0,x.materials=x,x.clone=function(){return x.slice()},x}function PointCloud(x,S){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Points(x,S)}function Particle(x){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Sprite(x)}function ParticleSystem(x,S){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Points(x,S)}function PointCloudMaterial(x){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(x)}function ParticleBasicMaterial(x){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(x)}function ParticleSystemMaterial(x){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(x)}function Vertex(x,S,w){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Vector3(x,S,w)}function DynamicBufferAttribute(x,S){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new BufferAttribute(x,S).setUsage(Ri)}function Int8Attribute(x,S){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Int8BufferAttribute(x,S)}function Uint8Attribute(x,S){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Uint8BufferAttribute(x,S)}function Uint8ClampedAttribute(x,S){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Uint8ClampedBufferAttribute(x,S)}function Int16Attribute(x,S){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Int16BufferAttribute(x,S)}function Uint16Attribute(x,S){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Uint16BufferAttribute(x,S)}function Int32Attribute(x,S){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Int32BufferAttribute(x,S)}function Uint32Attribute(x,S){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Uint32BufferAttribute(x,S)}function Float32Attribute(x,S){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Float32BufferAttribute(x,S)}function Float64Attribute(x,S){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Float64BufferAttribute(x,S)}function AxisHelper(x){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new AxesHelper(x)}function BoundingBoxHelper(x,S){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new BoxHelper(x,S)}function EdgesHelper(x,S){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new LineSegments(new EdgesGeometry(x.geometry),new LineBasicMaterial({color:void 0!==S?S:16777215}))}function WireframeHelper(x,S){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new LineSegments(new WireframeGeometry(x.geometry),new LineBasicMaterial({color:void 0!==S?S:16777215}))}function XHRLoader(x){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new FileLoader(x)}function BinaryTextureLoader(x){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new DataTextureLoader(x)}function WebGLRenderTargetCube(x,S,w){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new WebGLCubeRenderTarget(x,w)}function CanvasRenderer(){console.error("THREE.CanvasRenderer has been removed")}function JSONLoader(){console.error("THREE.JSONLoader has been removed.")}Curve.create=function(x,S){return console.log("THREE.Curve.create() has been deprecated"),x.prototype=Object.create(Curve.prototype),x.prototype.constructor=x,x.prototype.getPoint=S,x},Path.prototype.fromPoints=function(x){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(x)},GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},SkeletonHelper.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Loader.prototype.extractUrlBase=function(x){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),LoaderUtils.extractUrlBase(x)},Loader.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Box2.prototype.center=function(x){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(x)},Box2.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Box2.prototype.isIntersectionBox=function(x){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(x)},Box2.prototype.size=function(x){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(x)},Box3.prototype.center=function(x){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(x)},Box3.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Box3.prototype.isIntersectionBox=function(x){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(x)},Box3.prototype.isIntersectionSphere=function(x){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(x)},Box3.prototype.size=function(x){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(x)},Sphere.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Frustum.prototype.setFromMatrix=function(x){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(x)},Line3.prototype.center=function(x){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(x)},Matrix3.prototype.flattenToArrayOffset=function(x,S){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(x,S)},Matrix3.prototype.multiplyVector3=function(x){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),x.applyMatrix3(this)},Matrix3.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Matrix3.prototype.applyToBufferAttribute=function(x){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),x.applyMatrix3(this)},Matrix3.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Matrix3.prototype.getInverse=function(x){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(x).invert()},Matrix4.prototype.extractPosition=function(x){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(x)},Matrix4.prototype.flattenToArrayOffset=function(x,S){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(x,S)},Matrix4.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Vector3).setFromMatrixColumn(this,3)},Matrix4.prototype.setRotationFromQuaternion=function(x){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(x)},Matrix4.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Matrix4.prototype.multiplyVector3=function(x){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),x.applyMatrix4(this)},Matrix4.prototype.multiplyVector4=function(x){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),x.applyMatrix4(this)},Matrix4.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Matrix4.prototype.rotateAxis=function(x){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),x.transformDirection(this)},Matrix4.prototype.crossVector=function(x){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),x.applyMatrix4(this)},Matrix4.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Matrix4.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Matrix4.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Matrix4.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Matrix4.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Matrix4.prototype.applyToBufferAttribute=function(x){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),x.applyMatrix4(this)},Matrix4.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Matrix4.prototype.makeFrustum=function(x,S,w,U,G,H){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(x,S,U,w,G,H)},Matrix4.prototype.getInverse=function(x){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(x).invert()},Plane.prototype.isIntersectionLine=function(x){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(x)},Quaternion.prototype.multiplyVector3=function(x){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),x.applyQuaternion(this)},Quaternion.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ray.prototype.isIntersectionBox=function(x){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(x)},Ray.prototype.isIntersectionPlane=function(x){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(x)},Ray.prototype.isIntersectionSphere=function(x){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(x)},Triangle.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Triangle.prototype.barycoordFromPoint=function(x,S){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(x,S)},Triangle.prototype.midpoint=function(x){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(x)},Triangle.prototypenormal=function(x){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(x)},Triangle.prototype.plane=function(x){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(x)},Triangle.barycoordFromPoint=function(x,S,w,U,G){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Triangle.getBarycoord(x,S,w,U,G)},Triangle.normal=function(x,S,w,U){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Triangle.getNormal(x,S,w,U)},Shape.prototype.extractAllPoints=function(x){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(x)},Shape.prototype.extrude=function(x){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ExtrudeGeometry(this,x)},Shape.prototype.makeGeometry=function(x){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ShapeGeometry(this,x)},Vector2.prototype.fromAttribute=function(x,S,w){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(x,S,w)},Vector2.prototype.distanceToManhattan=function(x){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(x)},Vector2.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Vector3.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Vector3.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Vector3.prototype.getPositionFromMatrix=function(x){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(x)},Vector3.prototype.getScaleFromMatrix=function(x){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(x)},Vector3.prototype.getColumnFromMatrix=function(x,S){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(S,x)},Vector3.prototype.applyProjection=function(x){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(x)},Vector3.prototype.fromAttribute=function(x,S,w){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(x,S,w)},Vector3.prototype.distanceToManhattan=function(x){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(x)},Vector3.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Vector4.prototype.fromAttribute=function(x,S,w){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(x,S,w)},Vector4.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Object3D.prototype.getChildByName=function(x){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(x)},Object3D.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Object3D.prototype.translate=function(x,S){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(S,x)},Object3D.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Object3D.prototype.applyMatrix=function(x){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(x)},Object.defineProperties(Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(x){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=x}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Mesh.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Mesh.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Wn},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),SkinnedMesh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},PerspectiveCamera.prototype.setLens=function(x,S){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==S&&(this.filmGauge=S),this.setFocalLength(x)},Object.defineProperties(Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(x){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=x}},shadowCameraLeft:{set:function(x){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=x}},shadowCameraRight:{set:function(x){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=x}},shadowCameraTop:{set:function(x){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=x}},shadowCameraBottom:{set:function(x){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=x}},shadowCameraNear:{set:function(x){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=x}},shadowCameraFar:{set:function(x){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=x}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(x){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=x}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(x){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=x}},shadowMapHeight:{set:function(x){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=x}}}),Object.defineProperties(BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ri},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ri)}}}),BufferAttribute.prototype.setDynamic=function(x){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===x?Ri:Mi),this},BufferAttribute.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},BufferAttribute.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},BufferGeometry.prototype.addIndex=function(x){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(x)},BufferGeometry.prototype.addAttribute=function(x,S){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),S&&S.isBufferAttribute||S&&S.isInterleavedBufferAttribute?"index"===x?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(S),this):this.setAttribute(x,S):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(x,new BufferAttribute(arguments[1],arguments[2])))},BufferGeometry.prototype.addDrawCall=function(x,S,w){void 0!==w&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(x,S)},BufferGeometry.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},BufferGeometry.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},BufferGeometry.prototype.removeAttribute=function(x){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(x)},BufferGeometry.prototype.applyMatrix=function(x){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(x)},Object.defineProperties(BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),InterleavedBuffer.prototype.setDynamic=function(x){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===x?Ri:Mi),this},InterleavedBuffer.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ExtrudeGeometry.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},ExtrudeGeometry.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},ExtrudeGeometry.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Scene.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Uniform.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Material.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Color}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(x){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=x===ne}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(x){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=x}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(x){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=x}}}),WebGLRenderer.prototype.clearTarget=function(x,S,w,U){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(x),this.clear(S,w,U)},WebGLRenderer.prototype.animate=function(x){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(x)},WebGLRenderer.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},WebGLRenderer.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},WebGLRenderer.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},WebGLRenderer.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},WebGLRenderer.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},WebGLRenderer.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},WebGLRenderer.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},WebGLRenderer.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},WebGLRenderer.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},WebGLRenderer.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},WebGLRenderer.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},WebGLRenderer.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},WebGLRenderer.prototype.enableScissorTest=function(x){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(x)},WebGLRenderer.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},WebGLRenderer.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},WebGLRenderer.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},WebGLRenderer.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},WebGLRenderer.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},WebGLRenderer.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},WebGLRenderer.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},WebGLRenderer.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},WebGLRenderer.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},WebGLRenderer.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(x){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=x}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(x){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=x}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(x){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===x?Kn:Xn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(WebGLShadowMap.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(x){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=x}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(x){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=x}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(x){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=x}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(x){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=x}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(x){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=x}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(x){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=x}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(x){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=x}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(x){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=x}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(x){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=x}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(x){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=x}}}),Audio.prototype.load=function(x){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const S=this;return(new AudioLoader).load(x,(function(x){S.setBuffer(x)})),this},AudioAnalyser.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},CubeCamera.prototype.updateCubeMap=function(x,S){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(x,S)},CubeCamera.prototype.clear=function(x,S,w,U){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(x,S,w,U)},ImageUtils.crossOrigin=void 0,ImageUtils.loadTexture=function(x,S,w,U){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const G=new TextureLoader;G.setCrossOrigin(this.crossOrigin);const H=G.load(x,w,void 0,U);return S&&(H.mapping=S),H},ImageUtils.loadTextureCube=function(x,S,w,U){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const G=new CubeTextureLoader;G.setCrossOrigin(this.crossOrigin);const H=G.load(x,w,void 0,U);return S&&(H.mapping=S),H},ImageUtils.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ImageUtils.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const _l={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function LensFlare(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function ParametricGeometry(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new BufferGeometry}function TextGeometry(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new BufferGeometry}function FontLoader(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function Font(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:U}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=U)},557:(x,S,w)=>{WebGLDebugUtils=function(){var x;void 0===x&&(x=w.g);var error=function(S){x.console&&x.console.error?x.console.error(S):function(S){x.console&&x.console.log&&x.console.log(S)}(S)},S={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},U=null,G=null;function init(x){if(null==U)for(var S in U={},G={},x)"number"==typeof x[S]&&(U[x[S]]=S,G[S]=x[S])}function checkInit(){if(null==U)throw"WebGLDebugUtils.init(ctx) not called"}function glEnumToString(x){checkInit();var S=U[x];return void 0!==S?"gl."+S:"/*UNKNOWN WebGL ENUM*/ 0x"+x.toString(16)}function glFunctionArgToString(x,w,U,H){var z;if(void 0!==(z=S[x])&&(void 0!==(z=z[w])&&z[U])){if("object"==typeof z[U]&&void 0!==z[U].enumBitwiseOr){for(var j=z[U].enumBitwiseOr,X=0,K=[],q=0;q<j.length;++q){var Y=G[j[q]];0!=(H&Y)&&(X|=Y,K.push(glEnumToString(Y)))}return X===H?K.join(" | "):glEnumToString(H)}return glEnumToString(H)}return null===H?"null":void 0===H?"undefined":H.toString()}function makePropertyWrapper(x,S,w){x.__defineGetter__(w,(function(){return S[w]})),x.__defineSetter__(w,(function(x){S[w]=x}))}function resetToInitialState(x){var S=!!x.createTransformFeedback;S&&x.bindVertexArray(null);var w=x.getParameter(x.MAX_VERTEX_ATTRIBS),U=x.createBuffer();x.bindBuffer(x.ARRAY_BUFFER,U);for(var G=0;G<w;++G)x.disableVertexAttribArray(G),x.vertexAttribPointer(G,4,x.FLOAT,!1,0,0),x.vertexAttrib1f(G,0),S&&x.vertexAttribDivisor(G,0);x.deleteBuffer(U);var H=x.getParameter(x.MAX_TEXTURE_IMAGE_UNITS);for(G=0;G<H;++G)x.activeTexture(x.TEXTURE0+G),x.bindTexture(x.TEXTURE_CUBE_MAP,null),x.bindTexture(x.TEXTURE_2D,null),S&&(x.bindTexture(x.TEXTURE_2D_ARRAY,null),x.bindTexture(x.TEXTURE_3D,null),x.bindSampler(G,null));if(x.activeTexture(x.TEXTURE0),x.useProgram(null),x.bindBuffer(x.ARRAY_BUFFER,null),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,null),x.bindFramebuffer(x.FRAMEBUFFER,null),x.bindRenderbuffer(x.RENDERBUFFER,null),x.disable(x.BLEND),x.disable(x.CULL_FACE),x.disable(x.DEPTH_TEST),x.disable(x.DITHER),x.disable(x.SCISSOR_TEST),x.blendColor(0,0,0,0),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.ONE,x.ZERO),x.clearColor(0,0,0,0),x.clearDepth(1),x.clearStencil(-1),x.colorMask(!0,!0,!0,!0),x.cullFace(x.BACK),x.depthFunc(x.LESS),x.depthMask(!0),x.depthRange(0,1),x.frontFace(x.CCW),x.hint(x.GENERATE_MIPMAP_HINT,x.DONT_CARE),x.lineWidth(1),x.pixelStorei(x.PACK_ALIGNMENT,4),x.pixelStorei(x.UNPACK_ALIGNMENT,4),x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,!1),x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),x.UNPACK_COLORSPACE_CONVERSION_WEBGL&&x.pixelStorei(x.UNPACK_COLORSPACE_CONVERSION_WEBGL,x.BROWSER_DEFAULT_WEBGL),x.polygonOffset(0,0),x.sampleCoverage(1,!1),x.scissor(0,0,x.canvas.width,x.canvas.height),x.stencilFunc(x.ALWAYS,0,4294967295),x.stencilMask(4294967295),x.stencilOp(x.KEEP,x.KEEP,x.KEEP),x.viewport(0,0,x.canvas.width,x.canvas.height),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT|x.STENCIL_BUFFER_BIT),S){x.drawBuffers([x.BACK]),x.readBuffer(x.BACK),x.bindBuffer(x.COPY_READ_BUFFER,null),x.bindBuffer(x.COPY_WRITE_BUFFER,null),x.bindBuffer(x.PIXEL_PACK_BUFFER,null),x.bindBuffer(x.PIXEL_UNPACK_BUFFER,null);var z=x.getParameter(x.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(G=0;G<z;++G)x.bindBufferBase(x.TRANSFORM_FEEDBACK_BUFFER,G,null);var j=x.getParameter(x.MAX_UNIFORM_BUFFER_BINDINGS);for(G=0;G<j;++G)x.bindBufferBase(x.UNIFORM_BUFFER,G,null);x.disable(x.RASTERIZER_DISCARD),x.pixelStorei(x.UNPACK_IMAGE_HEIGHT,0),x.pixelStorei(x.UNPACK_SKIP_IMAGES,0),x.pixelStorei(x.UNPACK_ROW_LENGTH,0),x.pixelStorei(x.UNPACK_SKIP_ROWS,0),x.pixelStorei(x.UNPACK_SKIP_PIXELS,0),x.pixelStorei(x.PACK_ROW_LENGTH,0),x.pixelStorei(x.PACK_SKIP_ROWS,0),x.pixelStorei(x.PACK_SKIP_PIXELS,0),x.hint(x.FRAGMENT_SHADER_DERIVATIVE_HINT,x.DONT_CARE)}for(;x.getError(););}return{init,mightBeEnum:function mightBeEnum(x){return checkInit(),void 0!==U[x]},glEnumToString,glFunctionArgToString,glFunctionArgsToString:function glFunctionArgsToString(x,S){for(var w="",U=S.length,G=0;G<U;++G)w+=(0==G?"":", ")+glFunctionArgToString(x,U,G,S[G]);return w},makeDebugContext:function makeDebugContext(x,S,w,U){U=U||x,init(x),S=S||function(x,S,w){for(var U="",G=w.length,H=0;H<G;++H)U+=(0==H?"":", ")+glFunctionArgToString(S,G,H,w[H]);error("WebGL error "+glEnumToString(x)+" in "+S+"("+U+")")};var G={};function makeErrorWrapper(x,H){return function(){w&&w(H,arguments);var z=x[H].apply(x,arguments),j=U.getError();return 0!=j&&(G[j]=!0,S(j,H,arguments)),z}}var H={};for(var z in x)if("function"==typeof x[z])if("getExtension"!=z)H[z]=makeErrorWrapper(x,z);else{var j=makeErrorWrapper(x,z);H[z]=function(){var G=j.apply(x,arguments);return G?makeDebugContext(G,S,w,U):null}}else makePropertyWrapper(H,x,z);return H.getError=function(){for(var S in G)if(G.hasOwnProperty(S)&&G[S])return G[S]=!1,S;return x.NO_ERROR},H},makeLostContextSimulatingCanvas:function makeLostContextSimulatingCanvas(S){var w,U,G,H=[],z=[],j={},X=1,K=!1,q=[],Y=0,Z=0,J=!1,Q=0,ee={};function wrapEvent(x){return"function"==typeof x?x:function(S){x.handleEvent(S)}}S.getContext=(G=S.getContext,function(){var H=G.apply(S,arguments);if(H instanceof WebGLRenderingContext||x.WebGL2RenderingContext&&H instanceof WebGL2RenderingContext){if(H!=w){if(w)throw"got different context";U=x.WebGL2RenderingContext&&H instanceof WebGL2RenderingContext,j=makeLostContextSimulatingContext(w=H)}return j}return H});var addOnContextLostListener=function(x){H.push(wrapEvent(x))},addOnContextRestoredListener=function(x){z.push(wrapEvent(x))};function loseContextIfTime(){++Z,K||Y==Z&&S.loseContext()}function makeLostContextFunctionWrapper(x,S){var w=x[S];return function(){if(loseContextIfTime(),!K){var S=w.apply(x,arguments);return S}}}function makeWebGLContextEvent(x){return{statusMessage:x,preventDefault:function(){J=!0}}}return function wrapAddEventListener(x){var S=x.addEventListener;x.addEventListener=function(w,U,G){switch(w){case"webglcontextlost":addOnContextLostListener(U);break;case"webglcontextrestored":addOnContextRestoredListener(U);break;default:S.apply(x,arguments)}}}(S),S.loseContext=function(){if(!K){for(K=!0,Y=0,++X;w.getError(););!function clearErrors(){for(var x=Object.keys(ee),S=0;S<x.length;++S)delete ee[x[S]]}(),ee[w.CONTEXT_LOST_WEBGL]=!0;var x=makeWebGLContextEvent("context lost"),U=H.slice();setTimeout((function(){for(var w=0;w<U.length;++w)U[w](x);Q>=0&&setTimeout((function(){S.restoreContext()}),Q)}),0)}},S.restoreContext=function(){K&&z.length&&setTimeout((function(){if(!J)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function freeResources(){for(var x=0;x<q.length;++x){var S=q[x];S instanceof WebGLBuffer?w.deleteBuffer(S):S instanceof WebGLFramebuffer?w.deleteFramebuffer(S):S instanceof WebGLProgram?w.deleteProgram(S):S instanceof WebGLRenderbuffer?w.deleteRenderbuffer(S):S instanceof WebGLShader?w.deleteShader(S):S instanceof WebGLTexture?w.deleteTexture(S):U&&(S instanceof WebGLQuery?w.deleteQuery(S):S instanceof WebGLSampler?w.deleteSampler(S):S instanceof WebGLSync?w.deleteSync(S):S instanceof WebGLTransformFeedback?w.deleteTransformFeedback(S):S instanceof WebGLVertexArrayObject&&w.deleteVertexArray(S))}}(),resetToInitialState(w),K=!1,Z=0,J=!1;for(var x=z.slice(),S=makeWebGLContextEvent("context restored"),G=0;G<x.length;++G)x[G](S)}),0)},S.loseContextInNCalls=function(x){if(K)throw"You can not ask a lost contet to be lost";Y=Z+x},S.getNumCalls=function(){return Z},S.setRestoreTimeout=function(x){Q=x},S;function makeLostContextSimulatingContext(x){for(var S in x)"function"==typeof x[S]?j[S]=makeLostContextFunctionWrapper(x,S):makePropertyWrapper(j,x,S);j.getError=function(){if(loseContextIfTime(),!K)for(;x=w.getError();)ee[x]=!0;for(var x in ee)if(ee[x])return delete ee[x],x;return j.NO_ERROR};var G=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];U&&G.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var H=0;H<G.length;++H){var z=G[H];j[z]=function(S){return function(){if(loseContextIfTime(),K)return null;var w=S.apply(x,arguments);return w.__webglDebugContextLostId__=X,q.push(w),w}}(x[z])}var Y=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];U&&Y.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(H=0;H<Y.length;++H){z=Y[H];j[z]=function(S){return function(){return loseContextIfTime(),K?null:S.apply(x,arguments)}}(j[z])}var Z=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];U&&Z.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(H=0;H<Z.length;++H){z=Z[H];j[z]=function(S){return function(){return loseContextIfTime(),!K&&S.apply(x,arguments)}}(j[z])}return j.checkFramebufferStatus=function(S){return function(){return loseContextIfTime(),K?j.FRAMEBUFFER_UNSUPPORTED:S.apply(x,arguments)}}(j.checkFramebufferStatus),j.getAttribLocation=function(S){return function(){return loseContextIfTime(),K?-1:S.apply(x,arguments)}}(j.getAttribLocation),j.getVertexAttribOffset=function(S){return function(){return loseContextIfTime(),K?0:S.apply(x,arguments)}}(j.getVertexAttribOffset),j.isContextLost=function(){return K},U&&(j.getFragDataLocation=function(S){return function(){return loseContextIfTime(),K?-1:S.apply(x,arguments)}}(j.getFragDataLocation),j.clientWaitSync=function(S){return function(){return loseContextIfTime(),K?j.WAIT_FAILED:S.apply(x,arguments)}}(j.clientWaitSync),j.getUniformBlockIndex=function(S){return function(){return loseContextIfTime(),K?j.INVALID_INDEX:S.apply(x,arguments)}}(j.getUniformBlockIndex)),j}},resetToInitialState}}(),x.exports=WebGLDebugUtils},745:x=>{x.exports="#version 100\n#extension GL_EXT_draw_buffers: enable\nprecision highp float;\n\nuniform sampler2D u_colmap;\nuniform sampler2D u_normap;\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\n\nuniform mat4 u_view;\n\nvec3 applyNormalMap(vec3 geomnor, vec3 normap) {\n    normap = normap * 2.0 - 1.0;\n    vec3 up = normalize(vec3(0.001, 1, 0.001));\n    vec3 surftan = normalize(cross(geomnor, up));\n    vec3 surfbinor = cross(geomnor, surftan);\n    return normap.y * surftan + normap.x * surfbinor + normap.z * geomnor;\n}\n\nvoid main() {\n    vec3 norm = applyNormalMap(v_normal, vec3(texture2D(u_normap, v_uv)));\n    vec3 col = vec3(texture2D(u_colmap, v_uv));\n\n    // TODO: populate your g buffer\n    gl_FragData[0] = vec4(col, 1.0);\n    gl_FragData[1] = vec4(norm, 1.0);\n    gl_FragData[2] = vec4(v_position, 1.0);\n\n    //gl_FragData[3] = vec4(1.0);\n\n    // optimized version\n    //vec3 norm_sq = normalize(vec3(u_view * vec4(norm,0.0)));\n    //gl_FragData[0] = vec4(col, norm_sq.x);\n    //gl_FragData[1] = vec4(v_position, norm_sq.y);\n}"},864:x=>{x.exports="#version 100\nprecision highp float;\n\nuniform mat4 u_viewProjectionMatrix;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_Position = u_viewProjectionMatrix * vec4(a_position, 1.0);\n    v_position = a_position;\n    v_normal = a_normal;\n    v_uv = a_uv;\n}"},594:x=>{x.exports="#version 100\nprecision highp float;\n\nuniform mat4 u_viewProjectionMatrix;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_Position = u_viewProjectionMatrix * vec4(a_position, 1.0);\n    v_position = a_position;\n    v_normal = a_normal;\n    v_uv = a_uv;\n}"},863:x=>{x.exports="#version 100\nprecision highp float;\n\nuniform mat4 u_viewProjectionMatrix;\n\nattribute vec3 a_position;\nattribute vec3 a_normal;\nattribute vec2 a_uv;\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_Position = u_viewProjectionMatrix * vec4(a_position, 1.0);\n    v_position = a_position;\n    v_normal = a_normal;\n    v_uv = a_uv;\n}"},999:x=>{x.exports="#version 100\nprecision highp float;\n\nattribute vec3 a_position;\n\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_Position = vec4(a_position, 1.0);\n    v_uv = a_position.xy * 0.5 + 0.5;\n}"},355:x=>{x.exports="precision highp float;\n\nvarying vec3 v_color;\n\nvoid main() {\n  gl_FragColor = vec4(v_color, 1.0);\n}\n"},7:x=>{x.exports="#version 100\nprecision highp float;\n\nuniform mat4 u_viewProjectionMatrix;\n\nattribute vec3 a_position;\nattribute vec3 a_color;\n\nvarying vec3 v_color;\n\nvoid main() {\n    gl_Position = u_viewProjectionMatrix * vec4(a_position, 1.0);\n    v_color = a_color;\n}\n"}},S={};function __webpack_require__(w){var U=S[w];if(void 0!==U)return U.exports;var G=S[w]={exports:{}};return x[w].call(G.exports,G,G.exports,__webpack_require__),G.exports}__webpack_require__.n=x=>{var S=x&&x.__esModule?()=>x.default:()=>x;return __webpack_require__.d(S,{a:S}),S},__webpack_require__.d=(x,S)=>{for(var w in S)__webpack_require__.o(S,w)&&!__webpack_require__.o(x,w)&&Object.defineProperty(x,w,{enumerable:!0,get:S[w]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(x){if("object"==typeof window)return window}}(),__webpack_require__.o=(x,S)=>Object.prototype.hasOwnProperty.call(x,S),__webpack_require__.r=x=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})};__webpack_require__(943)})();
//# sourceMappingURL=bundle.js.map